<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook V3.1//EN"[
<!ENTITY szarp-info SYSTEM "../common/szarp-info.sgml">
<!ENTITY wdrozenia SYSTEM "../common/wdrozenia.sgml">
]>

<!--
$Id: howto.sgml 6724 2009-05-18 08:37:03Z reksio $
-->

<!-- Yo! 
Ten plik jest fragmentem dokumentacji systemu SZARP.
Jest napisany Docbooku (dialekcie SGML-a).
Styl pisania niniejszego dokumentu nie by³ explicite narzucony, 
st±d jego niejednorodno¶æ.
Jedyn± chyba szczególn± cech± by³y nazwy tagów, pisane z wielkiej litery
(sgml nie jest wra¿liwy na wielko¶æ czcionki). 
Obserwuj±c jednak rozwój Docbooka
widaæ du¿y zwrot ku XML-owi. Zeby u³atwiæ pó¼niejszym dokumentatorom
przeniesienie dokumetu na XML-a proponujê dwie rzeczy:
	o) niekorzystanie z pustych zamkniêæ tagów (</>), XML wymaga
	oznaczenia jaki tag jest zamykany. Czyli np. zamiast
	<quote>System</> piszmy: <quote>System</quote>.
	o) nieu¿ywanie wielkich liter wewn±trz tagów, czyli 
	zamiast <Para>Paragraf</Para>, piszmy <para>Paragraf</para>

Kolejna niekompatybilno¶æ pomiêdzy SGML-em i XML-em w postaci 
,,domykania'' sekcji tagów, które nie maj± tagów zamykaj±cych 
(np. w SGML-u mamy <xref linkend=""> podczas 
gdy w  XML-u <xref linkend=""/>) bêdzie mo¿na za³atwiæ w przysz³o¶ci 
odpowiednim skryptem 

Vooyeck 
-->

<book lang="pl" id="howto">

<bookinfo>

&szarp-info;

<title>SZARP HOWTO</title>

<subtitle>SZARP + Debian/Red Hat</subtitle>
<authorgroup>
<author><firstname>Micha³</firstname><surname>Blajerski</surname></author>
<author><firstname>Krzysztof</firstname><surname>Ga³±zka</surname></author>
<author><firstname>Dariusz</firstname><surname>Marcinkiewicz</surname></author>
<author><firstname>Maciej</firstname><surname>Mochol</surname></author>
<author><firstname>Jaros³aw</firstname><surname>Nowisz</surname></author>
<author><firstname>Pawe³</firstname><surname>Pa³ucha</surname></author>
<author><firstname>Lucjan</firstname><surname>Przykorski</surname></author>
<author><firstname>Micha³</firstname><surname>Rój</surname></author>
<author><firstname>Stanis³aw</firstname><surname>Sawa</surname></author>
</authorgroup>


<Abstract>

<para>
Dokument znany pod nazw± <quote>SZARP Howto</quote> powsta³ jako zbiór informacji
dotycz±cych Systemu Zbierania, Archiwizacji i Prezentacji danych SZARP, a w 
szczególno¶ci zagadnieñ zwi±zanych z instalacj±, konfiguracj± i u¿ywaniem
systemu operacyjnego RedHat Linux, pod kontrol± którego dzia³a³ SZARP.
Obecnie dokumentacja techniczna systemu SZARP zosta³a przeniesiona do
oddzielnego dokumentu, natomiast je¿eli chodzi o Linuksa nacisk zosta³
przeniesiony na dystrybucjê Debian i to do niej odnosi siê wiêkszo¶æ
aktualnych informacji, choæ dokument mo¿e byæ tak¿e przydatny dla u¿ytkowników
innych dystrybucji.
</para>
<para>
HOWTO przeznaczone jest dla ludzi z ogóln± wiedz± dotycz±c± komputerów i 
podstawowych komend Linuksa/Uniksa (w szczególno¶ci nie jest wymagana bieg³a 
znajomo¶æ Linuksa).
</para>

<para>
W³a¶cicielem praw autorskich do dokumentu jest firma <ulink
url="http://www.praterm.pl">Praterm S.A.</ulink> z siedzib± w
Warszawie. Ten utwór objêty jest licencj± <emphasis>Creative Commons Uznanie 
autorstwa-Na tych samych warunkach</emphasis>. Aby zobaczyæ kopiê niniejszej 
licencji przejd¼ na stronê 
<ulink url="http://creativecommons.org/licenses/by-sa/2.0/pl/">
http://creativecommons.org/licenses/by-sa/2.0/pl/</ulink>
lub  napisz do Creative Commons, 559 Nathan Abbott Way, Stanford, 
California 94305, USA. Na podstawie niniejszej licencji dozwolone jest
kopiowanie, rozpowszechnienie, modyfikowanie i komercyjne wykorzystanie 
tego dokumentu, pod warunkiem zamieszczenia informacji o autorach/w³a¶cicielu 
praw autorskich oraz
udostêpniania tego dokumentu (w tym jego zmodyfikowanych wersji) na warunkach
tej samej licencji.
</para>
<para>
Firma Praterm S.A. oraz autorzy nie ponosz± ¿adnej odpowiedzialno¶ci za
wykorzystanie informacji zawartych w tym dokumencie.
</para>

<para>
$Id: howto.sgml 6724 2009-05-18 08:37:03Z reksio $
</para>

</Abstract>


</bookinfo>


<part id="wstep">
<title>Wstêp</title>

<chapter id="historia-szarpa">
<title>Historia systemu SZARP</title>

<para>
Wszystko zaczê³o siê w roku 1991. Inicjatorem by³ Witold Kowalewski, w³a¶ciciel
firmy Praterm. Praterm od momentu powstania w 1983 roku zajmowa³ siê
automatyzacj± ciep³ownictwa. Pocz±tkowo wykorzystywa³ urz±dzenia
elektro-mechaniczne, od 1989 roku zacz±³ wykorzystywaæ mikroprocesorowe
sterowniki przemys³owe firmy Z-Elektronik nale¿±cej do Krystiana Zasadziñskiego.
Wkrótce okaza³o siê, ¿e dla przeprowadzenia analiz prowadzenia przez automatykê
procesów technologicznych w ciep³ownictwie potrzebny jest system do
rejestrowania danych charakteryzuj±cych te procesy: temperatur, ci¶nieñ itp.
Zbieg³o siê to z pocz±tkiem ery komputerów PC. W 1991 roku Piotr Branecki
stworzy³ pierwszy program w Turbo Pascalu pracuj±cy pod DOSem, który zbiera³
dane ze sterowników pod³±czonych za pomoc± terminala wieloportowego firmy
Specialix przez RS-y 232. Dane zapisane by³y w formacie binarnym specyficznym
dla tego programu. W roku 1992 do prac nad rozwojem SZARPa do³±czy³
Lucjan Przykorski. Oprogramowanie zosta³o podzielone na dwie czê¶ci:
</para>

<para>

<itemizedlist>
<listitem>

<para>
Serwer zbieraj±cy dane i prezentuj±cy je w formie raportów oraz
wykresów z ostatniej doby.

</para>
</listitem>
<listitem>

<para>
Terminal z programem przegl±daj±cym do prezentacji w formie wykresów
danych zarejestrowanych od pocz±tku pracy systemu.
</para>
</listitem>

</itemizedlist>

</para>

<para>
Wszystko pracowa³o w jednow±tkowym DOSie, st±d potrzeba dwóch komputerów,
aby mo¿na by³o uruchomiæ w systemie wiêcej ni¿ jeden program. Sieæ pracowa³a na
Novell NWLite 1.0, potem 1.1. Baza zapisywana by³a w systemie opartym na
plikach dBaseIV: DBF + MDX, który to format zachowa³ siê a¿ do SZARP v2.1.
W roku 1993 do zespo³u programistów do³±czy³ na chwilê Stanis³aw K³osiñski,
autor innego programu klienckiego dedykowanego do pracy na terminalu, s³u¿±cego
do specjalistycznej analizy zarejestrowanych danych.
</para>
<para>
W tym samym roku 1993 Branecki i Przykorski przenie¶li SZARP na platformê
Unix - by³ to USL Unix SVR4.2 firmy Consensys, którego ilo¶æ egzemplarzy
sprzedana w Polsce da³a siê policzyæ na palcach. SZARP jako system pracuj±cy
w ¶rodowisku wielozadaniowym zosta³ podzielony na szereg programów. Czê¶æ z nich
dzia³a³a jako demony pracuj±ce w tle, interfejs u¿ytkownika stanowi³y za¶
aplikacje klienckie wykorzystuj±ce Motif 1.1.1. W roku 1994 do zespo³u
programistów do³±czy³ Marcin Anderson, twórca kilku programów zarówno w
kategorii demonów jak i aplikacji u¿ytkowych.
</para>
<para>
We wrze¶niu 1994 Branecki i Przykorski obronili na Wydziale Elektroniki
i Technik Informatycznych Politechniki Warszawskiej pracê dyplomow±:
"System zbierania danych i sterowania wolnozmiennych procesów technologicznych
o rozproszonych punktach kontrolno-pomiarowych". Praca to dotyczy³a SZARPa i
wspó³pracuj±cych z nim sterowników przemys³owych. Pomimo innowacyjnego
charakteru pracy, kilku dzia³aj±cych w rzeczywisto¶ci instalacji i ewenementu
w postaci filmu, który dyplomanci nakrêcili w ramach pracy, spotka³a siê z
pe³n± ignorancj± ze strony uczelni.
</para>
<para>
Jeszcze w roku 1994 SZARP doczeka³ siê nowego systemu operacyjnego:
Novell UnixWare 1.1, który zosta³ przez Novella zakupiony od AT&amp;T. Nastêpn±
platform± by³ Novell UnixWare 2.03, po której to wersji Novell sprzeda³ ze
strat± UnixWare do SCO. Ta ostatnia wypu¶ci³a w 1995 roku SCO UnixWare 2.1,
który nie licz±c kilku patchy by³ ostatnim z komercyjnych Unixów, na którym
pracowa³ SZARP.
</para>
<para>
W latach 1993-1995 jako terminale wykorzystywane by³y komputery pracuj±ce w
DOSie z programem XAppeal firmy Xtreme charakteryzuj±cy siê bardzo ma³ymi
wymaganiami sprzêtowymi i jeszcze mniejsz± list± obs³ugiwanego sprzêtu nie
ró¿ni±c siê specjalnie w tym ostatnim od linii UnixWare. Od roku 1996 w swoich
instalacjach Praterm zacz±³ wykorzystywaæ emulatory Xserwera pracuj±ce pod
MS-Windows: Starnet X-Win, SCO XVision Eclipse 7.1, Labf.com X-Win Pro / WinaXe. Najwiêcej
terminali zosta³o wykorzystanych w oparciu o ten ostatni, najtañszy, najl¿ejszy
i najbardziej rozwijaj±cy siê produkt fiñskich programistów.
</para>
<para>
W 1996 roku pozostaj±cy do tego momentu bezimiennym system zbierania,
archiwizacji i prezentacji danych doczeka³ siê oficjalnej nazwy SZARP v2.0.
Nazwa SZARP v1.0 mia³a dotyczyæ instalacji pod DOSem. SZARP v2.0 sk³ada³ siê z
12 modu³ów, jego struktura pozwala³a na dowoln± rozbudowê o kolejne.
W lecie roku 1996 od Pratermu odszed³ Piotr Branecki, na pocz±tku roku 1997
firmê opu¶ci³ tak¿e Marcin Anderson. W roku 1997 w Legionowie dokonana zosta³a
ostatnia instalacja SZARPa na SCO UnixWare. Pod koniec roku 1997 do zespo³u
programistów do³±czyli Maciej Mochol i Jaros³aw Nowisz. To oni dokonali portu
SZARP z UnixWare do Linuksa tworz±c w ten sposób SZARP v2.1. Oprócz samego
przeniesienia wykonali szereg usprawnieñ i usunêli niezliczon± masê b³êdów. 
W roku 1998 SZARP doczeka³ siê repozytorium CVS, na którym rezyduje do dnia 
dzisiejszego. W tym samym roku Maciej Mochol zaadoptowa³ SZARPa do autoconfa i 
stworzy³ z niego dystrybucjê (wcze¶niej by³a to lu¼no rozrzucona grupa programów).
Od roku 1998 SZARP by³ instalowany ju¿ tylko na Linuxie, pocz±tkowo na dystrybucji
Red Hat poczynaj±c od wersji 5.2.
</para>
<para>
W roku 1999 do zespo³u programistów do³±czy³ Micha³ Rój. Na pocz±tku roku 2000 
Maciej Mochol stworzy³ narzêdzie parconf, które pó¼niej wielokrotnie udoskonalane 
znakomicie usprawni³o zmiany w konfiguracji poszczególnych serwerów, które to 
zmiany wcze¶niej wymaga³y du¿ej ilo¶ci rêcznych operacji. W po³owie 2000 roku 
zespó³ rozszerzy³ siê o Paw³a Pa³uchê. Pod koniec roku 2000 zrezygnowa³ z 
pracy nad projektem Jaros³aw Nowisz. W po³owie kwietnia 2001 uruchomiona 
zosta³a pierwsza instalacja BODASa - Bazy Ogólnopolskiej Danych Archiwalnych 
SZARP. Czê¶æ systemów z SZARPem pod³±czonych do internetu przez sta³e ³±cze
zrzuca aktualne dane co 10 minut, nieliczne ju¿ hosty z modemami ³±cz± siê raz na dobê 
zgrywaj±c dane na serwer praterm.com.pl. Do centralnego serwera Pratermu 
pod³±czane s± sukcesywnie kolejne hosty z SZARPem. W kwietniu 2001 do zespo³u 
developerów SZARPa do³±czy³ Stanis³aw Sawa. Pod koniec roku 2001 Pawe³ Pa³ucha 
doda³ do SZARPa pierwsz± od d³u¿szego czasu aplikacjê z graficznym interfejsem 
u¿ytkownika - Dyspozytor. 
</para>
<para>
Na pocz±tku 2002 zrezygnowa³ z pracy w zespole Maciej Mochol. We wrze¶niu 2002 
roku Pawe³ Pa³ucha obroni³ na Wydziale Matematyki, Informatyki i Mechaniki 
Uniwersytetu Warszawskiego kolejn± pracê magistersk± dotycz±c± SZARPa - <emphasis>Zdalne 
sterowanie i kontrola procesu przemys³owego z wykorzystaniem technologii XML/SVG</emphasis>,
tworz±c tym samym now± wersjê wizualizacyjnej czê¶ci systemu. Pod koniec roku 2002 ten 
sam developer rozpocz±³ przenoszenie czê¶ci aplikacji u¿ytkowych SZARPa na platformê 
MS-Windows, z wykorzystaniem biblioteki wxWindows/wxWidgets. 
</para>
<para>
W roku 2003 SZARP by³ instalowany na pochodnych dystrybucji Red Hat - Aurox 9.x. 
W tym samym roku, w zwi±zku z wycofaniem siê Red Hat z rozwijania dystrybucji 
niekomercyjnych, SZARP zacz±³ byæ instalowany na Debianie, którego specjalizowan± 
dystrybucjê przygotowa³ Stanis³aw Sawa. W tym samym roku terminale windowsowe 
zaczê³y byæ wyposa¿ane w Xserwer Cygwin - w odró¿nieniu od WinaXe darmowy i 
wyposa¿ony w wiele funkcji jak np. serwer sshd. Tak¿e w 2003 roku Pawe³ Pa³ucha 
rozpocz±³ prace nad przeniesieniem konfiguracji do IPK - Idealnego Pliku 
Konfiguracyjnego - w formacie XML.
</para>
<para>
W roku 2004 do zespo³u "sterownikowego" firmy Praterm S.A. do³±czy³ Pawe³
Kolega, tak¿e uczestnicz±cy w rozwoju oprogramowania. Pawe³ Pa³ucha
zaprojektowa³ i zaimplementowa³ nowy, prostszy format bazy danych, co
pozwoli³o na stopniowe wycofywanie siê z ostatniego komercyjnego elementu
systemu - biblioteki Codebase do obs³ugi bazy dBase IV. Jako emulator
X-terminala dla terminali z Windows, ze wzglêdu na prostotê instalacji, zacz±³
byæ stosowany freeware'owy Pexus X/Deep32.
</para>
<para>
06.12.2004 akcje Praterm SA zadebiutowa³y na GPW, co w praktyce oznacza³o szereg powa¿nych zmian dla SZARPa. Skoñczy³ siê etap pilnowania ka¿dej z³otówki przy pracach rozwojowych (rozpatrywanie ka¿dego tematu pod k±tem zwrotu w jak najkrótszym czasie), zamiast tego nale¿a³o po³o¿yæ nacisk na bezpieczeñstwo. 01.01.2005 Lucjan Przykorski oficjalnie przesta³ byæ aktywnym cz³onkiem zespo³u programistów (co sta³o siê faktem jaki¶ czas wcze¶niej), zajmuj±c siê w Pratermie sprawami technicznymi, informatyka za¶ pozosta³a jego hobby. Szefem dzia³u IT zosta³ Pawe³ Pa³ucha, który od tego momentu decydowa³ o przyjmowaniu nowych informatyków i szczegó³owych pracach nad SZARPem.
</para>
<para>
Na prze³omie roku 2004/2005 wspó³pracê przy tworzeniu SZARP'a zakoñczy³ Micha³
Rój, natomiast do³±czyli trzej nowi programi¶ci - Micha³ Blajerski, Dariusz
Marcinkiewicz i Krzysztof Ga³±zka. Do dzia³u sterownikowego do³±czy³ Jarek
Janik. Dokoñczono przenoszenie ca³o¶ci konfiguracji do formatu XML. Powsta³o
wiele sterowników do nowych urz±dzeñ, oprogramowanie do importu danych z innych
systemów telemetrycznych, zrealizowano instalacje wykorzystuj±ce ³±czno¶æ
bezprzewodow± WLAN i komunikacjê GSM/GPRS.
</para>
<para>
Pod koniec III-go kwarta³u 2005 z pracy w zespole programistów zrezygnowa³ Stanis³aw Sawa. Na wszystkich ciep³ownie Pratermu dokonano aktualizacji 
systemów operacyjnych do Debiana, przeprowadzono konwersjê istniej±cych baz na
nowy format. Dzia³ania te uda³o siê tak¿e podj±æ u wiêkszo¶ci klientów
zewnêtrznych - mimo kilku nowo zakupionych przedsiêbiorstw 
nadal oko³o po³owy instalacji to spó³ki spoza grupy Praterm.
</para>
<para>
Rok 2006 to okres do¶æ intensywnego rozwoju aplikacji klienckich, w
szczególno¶ci pierwszym u¿ytkownikom zaoferowano wersje programu
przegl±daj±cego nowej generacji, pracuj±cego tak¿e pod kontrol± Windows.
W po³owie roku do zespo³u programistów do³±czy³ Krzysztof O³owski, choæ w
du¿ej mierze z my¶l± o pracy przy oprogramowaniu do sprawozdawczo¶ci
finansowej w holdingu.
</para>

</chapter>

<chapter id="wdrozenia">
<title>Wdro¿one instalacje</title>

<para>
Na przestrzeni historii SZARPa by³y ró¿ne instalacje: od DOSa przez UnixWare do
Linuksa. Do koñca roku 1999 uda³o siê dokonaæ upgrade'ów wszystkich
wcze¶niejszych instalacji do Linuksa, co pozwoli³o na uporz±dkowanie wersji
SZARPa - wszêdzie znajdowa³ siê SZARP v2.1. W po³owie 2005 roku, ze wzglêdu na 
zmianê formatu konfiguracji i bazy danych, zapad³a decyzja o podwy¿szeniu
numeru wersji do 2.2. Poni¿sze zestawienie wymienia w
kolejno¶ci chronologicznej (pierwsza instalacja, nie upgrade) wszystkie
przedsiêbiorstwa ciep³ownicze z SZARP v2.1 - 3.1:
</para>

<para>

&wdrozenia;

</para>

</chapter>


</part>

<part id="wymaganiasprzetowe"><!-- -->

<title>Wymagania sprzêtowe</title>
<partintro>
<para>
Ogólnie SZARP dobrze siê czuje na co najmniej dwóch maszynach: jednej - serwerze
najlepiej schowanym w k±cie i drugiej terminalu z Linuksem lub Windows z jakim¶
emulatorem XServera. W przypadku wybitnie ograniczonych ¶rodków mo¿na
oczywi¶cie poprzestaæ tylko na jednym komputerze. Trudno okre¶liæ ¶ci¶le modele
poszczególnych komponentów komputerów pracuj±cych z Linuksem i SZARP'em z uwagi
na ci±g³e zmiany w ofercie producentów. Zbiór wymagañ podany jest przy
poszczególnych elementach. Dok³adniejsze informacje mo¿na uzyskaæ w HOWTO
dotycz±cych instalacji Linuksa (Hardware-HOWTO, Ethernet-HOWTO). Dobrym ¼ród³em
informacji s± te¿ newsy, np. przegl±dane z 
<ULink URL="http://www.deja.com">http://www.deja.com</ULink>.
Nale¿y zaznaczyæ, ¿e istnienie tego rozdzia³u, o ile by³o bardzo potrzebne w
pocz±tkach rozwoju Linuksa, to w tej chwili traci znaczenie, gdy¿ praktycznie
wiêkszo¶æ dostêpnego sprzêtu w tej chwili bez problemu pracuje z Linuksem.
</para>
</partintro>

<chapter id="wymagania-serwer">
<title>Serwer</title>

<para>
Chodzi 24 godziny na dobê, musi byæ niezawodny, odporny na przepiêcia i zaniki
zasilania, z bie¿±c± archiwizacj± danych.
</para>

<section id="deska"><!-- -->
<title>P³yta g³ówna</title>

<para>
Wymagane s± oczywi¶cie sloty PCI do instalacji kart wieloportowych, przyda siê
tak¿e port szeregowy na p³ycie. Grafika mo¿e byæ wbudowana, podobnie jak karta
sieciowa.
</para>
<para>
BIOS musi mieæ nastêpuj±ce opcje:
<itemizedlist>
<listitem>
<para>
podnoszenie systemu samodzielnie w przypadku powrotu zasilania po jego zaniku,
</para>
</listitem>
<listitem>
<para>
wy³±czenie opcji jakiegokolwiek oszczêdzania energii,
</para>
</listitem>
<listitem>
<para>
po zaniku napiêcia / wy³±czeniu w dowolnym momencie (szczególnie w trakcie
bootowania przy POST), ¿eby nie wchodzi³ automatycznie do BIOSa.
</para>
</listitem>
</ItemizedList>
</para>
<para>
W ostatnich latach praktycznie jedyne p³yty, z którymi zdarza³y siê problemy,
oparte by³y na chipsetach SiS (i chodzi³o g³ownie o grafikê). Chipsety innych
producentów (Intel, AMD, Via, NVidia) nie powinny sprawiaæ problemów. Nale¿y
zwróciæ jedynie uwagê, ¿eby nie kupowaæ super-nowo¶ci, np. nie wszystkie
kontrolery S-ATA s± w tej chwili poprawnie obs³ugiwane przez Linuksa.
</para>

</section>

<section id="procek">
<title>Procesor</title>

<para>
¯adnych szczególnych wymagañ - wiêkszo¶æ instalacji jest na Intelach, chocia¿
stosowane te¿ by³y AMD. SZARP kompiluje siê te¿ i dzia³a na platformie AMD
Athlon 64, ale obecnie nale¿y to uznaæ za platformê eksperymentaln±. Wydajno¶æ
procesora powinna byæ dyktowana wymaganiami u¿ywanego ¶rodowiska graficznego,
sam SZARP zadowoli siê naprawdê czymkolwiek.
</para>

</section>

<section id="pamiec">
<title>Pamiêæ</title>

<para>
Serwer teoretyczne zadowoli siê nawet 32 MB (oczywi¶cie bez 
X-ów), ale do sprawnej pracy w ¶rodowisku graficznym zalecane jest obecnie 512
MB.
</para>

</section>

<section id="pamiec-masowa">
<title>Pamiêæ masowa</title>

<para>
Do niedawna zalecane by³y dyski SCSI - maj± tê przewagê nad IDE, ¿e kolejkuj± 
odwo³ania do dysku, wiêc teoretycznie w ¶rodowisku wielozadaniowym powinny 
dzia³aæ szybciej mniej machaj±c g³owicami. Obecnie jednak dyski IDE ATA
zapewniaj± zupe³nie wystarczaj±c± prêdko¶æ. Serial ATA zapewnia wiêksz±
wydajno¶æ ni¿ ATA, nale¿y tylko zwróciæ uwagê, ¿eby kontroler S-ATA na p³ycie
by³ poprawnie obs³ugiwany przez Linuksa.
</para>
<para>
W przypadku SCSI nale¿y pamiêtaæ o zakoñczeniu ³añcucha urz±dzeñ terminatorem -
albo dodatkowym, albo przez prze³±czenie odpowiedniego jumpera na urz±dzeniu.
Kompatybilno¶æ z Linuksem mo¿na sprawdziæ na stronie producenta, w wiêkszo¶ci
przypadków nie powinno byæ problemów (kontrolery firm Adaptec czy Tekram).
</para>
<para>
Je¿eli chodzi o sprzêtowy RAID, to dobre wsparcie dla Linuksa posiadaj±
chipsety firmy HighPoint. Nale¿y zwróciæ uwagê, ¿e do instalacji Linuksa na
RAID'ie sprzêtowym konieczne jest wsparcie j±dra dla danego uk³adu ju¿ na
etapie instalacji (byæ mo¿e konieczne bêdzie rêczne za³adowanie odpowiedniego
modu³u - instalatory zarówno RedHata jak i Debiana daj± tak± mo¿liwo¶æ).
</para>

</section>

<section id="grafika" >
<title>Grafika</title>

<para>
Karta graficzna - znów dowolna, byle wspó³pracowa³a z Linuksem. Karty obu
najpopularniejszych producentów - NVidii i ATI dzia³aj± z Linuksem (choæ nie
zawsze dostêpna jest np. akceleracja 3D). Nie powinno byæ tak¿e problemów z
wiêkszo¶ci± kart zintegrowanych - powinny dzia³aæ zarówno S3, Intel Extreme
Graphics I/II czy VIA. 
</para>
<para>
Listê driverów i obs³ugiwanych przez nie kart dla XFree86 mo¿na obejrzeæ na stronie 
<ulink
url="http://www.xfree86.org/current/RELNOTES4.html#43">www.xfree86.org</ulink>,
dla X-serwera X.org odpowiedni link to 
<ulink url="http://www.x.org/X11R6.8.2/doc/manindex4.html">
http://www.x.org/X11R6.8.2/doc/manindex4.html</ulink>.
</para>
</section>

<section id="siec" >
<title>Sieæ</title>

<para>
Spora czê¶æ nowych p³yt g³ównych wyposa¿ona jest w zintegrowan± kartê
sieciow± Ethernet 100Mb/s lub 1Gb/s. Praktycznie wszystkie karty, zarówno te
zintegrowane, jak i w postaci kart PCI czy PCMCIA (dla notebooków), s± bez
problemu obs³ugiwane przez Linuksa. Najpopularniejsze s± karty oparte na
uk³adach firmy Realtek, inne spotykane to miêdzy innymi Intel, Via.
Rozbudowan± listê kart wraz z informacj± o wspó³pracy z Linuksem mo¿na znale¼æ
w sieci jako <ulink
url="http://www.tldp.org/HOWTO/Ethernet-HOWTO.html">Ethernet-HOWTO</ulink>.
</para>

<para>
W przypadku RJ45 (praktycznie jedyne obecnie stosowane z³±cza) mo¿na 
po³±czyæ dwa komputery bez u¿ycia HUB-a. U¿ywa siê do tego tzw. skrêtki 
przekrosowanej (zasada dzia³ania podobna do NULL-modemu), któr± ³±czy siê
bezpo¶rednio dwa gniazda RJ.
</para>
<para>
Przy wiêkszej ilo¶ci komputerów trzeba zastosowaæ HUB'a (obecnie praktycznie
ju¿ niespotykane) lub switcha. Starsze urz±dzenia posiada³y oznaczony (czêsto
aktywowany prze³±cznikiem) port Up-Link, pozwalaj±cy na po³±czenie kaskadowo
dwóch lub wiêcej urz±dzeñ. W przypadku braku takiego portu, do ³±czenia trzeba
by³o u¿ywaæ skrosowanego kabla. Obecnie wiêkszo¶æ nowych switchy automatycznie
wykrywa sposób pod³±czenia, wiêc praktycznie kabli zwyk³ych i skrosowanych
mo¿na u¿ywaæ wymiennie.
</para>
<para>
Switche (w przeciwieñstwie do HUB'ów) staraj± siê filtrowaæ ruch, ucz±c siê
topologii sieci. Je¿eli dokonamy zmian w topologii sieci (pozmieniamy porty, w
które powpinane s± konkretne komputery), mo¿e byæ koniecznie zmuszenie switcha
do zapomnienia dotychczasowej konfiguracji, najpro¶ciej przez reset -
wystarczy na kilka sekund od³±czyæ zasilanie switcha.
</para>

<para>
¯eby sieæ dzia³a³a z prêdko¶ci± 100Mbps lub wiêcej, przewody musz± byæ
po³±czone 1-do-1, ale musi byæ tak¿e
przestrzegana norma EIA/TIA 568. Specyfikacja dostêpna jest na
<ulink url="http://www.faqs.org/faqs/LANs/cabling-faq/preamble.html"> 
http://www.faqs.org/faqs/LANs/cabling-faq/preamble.html</ulink>. 
W sk³ad normy wchodz± nastêpuj±ce rodzaje okablowania:


<itemizedlist>
<listitem><para>
<emphasis>Standard EIA/TIA T568A (zwany tak¿e ISDN, uprzednio zwany
EIA)</emphasis>

<programlisting>

                      Pin  Wire Color
                      ===  ==========
                /--T3  1   White/Green
          pair3 \--R3  2   Green
        /----------T2  3   White/Orange
       /         /-R1  4   Blue
 pair2 \   pair1 \-T1  5   White/Blue
        \----------R2  6   Orange
                /--T4  7   White/Brown
          pair4 \--R4  8   Brown

</programlisting>
</para></listitem>

<listitem><para>
<emphasis>Standard EIA/TIA T568B (zwany tak¿e AT&amp;T, uprzednio zwany 258A;
czê¶ciej stosowany)</emphasis>

<programlisting>

                      Pin  Wire Color
                      ===  ==========
                /--T2  1   White/Orange
          pair2 \--R2  2   Orange
        /----------T3  3   White/Green
       /         /-R1  4   Blue
 pair3 \   pair1 \-T1  5   White/Blue
        \----------R3  6   Green
                /--T4  7   White/Brown
          pair4 \--R4  8   Brown

</programlisting>
</para></listitem>

<listitem><para>
<emphasis>USOC (Universal Service Order Code - praktycznie
nieu¿ywany)</emphasis>

<programlisting>

                  8-pins    6-pins
                        |  |
      /-------------T4  1     White/Brown
     /    /---------T3  2  1  White/Green
    /    /    /-----T2  3  2  White/Orange
   /    /    /    /-R1  4  3  Blue
pr4\ pr3\ pr2\ pr1\-T1  5  4  White/Blue
    \    \    \-----R2  6  5  Orange
     \    \---------R3  7  6  Green
      \-------------R4  8     Brown

</programlisting>
</para></listitem>

<listitem><para>
<emphasis>Przekrosowany kabel EIA/TIA T568B ma jedn± wtyczkê jak powy¿ej, 
a drug±:</emphasis>

<programlisting>

                      Pin  Wire Color
                      ===  ==========
                /--T2  1   White/Green
          pair3 \--R2  2   Green
        /----------T3  3   White/Orange
       /         /-R1  4   Blue
 pair2 \   pair1 \-T1  5   White/Blue
        \----------R3  6   Orange
                /--T4  7   White/Brown
          pair4 \--R4  8   Brown

</programlisting>
</para></listitem>
</itemizedlist>

Numeracja pinów na wtyku jest taka: patrz±c od do³u (od strony z³±cz) z
kablem do sieci od lewej 1,2,3,4,5,6,7,8.
</para>
</section>

<section id="cdrom">
<title>CD-ROM</title>

<para>
Dowolny CD-ROM IDE - wykorzystywany g³ównie przy instalacji systemu.
</para>

</section>

<section id="floppy">
<title>Napêd dyskietek</title>
<para>Praktycznie niewykorzystywany, choæ dyskietka mo¿e byæ sposobem na
uruchomienie komputera gdy wszystkie inne zawiod± (popsuty CD-ROM, uszkodzony
kana³ IDE...).</para>
</section>

<section id="monitor" >
<title>Monitor</title>

<para>
W przypadku instalacji z dwóch komputerów przy serwerze mo¿na postawiæ byle 15"
o rozdzielczo¶ci maksymalnej 800x600 - monitor ten w³±czany jest sporadycznie,
tylko przy pracach serwisowych i to te¿ czêsto praca na nim przebiega w trybie
tekstowym. Je¿eli instalacja jest "uboga" (tylko serwer), 
paradoksalnie monitor musi byæ porz±dny: minimum 17", zalecany 19" o przyzwoitej 
czêstotliwo¶ci od¶wie¿ania lub panel LCD.
Rozdzielczo¶æ najczê¶ciej wykorzystywana to 1024x768, praktyka pokazuje, ¿e
wiêksza rozdzielczo¶æ znajduje zastosowanie dopiero w monitorach 20", 21", które
sk±din±d nie s± zalecane z uwagi na du¿± pracê szyj±, któr± musi wykonaæ
siedz±cy przed takim ekranem u¿ytkownik.
</para>
<para>
Dla monitorów CRT minimalna zalecana czêstotliwo¶æ od¶wie¿ania pionowego to 85
Hz. Aktualn± czêstotliwo¶æ mo¿na sprawdziæ zwykle gdzie¶ w menu ekranowym
monitora. Parametr ten nie ma znaczenia dla paneli LCD. Dla paneli LCD
natomiast istotne jest ustawienie rozdzielczo¶ci na odpowiadaj±c±
rozdzielczo¶ci matrycy (zwykle 1024x768 dla 15", 1280x1024 dla 17").
</para>

</section>

<section id="obudowa" >
<title>Obudowa, klawiatura, myszka, kable i inne</title>

<para>
Dla komputerów instalowanych w ciep³owni konieczne 
jest zabezpieczenie przed nadmiernym zapyleniem. Na rynku wystêpuj± obudowy 
przemys³owe, s± one kilkukrotnie dro¿sze od zwyk³ych, ale wyposa¿one w 
dodatkowy wiatrak z wymiennym filtrem i bardzo porz±dnie wykonane. Zwykle 
wykorzystywan± py³oszczeln± obudow± przemys³ow± jest Advantech IPC-610MB lub 
IPC-510MB (tañszy wariant) do zabudowy w szafie 19", jednak doskonale 
nadaj±cy siê jako desktop. W przypadku p³yt do Pentium IV nale¿y zwróciæ 
uwagê, czy zasilacz wspiera takie p³yty (wszystkie nowe zasilacze wspieraj±). 
Dla procesorów Pentium IV z rdzeniem Prescot wymagany jest specjalny typ
obudowy, z dodatkow± rur± odprowadzaj±c± powietrze wprost znad procesora.
Zalecana moc zasilacza to nie mniej ni¿ 300W (istotne zw³aszcza przy karcie
wieloportowej Moxa).
</para>
<para>
Dystrybutorem Advantecha jest firma Elmark 
<ulink url="http://www.elmark.com.pl">
www.elmark.com.pl</ulink>.
</para>
<para>
Je¿eli nie instalujemy obudowy przemys³owej, mo¿na zastosowaæ dowoln± obudowê
dostosowan± do wspó³pracy z wykorzystywan± p³yt± g³ówn±. Zwykle wygodniejsza
bêdzie niezbyt ma³a obudowa typu "Tower" (stoj±ca).
</para>
<para>
Klawiatura PS/2 (lub USB) powinna byæ niezawodna, klawisze do Windows nie s± wymagane
(czê¶ciej przeszkadzaj±). Przy obecnych cenach niezawodno¶æ nie jest tak 
istotna - w razie czego zawsze klawiaturê mo¿na wy³±czyæ.
Myszka w przypadku serwera "schowanego" mo¿e byæ dowolna. W przypadku
"ubogiej" instalacji, gdzie praca odbywa siê przy serwerze oraz przy terminalu,
konieczne jest zastosowanie myszy optycznej (PS/2 lub USB), która jest do¶æ
odporna na zabrudzenia. Je¿eli u¿ywamy klawiatury USB, trzeba zwróciæ uwagê,
¿eby klawiatura by³a wspierana przez BIOS - w przeciwnym razie nie bêdziemy
mogli za jej pomoc± wej¶æ do BIOS'u i zmieniaæ opcji.
</para>

</section>

<section id="multiport">
<title>Modu³y wieloportowe</title>

<para>
Do pod³±czenia sterowników konieczna jest zwykle wiêksza ilo¶æ portów RS-232. 
Zwykle 2 standardowe porty w komputerze nie wystarczaj±, nowe p³yty maj±
zreszt± zwykle 1 port lub w ogóle s± ich pozbawione.
</para>
<para>
W starszych instalacjach wykorzystywane by³y modu³y wieloportowe 
firmy Specialix. Obecnie w nowych systemach instalowane s± modu³y Moxy z uwagi 
na znacznie ni¿sz± cenê tudzie¿ dobre wsparcie dla Linuksa.
</para>
<para>
Specialix <ULink
URL="http://specialix.co.uk"
>http://specialix.co.uk</ULink>, firma wykupiona w 1999 roku przez Perle,
produkuje system wieloportowy wykorzystywany w SZARPie do komunikacji ze
sterownikami. System sk³ada siê z karty i szeregu modu³ów 8-mio portowych. Do
ka¿dej karty mo¿na do³±czyæ maksymalnie 4 modu³y, do komputera mo¿na pod³±czyæ
do 4 kart, co ³±cznie daje maksymalnie 128 portów w jednym serwerze.
W chwili obecnej Specialix produkuje tylko karty PCI: SX PCI Adapter. Do³±czalne
modu³y to SXDC8/DX (z³±cza ¿eñskie DB25), SXDC8/MX (z³±cza mêskie DB25) 
lub SXDC8/RJX (z³±cza RJ45).
W praktyce u¿ywane s± g³ównie SXDC8/DX. £±czenie tych modu³ów ze sob±
odbywa siê poprzez specjalne hebelki umieszczone na ka¿dym rogu modu³u - w celu
dostania siê do nich trzeba zdemontowaæ zas³aniaj±ce wciskane klapki, co wymaga
u¿ycia si³y.
Ilo¶æ wykorzystywanych modu³ów Specialixa zale¿y od ilo¶ci sterowników, zwykle
s± to 2-3 sztuki. Dystrybutorami Specialixa w Polsce s± Talex
<ULink
URL="http://www.talex.com.pl"
>http://www.talex.com.pl</ULink
> i Veracomp <ULink
URL="http://www.veracomp.com.pl"
>http://www.veracomp.com.pl</ULink
>.
Pod³±czenie sterowników do SXDC8/DX wykonuje siê przewodem null-modem DB9-DB25
mêsko-mêski. Pod³±czenie do SXDC8/MX wykonuje siê przewodem 1-do-1 DB9-DB25 mêsko-¿eñski. Pod³±czenie do SXDC8/RJX wi±¿e siê z konieczno¶ci± zastosowania przej¶ciówki DB9 mêski z gniazdkiem na RJ45. Przewód po³±czeniowy RJ45 ma byæ 1-do-1. W przej¶ciówce nale¿y po³±czyæ przewody (na wtyczce RJ45 pin 1 jest pierwszym z lewej patrz±c na wtyczkê od strony przewodu przy zatrzasku skierowanym do góry):
<itemizedlist>
<listitem>
<para>
GND - czerwony (pin 4 na RJ45) - pin 5 na DB9 do sterownika,
</para>
</listitem>
<listitem>
<para>
TxD - zielony (pin 5 na RJ45) - pin 3 na DB9 do sterownika,
</para>
</listitem>
<listitem>
<para>
RxD - ¿ó³ty (pin 6 na RJ45) - pin 2 na DB9 do sterownika.
</para>
</listitem>
</ItemizedList>
</para>
<para>
Istniej± dwa urz±dzenia Moxy, które dobrze wspó³dzia³aj± z Linuksem. Karty Moxa 
C320Turbo i C320Turbo/PCI wraz z modu³ami rozszerzaj±cymi C32030T i C32045T 
(s± te¿ inne modu³y) s± - podobnie jak Specialix - kartami wieloportowymi. 
Wystêpuj± w ró¿nych odmianach, na stronie <ULink
URL="http://www.moxa.com">http://www.moxa.com</ULink> mo¿na znale¼æ wiêcej
informacji na ten temat. Charakteryzuj± siê doskona³ym wsparciem dla Linuksa,
ze strony firmy Moxa mo¿na ¶ci±gn±æ drivery do Linuksa, ale dostêpne s± one
domy¶lnie w j±drach systemu.
Wersj± ograniczon± do 8 portów jest karta C168H/PCI z modu³em OPT-8A. Stosuje 
siê j± dla instalacji ograniczonych w sensie ilo¶ci sterowników, gdzie wa¿ne 
jest maksymalne ograniczenie nak³adów inwestycyjnych. Instalacja jest równie 
³atwa i dok³adnie opisana w helpach na do³±czonym do karty CD-ROMie, jak w 
przypadku C320Turbo.
</para>
<para>
Dystrybutorem firmy Moxa jest firma Elmark <ulink url="http://www.elmark.com.pl">
www.elmark.com.pl</ulink>.
</para>
<para>
Dystrybutorem wtyczek i obudówek do wtyczek DB25, DB9 i RJ45 jest
np. Meditronik <ULink
URL="http://www.meditronik.com.pl"
>http://www.meditronik.com.pl</ULink
>.
</para>

<para>
Je¿eli potrzebujemy mniejszej ilo¶ci portów, mo¿emy wykorzystaæ kartê
dwuportow± PCI. Dobrze wspó³pracuj± z Linuksem karty na uk³adzie firmy NetMos
(wystarczy ustawienie portu i przerwania komend± <command>setserial</command>).
</para>

<para>
Jeszcze innym rozwi±zaniem jest u¿ycie przej¶ciówki USB/RS232. Testowane by³y
najpopularniejsze przej¶ciówki na uk³adzie PL-2303 formy Prolific. Poprawna
wspó³praca z przej¶ciówki wymaga patcha do j±dra dostêpnego pod adresem
<ulink url="http://www.szarp.com.pl/pub/">
http://www.szarp.com.pl/pub/</ulink> (patch zosta³ w³±czony do j±dra Linuksa
od wersji 2.6.14).
</para>

</section>

<section id="ups">
<title>UPS</title>

<para>
Na polskim rynku wystêpuje wiele modele UPSów dobrze wspó³pracuj±cych z Linuksem,
miêdzy innymi: APC <ULink
URL="http://www.apcc.com">http://www.apcc.com</ULink>, który zreszt± dosta³
certyfikat RedHat Ready,
Powerware <Ulink URL="http://www.powerware.com">http://www.powerware.com</Ulink>,
Ever <ulink url="http://www.ever.com.pl">http://www.ever.com.pl</ulink>,
oraz Fideltronik <ULink URL="http://www.fideltronik.com.pl">http://www.fideltronik.com.pl</ULink>
produkuj±cy liniê UPSów line
interactive Ares z darmowym oprogramowaniem UPS Monitor 1.0 dzia³aj±cym
poprawnie w RedHat v6.1. Stosowane z powodzeniem UPSy Fideltronika to:
Ares 300, 500, 700, 800, 1000, 1600, 3000. 
Producentem przej¶ciówek do komunikacji po RS-ie miêdzy
UPS Ares a komputerem jest Sterkom (zalecane) lub Fideltronik. Je¿eli u¿ywamy
nowego kabla Fideltronika, to przej¶ciówka nie jest potrzebna. Obecnie
najczê¶ciej stosowane w instalacjach SZARP-a s± UPS-y APC, stosowane by³y
tak¿e UPS'y Ever, ale wycofujemy siê z nich ze wzglêdu na s³ab± jako¶æ.
</para>
<para>
Rozpowszechnienie systemów plików z journalingiem powoduje, ¿e poprawna
wspó³praca z oprogramowaniem zamykaj±cym system przestaje byæ tak¿e warunkiem
krytycznym. W wiêkszo¶ci przypadków, je¿eli d³u¿sze zaniki napiêcia nie
zdarzaj± siê zbyt czêsto, mo¿na darowaæ sobie komunikacjê miêdzy UPS'em i
komputerem, wiêc wybór konkretnego urz±dzenia jest bardzo u³atwiony.
</para>

</section>

<section id="modem">
<title>Modem</title>

<para>
Polecany jest zewnêtrzny, pe³ny modem z portem RS232. Ka¿dy taki modem bêdzie
dobrze wspó³pracowa³ z Linuksem.
<para>
Czasami lepszym rozwi±zaniem bêdzie jednak modem wewnêtrzny (np. gdy
potrzebujemy dwóch portów szeregowych do pod³±czenia sterowników). Poza tym
modemy wewnêtrzne s± zwykle sporo tañsze od zewnêtrznych.
Niestety, zdecydowana wiêkszo¶æ z nich to tzw. soft-modemy, wymagaj±ce
wspó³pracy procesora komputera i odpowiedniego oprogramowania. W zwi±zku z tym
nie nale¿y ich stosowaæ przy s³abych procesorach, a poza tym nale¿y siê
upewniæ, ¿e modem ma sterowniki pod Linuksa (co zdarza siê nieczêsto).
Wsparcie pod Linuksa posiadaj± m.in. modemy oparte na chipach Conexant, np.
modemy Pentagram (modele Diablo 56I, Fanatic 56I, Omen2 56I, Hex 56I, Hex2
56I). Modele Diablo i Hex2 by³y z powodzeniem u¿ywane w instalacjach SZARP'a.
</para>

</section>

<section id="hw-isdn">
<title>Terminale ISDN</title>
<para>
Wewnêtrzne, karty rozszerzeñ PCI. Dotychczas zastosowano z powodzeniem:
</para>
<itemizedlist>
<listitem><para>Karta bazuj±ca na chipsecie HFC 2BDS0 PCI,</para></listitem>
<listitem><para>Karta bazuj±ca na NETjet PCI,</para></listitem>
<listitem><para>Karta bazuj±ca na uk³adzie Winbond 6692.</para></listitem>
</ItemizedList>
</section>
</chapter>

<chapter id="wymagania-terminal">
<title>Terminal</title>

<para>
Maszyna z wymaganiami co do niezawodno¶ci mniejszymi ni¿ serwer. Je¿eli ma
pracowaæ pod kontrol± Linuksa, nale¿y zwróciæ uwagê na dobór sprzêtu podobnie
jak dla serwera.
</para>

</chapter>

<chapter id="hardware-bios">
<title>Ustawienia BIOS'u serwera</title>

<para>
W BIOSie serwera - lub jumperami (obecnie niespotykane) - nale¿y ustawiæ nastêpuj±ce opcje:
</para>

<para>
<!--W sekcji <command>Standard CMOS Setup</>:-->
<itemizedlist>
<listitem>

<para>
Ustawiæ zegar na UCT: w zimie jest to czas Polski - 1 godzina, w lecie czas
Polski - 2 godziny. Czas letni zaczyna siê w nocy z ostatniej soboty
na niedzielê w marcu, a czas zimowy zaczyna siê w nocy z ostatniej soboty
na niedzielê w pa¼dzierniku.
</para>
</listitem>

<listitem>

<para>
Urz±dzenia IDE, których nie ma ustawiæ na None, chocia¿ ustawienie na
Auto nie powinno zaszkodziæ, a mo¿e byæ przydatne przy czêstej zmianie 
konfiguracji.
</para>
</listitem>
<listitem>

<para>
Ustawiæ <command>Halt on all but keyboard</command>.
</para>
</listitem>
<listitem>

<para>
Wy³±czyæ has³o na BIOS-a: <command>Password</command> ustawiæ na Disabled.
</para>
</listitem>
<listitem>

<para>
Mo¿na wy³±czyæ support dla USB (tak¿e przydzia³ IRQ), je¿eli nie bêdzie
u¿ywane.
</para>
</listitem>
<listitem>

<para>
OS/2 &gt; 64MB Disabled.
</para>
</listitem>

<listitem>
<para>
Wy³±czyæ oszczêdzanie energii.
</para>
</listitem>
<listitem>

<para>
W³±czyæ wstawanie po zaniku zasilania: <command>System After AC Back</>
ustawiæ na Full-On albo <command>State After Power Failure</command> na On.
Uwaga: niektóre stare p³yty g³ówne (np. Soltek SL-65DV2, SL-65KV2-T) wymagaj± 
dodatkowo uaktywnienia odpowiedniej zworki na p³ycie g³ównej.
</para>
</listitem>

<listitem>
<para>
W maszynie pe³ni±cej funkcjê serwera mo¿na wy³±czyæ zintegrowan± kartê muzyczn± (o ile p³yta posiada takow±). <command></>
</para>
</listitem>

<listitem>

<para>
Kolejno¶æ bootowania (je¶li zosta³y ju¿ zainstalowane wszystkie OS-y): 
dysk twardy, CD-ROM.
</para>
</listitem>
<listitem>

<para>
<command>Plug&amp;Play OS</command> ustawiæ na No.
</para>
</listitem>
<listitem>

<para>
Wy³±czyæ detekcjê obecno¶ci wirusów w sektorze startowym: 
<command>Boot virus detection</command> lub <command>Anti-Virus
Protection</command>
lub <command>Virus Warning</command> ustawiæ na Disabled.
</para>
</listitem>

<listitem>
<para>
<command>Quick boot test</command> Enabled.
</para>
</listitem>

<listitem>
<para>
<command>Boot floppy seek</command> Disabled.
</para>
</listitem>

<listitem>
<para>
W nowych BIOSach istnieje monitoring parametrów fizycznych pracy procesora i p³yty g³ównej; nale¿y w takim przypadku ustawiæ:
<itemizedlist>
<listitem>
<para>
alarm w przypadku wy³±czenia wiatraczka procesora,
</para>
</listitem>
<listitem>
<para>
alarm w przypadku przekroczenia temperatury procesora powy¿ej zadanej 65-75st.C,
</para>
</listitem>
<listitem>
<para>
alarm w przypadku przekroczenia temperatury p³yty g³ównej powy¿ej zadanej.
</para>
</listitem>
</ItemizedList>

</para>
</listitem>

<listitem>

<para>
W³±czyæ kontroler SCSI, je¶li jest zintegrowany z p³yt±.
</para>
</listitem>
<listitem>

<para>
Uaktywniæ terminator na kontrolerze SCSI, je¶li jest zintegrowany z p³yt±.
Je¿eli w serwerze jest kontroler SCSI Adapteca, w jego BIOSie nale¿y
ustawiæ opcje (aby dostaæ siê do BIOSu SCSI podczas startowania systemu nale¿y
wcisn±æ <Command>Ctrl-A</Command>, za¶ w przypadku kontrolera SCSI Tekram nale¿y
wcisn±æ <command>F2</command> b±d¼ <command>F6</command>):

<itemizedlist>
<listitem>

<para>
<command>Parity checking</command> Enabled.
</para>
</listitem>
<listitem>

<para>
<command>Termination</command> Automatic.
</para>
</listitem>
<listitem>

<para>
<command>Boot Device Configuration</command> - SCSI ID musi siê zgadzaæ z
ustawionym jumperami na dysku, najlepiej je¶li jest
0:
<itemizedlist>
<listitem>
<para>
<command>SCSI ID</command> 0,
</para>
</listitem>
<listitem>
<para>
<command>Lun</command> (zawsze) 0.
</para>
</listitem>
</itemizedlist>
</para>
</listitem>
<listitem>

<para>
W sekcji <command>SCSI Device Configuration:</command>
<itemizedlist>
<listitem>
<para>
<command>Initiate Sync</command> Yes.
</para>
</listitem>
<listitem>
<para>
<command>MaxSync Transfer</command> 40 dla Wide SCSI, 20 dla Narrow SCSI.
</para>
</listitem>
<listitem>
<para>
<command>Enable Discon</command> Yes.
</para>
</listitem>
<listitem>
<para>
<command>Initiate Wide Neg.</command> Yes (tylko dla Wide SCSI).
</para>
</listitem>
<listitem>
<para>
<command>Send Start</command> No.
</para>
</listitem>
<listitem>
<para>
<command>BIOS Multiple LUN Supp.</command> No.
</para>
</listitem>
<listitem>
<para>
<command>Include BIOS Scan</command> Yes.
</para>
</listitem>
</itemizedlist>
</para>
</listitem>
<listitem>

<para>
Sekcja <command>Advanced Configuration Options:</command>
<itemizedlist>
<listitem>
<para>
<command>P&amp;P SCAM</command> Enabled (urz±dzenia SCAM póki co s± do¶æ rzadkie).
</para>
</listitem>
<listitem>
<para>
<command>Reset SCSI at Init</command> Enabled.
</para>
</listitem>
<listitem>
<para>
<command>Extended Translation for DOS Drives &gt; 1GB</command> Enabled.
</para>
</listitem>
<listitem>
<para>
<command>Host BIOS</command> Enabled.
</para>
</listitem>
<listitem>
<para>
<command>Support Removable Disks Boot Only</command> Disabled.
</para>
</listitem>
<listitem>
<para>
<command>Display Ctrl-A</command> Disabled.
</para>
</listitem>
<listitem>
<para>
<command>BIOS Support for boot CD-ROM</> Enabled.
</para>
</listitem>
<listitem>
<para>
<command>BIOS Support for Int 13</command> Enabled.
</para>
</listitem>
</itemizedlist>
</para>
</listitem>

</ItemizedList>

</para>
</listitem>

</ItemizedList>

</para>

<para>
W celu skrócenia czasu uruchamiania komputera warto jest
wy³±czyæ funkcjê Boot PROM na karcie sieciowej (je¶li karta to wspiera).
</para>
<para>
Je¿eli instalujemy kartê dwuportow± PCI, konieczne mo¿e byæ w³a¶nie wy³±czenie
nieu¿ywanych urz±dzeñ (USB, modem, karta d¼wiêkowa, port drukarki) w celu
zwolnienia przerwañ dla karty. Wy³±czenie zbêdnych urz±dzeñ przyspieszy tak¿e
start systemu.
</para>



</chapter>


</part>


<part id="konfig-i-instal">
<title>Konfiguracja i instalacja oprogramowania</title>


<chapter id="dos">
<title>DOS</title>

<para>
Niegdy¶ zalecane by³o utworzenie na dysku jednej partycji z systemem DOS i
instalacja na niej np. programu CID do edycji plików dBase IV. Obecnie nie ma
ju¿ ¿adnego powodu aby instalowaæ DOS'a. Dwa kolejne rozdzia³y opisuj± wiêc
uruchamianie Linuksa z poziomu DOS'a (te¿ zasz³o¶æ historyczna - lepiej
wykorzystaæ mened¿era ³adowania takiego jak GRUB czy LILO), oraz instalacjê
wolnego klona DOS'a - systemu FreeDOS.
</para>

<section id="linuxspoddosa" >
<title>Uruchamianie Linuksa spod DOS-a</title>

<itemizedlist>
<listitem>
<para>
Aby móc odpalaæ Linuksa spod DOS-a, w config.sys trzeba wstawiæ linijkê:
<programlisting>
INSTALL=loadlin.exe c:\linux\autoboot\vmlinuz root=/dev/hda4
</programlisting>
i przy bootowaniu wybraæ odpowiedni± sekcjê (nale¿y podzieliæ autoexec.bat i config.sys na sekcje do uruchamiania DOS/Windows lub Linuksa). Mo¿na te¿ uruchomiæ <filename>loadlin.exe</filename> z linii komend.
</para>
</listitem>

<listitem>
<para>
Graficznym interfejsem do <filename>loadlin.exe</filename> dzia³aj±cym pod Windows9x jest <filename>ux-1.0</filename>. Podobnie jak <filename>loadlin.exe</filename> nie wymaga zainstalowanego w Master Boot Sector lilo. Po ¶ci±gniêciu <filename>ux-1.0.zip</filename> jego instalacja i konfiguracja sprowadza siê do:

<itemizedlist>

<listitem>
<para>
rozpakowania plików w katalogu np. <filename>C:\UX</filename>
</para>
</listitem>

<listitem>
<para>
przekopiowania j±dra z Linuksa do <filename>C:\</filename> pod nazw± <filename>vmlinuz</filename>
</para>
</listitem>

<listitem>
<para>
uruchomienia <filename>ux.exe</filename> i ustawienia:
<programlisting>
Linux kernel image: C:\vmlinuz
Root device: /dev/hda3
</programlisting>
(w polu <filename>/dev/hda</filename> trzeba podaæ partycjê linuksow± - 
jak znale¼æ jej nazwê - opisuje to 
<xref linkend="konfiguracjalilo">), 
reszta ustawieñ niezmieniona
</para>
</listitem>

<listitem>
<para>
za ka¿dym nastêpnym razem po uruchomieniu ux.exe wystarczy nacisn±æ GO!
</para>
</listitem>

<listitem>
<para>
to GPL i pe³ne ¼ród³a s± do³±czone - mo¿na spolszczyæ plik resources
</para>
</listitem>

</ItemizedList>

Wad± <filename>ux-1.0</filename> jest, ¿e uruchomiony w ten sposób Linux mo¿e
nie widzieæ niektórych urz±dzeñ.
</para>
</listitem>

</ItemizedList>
</section> <!-- Uruchamienie Linuksa spod DOS'a -->

<section id="freedos">
<title>FreeDOS</title>

<para>
W sytuacji gdy potrzebujemy aplikacji dzia³aj±cych pod DOS'em i z jakiego¶
powodu nie mo¿emy wykorzystaæ dosemu (emulatora DOS'a pod Linuksa), warto
rozwa¿yæ skorzystanie z systemu FreeDOS. Zw³aszcza, ¿e
oryginalny system MS-DOS lub PC-DOS jest ju¿ w tej chwili w³a¶ciwie
niedostêpny. FreeDOS zapewnia praktycznie 100% emulacjê oryginalnego DOS'a
w wersji 3.3/6.22 (j±dro / programy u¿ytkowe). 
Poza tym zapewnia lepsz± obs³ugê sprzêtu ni¿ orygina³, w tym
nie posiada wiêkszo¶ci DOS-owych ograniczeñ dotycz±cych uk³adu partycji na
dysku. Ma wbudowan± zaawansowan± obs³ugê wiersza poleceñ (tak¿e z dope³nianiem
poleceñ), czêsto dystrybuowany jest np. razem z edytorem Vim
czy przegl±dark± Lynx. FreeDOS jest
tworzony na licencji GPL, w zwi±zku z tym jest kompletnie darmowy.
</para>

<para>
Strona <ulink url="http://www.freedos.org">www.freedos.org</ulink> zawiera
miêdzy innymi dokumentacjê dotycz±c± systemu, mo¿na z niej ¶ci±gn±æ tak¿e
obrazy dyskietek lub CD-ROM'u wykorzystywane do instalacji systemu.
</para>
<para>
Ze wzglêdu na szybko¶æ i wygodê polecana jest raczej instalacja z CD-ROM'u. W katalogu <ulink url="http://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/distributions/">http://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/distributions/</ulink> znajduj± siê podkatalogi z dystrybucjami FreeDOSa, sk±d nale¿y ¶ci±gn±æ obraz dysku instalacyjnego <filename>fdboot.iso</filename>, np. <ulink url="http://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/distributions/beta9rc3/fdbootcd.iso">http://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/distributions/beta9rc3/fdbootcd.iso</ulink>. Nale¿y wypaliæ CD-R z tym obrazem wydaj±c komendê:
<programlisting>
cdrecord -v speed=0 dev=0,4,0 fdbootcd.iso
</programlisting> 
Nastêpnie nale¿y zbootowaæ komputer z tak przygotowanej p³ytki. Dok³adny sposób instalacji ró¿ni siê nieco
w zale¿no¶ci od wersji zw³aszcza, ¿e instalator systemu znajduje siê obecnie w
fazie do¶æ intensywnego rozwoju. Niemniej zawsze powinni¶my mieæ mo¿liwo¶æ 
instalacji systemu (co mo¿e wymagaæ przygotowania partycji za pomoc±
programu <filename>fdisk</filename> lub odpowiedniej graficznej nak³adki na niego), jak i
za³adowania systemu bezpo¶rednio z p³yty. Mamy te¿ mo¿liwo¶æ przygotowania
dyskietki startowej (w niektórych wersjach zdarzaj± siê b³êdy w przygotowywaniu
dyskietki - komputer nie chce ³adowaæ z niej systemu).
</para>
<para>
Nale¿y zwróciæ uwagê, ¿e je¿eli instalujemy system na istniej±cej instalacji
innego DOS'a, bez formatowania partycji, to, aby ³adowa³ siê nasz nowy FreeDOS,
nale¿y u¿yæ komendy SYS. Mo¿emy przygotowaæ dyskietkê startow± (odpowiedni±
opcjê znajdziemy w menu po za³adowaniu systemu z p³yty instalacyjnej), a
nastêpnie wydaæ komendê:
<programlisting>
A:\FREEDOS\SYS A:\ C:
</programlisting>
</para>
<para>
FreeDOS mo¿e korzystaæ z nieco innego uk³adu katalogów ni¿ oryginalny DOS, np.
wiêkszo¶æ elementów systemu mo¿e siê znajdowaæ w katalogu <filename>C:\FDOS\BIN</filename>. Inne
mog± byæ tak¿e nazwy plików startowych systemu: <filename>C:\FDCONFIG.SYS</filename> i 
<filename>C:\FDOS\FDAUTO.BAT</filename>. Inne s± nazwy np. dla programu zarz±dzaj±cego pamiêci±
XMS/EMS. Nieco inaczej w porównaniu z DOS'em 6.22 s± zrealizowane rozszerzenia
takie jak np. menu startowe systemu. Warto skorzystaæ z generowanych przy
instalacji plików startowych jako przyk³adów, wiêcej informacji znajduje siê w
dokumentacji systemu, która podczas instalacji tak¿e jest kopiowana na dysk.
</para>

</section> <!-- freedos -->


</chapter> <!-- dos -->


<chapter id="system-linux">
<title>Linux</title>

<section id="linux-instalacja">
<title>Instalacja systemu RedHat Linux</title>

<section id="redhat-install">
<title>Instalacja systemów RedHat 6.X/7.X</title>
<para>
<note>
<para>Niniejszy opis odnosi siê do starych, kilkuletnich wersji dystrybucji
RedHat. Ma znaczenie g³ównie historyczne i w przysz³o¶ci mo¿e zostaæ usuniêty.</para>
</note>
Niniejszy opis instalacji dotyczy systemu Linux RedHat v6.1, v6.2, v7.2, v7.3. 
Opis jest te¿ w du¿ej mierze prawdziwy dla systemów RH8.0/Aurox8.0
(lecz nie zosta³ sprawdzony punkt po punkcie). Sposób instalacji 
najnowszych systemów - RH9.0 i Aurox9.0 opisuje 
<xref linkend="rh90-instalacja">.
Na nowszym sprzêcie zalecane jest instalowanie v7.x (i wy¿ej), 
na starszym natomiast mo¿e byæ lepszy v6.2 
(instalowanie trwa krócej, starsze iksy lepiej pasuj± do starszych 
kart graficznych, wymagane jest mniej miejsca na dysku).
</para>
<para> 
Na tym opisie mo¿na siê wzorowaæ instaluj±c 
Linuksa do zastosowañ innych ni¿ system SZARP. 
Starali¶my siê tu opisaæ czêste problemy wystêpuj±ce podczas
instalacji i konfiguracji, oraz wyja¶niæ pewne niebanalne rzeczy, które
wydaj± siê nam warte opisania. 
</para>

<para>
W przypadku instalacji na dyskach IDE nale¿y pamiêtaæ o ograniczeniach zwi±zanych z trybem ATA. Wiêcej szczegó³ów opisano w rozdziale <xref linkend="pamiec-masowa">.
</para>

<para>
W przypadku CD-ROM ATAPI nale¿y w BIOSie
ustawiæ CD-ROM jako pierwsze urz±dzenie bootuj±ce i zbootowaæ komputer z
kompaktu. Je¶li jest to niemo¿liwe nale¿y wykonaæ dyskietkê startow±,
dokumentacja jak to zrobiæ znajduje siê na CD-ROM'ie z Linuksem.
</para>

<para>

<itemizedlist>
<listitem>

<para>
<anchor id="redhat-ekran-powitalny-enter">
na ekranie powitalnym nacisn±æ &lt;Enter&gt; (tryb graficzny - zalecane w RH 7.2), lub wpisaæ: 
text &lt;Enter&gt; ¿eby rozpocz±æ (szybsz±) instalacjê w trybie tekstowym.
</para>
</listitem>

<listitem>
<para>
W RH/Auroksie 8.x/9.x pierwsz± faz± jest testowanie no¶nika 
(sprawdzenie, czy nie uszkodzone zosta³y p³ytki instalacyjne).
Poniewa¿ test ten trwa dosyæ d³ugo to mo¿na go sobie darowaæ.
</para>
</listitem>

<listitem>
<para>
W przypadku trybu graficznego: wybraæ odpowiedni typ myszki 
(PS/2 2/3 klawisze - najlepiej 3 klawisze) i
klawiatury (domy¶lny). W trybie tekstowym wybieranie myszki bêdzie pó¼niej
(wprowadza siê powy¿sze ustawienia). W RedHat 7.3 myszka wybierana jest po 
wyborze jêzyka i klawiatury.
</para>
</listitem>

<listitem>
<para>
wybraæ English jako jêzyk instalacji (w przypadku RedHata v6.1 jest równie¿ 
mo¿liwo¶æ wybrania jêz. polskiego. Zosta³a usuniêta w wersji 6.2 i 7.x z powodu
b³êdów).
</para>
</listitem>

<listitem>
<para>
wybraæ <command>keyboard</> us (w RH 7.2 zostawiæ ustawienia domy¶lne: model Generic 105, layout U.S. English, Enable Dead Keys). W RH 7.3 nale¿y wybraæ 
layout Polish.
</para>
</listitem>

<listitem>

<para>
wybraæ instalacjê Custom
</para>
</listitem>

<listitem>
<para>
nale¿y wybraæ program partycjonuj±cy : <command>fdisk</> 
lub <command>Disk Druid</>. Drugi program (DD) jest prostszy, natomiast
<command>fdisk</> ma wiêcej (przewa¿nie zbêdnych) mo¿liwo¶ci, poleca siê
go raczej do¶wiadczonym <quote>Instalatorom Linuksa</>.
Dalej opisano instalacjê za pomoc± Disk Druida. W RH 7.3 jest jeszcze mo¿liwo¶æ
wybrania automatycznego partycjonowania - nie wybieraæ!
</para>
</listitem>

<listitem>
<para>
w ekranie Disk Druid najpierw zrobiæ partycjê swap o rozmiarze 2
* wielko¶æ pamiêci komputera na którym instalujemy Linuksa
</para>
</listitem>

<listitem>
<para>
nastêpnie w Disk Druid utworzyæ partycjê Linux Native z opcj± 
<command>Grow to fill disk</command> (<command>Use remaining</command>) 
- jako punkt zamontowania wybraæ "/". W RH 7.2 i 7.3 jako typ partycji wybraæ 
ext3. 
W RH 7.3 odpowiednia opcja nazywa siê "Fill to maximum allowable size".
</para>
</listitem>

<listitem>
<para>
W przypadku niektórych kontrolerów SCSI (m.in. Tekram DC-390U2W) nale¿y wy³±czyæ opcjê
<command>Use linear mode</command>
</para>
</listitem>

<listitem>

<para>
Sformatowaæ wszystkie nowo utworzone partycje.
Nie wybieraæ opcji <command>Check for bad blocks</command>. D³ugo trwa. 
</para>
</listitem>

<listitem>
<para>
<anchor id="redhat-boot-loader">
Umie¶ciæ bootloadera w MBR. Nie podawaæ ¿adnych parametrów do kernela.
Ustawiæ domy¶lne odpalanie Linuksa w LILO. W RH 7.2 i 7.3 jest mo¿liwo¶æ 
wybrania GRUB-a (zalecane). Wybieramy instalacjê do pierwszego sektora 
boot-partycji, nie ustawiamy has³a dla GRUB-a (wiêcej informacji 
o GRUB-ie zawiera <xref linkend="konfiguracjagruba">).
</para>
</listitem>

<listitem>
<para>
<anchor id="redhat-siec">
w Konfiguracja sieci na etapie instalacji na karcie eth0: Activate on boot: +;
IP Address 192.168.1.XXX, gdzie XXX jest ró¿ne dla ró¿nych maszyn,
netmask automatycznie ustawi siê na 255.255.255.0, broadcast
automatycznie ustawi siê na 192.168.1.255; nazwa hosta - dla serwera powinna byæ zgodna z prefixem bazy (np. kato), dla terminali - w³a¶ciwie dowolna, ale pomocne jest by by³a ona podobna do nazwy serwera (np. kat1).
NIE WPISYWAÆ <command>default gateway</>! Je¶li instalator ustawi tam jak±¶
warto¶æ to j± wywaliæ. W RH 7.3 trzeba odznaczyæ wcze¶niej opcjê "Configure
using DHCP".
</para>
</listitem>

<listitem>
<para>
w RH 7.2 i 7.3 pojawi siê opcja ustawienia firewalla - w przypadku komputera niepod³±czonego bezpo¶rednio do internetu wybieramy "No firewall". Tak¿e w RH 7.2 pojawi siê ekran wybory dodatkowych jêzyków - wybieramy "Polish" i jako domy¶lny tak¿e ustawiamy "Polish".
</para>
</listitem>


<listitem>
<para>
<anchor id="redhat-strefa-czasowa">
w ekranie wyboru strefy czasowej wybraæ "System clock uses UTC"/"Hardware
clock set to GMT" i wybraæ Warsaw w zak³adce "Location"
</para>
</listitem>
<listitem>

<para>
ustawiæ has³o roota i jednego usera - np. palacz; nale¿y mu ustawiæ dowolne
has³o, a potem aby ustawiæ mu has³o puste nale¿y po instalacji jako root
uruchomiæ: 
<programlisting>
passwd -d &lt;username&gt;
</programlisting>

</para>
</listitem>

<listitem>
<para>
ustawiæ <command>authentication options</>: shadow i MD5 - Enabled.
NIS, LDAP, Kerberos i SMB (RH 7.2 i 7.3) - Disabled.
</para>
</listitem>

<listitem>

<para>
w ekranie wyboru pakietów do instalacji wybraæ wszystkie (oznaczyæ ka¿d±
grupê pakietów z osobna), dodatkowo oznaczyæ opcjê <quote>Everything</quote>.
</para>
</listitem>
<listitem>

<para>
wybraæ "Use graphical login"
</para>
</listitem>
<listitem>

<para>
przetestowaæ grafikê: wybraæ poprawnie ilo¶æ pamiêci na karcie 
(np. zapamiêtaæ przy bootowaniu). Je¿eli nie mo¿e sam wykryæ karty, 
wybraæ Customize
X Configuration i tam najmniejsze co mo¿e byæ to: 640x480x8; je¿eli nie
dzia³a po prostu pój¶æ dalej bez testowania X-ów (zostawiæ Use
graphical login ustawiony).
</para>
</listitem>
<listitem>

<para>
skip boot disk creation
</para>
</listitem>
<listitem>

<para>
reboot ju¿ z dysku twardego
</para>
</listitem>
<listitem>

<para>
<filename>/tmp/install.log</filename> - zapis historii instalacji
</para>
</listitem>
<listitem>

<para>
instalator mo¿e mieæ k³opoty z prawid³ow± detekcj± parametrów karty graficznej
- w takim przypadku nale¿y po instalacji rekonfigurowaæ przy pomocy
<filename>/usr/X11R6/bin/Xconfigurator</filename>, je¿eli nie wykryje sam karty,
wybraæ j± z
listy; monitor np. Samsung 17GLsi; wybraæ tryb 1024x748x8 i ustawiæ ¿eby
X-y automatycznie startowa³y przy boocie. W RH 7.x nale¿y wybraæ jako domy¶lne ¶rodowisko graficzne KDE.
</para>

<para>
W przypadku, gdyby to
narzêdzie te¿ nie dawa³o efektu nale¿y rêcznie uzupe³niæ wpisy w pliku
<filename>/etc/X11/XF86Config</filename> na podstawie odpowiedniego pliku 
README dla danej
karty graficznej <filename>/usr/X11R6/lib/X11/README.XXX</filename>; w 
przypadku
dokonywania takich zmian nale¿y zrobiæ kopiê bezpieczeñstwa istniej±cego
pliku <filename>XF86Config</filename>, na wypadek pomy³ki..
</para>

<para>
W przypadku niektórych starych kart graficznych lepiej jest zainstalowaæ
starsze X-y - w wersji 3.3.6 - maj± one lepsze wsparcie dla starego sprzêtu.
Instalacjê starszych X-ów przeprowadzamy przez instalacjê pakietu 
XFree86-SVGA-3.3.6-*.rpm (dla innych kart, wymagaj±cych innego X-serwera, nale¿y
oczywi¶cie wybraæ odpowiedni pakiet, typu XFree86-S3-3.3.6-*.rpm).
</para>

<para>
W przypadku kombinacji X'ów w wersji 3.3.6 (dostarczanych np. z RedHatem 6.2)
i niektórych kart S3 Trio wystêpuj± problemy z kursorem - zamiast niego
wy¶wietlany jest bia³y kwadrat. W takim przypadku nale¿y dokonaæ rêcznej modyfikacji
pliku <filename>/etc/X11/XF86Config</filename> nale¿y dodaæ w sekcji "Device"
opisuj±cej dan± kartê graficzn± liniê postaci:
<programlisting>
Option "sw_cursor"
</programlisting>
</para>
<para>
Przy instalacji X'ów w wersji 3.3.6 z kart± S3 Vision 964 Paradise do pliku 
<filename>/etc/X11/XF86Config</filename> nale¿y do sekcji "Device" dodaæ
wpisy, tak aby ca³a sekcja wygl±da³a nastêpuj±co:
<programlisting>
Section "Device"
	Identifier	"Vision 964-P"
	VideoRam	1024
	Ramdac		"bt9485"
	Option		"nolinear"
	Option		"nomemaccess"
	ClockChip	"ics9161a"
</programlisting>
</para>

<para>
Je¶li u¿ywamy XFree86 w wersji co najmniej 4.0.1 (mo¿na to sprawdziæ przez
<filename>XFree86 -version</filename>), to byæ mo¿e najprostszym sposobem
skonfigurowania X-serwera bêdzie wpisanie <filename>XFree86 -configure</filename>.
Ta wersja X-ów wprowadza wiele innych zmian - inny jest format wspomnianego
wy¿ej pliku <filename>XF86Config</filename>, jest tylko jeden wspólny X-serwer,
a dla poszczególnych kart s± oddzielne sterowniki. W przypadku problemów
warto zaopatrzyæ siê w jak najnowsz± wersjê XFree86 - im nowsza, tym wiêcej
kart powinna obs³ugiwaæ.
</para>

<para>
Istniej± karty graficzne, które ani nie s± wykrywane przez instalatora ani
nie mo¿na ich wybraæ z listy dostêpnych kart graficznych. 
Z takim przypadkiem mo¿na siê spotkaæ
(przy najmniej na razie) w przypadku kart z chipsetem Intela i810/i815.
Na szczê¶cie Intel uruchomi³ support Linuksa pod adresem
<ulink url="http://support.intel.com/support/graphics/intel815/linuxsoftware.htm">
http://support.intel.com/support/graphics/intel815/linuxsoftware.htm</ulink>. 
Nale¿y st±d ¶ci±gn±æ pliki (mog± siê pojawiæ nowsze wersje):
<filename>I810Gtt-0.2-4.src.rpm</> i 
<filename>XFCom_i810-1.2-3.i386.rpm</> oraz
<filename>release_linux.pdf</> (z linku ReleaseNotes).
Ostatni z nich (pdf) to opis instalacji i konfiguracji sprzêtu. 

Dwa pierwsze to odpowiednio: modu³ do j±dra i X-server. Mo¿na równie¿
¶ci±gn±æ patcha na ¼ród³a XServera (<filename>XFCom_i810.1.2.patch.tar.gz</>), 
ale rozwi±zanie z gotowym serwerem 
(prezentowane poni¿ej) jest chyba lepszym rozwi±zaniem.
Nale¿y wiêc wydaæ polecenia:
<programlisting>
rpm --recompile I810Gtt-0.2-4.src.rpm 
rpm -Uvh XFCom_i810-1.2-3.i386.rpm
</programlisting>

Mo¿na przetestowaæ czy modu³ <command>agpgart</> daje siê za³adowaæ
(<filename>modprobe agpgart</>) i czy <filename>/etc/X11R6/bin/XF86_SVGA</>
jest linkiem na <filename>/etc/X11R6/bin/XFCom_i810</>.

I teraz najbardziej przykra czê¶æ instalacji: rêczna modyfikacja pliku
<filename>/etc/X11/XF86Config</>. Zmieniamy odpowiednio sekcje "Device"
i "Screen" (tutaj <command>Driver</> "svga" i <command>Subsection</> 
odpowiednio do pamiêci na karcie i rodzaju monitora). Przewa¿nie nale¿y
równie¿ zmodyfikowaæ sekcjê "Monitor", szczególnie <command>HorizSync</> 
i <command>VertRefresh</>. Czasem wypada te¿ poprawiæ sekcjê "Pointer",
opisuj±c± mysz.
</para>
<para> Po powy¿szych zmianach mo¿emy ju¿ próbowaæ testowaæ iksy 
(<command>startx</>).
</para>
</listitem>

<listitem>
<para>
Jeszcze innym przypadkiem trudno¶ci z uruchomieniem karty graficznej, mo¿e byæ nowa karta nVidii, która na szczê¶cie ma dobry support do Linuksa <ulink url="http://www.nvidia.com">http://www.nvidia.com</ulink>, niestety nie do ka¿dego (poni¿ej opisano to dla wspieranego Red Hat v7.2). Konieczna jest instalacja dwóch rpm'ów: GLX i interfejsu miêdzy kernelem, a tym¿e GLX. Tego ostatniego trzeba instalowaæ najpierw, mo¿na to zrobiæ z pakietu binarnego <filename>NVIDIA_kernel-1.0-2880.rh72up</filename>, ale lepiej zrobiæ to ze ¼róde³ <filename>NVIDIA_kernel-1.0-2880.src.rpm</filename> - szczególnie jest to konieczne w przypadku kernela innego ni¿ oryginalne z Red Hat v7.2:
<programlisting>
rpm --rebuild NVIDIA_kernel-1.0-2880.src.rpm
rpm -ihv /usr/src/redhat/RPMS/i386/NVIDIA_kernel-1.0-2880.i386.rpm
rpm -ihv NVIDIA_GLX-1.0-2880.rh72up.i386.rpm
</programlisting>
</para>
</listitem>

<listitem>

<para>
je¿eli nie zainstalowa³ siê odpowiedni XServer, nale¿y go zainstalowaæ
rêcznie:

<itemizedlist>
<listitem>

<para>
jako root:
<programlisting>
	mount -t iso9660 /dev/cdrom /mnt/cdrom
</programlisting>
</para>
</listitem>
<listitem>

<para>
potem:
<programlisting>
	rpm -ihv /mnt/cdrom/RedHat/RPMS/&lt;brakuj±cy_XServer&gt; 
</programlisting>
gdzie brakuj±cy serwer to mo¿e byæ np. 
<filename>XFree86-SVGA-3.3.5-3.i386.rpm</filename>.
Czasami mo¿e byæ konieczne u¿ycie innych opcji do programu 
<command>rpm</command>, np. <command>rpm -Uhv</command> albo 
<command>rpm -Uvh --force</command>.
</para>
</listitem>
<listitem>

<para>
uruchomiæ Xconfigurator ponownie
</para>
</listitem>

</ItemizedList>

</para>
</listitem>

<listitem>
<para>
aby prze³±czyæ mysz z np. COM2 na port PS/2:
<itemizedlist>
<listitem>
<para>
uruchomiæ <filename>mouseconfig</filename>
</para>
</listitem>
<listitem>
<para>
przestawiæ w <filename>/etc/sysconfig/mouseconfig</filename> na <filename>"ps2"</filename> (taki jest parametr w wywo³aniu <filename>gpm -t</filename>)
</para>
</listitem>
<listitem>
<para>
sprawdziæ, czy odpalany jest przy starcie <filename>gpm</filename> (link w <filename>/etc/rc.d/rc5.d</filename>)
</para>
</listitem>
<listitem>
<para>
ustawiæ w <filename>/etc/X11/XF86Config</filename> w sekcji <filename>"Pointer"</filename> typ na <filename>"PS/2"</filename>
</para>
</listitem>
</ItemizedList>

</para>
</listitem>

<listitem>
<para>
je¿eli po instalacji po reboocie przy wybraniu jako bootmanagera <filename>lilo</filename> komputer nie startuje, tylko wypisuje co¶ w rodzaju:
<programlisting>
L 80 80 80 80 80 80 80 80 80 80 ...
</programlisting>
albo:
<programlisting>
L
L
L
L
</programlisting>
mo¿e to oznaczaæ (szczególnie w przypadku kontrolerów SCSI), ¿e w trakcie instalacji b³êdnie zosta³a zaznaczona opcja <command>Use linear mode</command>. Aby temu zaradziæ nale¿y w pliku <filename>/etc/lilo.conf</filename> zamieniæ linijkê:
<programlisting>
linear
</programlisting>
na:
<programlisting>
lba32
</programlisting>
</para>
</listitem>

<listitem>
<para>
sprawdzenie czy karta sieciowa zainstalowa³a siê poprawnie: jako root odpaliæ

<programlisting>
/sbin/ifconfig
</programlisting>
 - powinien pokazaæ siê eth0; dla próby jeszcze odpaliæ

<programlisting>
ping &lt;ip_jakiego¶_pod³±czonego_komputera&gt;
</programlisting>
<anchor id="prom-config">
 je¿eli nie dzia³a, pój¶æ do
DOSa, odpaliæ program do ustawiania parametrów karty sieciowej i
sprawdziæ, czy jest w³a¶ciwe medium - lepiej ustawiæ rêcznie RJ45/BNC
ni¿ auto. Poza tym dla kart, które obs³uguj± funkcjê Boot PROM - lepiej tê
funkcjê wy³±czyæ.
</para>
</listitem>
<listitem>

<para>
aby karta sieciowa zainstalowa³a siê, w systemie musi byæ odpowiedni modu³

<programlisting>
/lib/modules/&lt;kernel_number&gt;/net/&lt;modul_karty&gt;.o
</programlisting>
 - jaki modu³ potrzebny
jest do jakiej karty sieciowej mo¿na odczytaæ w

<filename>
/usr/doc/HOWTO/Ethernet-HOWTO
</filename>
 (parametr Driver Name przy opisie danej
karty); potem nale¿y wydaæ jako root komendê:
<programlisting>
lsmod
</programlisting>
i sprawdziæ, czy
odpowiedni modu³ nie jest ju¿ za³adowany - je¿eli jest, problem
prawdopodobnie tkwi w karcie; je¿eli nie, nale¿y wydaæ komendê:
<programlisting>
insmod &lt;modul_karty&gt;
</programlisting>
(uwaga: podajemy nazwê modu³u bez rozszerzenia .o)
(dostêpne opcje podane s± w
<filename>
/usr/src/linux/Documentation/networking/net-modules.txt
</filename>
);
komenda: 
<programlisting>
rmmod &lt;modul_karty&gt;
</programlisting>
usuwa driver
</para>
<para>
¿eby 
<programlisting>
/sbin/ifconfig
</programlisting>
pokaza³
eth0 (prawid³owo zainstalowana sieæ na karcie) nale¿y uruchomiæ:

<programlisting>
/etc/rc.d/init.d/network restart
</programlisting>
 ¿eby samo wchodzi³o przy starcie
komputera, w pliku 
<programlisting>
/etc/conf.modules
</programlisting>
 nale¿y wstawiæ linijkê: 

<programlisting>
alias eth0 &lt;modu³ karty&gt;
</programlisting>

</para>
</listitem>

<listitem>
<para>
<anchor id="netconf">
Mo¿na u¿yæ tak¿e narzêdzia do pó³automatycznej instalacji karty sieciowej. Mo¿e
to byæ konieczne tak¿e je¶li karta zostanie ¼le wykryta przy instalacji, b±d¼
trzeba zmieniæ numer IP komputera. 
</para>
<para>
W RH6.x oraz RH7.0, 7.1 i 7.2 dostêpne jest narzêdzie 
<command>netconf</command>, które pracuje w trybie tekstowym jak i
graficznym. Tu opiszemy wersjê tekstow± tego narzêdzia.
</para>
<para>
Po uruchomieniu nale¿y wybraæ z menu opcjê <command>Basic host configuration</>,
wcisn±æ <command>Enter</>, po czym wpisaæ nastêpuj±ce informacje: nazwê 
komputera (Host name), w sekcji Adaptor 1 (je¶li konfigurujemy pierwsz± 
kartê) zaznaczyæ opcje <Emphasis>Enabled</> i Config Mode - Manual. Potem 
wpisujemy jeszcze raz nazwê komputera pe³n± (z nazw± domeny), a wiêc np. 
mail.praterm.com.pl. Kolejne pole, które musimy wype³niæ, to numer IP 
komputera (IP address), w notacji z kropkami (a wiêc np. 192.168.1.1). W polu
Mask wpisujemy maskê sieci (w sieci lokalnej jest to zwykle 255.255.255.0),
a na koniec podajemy jeszcze nazwê urz±dzenia (dla pierwszej karty jest to
eth0).
</para>
<para>
Potem klawiszem <command>Tab</> przechodzimy do przycisku <command>Accept</>
i <command>Enterem</> akceptujemy wprowadzone zmiany. Je¿eli komputer ma byæ
pod³±czony do Internetu przez inny komputer (bramkê), to nale¿y jeszcze wpisaæ
numer IP komputera bêd±cego bramk± (routera) w pole, które pojawi siê po 
wybraniu z menu g³ównego opcji <emphasis>Routing and gateways</>, a nastêpnie
<emphasis>Set default</>. Nale¿y tak¿e zaznaczyæ opcjê 
<emphasis>Enable route</>.
</para>

<para>
<anchor id="redhat-config-network">
W najnowszych wersjach RedHata (RH7.3, RH8.x, RH9.x) program 
<command>netconf</command> zosta³
usuniêty. W tym przypadku powinni¶my skorzystaæ z programu 
<command>redhat-config-network</command> (jednego z suity programów
redhat-config), który ma tylko wersjê graficzn±.
</para>
<para>
Po uruchomieniu mo¿emy klikn±æ zak³adkê Hardware, ¿eby przekonaæ
siê jakie urz±dzenie mog± byæ potencjalne wykorzystane do kontaktu z sieci±.
Z regu³y bêdzie to karta sieciowa (eth0). 
</para>
<para>W zak³adce Devices mo¿emy kartê tê skojarzyæ z jednym lub wiêcej 
numerem IP. W tym celu klikamy przycisk Add, wybieramy urz±dzenie Ethernet
i zatwierdzamy (OK). Pojawi siê nowe okno. Po pierwsze musimy nadaæ
temu skojarzeniu jak±¶ nazwê (Nickname). Zwykle, dla porz±dku, skojarzenia
nazywane s± tak jak urz±dzania, do których s± przypisane (eth0, eth1 itd).
Aliasy IP maj± dodatkowo numer aliasa po dwukropku (np. eth0:0, eth0:1 itd).
Opcjê "Activate Device when Computer Starts" zostawiamy w³±czon± i przechodzimy
do zak³adki Protocols. Klikamy na przycisk Edit, co spowoduje wy¶wietlenie
siê kolejnego okienka. 
</para>
<para>Je¿eli nie korzystamy z DHCP (z regu³y nie korzystamy)
to wy³±czamy opcjê "Automatically obtain IP address settings with" 
i ustawiamy odpowiednio adres IP, maskê podsieci i gateway (maska
podsieci dla sieci prywatnych to zwykle 255.255.255.0, a
w sieciach bez dostêpu do Internetu pole gateway mo¿na pozostawiæ
puste). W zak³adce Hostaname wpisujemy nazwê naszego hosta
natomiast do zak³adki Routing w ogóle nie wchodzimy (chyba ¿e chcemy
stworzyæ jakie¶ zaawansowane tablice routingu). Ca³o¶æ zatwierdzamy (OK).
</para>
<para>Jeste¶my teraz znowu w okienku Ethernet Device. Klikamy 
na zak³adkê Hardware Device i tam wybieramy które urz±dzenie chcemy
konfigurowaæ. Je¶li dodajemy alias IP to musimy zaznaczyæ opcjê
"Enable Device Alias Support" i ustawiæ numer aliasu (zwykle 0).
Ca³o¶æ zatwierdzamy. I przechodzimy do okienka g³ównego (Network Configuration).
</para>
<para>
Klikaj±c na zak³adce Hosts mo¿emy zmodyfikowaæ plik <filename>/etc/hosts</filename> (mo¿na to zrobiæ równie¿ pó¼niej - rêcznie). 
Zak³adka DNS pozwoli nam ustawiæ
nazwê hosta (Hostname) i nasz± domenê (Domain), chocia¿  tê mo¿na 
zostawiæ pust± (jest to odpowiednik domain 
z <filename>resolv.conf</filename>-a).
Najwa¿niejsz± funkcj± jest mo¿liwo¶æ dodania numerów IP serwerów DNS.
Mo¿na równie¿ ustawiæ tzw. Search Domain (czyli search z 
<filename>resolv.conf</filename>-a).
Jak ³atwo zauwa¿yæ, wszystkie powy¿sze czynno¶ci w zak³adce DNS mo¿na 
równie¿ zrobiæ pó¼niej (modyfikuj±c plik 
<filename>/etc/resolv.conf</filename>. Zmiany zatwierdzamy
przyciskiem Zastosuj a nastêpnie Zamknij.
</para>
</listitem>

<listitem>
<para>
W RH 6.x instalacja w przypadku wyboru zarówno pakietu Gnome jak i KDE domy¶lnie
ustawia jako graficzny mened¿er logowania gdm, z którym s± k³opoty
w sieci. Aby zmieniæ gdm na kdm nale¿y jako root w pliku
/etc/X11/prefdm ustawiæ linijkê:
<programlisting>
preferred=kdm
</programlisting>
tu¿ przed warunkiem pod koniec pliku:
<programlisting>
if [ -n "$preferred" ] &#38;&#38; which $preferred &gt;/dev/null 2&gt;&#38;1; then
 exec `which $preferred` $*
</programlisting>
aby zmiany zosta³y uwzglêdnione nale¿y zrestartowaæ system lub wpisaæ komendy:
<programlisting>
init 3
init 5
</programlisting>
Je¶li to nie zadzia³a - dalej bêdzie startowa³ gdm, lub X nie wystartuje
w ogóle (poka¿e siê komunikat:
<programlisting>
INIT: Id "x" respawning too fast: disabled for 5 minutes
</programlisting>
trzeba wówczas prze³adowaæ system i przy starcie systemu po napisie LILO: 
napisaæ:
<programlisting>
linux single
</programlisting>
(dostêpny jest wówczas bash bez uruchamianych X-ów) w <filename>/etc/inittab</filename> nale¿y na miejscu linii:
<programlisting>
x:5:respawn:/etc/X11/prefdm -nodeamon
</programlisting>
wstawiæ liniê:
<programlisting>
x:5:respawn:/usr/bin/kdm -nodeamon
</programlisting>
</para>
</listitem>

<listitem>
<para>
standardowo po instalacji z wybran± opcj± "Use graphical login" serwer startuj±c w runlevel 5 (linia <filename>id:5:initdefault</filename> w pliku <filename>/etc/inittab</filename>) uruchamia X'y tak¿e na serwerze; je¿eli chcemy, ¿eby login w X'ach uruchamiany by³ na wszystkich terminalach, ale nie na serwerze (w celu zniechêcenia u¿ytkowników do dotykania serwera) nale¿y w pliku <filename>/etc/X11/xdm/Xservers</filename> wykomentowaæ (wstawiaj±c na pocz±tku znak "#") liniê:
<programlisting>
# :0 local /usr/X11R6/bin/X
</programlisting>
</para>
</listitem>

<listitem>
<para>
aby prze³±czyæ desktop w trakcie pracy nale¿y pod Gnome/KDE uruchomiæ: <filename>Panel | System | Desktop Switching Tool</filename>, uruchamiaj±cy program:
<programlisting>
/usr/bin/switchdesk
</programlisting>
lub z poziomu konsoli:
<programlisting>
/usr/bin/switchdesk-helper
</programlisting>
</para>
</listitem>

<listitem>
<para>
w Red Hat v6.1 przy logowaniu do serwera z terminala spod Windows w KDE pojawia siê komunikat: "Sorry your X11 server lacks DPMS support"; odpowiedzialny za to jest element KDE - <filename>kcmdpms</filename> - ¿eby ten komunikat nie wyskakiwa³ przy logowaniu siê w KDE nale¿y w pliku <filename>/usr/share/applnk/Settings/Desktop/kcmdpms.kdelnk</filename> liniê:
<programlisting>
Init=kcmdpms -init
</programlisting>
zamieniæ na:
<programlisting>
Init=
</programlisting>
</para>
</listitem>

<listitem>
<para>
czas jest ustawiany w skrypcie <filename>/etc/rc.d/rc.sysinit</filename>
wywo³anie:
<programlisting>
/sbin/hwclock --hctosys -u
</programlisting>
(w <filename>/etc/rc.d/rc.sysinit</filename> - $CLOCK $CLOCKFLAGS); je¿eli 
hwclock na
podstawie RTC nie ustawia prawid³owo czasu systemowego nale¿y sprawdziæ,
czy plik <filename>/etc/localtime</filename> jest kopi± (albo soft linkiem)
pliku
<filename>/usr/share/zoneinfo/Poland</filename>, lub 
<filename>/usr/share/zoneinfo/Europe/Warsaw</filename>, lub
<filename>/usr/share/zoneinfo/posix/Poland</filename> (wszystkie te pliki s± 
identyczne), co
zapewnia w³a¶ciw± zmianê czasu na letni i zimowy; plik
<filename>/etc/sysconfig/clock</filename> powinien mieæ postaæ:
<programlisting>
UTC=true
ARC=false
ZONE="Poland"
</programlisting>
Ostatnia linijka nie jest konieczna.
</para>
</listitem>

<listitem>
<para>
je¿eli trzeba zmieniæ nazwê komputera ustawion± przy instalacji nale¿y w pliku
<filename>/etc/sysconfig/network</filename> ustawiæ odpowiednio liniê
<programlisting>
HOSTNAME=hostname.hostdomain
</programlisting>
Ponadto nazwê hosta w formacie <filename>hostname.hostdomain</filename> nale¿y umie¶ciæ w pliku <filename>/etc/HOSTNAME</filename>.
</para>
</listitem>

<listitem>
<para>
¯eby poprawnie dzia³a³a u¿ywana czêsto w plikach konfiguracyjnych SZARPa komenda <filename>hostname -s</filename> nale¿y pamiêtaæ o wpisie w pliku <filename>/etc/hosts</filename> postaci np.:
<programlisting>
127.0.0.1	hostname hostname.hostdomain localhost localhost.localdomain
</programlisting>
albo - zak³adaj±c, ¿e numer IP komputera to <filename>192.168.1.2</filename>:
<programlisting>
127.0.0.1	localhost localhost.localdomain
192.168.1.2	hostname hostname.hostdomain
</programlisting>
</para>
</listitem>
<listitem>

<para>
dodawanie u¿ytkowników z poziomu konsoli: 
<programlisting>
adduser &lt;username&gt;
</programlisting>
¿eby u¿ytkownik
nie mia³ has³a (mo¿e siê wtedy logowaæ nie podaj±c has³a):

<programlisting>
passwd -d &lt;username&gt;
</programlisting>

</para>
</listitem>
<listitem>

<para>
pewne rzeczy mo¿na wyrzuciæ z <filename>/etc/rc.d/rc5.d</filename>, aby system
startowa³ szybciej
i by³ mniej obci±¿ony. W katalogu <filename>/etc/rc.d/rc5.d</filename> powinny
zostaæ linki:


<programlisting>
	
	K01parstart	
	K03smb		 
	K10linuxconf
	K20gpm
	K30xfs
	K40keytable
	K50lpd		(opcja, patrz ni¿ej)
	K60inet
	K65crond
	K70atd		(opcja, patrz ni¿ej)
	K75syslog
	K80random
	K85portmap	(opcja, patrz ni¿ej)
	K90network
	S10network
	S11portmap	(opcja - potrzebny do NFS'a)
	S20random
	S30syslog
	S40atd		(opcja - mo¿na tego nie zamieszczaæ)
	S41crond
	S50inet
	S60lpd		(opcja - tylko gdy chcemy drukowaæ lokalnie b±d¼ zdalnie)
	S75keytable
	S90xfs
	S91gpm
	S97linuxconf
	S94smb		 
	S98parstart	
	S99local
</programlisting>


oczywi¶cie jest to minimum, mog± siê przydaæ jeszcze: http, nfs, netfs,
upsd, smb, nfslock etc.
	
(numery po literach K i S nie maj± znaczenia, byleby linki zachowa³y
t± sam± kolejno¶æ)

do konfiguracji uruchamianych serwisów mo¿na u¿yæ narzêdzia <command>ntsysv</>.
</para>
</listitem>

<listitem>
<para>
Czasem w RH 6.x (co siê jednak nie powinno zdarzaæ) mog± wyst±piæ b³êdy na partycji z systemem Linux (mo¿e to nast±piæ w skutku np. nag³ego wy³±czenia zasilania). Wiêkszo¶æ napraw jest on w stanie wykonaæ bez interakcji z u¿ytkownikiem, nale¿y mu to jednak umo¿liwiæ - w pliku <filename>/etc/rc.d/rc.sysinit</filename> nale¿y zamieniæ liniê (~158 linii):
<programlisting>
initlog -c "fsck -T -a $fsckoptions /"
</programlisting>
na:
<programlisting>
initlog -c "fsck -T -y $fsckoptions /"
</programlisting>
</para>
</listitem>

<listitem>
<para>
¿eby w KDE w RH 6.x u¿ywane by³y polskie czcionki: uruchomiæ z menu KDE Centrum
Sterowania / Desktop / Czcionki i dla ka¿dej opcji (Czcionka ogólna,
Czcionka proporcjonalna, Czcionka tytu³ów okna, Czcionka przycisków
panelu, Czcionka zegara panelu) wybraæ Kodowanie iso-8859-2,
nacisn±æ Zastosuj. 
</para>
<para>
By w RedHat 6.2 standardowa czcionka Helvetica obs³ugiwa³a poprawnie kodowania
iso-8859-2 nale¿y zmieniæ czcionkê przed zmian± jêzyka na Polski (patrz ni¿ej).
</para>
</listitem>

<listitem>
<para>
¿eby w KDE w Rh 6.x u¿ywany by³ jêzyk polski: uruchomiæ z menu KDE Centrum Sterowania
(KDE Control Center) / Desktop / Jêzyk (Language) i ustawiæ wszystkie
na polski, nacisn±æ Zastosuj (Apply); po tym najlepiej zamkn±æ i
powtórnie uruchomiæ KDE Centrum Sterowania - ju¿ z odpowiednimi
ustawieniami
</para>
</listitem>

<listitem>
<para>
¿eby w KDE w RH 6,x u¿ywana by³a polska klawiatura programisty: uruchomiæ z menu KDE
Centrum Sterowania / Urz±dzenia wej¶ciowe / Miêdzynarodowe Ustawienia 
na karcie Ogólne w opcji Mapy klawiatury dodaæ "Pl Jêzyk: Polski.
Kodowanie: domy¶lne. Klawiatura programisty"
(uwaga - je¶li nie dzia³a, wybieraæ "nPl Jêzyk: Polski. Kodowanie: domy¶lne.
Klawiatura Miêdzynarodowa"); istniej±c± klawiaturê amerykañsk± usun±æ;
na karcie Start zaznaczyæ opcjê Autostart; W oknie Zaawansowane wybraæ 
"Codes for pc101 keyboard" i Menu globalne;
nacisn±æ Zastosuj - zmiany
zostan± uwzglêdnione dopiero przy nastêpnym loginie
</para>
</listitem>

<listitem>
<para>
W RH 7.2 zamiast powy¿szych dzia³añ w celu ustawienia polskich liter nale¿y po pierwszym zalogowaniu siê u¿ytkownika zaakceptowaæ ustawienia standardowe magika (kraj i jêzyk).
Pamiêtaæ nale¿y równie¿ o wy³±czeniu Antyaliasingu (Centrum Sterowania / Czcionki / Stosuj Wyg³adzanie). W przeciwnym razie niektóre polskie znaki bêd± ¼le wy¶wietlane.

</para>
<para>
W RH 7.3 polskie litery dzia³aj± od razu. W celu uzyskania polskich liter na 
klawiaturze nale¿y w pliku /usr/X11R6/lib/X11/xkb/symbols/pl nale¿y usun±æ
przecinek po "EuroSign".
</para>
</listitem>

<listitem>
<para>
powy¿sze ustawienia w KDE nale¿y wykonaæ dla ka¿dego u¿ytkownika oddzielnie
</para>
</listitem>

<listitem>
<para>
¯eby na ekranie powitalnym w KDE (w kdm) by³a w³a¶ciwa konfiguracja i
odpowiednie napisy po polsku: zalogowaæ siê jako root, uruchomiæ z menu
KDE Centrum Sterowania / Aplikacje / Mened¿er logowania / karta Wygl±d / 
opcja Wygl±d / tekst powitalny - np. "Witamy w SZARP v2.1", opcja Jêzyk
- polski; karta Czcionki / Wybierz czcionkê / przycisk Zmieñ czcionkê
dla ka¿dej opcji w menu: Powitanie, B³±d, Zwyk³a: w okienku Wybierz
czcionkê / ¯±dana czcionka / Kodowanie iso-8859-2, nacisn±æ OK; na
karcie U¿ytkownicy przeci±gn±æ wybranych u¿ytkowników, którzy bêd± siê
logowaæ w KDE z okna Wszyscy do okna Wybrani, zaznaczyæ opcjê Pokazuj
jedynie wybranych oraz Pokazuj; na karcie Sesje: w menu Pozwól na
zamkniêcie systemu ustawiæ Tylko konsola (je¿eli wszyscy maj± mieæ
mo¿liwo¶æ zamkniêcia systemu - ustawiæ Wszyscy), z okna Dostêpne typy
usun±æ wszystko prócz KDE (je¿eli tylko w ten sposób u¿ytkownicy maj±
siê logowaæ), nacisn±æ Zastosuj.
</para>
</listitem>

<listitem>
<para>
¯eby ustawiæ automatyczne logowanie dla KDE (dotyczy to tych dostarczanych z
RH 7.x) w KDE Centrum Sterowania / System / Menad¿er logowania / karta
U³atwienia / Logowanie automatyczne - ustawiamy opcjê w³±cz logowanie
automatyczne, Zaloguj po starcie i ustawiamy wybranego u¿ytkownika (np.
palacz).
</para>
</listitem>

<listitem>
<para>
dla tych, którzy czêsto u¿ywaj± program mc - aby poprawnie obs³ugiwa³ 
polskie litery nale¿y ustawiæ opcjê: 8-bit display. Bardzo przydatna jest te¿
opcja: Definiuj klawisze.
</para>
</listitem>

<listitem>
<para>
konfigurowanie locate; standardowo to siê samo nie robi w systemie, tylko 
trzeba raz na pocz±tku odpaliæ rêcznie jako root:
<programlisting>
/etc/cron.daily/slocate.cron
</programlisting>
W RH 7.2 zwykle jest to dobrze skonfigurowane i nic nie trzeba robiæ, czasami trzeba odpaliæ <command>updatedb</command>.
</para>
</listitem>

<listitem>
<para>
Polskie fonty i klawiaturê w trybie tekstowym mo¿na osi±gn±æ na
kilka sposobów: 
<itemizedlist>
<listitem><para>
W RH 7.2 wystarczy w pliku <filename>/etc/sysconfig/keyboard</> zamieniæ linijkê 
<programlisting>
KEYTABLE="us"
</programlisting>
na
<programlisting>
KEYTABLE="pl"
</programlisting>
a nastêpnie uruchomiæ (jako root) <filename>/etc/init.d/keytable restart</>.
</para></listitem>

<listitem><para>
Wywo³aæ komendê <filename>anaconda --reconfig</filename>. 
W tym przypadku (w przeciwieñstwie do wersji instalacyjnej) bêdziemy
mieli mo¿liwo¶æ wyboru jêz. polskiego. (uruchamianie tego nie jest zalecane ze
wzglêdu na pewne b³êdy i nadmierne rzeczy generowane przez anaconde)
</para></listitem>

<listitem><para>
na koñcu pliku <filename>/etc/rc.d/rc.local</filename> nale¿y dodaæ linijki:
<programlisting>
loadkeys /usr/lib/kbd/keymaps/i386/qwerty/pl.kmap.gz
consolechars -f /usr/lib/kbd/consolefonts/lat2u-16.psf.gz
</programlisting>
</para></listitem>

<listitem><para>
zmieniæ zawarto¶æ pliku <filename>/etc/sysconfig/i18n</filename> dopisuj±c na jego koñcu linijki:
<programlisting>
LANG="pl_PL"
SYSFONT="lat2-sun16"
SYSFONTACM="iso02"
</programlisting>
a w pliku <filename>/etc/sysconfig/keyboard</filename> zamiast linijki:
<programlisting>
KEYTABLE="us"
</programlisting>
wstawiæ linijki:
<programlisting>
KEYTABLE=pl
KBCHARSET=iso-8859-2
</programlisting>
aby zadzia³a³ którykolwiek z dwóch wymienionych sposobów nale¿y zresetowaæ komputer
</para>
<para>
Uwaga! W RedHat 6.1 zamiast czcionki lat2-sun16 nale¿a³o u¿yæ lat2u-16.
Inn± mo¿liwo¶ci± jest czcionka iso02grf.
</para>
</listitem>
</itemizedlist>
</para>
</listitem>

<listitem>
<para>
aby z poziomu Linuksa widoczne by³y dyski dosowe nale¿y odpowiednio zmodyfikowaæ (jako root) plik <filename>/etc/fstab</filename> wstawiaj±c tam linijki:
<programlisting>
/dev/hda1		/dos/c			msdos	defaults	0 0
/dev/hda5		/dos/d			msdos	defaults	0 0
/dev/hda6		/dos/e			msdos	defaults	0 0
/dev/hda7		/dos/f			msdos	defaults	0 0
/dev/hda8		/dos/g			msdos	defaults	0 0
/dev/hda4		/win98			vfat	defaults	0 0
</programlisting>
gdzie odpowiednie ¶cie¿ki do kolejnych dysków dosowych (nazwy w pierwszej kolumnie) mo¿na w przypadku dysku IDE odczytaæ poprzez wywo³anie komendy:
<programlisting>
/sbin/fdisk /dev/hda
</programlisting>
w przypadku dysku SCSI:
<programlisting>
/sbin/fdisk /dev/sda
</programlisting>
w przypadku macierzy RAID:
<programlisting>
/sbin/fdisk /dev/md0
</programlisting>
</para>
</listitem>

<listitem>
<para>
¿eby nie trzeba by³o przy naprawie plików DBF korzystaj±c z NU i CID wychodziæ z Linuksa, lub robiæ to na innej maszynie trzeba zainstalowaæ dobre dosemu. Trzeba ¶ci±gn±æ dosemu-1.0.0-1.i386.rpm (lub nowszy), odinstalowaæ dostarczane standardowo z RH 6.1 pakiety 0.99 wydaj±c jako root komendy:
<programlisting>
rpm -e xdosemu
rpm -e dosemu-freedos
rpm -e dosemu
</programlisting>
zainstalowaæ dosemu-1.0.0 wydaj±c jako root komendê:
<programlisting>
rpm -ihv dosemu-1.0.0-1.i386.rpm 
</programlisting>
w katalogu /var/lib/dosemu nale¿y zrobiæ podkatalog <filename>drives</filename>, a w nim linki na dyski DOSowe widziane pod Linuksem (musi byæ odpowiednio zmodyfikowany /etc/fstab). Zak³adaj±c, ¿e jest to katalog /dos i podkatalogi c, d... (jak w powy¿szym przyk³adzie ustawiania pliku <filename>/etc/fstab</filename>) w katalogu <filename>/var/lib/dosemu/drives</filename> trzeba zrobiæ jako root nastêpuj±ce soft linki:
<programlisting>
for i in `ls /dos`
do ln -s /dos/$i $i
done
</programlisting>
w pliku <filename>/etc/dosemu.conf</filename> zrobiæ wpisy: zamiast
<programlisting>
$_hdimage="hdimage.first"
</programlisting>
wstawiæ:
<programlisting>
$_hdimage="drives/* commands"
</programlisting>
zamiast:
<programlisting>
$_rawkeyboard = (0)
</programlisting>
wstawiæ:
<programlisting>
$_rawkeyboard = (1)
</programlisting>
zamiast:
<programlisting>
$_term_char_set = ""
</programlisting>
wstawiæ:
<programlisting>
$_term_char_set = "ibm"
</programlisting>
wtedy mo¿na korzystaæ z <filename>Ctrl+Alt+Fx</filename> do prze³±czania sesji. Katalog <filename>/var/lib/dosemu/commands</filename> zawiera ró¿ne programy dosemu, m.in. <filename>exitemu.com</filename>. Ten katalog zostanie przyporz±dkowany w ¶rodowisku dosemu ostatniej (prócz ramdysku) literze dysku DOSowego. ¯eby mieæ pe³ny dostêp znaków ASCII jak pod DOSem trzeba wcze¶niej wy³±czyæ polski font pod konsol±. Z dosemu nale¿y korzystaæ jako root wywo³uj±c <filename>dos</filename> pod konsol±, a koñczyæ przez wywo³anie:
<programlisting>
&lt;ostatni_dostepny_dysk_dosowy&gt;:exitemu.com
</programlisting>
tak skonfigurowane dosemu bierze <filename>autoexec.bat</filename> i <filename>config.sys</filename> z DOSa, które na pewno s± nieodpowiednie dla ¶rodowiska dosemu, ale to bardzo nie przeszkadza. Mo¿na tez sobie zrobiæ skonfigurowan± pod potrzeby dosemu sekcjê w DOSowych <filename>autoexec.bat</filename> i <filename>config.sys</filename> pod tytu³em np. <filename>[dosemu]</filename> i wybieraæ j± przy starcie dosemu. Inna mo¿liwo¶æ to stworzenie odpowiednio zmodyfikowanych plików <filename>autoexec.bat</filename> i <filename>config.sys</filename> pod nazwami np. <filename>autoexec.emu</filename> i <filename>config.emu</filename> i zamiast:
<programlisting>
$_emusys = ""
$_emubat = ""
</programlisting>
wstawiæ:
<programlisting>
$_emusys = "emu"
$_emubat = "emu"
</programlisting>
</para>
</listitem>

<listitem>
<para>
Niektóre nowe p³yty g³ówne, np. Intel D845BGL, nie obs³uguj± standardu APM (Advanced Power Management), tylko ACPI (Advanced Configuration and Power Interface) opracowane przez Intela, Toshibê i Microsoft. Poni¿ej opisane s± czynno¶ci konieczne do wykonania przy instalacji Red Hat v7.2 na maszynie z pyt± g³ówn± Intel D845BGL, przy za³o¿eniu domy¶lnego kernela 2.4.7-10:
</para>
<para>
Konieczna jest rekonfiguracja kernela - w domy¶lnej w³±czone jest APM, a wy³±czone ACPI:
Y<programlisting>
cd /usr/src/linux-2.4
make menuconfig
</programlisting>
Teraz nale¿y odpowiednio w³±czyæ i wy³±czyæ odpowiednie opcje:
<programlisting>
General Setup:
[*] Power Management support
[*]   ACPI Support
&lt; &gt;     ACPI Debug Statements
&lt;*&gt;     ACPI Bus Manager
&lt;*&gt;       System
&lt;M&gt;       Processor
&lt;*&gt;       Button
&lt; &gt;       AC Adapter
&lt; &gt;       Embedded Controller
&lt; &gt;   Advanced Power Management BIOS support
</programlisting>
Na tym etapie mo¿na te¿ zrobiæ inne rzeczy, aby odchudziæ kernela i przyspieszyæ sam± kompilacje, wyrzucaj±c niepotrzebne sekcje jak np. <command>SCSI</command>, <command>ISDN</command>, <command>RAID</command> itp. w zale¿no¶ci od sprzêtowej konfiguracji maszyny. Po tym nale¿y wybraæ <command>Exit</command> i <command>Save configuration</command>. Teraz trzeba zrekompilowaæ j±dro:
<programlisting>
make dep bzImage modules modules_install
</programlisting>
Na etapie <command>modules_install</command> mo¿e doj¶æ do b³êdu <command>depmod</command>, ale nie koniecznie uniemo¿liwi to poprawne dzia³anie tak przygotowanego kernela. 

Po kompilacji trzeba przygotowaæ system do zmiany aktywnego kernela 
(zmiana <filename>System.map</filename> nie jest konieczna). 
W tym celu najpierw kopiujemy nowe j±dro do katalogu <filename>/boot</filename>:

<programlisting>
cp System.map /boot/System.map-2.4.7-10custom
cp arch/i386/boot/bzImage /boot/vmlinuz-2.4.7-10custom
cd /boot
ln -sf System.map-2.4.7-10custom System.map
mkinitrd /boot/initrd-2.4.7-10custom.img 2.4.7-10custom
</programlisting>
a nastêpnie konfigurujemy menad¿er bootowania w taki sposób, ¿eby uruchamia³ nowe j±dro
(tak jako to opisuj± <xref linkend="konfiguracjagruba"> i <xref linkend="konfiguracjalilo">).
Warto na wszelki wypadek zostawiæ tymczasowo mo¿liwo¶æ uruchamiania systemu ze starego j±dra.
</para>
<para>
Teraz komputer nale¿y zrestartowaæ. Je¿eli instalacja karty graficznej by³a standardowa, 
wszystko powinno byæ gotowe. 
Je¿eli nie, nale¿y ponownie zrobiæ modu³y z pakietów ¼ród³owych i ponownie zrestartowaæ.
</para>
</listitem>

</itemizedlist>
</para>
</section> <!-- redhat-install -->

<section id="rh90-instalacja">
<title>Instalacja systemów RedHat 9.x, Aurox 9.x i Fedora 1.x</title>
<para>
Instalacja systemów RH 9.x/Aurox 9.x/Fedora ró¿ni siê na tyle wyra¼nie
od instalacji starszych systemów, ¿e
wyodrêbnienie tego podpunktu sta³o siê konieczno¶ci±. 
¯eby jednak nie powtarzaæ informacji, tam, gdzie to tylko mo¿liwe, 
znajd± siê odniesienia
do odpowiednich fragmentów z dokumentacji powy¿ej.
</para>
<para>
Wraz z wydaniem wersji 8.0, RedHat
zabroni³ innym firmom wydawania i sprzedawania wersji systemu
pod szyldem RedHat. Jest to jedna z przyczyn powstania
<quote>polskiego RedHata</quote>, czyli Auroksa. 
</para>
<para>
W roku 2003 RedHat podj±³ decyzjê o wycofaniu siê z segmentu 
rynku dla odbiorcy indywidualnego. 
Tradycjê dystrybucji biurkowej <quote>dla ka¿dego</quote> podtrzymuje jednak
w ramach inicjatywy <ulink url="http://fedora.redhat.com/">Fedora</ulink>,
która jest rozwijana przez spo³eczno¶æ programistów (podobnie jak np. system
Debian).
</para>
<para>
Na poziomie pakietów dystrybucje RH/Aurox (w odpowiednich wersjach)
s± niemal¿e identyczne. System Aurox jest oczywi¶cie bardziej spolszczony:
instalacja przebiega po polsku a wszystkie domy¶lne ustawienia
s± dobrane do jêzyka polskiego i naszej strefy czasowej.
Polskie komunikaty widzimy równie¿ w trakcie uruchamiania siê 
systemu i startowania serwisów.
Co wiêcej, w Auroksie obecne s± pakiety multimedialne,
których w <quote>zwyk³ym</quote> RedHacie najbardziej brakuje:
obs³uga formatu mp3 oraz formatów video (program <command>mplayer</command>).
Dodatkowo systemy RH z rodziny 8.x i 9.x charakteryzuj± siê (domy¶lnie 
ustawionym) wygl±dem interfejsu u¿ytkownika niemal¿e identycznym
w systemie Gnome jak i KDE (interfejs BlueCurve).
W systemie RH 9.0 standardowo jest instalowany jest system CUPS,
który w tandemie z programem <command>kudzu</command> instaluj± nam
i konfiguruj± drukarkê (np. HP 815 - bezb³êdnie).
RH 9.0 wspiera równie¿ obs³ugê kó³eczka w OEM-owych myszkach Logitech
(bez ¿adnych patchy) i odczyt z p³ytek zapisanych w pakietowym
formacie UDF. 
RH/Aurox (8.x jak i 9.x) posiadaj± ca³± masê narzêdzi biurowych 
(m.in. OpenOffice). Teraz pliki Excela, Worda, PowerPointa mo¿na
otwieraæ i modyfikowaæ pod Linuksem bez wiêkszego problemu.
</para>
<para>
Sposób instalacji systemu w wersji 8.0 jest analogiczny
do wcze¶niejszych wersji. W przypadku systemu RH 9.x (Aurox 9.x, Fedora)
mamy nowo¶æ - na wzór instalacji systemu Windows, instalacja systemu
zosta³a rozdzielona na 2 czê¶ci:
<itemizedlist>
<listitem><para>
Pierwsza czê¶æ to (tradycyjnie) program instalacyjny uruchamiany automatycznie
z p³ytki: 
<itemizedlist>
<listitem><para>
Kilka pocz±tkowych kroków, czyli ENTER po tek¶cie powitalnym,
testowanie no¶nika, wybór jêzyka (w Auroksie zaproponowany bêdzie jêz. polski), 
ustawienia klawiatury i rodzaj myszy 
oraz typ instalacji (<quote>Custom</quote>, czyli <quote>Decyduj Sam</quote>)
i podzia³ dysku na partycje, wykonujemy wg opisu ogólnego 
(por. <link linkend="redhat-ekran-powitalny-enter">wy¿ej</link>).

Niestety, w RH 9.0 (przynajmniej w wersji graficznej) nie mamy do 
dyspozycji programu <command>fdisk</command>.
Dysk musimy podzieliæ na partycje 
za pomoc± programu <command>Disk Druid</command>.
</para></listitem>

<listitem><para>
Jako boot loadera wybieramy GRUB-a w MBR
(por. <link linkend="redhat-boot-loader">wy¿ej</link>).
</para></listitem>

<listitem><para>
W kolejnym kroku ustawiamy sieæ 
(por. <link linkend="redhat-siec">wy¿ej</link>).
Musimy wybraæ przycisk <quote>Edycja</quote> je¶li chcemy zmieniæ domy¶lne 
ustawienie DHCP. Dopiero wtedy uaktywni± nam siê opcje
<quote>Bramka</quote> i serwery DNS. W opcjach firewalla
w³±czamy <command>ssh</command>.
</para></listitem>

<listitem><para>
Nastêpnie wybieramy jêzyk polski (jako standardowy jêz.
dla systemu), wybieramy strefê czasow± warszawsk± (w Auroksie
wszystko to jest domy¶lnie) oraz ustawiamy has³o roota,
i potwierdzamy opcje bezpieczeñstwa systemu: shadow i MD5
(por. <link linkend="redhat-strefa-czasowa">wy¿ej</link>).
</para></listitem>
<listitem><para>
W menu wyboru grup pakietów, przewijamy listê na dó³ 
i zaznaczamy opcjê <quote>Everything</quote> (w Auroksie - 
<quote>Wszystko</quote>). Nie ma potrzeby wybierania ka¿dej
z grup z osobna. Uwaga! Wymagane oko³o 5GB przestrzeni dyskowej.
</para></listitem>
<listitem><para>
Teraz zaczyna siê instalacja systemu RH (trzy p³yty) - zale¿no¶ci
od systemu trwa od kilkudziesiêciu minut do 2-3 godzin.
Po zakoñczeniu instalowania pakietów zostaniemy poproszeni o stworzenie 
dyskietki startowej (nie chcemy) oraz wejdziemy do czê¶ci
konfiguracji interfejsu graficznego (X Window System).
Wybieramy odpowiedni± kartê graficzn± (powinna zostaæ wykryta),
monitor oraz parametry wy¶wietlania (g³êbia kolorów i rozdzielczo¶æ)
</para>
<para>
Po zainstalowaniu i ponownym uruchomieniu systemu 
przechodzimy do czê¶ci drugiej instalacji. 
Je¿eli instalujemy korzystaj±c z systemu Kickstart to
tej drugiej czê¶ci mo¿e nie byæ w ogóle.
</para></listitem>
</itemizedlist>

</para></listitem>

<listitem><para>
Przy pierwszym uruchomieniu systemu uaktywniany jest post-installer.
To tutaj w³a¶nie:
<itemizedlist>
<listitem><para>
   Dodajemy pierwszego zwyk³ego u¿ytkownika (nie roota).
   Trzeba nadaæ u¿ytkownikowi has³o. Inaczej nie przejdziemy 
   do nastêpnego kroku.
</para></listitem>
<listitem><para>
   Ustawiamy datê i czas. Mo¿emy skonfigurowaæ system <command>ntpd</command> 
   (to nowo¶æ!) i podaæ adres komputera, z którym siê bêdziemy synchronizowaæ.
</para></listitem>
<listitem><para>
   Konfigurujemy (a w³a¶ciwie akceptujemy zaproponowane) 
   ustawienia karty d¼wiêkowej.
</para></listitem>
<listitem><para>
   Rejestrujemy siê (lub nie) w Red Hat Network. Rejestracja daje nam
   automatyczny upgrade pakietów, ³atki itd. Je¶li nie chcemy siê
   rejestrowaæ (a innej opcji nie testowali¶my ;-) to pozostanie nam z spadku
   denerwuj±ca ikonka (czerwony wykrzyknik) na dole ekranu, pokazuj±cy
   brak po³±czenia z serwerami RH.
   Usuwamy j± nastêpuj±co:
   klikamy prawym klawiszem na wykrzykniku 
   i wybieramy opcjê <quote>Configuration</quote>.
   Na ekranie <quote>Red Hat Network Alert Notification Tool</quote> klikamy 
   <quote>Dalej</quote>.
   Na nastêpnym ekranie (<quote>Terms of Service</quote>) klikamy na klawisz 
   <quote>Remove from Panel</quote>.
</para></listitem>
<listitem><para>
   Instalujemy pakiety z dodatkowych CD-Romów RH (je¶li chcemy, je¶li mamy): 
   <quote>RH Linux Documentation CD</quote>,
   <quote>RH Linux Installation CD</quote>, 
   <quote>Additional CDs</quote>. 
</para></listitem>
</itemizedlist>
   
</para></listitem>
</itemizedlist>
Przy pierwszym logowaniu siê nale¿y upewniæ siê, ¿e uruchamiamy KDE.
Wprawdzie Bluecurve powoduje, ¿e oba systemy wygl±daj± tak samo, 
ale wcale nie zachowuj± siê tak samo (skróty klawiszowe, ustawienia).
Wybieraj±c KDE zostaniemy zapytani, czy chcemy danego u¿ytkownika skojarzyæ 
z sesj± KDE na przysz³o¶æ. Odpowiadamy, ¿e tak.
</para>
<para>
RH 9.0 ma domy¶lnie ustawione kodowanie znaków UTF-8 (unicode). 
Poprawiamy to ustawiaj±c w pliku 
<filename>/etc/sysconfig/i18n</filename> 
zmienn± LANG na <quote>pl_PL</quote>
a zmienn± SYSFONT na <quote>lat2-16</quote>.
</para>

<para>
Uwaga! Program Raporter z dystrybucji SZARP ¼le wspó³pracuje z Tcl 8.3 obecnym w systemie Aurox 
9.x (9.0, 9.1, 9.2) - po¿era ok. 60MB pamiêci RAM. Nie jest to zwi±zane z konkretn± wersj± 
Raportera.
Na RH7.2 i 7.3, gdzie jest TclTk 8.3.3-x, nie ma tego problemu, podobnie na Debianie z TclTk 8.0, 8.2, 8.3, 8.4. 

Rozwi±zanie problemu:
<itemizedlist>
<listitem><para>
Usun±æ TclTk (parê pakietów od niego zale¿y - dlatego nale¿y zastosowaæ opcjê <command>--nodeps</command>):
<programlisting>
rpm -e tk --nodeps
rpm -e tcl --nodeps
</programlisting>
</para></listitem>

<listitem><para>
Zainstalowaæ nowe rpm-y TclTk 8.4 (przetestowane, prawdopodobnie 
nowsze wersje te¿ bêd± dzia³aæ poprawnie), np.
<programlisting>
rpm -i tcl-8.4.4-1.i386.rpm
rpm -i tk-8.4.4-1.i386.rpm
</programlisting>
</para></listitem>

<listitem><para>
Zrobiæ odpowiednie linki:
<programlisting>
ln -s tclsh8.4 /usr/bin/tclsh
ln -s wish8.4 /usr/bin/wish
</programlisting>
</para></listitem>
</itemizedlist>
</para>

<para>
Uwaga! W systemie Aurox 9.2 (dystrybucja czterop³ytowa), przeinstalowane
pakiety systemu wxWindows (<filename>wxGTK-2.4.1-9.2</filename>) maj± b³±d, 
który powoduje, ¿e nie mog± byæ
uruchamiane aplikacje w programie SCC. Nale¿y wiêc zrobiæ upgrade systemu wx
do wersji 2.4.2. Podejrzanie zachowuje siê równie¿ program <command>rpm</command> 
- zdarza mu siê zawiesiæ siê przy instalowaniu lub odinstalowywaniu
pakietów. Bardzo o¿ywczo dzia³a na niego reboot systemu.
</para>
</section> <!-- rh90-instlacja -->

<section id="kickstart">
<title>Automatyzacja instalacji RedHata: <command>KickStart</command></title>

<para>
<note>
<para>Niniejszy opis tworzony/uaktualniany by³ na dystrybucjach RedHat 9.0 i 
wcze¶niejszych. Autorzy nie s± w stanie nic powiedzieæ o jego przydatno¶ci
przy nowszych wersjach RedHat'a/Fedory.</para>
</note>
RedHat KickStart (KS) daje mo¿liwo¶æ zainstalowania
RedHata wed³ug pewnego schematu. Mo¿e to byæ przydatne w sytuacjach,
gdy instalowanych jest wiele, identycznie skonfigurowanych hostów;
dziêki RH KS mo¿na równie¿ (przynajmniej teoretycznie) zleciæ instalowanie
RH laikowi, bo wybór elementów do instalacji oraz konfiguracja systemu
zostan± przeprowadzone automatycznie (<emphasis>laik</emphasis> bêdzie
wówczas odpowiedzialny za wymianê p³ytek instalacyjnych i naciskanie
Entera). KickStart pozwala na:
<itemizedlist>
<listitem><para>Wybór po¿±danych pakietów (ich do³o¿enie/usuniêcie w stosunku
do oficjalnej dystrybucji)</para></listitem>
<listitem><para>Zainstalowanie wybranych pakietów przez sieæ (z serwera 
FTP lub HTTP)</para></listitem>
<listitem><para>Batchow± konfiguracj± wielu elementów systemu</para></listitem>
<listitem><para>£atwo¶æ i szybko¶æ konfiguracji samego KS</para></listitem>
<listitem><para>Przeniesienie konfiguracji KS na inn± wersjê RH ni¿ wersja,
na/dla której utworzono pierwotn± konfiguracjê KS.</para></listitem>
</itemizedlist>
</para>
<para>
Dokumentacjê do systemu RedHat KickStart mo¿na znale¼æ na p³ycie
RedHata <quote>Dokumentacja</quote>.
Ponadto w RH 7.3 jest standardowo instalowany plik
<filename>/usr/share/doc/anaconda-7.3/kickstart-docs.txt</filename>,
zawieraj±cy pewne informacje dotycz±ce KS-a
(KS jest elementem Anacondy - programu instalacyjnego dla RH).
Niniejsze streszczenie powsta³o na podstawie tej dokumentacji 
oraz na podstawie w³asnych do¶wiadczeñ z KS na systemach RH 6.2 i RH 7.3.
</para>

<para>
¯eby uaktywniæ KickStarta w czasie instalacji RH, nale¿y przekazaæ do 
j±dra parametr 
ks=&lt;lokalizacja pliku konfiguracyjnego KS (<filename>ks.cfg</filename>)&gt;
<footnote><para>Nie oznacza to, ¿e RedHat dostarcza jakiego¶ wyspecjalizowanego
kernela. Ka¿de j±dro, je¿eli nie zrozumie jakiego¶ parametru,
(w tym przypadku <quote>ks=</quote>), przekazuje go dalej - do inita. 
Wyspecjalizowany (ale i bardzo uproszczony) jest natomiast instalacyjny 
<command>init</command>, który po otrzymaniu parametru <quote>ks=</quote>
uruchamia anacondê z odpowiednim parametrem.
</para></footnote>.

Plik <filename>ks.cfg</filename> mo¿e siê znajdowaæ na dyskietce (ks=floppy), 
jak równie¿ w sieci (ks=nfs: lub ks=http:), mo¿e byæ reprezentowany przez 
urz±dzenie w katalogu <filename>/dev/</filename> (ks=hd:) albo mo¿e byæ umieszczony
na p³ytce (ks=cdrom:). I nie musi siê nazywaæ <filename>ks.cfg</filename>,
lecz np. <filename>praterm-ks.cfg</filename>. Wówczas parametr <quote>ks=</quote>
musi zawieraæ nazwê pliku, np. <quote>ks=hd:fd0/praterm-ks.cfg</quote>.
</para>

<para>
Z KickStarta naj³atwiej skorzystaæ tworz±c odpowiedni± dyskietkê startow± RH, 
np. przy pomocy komendy <command>dd</command> 
(za³ó¿my, ¿e w <filename>/mnt/cdrom</filename> jest zamontowana p³yta 
z oryginalnym RedHatem):
<programlisting>
dd if=/mnt/cdrom/images/boot.img of=/dev/fd0,
</programlisting>
</para>

<para>
Kilka s³ów nale¿y siê dyskietce instalacyjnej RedHata.
Do uruchomienia i sparametryzowania procesu instalacji RH u¿ywa narzêdzia 
zwanego SysLinux. Prosty boot manager pozwala u¿ytkownikowi wybraæ jedn±
z mo¿liwo¶ci instalacji; ró¿nice s± wprowadzane na poziomie parametrów przekazywanych
do j±dra. Dyskietka ma DOS-owy system plików, ³atwo jest wiêc zmodyfikowaæ
owe parametry lub dodaæ swoje w³asne rozszerzenia. Plikiem konfiguracyjnym
dla SysLinuksa jest <filename>syslinux.cfg</filename>, którego zawarto¶æ
do z³udzenia przypomina format pliku <filename>lilo.conf</filename>, 
nie bêdzie wiêc tu opisywana.
¯eby uruchamiany by³ KS, nale¿y dodaæ liniê ks=floppy do parametrów j±dra
w danym trybie, po czym przekopiowaæ przygotowany wcze¶niej plik 
<filename>ks.cfg</filename> na dyskietkê. 
Instalacja KickStart uruchomi siê wówczas automatycznie.
Dodatkowo, mo¿liwe jest, podobnie jak w przypadku oryginalnej instalacji RH,
wprowadzenie ró¿nych opcji instalacji, np. 
<quote>Instalacja minimalna (wymagane 900MB miejsca na dysku)</quote>, 
<quote>Instalacja pe³na (2.5GB)</quote> albo
<quote>Instalacja sieciowa</quote>.
W tym celu modyfikujemy odpowiednio plik <filename>syslinux.cfg</filename>
oraz pliki zawieraj±ce wy¶wietlane informacje, np. <filename>boot.msg</filename>,
<filename>minimalna.msg</filename>, <filename>pelna.msg</filename>,
<filename>sieciowa.msg</filename>. 
Niezbêdne staje siê te¿ stworzenie kilku plików konfiguracyjnych dla KickStarta,
i ustawianie innej opcji <quote>ks=</quote> w ka¿dym z trybów, 
np. <quote>ks=hd:fd0/ks-minimalna.cfg</quote>, 
<quote>ks=hd:fd0/ks-pelna.cfg</quote> itd.
</para>
<para>
Obraz dyskietki instalacyjnej znajduje siê na CDROM-ach instalacyjnych
RedHata i jest u¿ywany w procesie instalacji. 
Zmodyfikowanej wersji dyskietki mo¿na zatem u¿yæ przy tworzeniu
w³asnej dystrybucji RH.
</para>

<para>
Format pliku <filename>ks.cfg</filename>
</para>
<para>
Plik <filename>ks.cfg</filename> zawiera odpowiedzi na pytania (niekoniecznie
wszystkie), które s± normalnie zadawane w procesie instalacji. Je¿eli pewnej
odpowiedzi nie ma w pliku, u¿ytkownik zostanie o to zapytany w trakcie instalacji.
Poniewa¿ pewne ustawienia s± stosowane zawsze przy instalacji RH dla potrzeb 
SZARP-a, np. wybór jêzyka, strefy czasowej, firewalla, has³o dla roota, bootloader, 
i inne (por. <xref linkend="linux-instalacja">), 
<filename>ks.cfg</filename> z tym przypadku bêdzie zawiera³ odpowiedzi na te pytania.
Na inne (np. numer IP hosta) u¿ytkownik bêdzie musia³ odpowiedzieæ samemu
podczas instalacji.
</para>
<para>
Format pliku <filename>ks.cfg</filename> ró¿ni siê pomiêdzy wersjami 6.x i 7.x
RedHata. Ró¿nice s± wprawdzie niewielkie i du¿y podzbiór komend jest wspólny
dla obu wersji, ale nale¿y byæ ¶wiadomym tego przy korzystaniu z istniej±cych
plików <filename>ks.cfg</filename> oraz dokumentacji do systemu KS.
Nale¿y równie¿ pamiêtaæ o tym, ¿e w RH6.2 komendy KS mia³y znacznie mniej 
parametrów (np. konfiguruj±c X Window System w KS z RH6.2 nie mo¿na by³o ustawiæ 
rozdzielczo¶ci, podczas gdy w RH7.3 mo¿na ustawiæ nie tylko rozdzielczo¶æ ale
i g³êbiê kolorów).
</para>

<para>
Automatyczn± konfiguracjê w <filename>ks.cfg</filename> dla RH 7.3
niektórych z opcji przedstawiono poni¿ej;
ustawiany jest tu jêzyk instalacji (angielski - en_US), wsparcie i 
ustawienie jako domy¶lnego jêzyka polskiego, ustawienia klawiatury, myszy,
has³a <quote>na roota</quote>, opcji firewalla (otwarcie 3-ch portów),
w³±czenie shadowingu dla hase³, ustawienie strefy czasowej oraz ¿±danie
zainstalowania bootloadera (GRUB-a):

<programlisting>
install
lang en_US
langsupport --default pl_PL en_US.iso885915 pl_PL
keyboard us
mouse generic3ps/2 --device psaux
rootpw --iscrypted $1$Ë0ÅÑÜIÅa$hmRXwbpzFytxg0bU/0TML/
firewall --medium --port smtp:tcp --port http:tcp --port ssh:tcp
authconfig --enableshadow --enablemd5
timezone --utc Europe/Warsaw
bootloader
</programlisting>
</para>

<para>
Je¿eli konfigurujemy np. 20 hostów z identyczn± kart± graficzn± 
(i z podobnym monitorem) to mo¿emy
automatycznie skonfigurowaæ te¿ iksy, jak poni¿ej:

<programlisting>
xconfig --card "RIVA128" --videoram 4096 --hsync 31.5-48.5 --vsync 50-70 --resolution 1024x768 --depth 16 --startxonboot 
</programlisting>

Pominiêcie symbolu karty graficznej (lub/i rozmiaru RAM-u na karcie) spowoduje,
¿e system spróbuje automatycznie j± wykryæ i, je¶li mu siê powiedzie, u¿ytkownik
nie zostanie zapytany o kartê.

<programlisting>
xconfig --hsync 31.5-48.5 --vsync 50-70 --resolution 1024x768 --depth 16 --startxonboot 
</programlisting>
</para>

<para>
Mo¿liwe jest te¿ automatyczne partycjonowanie dysku.
Poni¿ej pokazano partycjonowanie dysku wg nastêpuj±cej zasady:
<itemizedlist>
<listitem><para> 200MB dla dosa </para></listitem>
<listitem><para> RAMx2 (warto¶æ rekomendowana) dla swapa </para></listitem>
<listitem><para> reszta - <filename>/</filename> dla Linuksa</para></listitem>
</itemizedlist>
Przed dodaniem jakiejkolwiek partycji wyrzucone bêd± z dysku wszystkie 
istniej±ce dotychczas partycje (<filename>clearpart --all</filename>):

<programlisting>
clearpart --all
part /mnt/dos --fstype vfat --size 200
part swap --recommended
part / --fstype ext3 --size 10000 --grow
</programlisting>
</para>

<para>
KickStart pozwala równie¿ okre¶liæ pakiety oraz 
modu³y (zbiory pakietów, poprzedzone znakiem <quote>@</quote>) do 
zainstalowania, np.:
<programlisting>
%packages
@ Printing Support
@ Classic X Window System
@ X Window System
@ KDE
@ Network Support
@ Router / Firewall
@ Authoring and Publishing
@ Emacs
@ Utilities
@ Software Development
@ Kernel Development
szarp
codebase
codebase-devel
</programlisting>
 
lub po prostu:

<programlisting>
%packages
@ Everything
</programlisting>
</para>

<para>
Mo¿liwe jest tak¿e umieszczenie w³asnych skryptów i komend 
po zainstalowaniu wszystkiego (np. w celu stworzenia katalogów,
modyfikacji konfiguracji):
<programlisting>
%post
echo "nameserver 192.168.1.1" &gt; /etc/resolv.conf
mkdir /usr/work
</programlisting>
</para>

<para>
W pliku konfiguracyjnym KS mo¿liwa jest te¿ konfiguracja sieci 
oraz przeprowadzenie ca³ej instalacji przez sieæ.
Wówczas instalacja RH wygl±daæ mo¿e tak:
<itemizedlist>
<listitem><para> 
Wk³adam dyskietkê (ze skonfigurowanym KS-em) do stacji. 
</para> </listitem>
<listitem><para> 
Uruchamiam komputer tak, ¿eby wystartowa³ z dyskietki.
</para> </listitem>
<listitem><para> 
Gdy ju¿ instalacja wystartuje zwykle mamy mo¿liwo¶æ 
wyboru ¼ród³a pakietów do zainstalowania (lokalny CD-ROM,
dysk twardy, NFS, FTP, HTTP). W przypadku opisywanym tu
wybieramy opcjê: lokalny CD-ROM.
</para> </listitem>
</itemizedlist>

Najlepszym rozwi±zaniem (minimalizacja ruchu w sieci a zarazem dostêp
do najnowszych wersji pakietów) jest instalacja hybrydowa, 
np. ca³o¶æ systemu instalowana 
jest z p³ytek, natomiast reszta (najnowsze biblioteki motifa, SZARP, 
niestandardowe pakiety) mog± byæ zainstalowane przez sieæ.  
Jest to mo¿liwe m.in. dziêki opcjom programu <command>rpm</command>,
którego wywo³anie mo¿na umie¶ciæ w sekcji <filename>%post</filename>
w pliku konfiguracyjnym KS w formie jak ni¿ej:

<programlisting>
rpm -i ftp://user:password@host:/path/packet.rpm
</programlisting>
</para>

<para>
Po ka¿dej instalacji RedHata w katalogu <filename>/root</filename> generowany 
jest plik <filename>anaconda-ks.cfg</filename> z konfiguracj±, wg której  
przebiega³a instalacja. Plik ten mo¿e pos³u¿yæ za wzorzec do 
tworzenia w³asnych plików konfiguracyjnych <filename>ks.cfg</filename>.
</para>

<para>
Przyk³adowy plik konfiguracyjny <filename>ks.cfg</filename> dla RH6.2 
przedstawiono poni¿ej:
<programlisting>
install
lang en_US
keyboard us
mouse generic3ps/2 --device psaux
auth --useshadow --enablemd5
rootpw --iscrypted $1$Ë0ÅÑÜIÅa$hmRXwbpzFytxg0bU/0TML/
timezone --utc Europe/Warsaw
lilo --location mbr
# W nie ma polecenia booloader, jest tylko lilo
xconfig --hsync 31.5-48.5 --vsync 50-70 --startxonboot 
# Nie ma mo¿liwosci ustawienia typu i systemu plików dla partycji
clearpart --all
part /mnt/dos --size 200
part swap --size 200
part /  --size 1000 --grow
network --bootproto static --ip 192.168.1.111 --netmask 255.255.255.0

%packages
# Nie ma opcji @ Everything
@ Printer Support
@ X Window System
@ Mail/WWW/News Tools
@ DOS/Windows Connectivity
@ Utilities
@ Graphics Manipulation
@ Multimedia Support
@ Networked Workstation
@ Dialup Workstation
@ Authoring/Publishing
@ Emacs
@ Development
@ Kernel Development
@ Workstation Common
@ GNOME
@ KDE
@ Network Server
@ News Server
@ NFS Server
@ SMB (Samba) Server
@ Anonymous FTP Server
@ Web Server
@ DNS Name Server
@ Postgres (SQL) Server
@ Network Management Workstation
%post
mkdir /usr/work
/usr/sbin/useradd palacz
chfn -f '' palacz
/usr/bin/passwd -d palacz
</programlisting>

</para>

<para>
Uwaga! Plików <filename>ks.cfg</filename> nie powinno siê pisaæ rêcznie, nale¿y
raczej wykorzystaæ istniej±cy ju¿ plik <filename>anaconda-ks.cfg</filename> lub RedHatowe
narzêdzie graficzne pod nazw± <command>ksconfig</command>, 
które s³u¿y w³a¶nie do konfiguracji i generowania plików <filename>ks.cfg</filename>. 
</para>
</section> <!-- kickstart -->

<section id="anaconda">
<title>Rekonfiguracja RedHat'a - <command>Anaconda</></title>
<para>
RedHat Linux w trakcie instalacji u¿ywa programu o nazwie <command>anaconda</> 
do skonfigurowania systemu, ustalenia zale¿no¶ci miêdzy pakietami i grupami
pakietów rpm oraz do zrêcznego poprowadzenia u¿ytkownika przez trudy 
instalacji. ¯eby uruchomiæ anacondê ju¿ na zainstalowanym systemie nale¿y 
wpisaæ w shellu
<programlisting>
anaconda --reconfig
</programlisting>
W ten sposób mo¿emy powtórnie ustawiæ rzeczy takie jak: klawiatura, jêzyk,
strefa czasowa i ustawienia zegara systemowego, ustawienia sieci, has³o roota,
parametry autoryzacji (shadow, MD5) oraz NIS. Niestety nie da siê w ten sposób ustawiæ fontu dla konsoli.
</para>
<para> UWAGA! Dla bezpieczeñstwa lepiej uruchamiaæ anakondê w 3-cim runlevelu
(bez X-ów). I w ogóle dla bezpieczeñstwa lepiej tego programu nie uruchamiaæ w ogóle.
</para>
</section> <!-- anaconda -->

</section> <!-- redhat-install -->

<section id="linux-debian-instalacja">
<title>Instalacja systemu Debian GNU/Linux</title>

<para>
Opis ten dotyczy instalacji systemu Debian GNU/Linux. 
W sieci mo¿na spotkaæ du¿o innych opisów, np. 
<ulink url="http://www.togaware.com/linux/survivor">
Debian GNU/Linux. Desktop Survival Guide</ulink> autorstwa
Grahama Wiliamsa, które s± bardziej wyczerpuj±ce i kompletne.
</para>
<para>
Instrukcja z niniejszego rozdzia³u dotyczy 
specyficznej dystrybucji systemu Debian, przygotowanej przez
firmê Praterm. Nasza dystrybucja mie¶ci siê na jednej p³ycie CD, 
jako bazê wykorzystujemy najnowsze dystrybucje oficjalne systemu. 
Przebieg instalacji jest podobny do przebiegu instalacji
zwyk³ego systemu Debian (g³ówn± ró¿nic± jest ilo¶æ pakietów 
do zainstalowania i skonfigurowania).
</para>

<para>
¯eby zainstalowaæ system Debian z p³yty instalacyjnej, komputer
musi wspieraæ uruchamianie systemu operacyjnego poprzez urz±dzenie CD
(tzw. bootable CD-ROM). Co robimy, krok po kroku:

<itemizedlist>

<listitem><para>
Wk³adamy p³ytkê instalacyjn± do napêdu CD-ROM i uruchamiamy komputer.
</para></listitem>

<listitem><para>
Na ekranie powitalnym <quote>Welcome to Debian GNU/Linux</quote> 
naciskamy ENTER. Uruchomiony zostanie wówczas program instalacyjny Debiana(graficzny instalator). Je¶li z jakiego¶ powodu nie uda nam siê zainstalowaæ przy pomocy tego instalatora mo¿emy u¿yæ starego poprzez wpisanie na ekranie powitalnym "install".
</para>
<para>
Program instalacyjny charakteryzuje siê m.in. mo¿liwo¶ci± powrotu do dowolnego 
poprzedniego kroku instalacji bez przechodzenia przez kroki po¶rednie: 
na przyk³ad mo¿na powróciæ do czê¶ci instalowania j±dra i sterowników, 
nastêpnie dodania potrzebnego sterownika (powiedzmy, 
karty sieciowej) i kontynuowania instalacji od momentu, w którym
zosta³a ona przerwana.
</para></listitem>

<!--<listitem><para>
Pierwszym etapem jest wybór jêzyka. Wyszukujemy z listy Polski(Polish) i naciskamy enter.
</para></listitem>
-->
<listitem><para>
Pierwszym etapem jest skonfigurowanie sieci. Je¶li nie mamy w sieci DHCP, to powinni¶my wcze¶niej przygotowaæ sobie te ustawienia np. poprzez kontakt z osob± kompetentn± w tej sprawie. Je¶li mimo to nie znamy ustawieñ, mo¿emy jako adres wpisaæ np. 192.168.1.181, maska 255.255.255.0, reszta obojêtna, mo¿emy naciskaæ enter uznaj±c domy¶lne ustawienia za poprawne. 
</para></listitem>

<listitem><para>
Nastêpnie instalator zapyta nas o nazwê komputera. Mo¿e to byæ np. debian, praca, dom itp. 
Po tym pytaniu zostaniemy zapytani o nazwê domeny, je¶li nie znamy naciskamy enter.
</para></listitem>
<!--
<listitem><para>
WA¯NE! Instalator zapyta nas o serwer lustrzany z archiwum Debiana. Wybieramy <quote>WSTECZ</quote>, a nastepnie <quote>Wykryj dyski</quote>.
</para></listitem>
-->
<listitem><para>
Nastêpny etapem to podzia³ dysku na partycje (okno: <quote>Partycjonuj Dyski</quote>).
</para>
<para>
Najpierw wybieramy sposób partycjonowania. Mamy tu dwie mo¿liwo¶ci:
<itemizedlist>

<listitem><para>
<quote>Wyczy¶æ ca³y dysk</quote> - ta opcja usunie z dysku wszystkie 
partycje a nastêpnie
zaproponuje podzia³ na partycje wg. jednego z kilku planów (<quote>Wszystkie pliki
na jednej partycji</quote>, <quote>Osobna partycja na katalogi domowe</quote>, 
<quote>System wielou¿ytkownikowy</quote>). Tê opcjê mo¿emy wybraæ
w sytuacji, gdy instalujemy system na nowym dysku (nie bêdzie trzeba wówczas 
dzieliæ rêcznie dysku na partycje) lub 
gdy chcemy skasowaæ wszystkie istniej±ce systemy operacyjne na dysku.
Do¶wiadczeni u¿ytkownicy z tej opcji raczej nie korzystaj±, lecz wybieraj± (opisan±
w kolejnym punkcie) opcjê <quote>Modyfikuj rêcznie tablicê partycji</quote>.
</para>
<para>
Opcja <quote>Wyczy¶æ ca³y dysk</quote> jest dobra natomiast dla u¿ytkowników niedo¶wiadczonych
w partycjonowaniu dysków. Ponadto, je¶li nie mamy do¶wiadczenia w dzieleniu dysku na partycje 
(albo trudno nam oszacowaæ przysz³e potrzeby dyskowe), to powinni¶my wybraæ mo¿liwo¶æ
<quote>Wszystkie pliki na jednej partycji</quote>. 
Na dysku powstanie wówczas jedna du¿a partycja do zamontowania jako <quote>/</quote> 
(ang. <emphasis>root partition</emphasis>) oraz druga, mniejsza, dla przestrzeni wymiany 
(ang. <emphasis>swap space</emphasis>).
Ten podzia³ potwierdzamy wybieraj±c opcjê
<quote>Zakoñcz partycjonowanie i zapisz zmiany na dysku</quote>.
</para>
</listitem>

<listitem><para>
<quote>Modyfikuj rêcznie tablicê partycji</quote> - wybieramy je¶li chcemy ustawiæ 
partycje rêcznie (opcja zalecana).
Po uruchomieniu tej opcji wy¶wietli siê nam okno z wieloma interesuj±cymi mo¿liwo¶ciami
(m.in. 
	konfiguracj± RAID-a programowego, 
	konfiguracj± menad¿era wolumenów logicznych, 
	partycjonowanie z przewodnikiem
).

Z wiêkszo¶ci opcji bêdziemy korzystaæ tylko 
w szczególnych okoliczno¶ciach 
(np. gdy odpowiednio: 
	chcemy zainstalowaæ system na macierzy RAID;
	skorzystaæ z partycji <quote>wirtualnych</quote>, tj. stworzyæ/zmodyfikowaæ 
		partycje <quote>wy¿szego rzêdu</quote> zbudowane ze 
		<quote>zwyk³ych</quote> partycji; 
	dostaæ wiêcej podpowiedzi od systemu).
</para>
<para>
W najczêstszym przypadku powinni¶my przesun±æ kursor do listy partycji
(rozpoczynaj±cej siê od linii oznaczaj±cej ca³y dysk),
w której wy¶wietlone s± równie¿ fragmenty wolnej przestrzeni 
na dysku, i wybraæ jedn± z mo¿liwo¶ci. 
</para>
<para>
Zwykle musimy stworzyæ dwie partycje: jedn± du¿± partycjê dla g³ównego
systemu 
plików i jedn± partycjê o wielko¶ci co najmniej 2xRAM (512 MB jest OK) na przestrzeñ wymiany 
(ang. <emphasis>swap space</emphasis>). Natomiast partycja dla systemu plików powinna
mieæ co najmniej 5GB. (Uwaga dla zaawansowanych u¿ytkowników. Mo¿emy stworzyæ
wiele partycji dla Linuksa o rozmiarach co najmniej:
<filename>/</filename> - 2GB
<filename>/home</filename> - 2 GB
<filename>/opt</filename> - 3 GB).
</para>

<para>
Je¿eli wybrali¶my partycjê ju¿ stworzon±, to przechodzimy do okna ustawiania partycji
(opisanego 2 akapity dalej).
</para>
<para>
Je¿eli natomiast wybrali¶my woln± przestrzeñ na dysku, system zapyta nas czy chcemy 
utworzyæ now± partycjê, czy pozwoliæ systemowi na automatyczne partycjonowanie 
przestrzeni. 
Wybieramy opcjê <quote>Utwórz now± partycjê</quote>. Bêdziemy mogli tu ustawiæ 
wielko¶æ partycji i jej rodzaj (Podstawowa/Logiczna). Nastêpnie zostanie wy¶wietlone 
okienko z mo¿liwo¶ci± ustawienia partycji (poni¿ej). 
</para>

<para>
Okno ustawiania partycji. Mamy tu wyboru kilka opcji (uwaga! nie 
wszystkie opcje s± widoczne od pocz±tku; kolejne opcje bêd± siê 
pojawiaæ w miarê uzupe³niania danych w kolejnych wierszach):

<itemizedlist>
  <listitem><para>
  <quote>Sposób u¿ycia</quote>, a w nim: formatowanie partycji (dla nowych partycji 
  jest to czynno¶æ domy¶lna), u¿ycie partycji jako przestrzeni wymiany (czyli zamiana 
  partycji na tzw. <emphasis>swap disk</emphasis>), nie u¿ywanie partycji (je¿eli mamy
  tam jakie¶ dane, których nie chcemy straciæ) i inne.
  Je¿eli chcemy na partycji zainstalowaæ system, wybieramy opcjê <quote>Formatuj Partycjê</quote>.
  </para></listitem>
 
  <listitem><para>
  <quote>System plików</quote> - tu wybieramy system plików dla partycji
  (do wyboru mamy ext2, ext3, ReiserFS, JFS, XFS, FAT16 i FAT32). Zalecane jest wybranie
  systemu z ksiêgowaniem: ReiserFS. 
  </para></listitem>

  <listitem><para>
  <quote>Punkt montowania</quote> - czyli miejsce, gdzie w drzewie katalogów pojawi pojawi
  siê dana partycja (gdy mamy tylko jedn± partycjê to musi byæ katalog g³ówny, czyli <quote>/</quote>).
  </para></listitem>
  
  <listitem><para>
  <quote>Opcje montowania</quote> - dodatkowe opcje (nie zmieniamy - <quote>defaults</quote> jest ok).
  </para></listitem>

  <listitem><para>
		  <quote>Flaga uruchomieniowa</quote> - przewa¿nie nie zmieniamy. Uwaga! Na nowszych (jest koniec 2007 roku) p³ytach Intela trzeba ustawiæ flagê uruchomieniow± przynajmniej dla partycji z katalogiem g³ównym <quote>/</quote>. W innym przypadku po restarcie system nie wstanie i pojawi siê komunikat, ¿e system nie ma sk±d siê uruchomiæ. Mo¿na wtedy (np. po odpaleniu systemu z p³yty) narzêdziem <emphasis>cfdisk</emphasis> zmieniæ flagê uruchomieniow± partycji. Innym wyj¶ciem jest instalacja wszystkiego od nowa.
  </para></listitem>

  <listitem><para>
  <quote>Rozmiar</quote> - nie zmieniamy.
  </para></listitem>

</itemizedlist>

Po ustawieniu w³a¶ciwo¶ci danej partycji zatwierdzamy zmiany wybieraj±c opcjê <quote>Zakoñczono ustawianie
partycji</quote>. Czynno¶æ powtarzamy dla ka¿dej partycji, któr± chcemy dostosowaæ do w³asnym potrzeb 
(najczê¶ciej wystarczy jednak tylko jedna partycja).
</para>

<para>
Je¿eli zakoñczyli¶my modyfikacjê partycji, wybieramy opcjê 
<quote>Zakoñcz partycjonowanie i zapisz zmiany na dysku</quote>.
</para>

</listitem>

</itemizedlist>

Je¿eli dokonywali¶my jaki¶ zmian w ustawieniach
partycji, konfigurator dopyta nas czy na pewno chcemy je wprowadziæ (potwierdzamy).
W ten sposób zakoñczy siê operacja partycjonowania dysku.
</para></listitem>

<listitem><para>
(teraz system automatycznie przepartycjonuje dysk wg. wskazówek od u¿ytkownika
udzielonych w poprzednim kroku i przekopiuje podstawowe pliki na dysk)
</para></listitem>

<listitem><para>
Opcjonalnie Instalator zapyta nas, czy zegar komputera ma byæ ustawiony na UTC. Je¶li na komputerze jest tylko Linux, powinni¶my wybraæ odpowied¼ <quote>Tak (Yes)</quote>. Je¶li mamy zainstalowany jaki¶ inny system, np. Windows, wybieramy <quote>Nie (No)</quote>.
</para></listitem>

<listitem><para>
W oknie (<quote>Ustaw u¿ytkowników i has³a</quote>) ustawiamy has³o dla administratora
systemu (root).
</para></listitem>

<listitem><para>
W kolejnym oknie zostaniemy poproszeni wpisanie pe³nej nazwy u¿ytkownika, 
nastêpnie jego nazwy w systemie (tzw. <emphasis>login</emphasis>) oraz
has³a dla tego u¿ytkownika (nazwa dowolna).
</para></listitem>

<listitem><para>
Podczas instalacji systemu podstawowego zostaniemy zapytani o docelowe j±dra w systemie. Z listy wybieramy j±dro odpowiednie dla naszego procesora (intel - 686, amd - k6) np. linux-image-2.6.16-1-686.
</para></listitem>

<listitem><para>
W trakcie instalacji bêdziemy musieli wybraæ j±dro. Je¶li mamy intela, wybierzmy 686, je¶li amd k7, w innym przypadku sugerowany jest wybór 486.
</para></listitem>

<listitem><para>
Po instalacji systemu podstawowego instalator poinformuje nas ¿e nie móg³ po³±czyæ siê z serwerem lustrzanym. Wybieramy <quote>Ignoruj</quote> i naciskamy enter. Instalator zatrzyma siê na d³u¿sz± chwilê na przeszukiwaniu repozytorium z poprawkami bezpieczeñstwa i poinformuje nas ¿e nie mo¿e uzyskaæ do niego dostêpu. Naciskamy dalej.
</para></listitem>

<listitem><para>
W oknie <quote>Wybór oprogramowania</quote> ODZNACZAMY wszystkie opcje, tak by nic nie by³o instalowane. Wszystkim zajmie siê pó¼niej instalator przygotowany przez pracowników Praterm S.A.</para></listitem>

<listitem><para>
W oknie <quote>Instaluj program uruchomieniowy GRUB na dysku twardym</quote> potwierdzamy, 
¿e chcemy zainstalowaæ GRUB-a w g³ównym rekordzie uruchomieniowym. (System Debian mo¿e
poinformowaæ nas równie¿ o wykrytych istniej±cych systemach operacyjnych, które 
zostan± dodane do menu GRUB-a).
</para></listitem>


<listitem><para>
Po zainstalowaniu programu GRUB, program instalacyjny wy¶wietli okno 
<quote>Zakoñcz instalacjê</quote>, (potwierdzamy) i uruchomi system z 
nowo zainstalowanej dystrybucji Debiana.</para>
<para>
<emphasis>
Uwaga! Nale¿y pamiêtaæ o wyci±gniêciu p³yty instalacyjnej: system powinien
siê uruchomiæ z dysku nie z p³yty!
</emphasis>
</para></listitem>

<listitem><para>
Pierwszym elementem uruchamianym w nowo instalowanym systemie jest GRUB. 
Poniewa¿, jak wspomniano, w systemie Debian GRUB stara siê automatycznie wykryæ inne systemy 
operacyjne (dodaj±c je do listy), w menu GRUB-a powinni¶my
zobaczyæ wszystkie lub wiêkszo¶æ systemów zainstalowanych na komputerze.
System Debian, który instalujemy aktualnie, bêdzie umieszczony na pierwszej
pozycji (wybór domy¶lny).
</para></listitem>

<listitem><para>
Po uruchomieniu siê nowego systemu, logujemy siê jako root i wydajemy polecenie:
<programlisting>
deb4szarp-installer
</programlisting>

</para></listitem>

<listitem><para>
(opcjonalnie) Pojawi siê pro¶ba o w³o¿enie naszej p³yty instalacyjnej do napêdu cdrom.
</para></listitem>

<listitem><para>
Mo¿e pojawiæ siê okno konfiguracji pakietu locales. Nasz wybór to pl_PL.
</para></listitem>

<listitem><para>
W oknie <quote>Wybierz profil</quote> mamy nastêpuj±cy wybór:
<itemizedlist>
<listitem><para>
<command>Standardowy</command> - instaluje wszystkie pakiety potrzebne do kompilacji SZARP'a, oraz X'y i KDE.
</para></listitem>
<listitem><para>
<command>Minimalny</command> - instaluje tylko pakiety potrzebne do kompilacji SZARP'a, nie ma X'ów, ani nic zbêdnego.
</para></listitem>
<listitem><para>
<command>Pe³ny</command> - instaluje to, co w profilu Standardowym + inne przydatne rzeczy nie tylko na ciep³owni, np. Thunderbird, OpenOffice, mtr, itd...
</para></listitem>
</itemizedlist>
</para></listitem>

<listitem><para>
W oknie <quote>Dodatki</quote> wybieramy elementy mog±ce siê przydaæ w danym przypadku:
<itemizedlist>
<listitem><para>
<command>cups</command> - je¶li bêdziemy chcieli korzystaæ z drukarek, 
</para></listitem>
<listitem><para>
<command>isdn</command> - w przypadku u¿ywania ISDN-a do ³±czenia siê z Internetem,
</para></listitem>
<listitem><para>
<command>samba</command> - je¶li chcieliby¶my siê dzieliæ zasobami dyskowymi z komputerami z systemem Windows,
</para></listitem>
<listitem><para>
<command>apt-proxy</command> - je¶li chcieliby¶my zainstalowaæ proxy pakietów Debian'a,
</para></listitem>
<listitem><para>

<command>edge-gprs</command> - je¶li bêdziemy u¿ywaæ modemów Sony Ericsson GC 75/75e/85/89 do komunikacji ze ¶wiatem zewnêtrznym,
</para></listitem>
<listitem><para>
<command>openoffice</command> - je¶li chcieliby¶my zainstalowaæ pakiet biurowy OpenOffice.org 2.0.
</para></listitem>
</itemizedlist>

</para></listitem>


<!--
<listitem><para>
W oknie <quote>Ethernet Networking Configuration</quote> na pytanie <quote>Manage network
configuration files with debconf?</quote> odpowiadamy <quote>Tak (Yes)</quote>.
</para>
<para>W kolejnym kroku konfigurator zapyta nas o to, czy chcemy skonfigurowaæ
wykryty interfejs (je¶li jaki¶ zosta³ wykryty), zwykle jest to interfejs eth0.
Zostaniemy zapytani czy nasza karta sieciowa to urz±dzenie wymienne 
(<quote>Removable device</quote>) - na komputerze stacjonarnym odpowiadamy <quote>Nie</quote>.
Teraz zostaniemy zapytani o to, czy chcemy u¿ywaæ protoko³u DHCP (<quote>Automatically
configure device with DHCP?</quote>). Tu odpowiadamy w zale¿no¶ci od konfiguracji sieci 
i przeznaczenia systemu (je¿eli przygotowujemy serwer SZARP-a, to nie powinni¶my stosowaæ
dynamicznych adresów IP, lecz przydzielaæ numer IP na sta³e).
Opisana poni¿ej procedura dotyczy rêcznego ustawiania konfiguracji sieci (bez DHCP),
na pytanie o DHCP odpowiadamy wiêc <quote>Nie</quote>.
Zostaniemy poproszeni o numer IP urz±dzenia
(<quote>Device's IP address</quote>), adres bramki (<quote>IP address of the device's gateway router</quote>),
maskê podsieci (<quote>Device's subnet mask</quote>), adres rozg³oszeniowy (<quote>Device's
broadcast address</quote>), serwery nazw - czyli tzw. DNS-y (<quote>IP address of your system's 
domain name servers</quote>). <emphasis>Uwaga! Je¿eli konfigurujemy hosta tylko do pracy w sieci lokalnej
(bez dostêpu do Internetu), to pola adresu bramki i adresu serwerów DNS powinni¶my pozostawiæ puste.</emphasis>
</para></listitem>

<listitem><para>
Na polecenie wprowadzenia nazwy komputera wpisujemy odpowiedni± nazwê,
 a w kolejnym oknie nazwê domeny 
(np. <quote>ciep</quote>). Je¶li nie znamy nazwy domeny, wpisujemy <quote>.</quote>.

</para></listitem>

-->


<listitem><para>
W oknie <quote>Konfigurowanie Exim v4</quote> wybieramy 
<quote>o¶rodek internetowy</quote> jako typ konfiguracji poczty.
Jako odbiorcê poczty ustawiamy u¿ytkownika <command>root</command>.
</para></listitem>

<listitem><para>
Gdy zostaniemy zapytani o rozdzielczo¶æ naszego monitora, powinni¶my zaznaczyæ optymaln± dla posiadanego przez nas urz±dzenia (np. 1024x768).
</para></listitem>

<listitem><para>
Gdy zostaniemy zapytani o mysz i port do którego jest pod³±czona mo¿emy wybraæ /dev/input/mice.
</para></listitem>


<listitem><para>
(Uwaga! To pytanie pojawia siê tylko wtedy, gdy w poprzednim punkcie wybrali¶my element <quote>cups</quote>).
W oknie <quote>Foomatic Printer Filter Configuration</quote> wybieramy opcjê <quote>cups</quote>.
</para></listitem>


 
<listitem><para>
(opcjonalnie) To pytanie pojawia siê tylko wtedy, gdy wybrali¶my wcze¶niej opcjê ISDN.
Na pytanie <quote>Does firmware need to be loaded?</quote> odpowiadamy <quote>none</quote>.
</para></listitem>

<listitem><para>
(opcjonalnie) Poni¿sze pytania dotycz± konfiguracji ipppd i pojawiaj± siê tylko wtedy, gdy 
wybrali¶my wcze¶niej opcjê ISDN.
Na pytanie <quote>What is your ISP phone number?</quote> zostawiamy opcjê <quote>manual</quote>.
Nastêpnie w pytaniu o kraj wypieramy opcjê <quote>other</quote> (poniewa¿ Polski nie ma
na li¶cie). W kolejnym oknie wpisujemy skrót dla Polski (<quote>PL</quote>). Pytanie
<quote>What is your area code?</quote> pozostawiamy bez odpowiedzi. Na kolejne pytanie odpowiadamy
domy¶lnie <quote>quit</quote>.
</para></listitem>

<listitem><para>
(W kolejnym oknie potwierdzamy przyjêcie do wiadomo¶ci, ¿e libsensors3 nie jest 
aktualnie w pe³ni funkcjonalne).
</para></listitem>

<listitem><para>
(opcjonalne) Je¿eli wybrali¶my w jednym z poprzednich kroków instalacjê Samby, to zostaniemy
zapytani o kilka rzeczy:
<itemizedlist>
<listitem><para>
System zapyta nas o nazwê grupy roboczej lub domeny. Wpisujemy i potwierdzamy (mo¿e byæ nazwa pusta).
</para></listitem>

<listitem><para>
Na pytanie: <quote>Use password encryption?</quote> odpowiadamy <quote>Yes</quote>.
</para></listitem>

<listitem><para>
Na kolejne pytanie: <quote>Modify <filename>smb.conf</filename> to use WINS settings from DHCP?</quote>
odpowiadamy <quote>No</quote>.
</para></listitem>

<listitem><para>
Na pytanie <quote>How do you want to run Samba?</quote> wybieramy opcjê <quote>daemons</quote>.
</para></listitem>

<listitem><para>
Na pytanie <quote>Create samba password database, <filename>/var/lib/samba/passdb.tdb</filename>?</quote>
odpowiadamy <quote>No</quote>.
</para></listitem>
</itemizedlist>

<emphasis>
(Uwaga! Powy¿sze ustawienia mo¿emy zmodyfikowaæ w zale¿no¶ci od
potrzeb - np. szyfrowaæ bez has³a je¶li jest taka potrzeba). 
</emphasis>
</para></listitem>


<listitem><para>
(opcjonalne) Je¿eli w jednym z poprzednich kroków wybrali¶my instalacjê systemu cups, to 
teraz zostaniemy zapytani o to, czy zainstalowaæ interfejsy zgodno¶ci z drukowaniem BSD
(<quote>BSD lpd compatibility server</quote>). Odpowiadamy przecz±co.
</para></listitem>

<listitem><para>
Teraz powinna siê rozpocz±æ instalacja wszystkich skonfigurowanych pakietów. 
</para>
<para>
<emphasis>Uwaga! Poniewa¿ w niektórych przypadkach robione jest przeinstalowanie
istniej±cych pakietów, system mo¿e wykryæ pewne konflikty i zaproponowaæ 
przerwanie instalacji (<quote>Do you want to stop now?</quote>). Odpowiadamy
<quote>N</quote>, bo nie chcemy przerywaæ instalacji</emphasis>.
</para>

</listitem>
<listitem><para>
<emphasis>
Uwaga(2)! Dla niektórych pakietów nie mo¿na sprawdziæ ich podpisów cyfrowych 
(ostrze¿enie <quote>(...) cannot be securely authenticated</quote>). Pojawia siê
wówczas propozycja przerwania instalacji. Nie nale¿y tego robiæ - na pytanie 
<quote>Continue?</quote> odpowiadamy: <quote>Y</quote>.
</emphasis>
</para></listitem>


<!-- to-tu -->

</itemizedlist>

</para>
<para>
W ten sposób Debian zosta³ zainstalowany.
</para>
<para>
<emphasis>
Uwaga! Po zainstalowaniu Debiana  
nale¿y uruchomiæ powtórnie system.
Po uruchomieniu system bêdzie dzia³a³ na nowym j±drze.
</emphasis>
</para>

<section id="debian-install-contrib">
<title>Dodatki i problemy podczas instalacji</title>

<para>
Poni¿ej przedstawiono gar¶æ informacji dotycz±cych problemów, które mog± siê
pojawiæ po zainstalowaniu systemu.

<section id="x-windows-configure">
<title>Konfiguracja X-Windows</title>

<para>
Mo¿e siê zdarzyæ, ¿e w czasie instalacji ¼le skonfigurowali¶my X-Windows 
(np. wybrali¶my opcjê automatycznego wykrywania ¶rodowiska, 
która siê programowi instaluj±cemu nie uda³a) i iksy nie wstaj±  po uruchomieniu systemu.
Nale¿y siê wówczas zalogowaæ w trybie tekstowym i wydaæ z konsoli komendê:
<programlisting>
   dpkg-reconfigure xserver-xorg
</programlisting>
Uruchomiony zostanie konsolowy program konfiguracyjny, który pozwoli nam na wprowadzenie nowych
ustawieñ.
</para>
</section>

<section id="debian-network">
<title>Konfiguracja sieci</title>
<para>
W Debianie nie ma jednego spójnego narzêdzia do
zarz±dzania systemem. Istnieje za to wybór narzêdzi do konfiguracji poszczególnych 
elementów systemu (np. narzêdzie <command>etherconf</command> do konfiguracji sieci lokalnej).

<!-- TODO: dodac opis konfiguracji sieci z etherconfem -->
</para>
<para>
Debiana natomiast jest stosunkowo ³atwo konfigurowaæ rêcznie: 
ustawienia sieci s± w pliku <filename>/etc/network/interfaces</filename>.
Plik ze skonfigurowanymi urz±dzeniami lo i eth0 ma nastêpuj±c± postaæ:
<programlisting>
auto lo eth0

iface lo inet loopback

iface eth0 inet static
        address 192.168.1.166
        netmask 255.255.255.0
        broadcast 192.168.1.255
        gateway 192.168.1.1
</programlisting>
Pierwsza linia mówi które 
interfejsy s± uruchamiane automatycznie przy starcie systemu. Opis ka¿dego 
interfejsu rozpoczyna siê od s³owa <userinput>iface</userinput>. Komenda, co widaæ 
powy¿ej, mo¿e przyjmowaæ ró¿ne parametry w zale¿no¶ci od rodzaju interfejsu.
</para>
<para>
Po wprowadzeniu poprawki w pliku <filename>interfaces</filename> nale¿y uruchomiæ 
ponownie interfejsy sieciowe:
<programlisting>
/etc/init.d/networking restart
</programlisting>
..i sprawdziæ czy interfejsy zosta³y zainicjowane:
<programlisting>
ifconfig
</programlisting>
</para>
<para>
Nale¿y równie¿ skonfigurowaæ listê serwerów DNS. 
Podobnie jak w innych Linuksach,
serwery DNS s± wypisane w pliku <filename>/etc/resolv.conf</filename>. Plik
sk³ada siê z kolejnych wierszy z adresami DNS-ów,
przyk³adowy plik <filename>/etc/resolv.conf</filename> wygl±da zatem nastêpuj±co:
<programlisting>
nameserver 148.81.16.51
nameserver 195.187.245.51
nameserver 194.204.159.1
nameserver 194.204.152.34
</programlisting>
</para>

<para>
Jeszcze innym plikiem jest <filename>/etc/hosts</filename>, który zawiera 
listê statycznych numerów IP i ich nazw (albo tzw. aliasów), np.:
<programlisting>
192.168.1.1	server
192.168.1.10	terminal1
192.168.1.11	terminal2
192.168.1.12	terminal3	kierownik
</programlisting>
Dla ka¿dego numeru IP mo¿na wpisaæ wiêcej ni¿ jedn± nazwê hosta: do hosta
192.168.1.12 mo¿na siê odwo³ywaæ równie dobrze za pomoc± nazwy 
<command>terminal3</command> jak i <command>kierownik</command>.
</para>
</section>

<section id="instalowanie-pakietow-apt">
<title>Instalowanie/upgrade pakietów</title>
<para>
W systemie Debian istnieje wygodne narzêdzie
do zarz±dzania pakietami: <command>apt-get</command>. 
Potrafi automatycznie zlokalizowaæ niezbêdne pakiety w sieci (lub na CD-ROM-ie), 
wykryæ zale¿no¶ci pomiêdzy paczkami i poprawnie zainstalowaæ ¿±dany pakiet. 
¯eby zainstalowaæ pakiet &lt;pakiet&gt;, nale¿y wywo³aæ program nastêpuj±co:
<programlisting>
apt-get install &lt;pakiet&gt;
</programlisting>
Program wyszuka w lokalnej bazie danych indeks paczki a nastêpnie sprawdzi
co jest potrzebne do poprawnego jej zainstalowania. Przed zainstalowaniem poinformuje 
o wielko¶ci ¶ci±ganych z sieci danych i poprosi nas o potwierdzenie. Po ¶ci±gniêciu,
pakiet zostanie automatycznie zainstalowany i skonfigurowany.  
</para>
<para>
Pliki konfiguracyjne programu znajduj± siê w katalogu <filename>/etc/apt</filename> - szczególnie
istotny jest plik <filename>/etc/apt/sources.list</filename>, który zawiera listê wszystkich 
hostów (lub identyfikatorów p³yt CD-ROM),
z których bêd± pobierane paczki. 
Dodawanie do pliku hostów odbywa siê rêcznie, nale¿y do pliku dopisaæ now± liniê, np.:
<programlisting>
deb http://sunsite.icm.edu.pl/pub/Linux/debian sid main contrib non-free
</programlisting>
co oznacza, ¿e paczki <filename>.deb</filename> bêd± ¶ci±gane z sieci za pomoc± 
protoko³u HTTP z adresu: 
<ulink url="http://sunsite.icm.edu.pl/pub/Linux/debian">sunsite.icm.edu.pl/pub/Linux/debian</ulink>.
</para>
<para>
Je¿eli posiadamy p³yty z pakietami Debiana, to nale¿y ka¿d± z takich p³yt dodaæ do listy
za pomoc± komendy <command>apt-cdrom add</command> - program poprosi nas o w³o¿enie p³yty,
stworzy sobie lokalny indeks pakietów i wpisze identyfikator p³yty do pliku 
<filename>/etc/apt/sources/list</filename>.
</para>
<para>
Je¿eli korzystamy z sieci do ¶ci±gania/od¶wie¿ania paczek, to co pewien czas program 
<command>apt-get</command> wymaga od¶wie¿enia danych (na serwerach zmieniaj± siê pakiety,
powstaj± nowe zale¿no¶ci itp). Je¿eli wiêc
komenda z opcj± <quote>install</quote> np. nie znajduje poprawnie zale¿no¶ci pomiêdzy paczkami, 
nale¿y wywo³aæ j± z opcj± <quote>update</quote>:
<programlisting>
apt-get update
</programlisting>
</para>
</section>

<section id="flash-plugin">
<title>Wtyczka Macromedia Flash dla programu Mozilla</title>

<para>
Poniewa¿ wtyczka Macromedia Flash nie jest czê¶ci± programu Mozilla
(Mozilla Firefox), nale¿y j± oddzielnie zainstalowaæ, ¿eby 
na stronach wy¶wietla³y siê programy napisane we Flashu.
W tym celu wywo³ujemy komendê (zak³ada siê, ¿e program 
<command>apt</command> zosta³ ju¿ poprawnie skonfigurowany):
<programlisting>
apt-get install flashplugin-nonfree
</programlisting>
</para>
</section>

<section id="no-pass-auth">
<title>Logowanie siê bez has³a</title>

<para>
W Debianie (ze wzglêdów bezpieczeñstwa) zosta³a zablokowana
mo¿liwo¶æ logowania siê bez has³a. ¯eby j± odblokowaæ, nale¿y
otworzyæ plik <filename>/etc/pam.d/common-auth</filename>
i znale¼æ nastêpuj±c± liniê:
<programlisting>
	auth    required        pam_unix.so 
</programlisting>

i zamieniæ j± na nastêpuj±c±:

<programlisting>
	auth    required        pam_unix.so nullok
</programlisting>

</para>
</section>

<section>
<title>Polska klawiatura w KDE</title>

<para>
(Uwaga! zwykle klawiatura jest poprawnie skonfigurowana 
od razu po zainstalowaniu systemu)
</para>
<para>
W celu skonfigurowania w KDE (3.1) polskiej klawiatury tak, 
¿eby nasze znaczki narodowe otrzymywane przy pomocy
kombinacji ALT-&lt;klawisz&gt;, nale¿y:

<itemizedlist>
<listitem><para>
Otworzyæ <command>Centrum sterowania</command> a tam:
<command>Regionalne i Dostêpno¶æ</command>/<command>Uk³ad klawiatury</command>.
</para></listitem>
<listitem><para>
Zaznaczyæ (na górze): <quote>w³±cz uk³ady klawiatury</quote>.
</para></listitem>
<listitem><para>
W czê¶ci <command>dostêpne uk³ady</command> dodaæ uk³ad <quote>polski</quote>.
</para></listitem>
<listitem><para>
Ustawiæ podstawowy uk³ad <quote>polski</quote> .
</para></listitem>
<listitem><para>
Sprawdziæ, czy na dolnym pasku jest wy¶wietlone wy¶wietlone s³owo 
<quote>pl</quote> - co oznacza, ¿e nasz uk³ad klawiatury zosta³ w³±czony.
</para></listitem>
</itemizedlist>

</para>
</section>

<section id="login-manager">
<title>Konfiguracja Mened¿era logowania</title>
<para>
Mo¿emy jeszcze skonfigurowaæ Debiana tak, ¿eby wy¶wietla³ mi³e przywitanie i automatycznie logowa³ siê na u¿ytkownika palacz. W tym celu nale¿y:
<itemizedlist>
<listitem><para>
Otworzyæ <command>Panel sterowania</command>, nastêpnie wybraæ <command>Administracja systemu</command> i tam <command>Mened¿er logowania</command>.
</para></listitem>
<listitem><para>
W zak³adce <command>Wygl±d</command> zmieniæ <command>Powitanie</command> na np. <quote>Witamy w systemie SZARP 2.2</quote>. Widoczne logo KDE mo¿na zmieniæ na ikonê umieszczon± w pliku <filename>/opt/szarp/resources/documentation/new/common/praterm-logo.png</filename>.
</para></listitem>
<listitem><para>
W zak³adce <command>U¿ytkownicy</command> klikn±æ na <command>obrazki u¿ytkowników</command> i wybraæ np. <filename>default2.png</filename>.
</para></listitem>
<listitem><para>
Na koniec w zak³adce <command>U³atwienia</command> zaznaczyæ <command>W³±cz automatyczne logowanie</command> i wybraæ u¿ytkownika <quote>palacz</quote>.
</para></listitem>
</itemizedlist>
</para>
</section>

<section>
<title>WindowMaker</title>
<para>
Je¿eli instalujemy system <command>WindowMaker</command>, 
to nale¿y pamiêtaæ, ¿eby nazwa menad¿era okien w KDM-ie 
by³a taka sama, jak nazwa programu wykonywalnego (w Debianie: <command>wmaker</command>).
</para>
</section>

<section>
<title>CD-ROM</title>

<para>W systemie Debian CD-ROM jest domy¶lnie montowany w katalogu
<filename>/cdrom</filename> lub w nowszych wersjach (zgodnie z LSB 2.0) w
katalogu <filename>/media/cdrom</filename>,
a nie, jak w przypadku systemu RedHat, w katalogu <filename>/mnt/cdrom</filename>.
</para>
</section>

<section id="update-grub">
<title>GRUB</title>
	<para>W systemie Debian istnieje skrypt o nazwie <command>update-grub</command>,
	który automatycznie wykrywa wszystkie dostêpne j±dra
	Linuksa i odpowiednio konfiguruje plik <filename>/boot/grub/menu.lst</filename>. Niestety,
	nie dodaje on partycji Windowsowych. Je¿eli chcieliby¶my skorzystaæ z tego wygodnego skryptu
	to nale¿y pamiêtaæ, ¿e dodane przez nas rêcznie partycje (Windowsowe) zostan± usuniête przez skrypt
	<command>update-grub</command>, je¶li umie¶cimy je pomiêdzy liniami:
	<programlisting>
	### BEGIN AUTOMAGIC KERNELS LIST
	</programlisting>
	oraz
	<programlisting>
	### END DEBIAN AUTOMAGIC KERNELS LIST
	</programlisting>
	Najlepiej wiêc dodaæ w³asn± sekcjê na koñcu pliku po oznaczeniu:
	<programlisting>
	### END DEBIAN AUTOMAGIC KERNELS LIST
	</programlisting>
	</para>
</section>

<section>
<title>Zarz±dzanie modu³ami j±dra</title>
	<para>W Debianie, podobnie jak w innych Linuksach, konfiguracja 
	i zarz±dzanie modu³ami wykonywane jest za pomoc± programów <command>modprobe</command>
	(³adowanie modu³ów), <command>depmod</command> (tworzenie pliku z zale¿no¶ciami) itp.
	Tradycyjnie, plikiem konfiguracyjnym jest tu <filename>/etc/modules.conf</filename>
	(w powodu pewnych zasz³o¶ci historycznych, czasami nazywanym 
	<filename>/etc/conf.modules</filename>, ale ju¿ rzadko). W pliku tym wypisane s±
	nazwy modu³ów do za³adowania przez system, ich parametry oraz inne mo¿liwe nazwy 
	plików (tzw. aliasy). 
	Dodatkowym plikiem zwi±zanym z modu³ami jest <filename>/etc/modules</filename>, 
	który zawiera listê modu³ów ³adowanych przy starcie systemu (w trakcie dzia³ania nie 
	jest u¿ywany). 
	</para>
	<para>
	Niestety plik <filename>/etc/modules.conf</filename> jest wykorzystywany przez wiele
	ró¿nych programów, pojawiaj± siê wiêc k³opoty wynikaj±ce dodawania doñ przez programy 
	w³asnych wpisów (których ju¿ zwykle nie usuwaj±, a je¶li usuwaj± stosuj± w³asne 
	<quote>magiczne triki</quote>, ¿eby rozpoznaæ to, co same nawpisywa³y).
	Wprowadzono wiêc w Debianie nowy mechanizm polegaj±cy na tym, ¿e oryginalna konfiguracja
	jest umieszczona w wielu oddzielnych plikach w katalogu <filename>/etc/modutils</filename>.
	Nastêpnie plik <filename>/etc/modules.conf</filename> jest generowany przy u¿yciu komendy
	<command>update-modules</command>.
	</para>
	<para>
	Uwaga! W przypadku j±dra w wersji 2.6.x zamiast pliku <filename>/etc/modules.conf</filename>,
	mamy plik <filename>/etc/modprobe.conf</filename> a zamiast katalogu 
	<filename>/etc/modutils/</filename> mamy katalog <filename>/etc/modprobe.d/</filename>.
	</para>
</section>
	
<section id="graphic-card-ProSavage">
<title>Konfiguracja karty graficznej S3 VT835 ProSavage KM266/KL266</title>
<para>
Niektóre modele kart graficznych <emphasis>X-server</emphasis> nie s± poprawnie konfigurowane na etapie
instalacji. Objawia siê to brakiem obrazu w trybie graficznym. Jedn± z takich kart jest:
<programlisting>
VGA compatible controler S3 Inc. VT8375 [ProSavage9 KM266/KL266]
</programlisting>
W celu rêcznej konfiguracji nale¿y prze³±czyæ siê na konsole tekstow±, zalogowaæ
siê na root-a, a nastêpnie wydaæ polecenie:
<programlisting>
dpkg-reconfigure xserver-xfree86
</programlisting>
<para>
W oknie <emphasis>Select the desired X server driver</emphasis> nale¿y wybraæ
<emphasis>vesa</emphasis>. 
</para>
<para>
Identyfikator karty graficznej w oknie: <emphasis>Enter an identifier for your video card</emphasis> nale¿y pozostawiæ niezmieniony. 
</para>
<para>
W oknie <emphasis>Please enter the video card's bus identifier</emphasis> pozostawiamy puste pole. Podobnie postêpujemy w oknie <emphasis>Enter the amount of memory (in kB) to be used by your video card</emphasis>. 
</para>
<para>

Zawarto¶æ okna <emphasis>Please select the XKB rule set to use</emphasis> równie¿ pozostawiamy niezmienion±. 
</para>
<para>
W oknie
<emphasis>Please select your keyboard model</emphasis> nale¿y wybraæ <emphasis>pc104</emphasis>. 
</para>
<para>
W oknie <emphasis>Please select your keyboard layout</emphasis> nale¿y wpisaæ <emphasis>pl</emphasis>. 
</para>
<para>
Pole oknie <emphasis>Please select your keyboard variant</emphasis> pozostawiamy puste, podobnie jak pole w oknie <emphasis>Please select your keyboard options</emphasis>. 
</para>
<para>

W oknie <emphasis>Please select your mouse port</emphasis> nale¿y wybraæ ¶cie¿kê do portu, do którego jest pod³±czona mysz.
Pozycja domy¶lna (ustawiona przez skrypt konfiguracyjny) jest zalecana, gdy¿ mo¿e zapobiec ewentualnym problemom. 
</para>
<para>

W oknie
<emphasis>Please choose the entry that best describe your mouse</emphasis> nale¿y
wybraæ typ myszy. Dla myszy bez kó³ka nale¿y wybraæ pozycjê <emphasis>PS/2</emphasis>, natomiast dla myszy z kó³kiem nale¿y wybraæ <emphasis>imPS/2</emphasis>. Uwaga: 
równie¿ w tym przypadku pozycja domy¶lna jest zalecana. 
</para>
<para>

W oknie <emphasis>Emulate 3 button mouse?</emphasis> odpowiadamy twierdz±co tylko, gdy chcemy programowo emulowaæ trzeci klawisz myszy przy pomocy jednoczesnego wci¶niêcia lewego i prawego
przycisku myszy. Je¿eli posiadamy mysz trójprzyciskow± odpowiadamy przecz±co.
</para>
<para>

W oknie <emphasis>Enable scroll events from mouse wheel</emphasis> odpowiadamy twierdz±co je¿eli <emphasis>X-server</emphasis> ma obs³ugiwaæ kó³ko od myszy. 
</para>
<para>

W oknie <emphasis>Enter an identifier for your monitor</emphasis> nale¿y wpisaæ identyfikator posiadanego monitora. Mo¿na te¿ pozostawiæ istniej±c± nazwê proponowan± przez skrypt konfiguracyjny. 
</para>
<para>

W oknie <emphasis>Is your monitor an LCD device?</emphasis>
odpowiadamy twierdz±co, gdy posiadamy panel LCD. W przypadku monitorów CRT (z kineskopem) nale¿y wybraæ <emphasis>Nie</emphasis>. 
</para>
<para>

W oknie <emphasis>Please choose a method for selecting your monitor characteristics</emphasis> nale¿y wybraæ pozycjê <emphasis>Advanced</emphasis>. 
</para>
<para>

W oknie <emphasis>Enter your monitor's horizontal sync range</emphasis> zaleca siê wpisanie warto¶ci <emphasis>28-50</emphasis>. Jest to warto¶æ do¶æ uniwersalna, zapewnia poprawn± pracê monitora i powinna byæ bezpieczna dla wiêkszo¶ci monitorów.
</para>
<para>


W oknie <emphasis>Enter your monitor's vertical refresh range</emphasis>
zaleca siê wpisanie warto¶ci <emphasis>43-75</emphasis>. Podobnie jak poprzednio warto¶æ ta jest uniwersalna i bezpieczna. 
</para>
<para>

W oknie <emphasis>Select the video modes you would like the X server to use</emphasis> nale¿y zaznaczyæ tryby graficzne,
w których ma pracowaæ <emphasis>X-server</emphasis>. Zaleca siê zaznaczenie opcji
<emphasis>800 x 600</emphasis> oraz <emphasis>1024 x 768</emphasis>. W oknie
<emphasis>Please select your desired default color depth in bits</emphasis>
zaleca siê wybranie pozycji <emphasis>24</emphasis>. 
</para>
<para>

W oknie 
<emphasis>Select the XFree86 server modules that should be loaded by default</emphasis> nale¿y sprawdziæ czy zaznaczone s± nastêpuj±ce pozycje: <emphasis>GLcore</emphasis>, <emphasis>bitmap</emphasis>, <emphasis>dbe</emphasis>, 
<emphasis>ddc</emphasis>, <emphasis>dri</emphasis>, <emphasis>extmod</emphasis>, 
<emphasis>freetype</emphasis>, <emphasis>glx</emphasis>, <emphasis>int10</emphasis>, <emphasis>record</emphasis>, <emphasis>speedo</emphasis>, <emphasis>type1</emphasis>, <emphasis>vbe</emphasis>. 
</para>
<para>

W oknie <emphasis>Write default Files section to configuration file</emphasis> odpowiadamy <emphasis>Tak</emphasis>. 
</para>
<para>

W oknie <emphasis>Write default DRI section to configuration file</emphasis> równie¿ odpowiadamy <emphasis>Tak</emphasis>. 
</para>
<para>

W celu wprowadzenia zmian nale¿y zrestartowaæ <emphasis>X-server</emphasis> poleceniem:
<programlisting>
/etc/init.d/kdm restart
</programlisting>
</para>
</section> <!-- graphic-card-ProSavage -->

<section id="get-edid-fails">
<title>Zawieszanie siê instalatora podczas autodetekcji parametrów monitora</title>
<para>Czasami mo¿e siê zdarzyæ, ¿e podczas instalacji systemu Linux, po wybraniu opcji <emphasis>Attempt monitor autodetection</emphasis>
z odpowiedzi± <emphasis>Yes</emphasis> instalator siê zawiesi. Dzieje siê tak dlatego, ¿e podczas instalacji jest wywo³ywany program <emphasis>get-edid</emphasis>, który w przypadku niewykrycia poprawnych parametrów monitora zawiesza siê. W celu odblokowania instalatora
nale¿y prze³±czyæ siê na inn±, woln± konsolê, zalogowaæ siê a nastêpnie wywo³aæ polecenie: <programlisting>killall get-edid</programlisting>
<emphasis>Uwaga!</emphasis> Tê czynno¶æ nale¿y wykonaæ kilkukrotnie tak¿e podczas instalowania pakietów <emphasis>XServer</emphasis>.
</para>
</section> <!-- get-edid-fails -->
</section> <!-- debian-install-contrib -->
</section> <!-- linux-debian-instalacja -->

<section id="livecd">
<title>Przygotowanie dystrybucji LiveCD</title>
<para>
Niniejszy rozdzia³ opisuje przygotowanie dystrybucji Linuksa typu LiveCD
(uruchamianej z p³ytki), a konkretnie dystrybucji opartej na Ubuntu 5.10, z
do³±czonym oprogramowaniem SZARP, ale mo¿e byæ wykorzystany tak¿e przy
tworzeniu innej dystrybucji.
</para>
<para>
Przy tworzeniu tego opisu korzysta³em z 
<ulink url="http://www.informatik.fh-muenchen.de/~schieder/ubuntu-livecd-customize/index.html">opisu
autorstwa  Reinharda Schiedermeiera</ulink> oraz dokumentu z 
<ulink url="https://wiki.ubuntu.com//LiveCDCustomizationHowTo">Ubuntu Wiki</ulink>.
</para>
<para>
Ogólna idea jest prosta - bierzemy gotow± dystrybucjê LiveCD i modyfikujemy j±
do naszych potrzeb. Poni¿ej znajduje siê dok³adny opis wszystkich kroków. W
repozytorium CVS SZARP'a, w katalogu <filename>script/livecd</filename>
znajduje siê kilka gotowych skryptów wykorzystanych do tworzenia dystrybucji
SZARP Demo LiveCD. Przy opisie poszczególnych poleceñ znajduje siê informacja,
jak nazywa siê skrypt wykonuj±cy dany krok.
</para>

<section id="livecd-prephw">
<title>Przygotowania</title>
<para>
Bêdziemy potrzebowali w miarê szybki komputer, z du¿± pamiêci± i szybkim
dyskiem z du¿± ilo¶ci± wolnego miejsca. Autorzy obu wy¿ej wymienionych
dokumentów zalecaj± wykonywanie kompresji systemu plików w pamiêci, do czego
swap powinien byæ mniej wiêcej dwa razy wiêkszy od obrazu systemu
plików, który chcemy stworzyæ. W poni¿szym opisie zak³adam kompresjê z pliku
do pliku, niemniej du¿y swap tak¿e nie zaszkodzi.
</para>
<para>
Na naszym du¿ym i szybkim dysku zak³adamy sobie pusty katalog, od tej pory
zak³adam, ¿e wszystkie operacje bêd± wykonywane w tym katalogu.
</para>
</section> <!-- livecd-prephw -->

<section id="livecd-getiso">
<title>Pobieramy obraz ISO</title>
<para>Ze strony <ulink url="http://www.ubuntulinux.org">Ubuntu</ulink>
¶ci±gamy obraz CD wersji dystrybucji LiveCD. Je¶li obraz mamy na p³ytce, to
kopiujemy zawarto¶æ p³ytki do nowo utworzonego katalogu:
<programlisting>
mkdir ubuntu-livecd
mount /cdrom
cp -a /cdrom/. ubuntu-livecd
umount /cdrom
</programlisting>
Je¶li mamy obraz ¶ci±gniêty, ale nie wypalony, mo¿emy go podmontowaæ i wtedy
kopiowaæ:
<programlisting>
mkdir ubuntu-livecd
mkdir tmp
mount -t iso9660 -o loop ubuntu.iso tmp
cp -a tmp/. ubuntu-livecd
umount tmp
rm -rf tmp
</programlisting>
</para>

</section> <!-- livecd-getiso -->

<section id="livecd-cleaniso">
<title>Kasujemy niepotrzebne programy</title>
<para>
P³yta Ubuntu Live zawiera trochê dodatkowych rzeczy, w tym programy
przeznaczone dla Windows, przegl±darkê p³yty pod Windows itp. Mo¿emy je
usun±æ, kasuj±c niepotrzebne katalogi i pliki:
<programlisting>
rm -rf bin disctree doc programs README.diskdefines start.bmp \
start.exe start.ini
</programlisting>
Zaoszczêdzamy w ten sposób sporo miejsca - w¶ród programów by³a miêdzy innymi
pe³na wersja OpenOffice 2.0.
</para>
</section> <!-- livecd-cleaniso -->

<section id="livecd-autorun">
<title>Umieszczamy dokumentacjê dla u¿ytkowników Windows</title>
<para>
Poniewa¿ nasza p³ytka bêdzie zapewne wk³adana do napêdu przez u¿ytkowników
Windows, zadbajmy, aby po w³o¿eniu p³yty otworzy³ im siê na przyk³ad opis jak
uruchomiæ nasz± p³ytê. Przygotowujemy plik w HTML'u, zapisujemy go w katalogu
<filename>livecd</filename>, np. jako <filename>index.html</filename>, dodajemy
ewentualne grafiki i ikonê p³yty dla Windows. Ikonê mo¿emy wykonaæ w programie
GIMP, zapisuj±c obrazek o rozmiarach 32x32 punkty jako typ pliku Ikona
Windows. Nastêpnie przygotowujemy plik <filename>autorun.info</filename>,
zawieraj±cy odpowiednie informacje o p³ycie dla mechanizmu autouruchamiania
p³yty przez Windows:
<programlisting>
[autorun]
shellexecute=index.html
icon=praterm.ico
</programlisting>
Komenda <emphasis>shellexecute</emphasis> zadzia³a tylko na Windows 2000 i XP,
je¶li chcemy aby autouruchamianie dzia³a³o na starszych wersjach Windows,
musimy siê trochê wiêcej natrudziæ - poszukajmy odpowiedniego opisu w
<ulink url="http://en.wikipedia.org/wiki/Autorun">sieci</ulink>.
<note><para>
W repozytorium SZARP znajduj± siê odpowiednie pliki
<filename>autorun.inf</filename>, <filename>index.html</filename>, 
<filename>praterm.ico</filename> i <filename>praterm-logo.png</filename>.
</para></note>
</para>
</section> <!-- livecd-autorun -->

<section id="livecd-isolinux">
<title>Modyfikujemy konfiguracjê isolinux</title>
<para>
P³yta Ubuntu LiveCD wykorzystuje do ³adowania systemu program ISOLINUX. Sam
program i pliki konfiguracyjne znajduj± siê na p³ycie w katalogu
<filename>isolinux</filename>. Mo¿emy je zmodyfikowaæ:
<itemizedlist>
<listitem><para>
Nie zale¿y nam na dodatkowych opcjach ³adowania systemu - kasujemy pliki z ich
opisami:
<programlisting>
rm -f isolinux/f*.txt
</programlisting>
</para></listitem>

<listitem><para>
Modyfikujemy plik <filename>isolinux.cfg</filename> - kasujemy wszystkie
sekcje <emphasis>LABEL</emphasis> i <emphasis>F*</emphasis>. Do linii
parametrów j±dra mo¿emy daæ dwa dodatkowe parametry -
<emphasis>debian-installer/locale=pl_PL</emphasis> i
<emphasis>debconf/priority=critical</emphasis>. W ten sposób przy uruchamianiu
nie bêdziemy pytani o wybór jêzyka i klawiatury (ustawienie priorytetu debconfa
na <emphasis>critical</emphasis> jest bezpieczne, bo poza tym i tak instalator
nie zadaje ¿adnych pytañ).
</para>
<para>
Po tych operacjach ca³y plik mo¿e mieæ zawarto¶æ:
<programlisting>
DEFAULT /install/vmlinuz
APPEND  casper/enable=true \
casper-udeb/snapshot/backing-file=/cdrom/casper/filesystem.cloop vga=normal \
initrd=/install/initrd.gz ramdisk_size=1048576 root=/dev/rd/0 \
debian-installer/locale=pl_PL debconf/priority=critical rw --
DISPLAY isolinux.txt
TIMEOUT 0
PROMPT 1
</programlisting>
</para></listitem>

<listitem><para>
Wpisujemy do pliku <filename>isolinux.txt</filename> tekst wy¶wietlany jako
powitanie po za³adowaniu p³yty. Nie kasujemy pierwszej linii odpowiedzialnej
za za³adowanie grafiki!
</para></listitem>

<listitem><para>
Przygotowujemy w³asny plik z wy¶wietlan± przy starcie grafik±. Plik robimy w
Gimpie, szeroko¶æ 640 punktów, wysoko¶æ 200 do 300 punktów. Zmieniamy mu
paletê na 16 kolorów - w menu wybieramy Obraz (Image), Tryb (Mode),
Indeksowany (Indexed), wybieramy 16 kolorów, mo¿na poeksperymentowaæ z
ditheringiem. Zapisujemy ca³o¶æ jako BMP, a nastêpnie u¿ywamy dwóch narzêdzi z
pakietów netpbm i syslinux:
<programlisting>
bmptoppm < splash.bmp | ppmtolss16 > splash.rle
</programlisting>
Uwaga - konkretne kolory z palety u¿ywane s± te¿ w innym celu - do ustalania
koloru t³a i tekstu.
</para></listitem>
</itemizedlist>

<note><para>
W repozytorium SZARP dostêpny jest katalog <filename>isolinux</filename> z
gotowymi plikami <filename>isolinux.cfg</filename>,
<filename>isolinux.txt</filename> i <filename>splash.rle</filename>.
</para></note>

<note><para>
Pe³en opis sk³adni pliku <filename>isolinux.cfg</filename> mo¿na znale¼æ pod
adresem <ulink url="http://syslinux.zytor.com/faq.php#config">http://syslinux.zytor.com/faq.php#config</ulink>. W szczególno¶ci mo¿emy u¿yæ:
<itemizedlist>
<listitem><para>
<programlisting>
<![CDATA[
DEFAULT <etykieta> | kernel <opcje>
]]>
</programlisting>
Podajemy albo s³owo <emphasis>kernel</emphasis> i domy¶lne opcje do j±dra,
albo jedn± ze zdefiniowanych pó¼niej etykiet.
</para></listitem>

<listitem><para>
Etykiety definiujemy nastêpuj±co:
<programlisting>
<![CDATA[
LABEL <etykieta>
	kernel <¶cie¿ka do j±dra>
	append <opcje do j±dra>
]]>
</programlisting>
</para></listitem>

<listitem><para>
Domy¶lny plik wy¶wietlany przy starcie podajemy tak:
<programlisting>
<![CDATA[
DISPLAY <¶cie¿ka do pliku>
]]>
</programlisting>
Plik wy¶wietlany po naci¶niêciu klawisza funkcyjnego (np. F2) definiujemy przez
podanie:
<programlisting>
<![CDATA[
F2 <¶cie¿ka do pliku>
]]>
</programlisting>
</para></listitem>

<listitem><para>
Mo¿emy podaæ czas po jakim system zostanie automatycznie za³adowany
z domy¶lnymi opcjami. Czas podajemy jako wielokrotno¶æ 1/10 sekundy,
ustawienie 0 (domy¶lnie) powoduje, ¿e system zostanie za³adowany tylko po
wybraniu odpowiedniej opcji przez u¿ytkownika:
<programlisting>
<![CDATA[
TIMEOUT <czas>
]]>
</programlisting>
</para></listitem>

<listitem><para>
<programlisting>
PROMPT 1
</programlisting>
Dyrektywa ta steruje wy¶wietleniem znaku zachêty <emphasis>boot:</emphasis>.
</para></listitem>
</itemizedlist>

W wy¶wietlanych plikach mo¿emy u¿yæ nastêpuj±cych sekwencji znaków:
<itemizedlist>
<listitem><para>
<emphasis>Ctrl-L</emphasis> - czy¶ci ekran wype³niaj±c go aktualnym kolorem.
</para></listitem>

<listitem><para>
<emphasis>Ctrl-O&lt;f&gt;&lt;b&gt;</emphasis> - ustawia kolor tekstu i t³a -
zamiast f i b nale¿y u¿yæ kodów kolorów w postaci pojedynczych cyfr
szesnastkowych (od 0 do f). Paleta mo¿e zale¿eæ miêdzy innymi od za³adowanego
obrazka.
</para></listitem>

<listitem><para>
<emphasis>Ctrl-X&lt;nazwa pliku&gt;</emphasis> - wy¶wietla obrazek z pliku
o zadanej nazwie (patrz wy¿ej opis tworzenia pliku w odpowiednim formacie).
Po nazwie pliku musi nast±piæ znak nowej linii.
</para></listitem>
</itemizedlist>

Odpowiednie znaki mo¿na wprowadzaæ, np. w edytorze vim, przez poprzedzenie
ich wci¶niêciem kombinacji klawiszy <emphasis>Ctrl-V</emphasis>.
</para></note>

</para>
</section> <!-- livecd-isolinux -->

<section id="livecd-decompress">
<title>Rozkompresowujemy system plików</title>
<para>
Ubuntu u¿ywa skompresowanego systemu plików cloop, zawieraj±cego obraz ca³ego
systemu. Musimy go rozkompresowaæ, ¿eby móc go modyfikowaæ. Do pracy ze
skompresowanymi obrazami potrzebne s± narzêdzia z pakietu
<emphasis>cloop-utils</emphasis> - musimy je zainstalowaæ. Potem robimy:
<programlisting>
extract_compressed_fs casper/filesystem.clopp > old-fs.ext2
mkdir old
mount -o loop old-fs.ext2 old
</programlisting>
Dekompresja systemu plików mo¿e trwaæ d³ugo.
Mogliby¶my teraz pracowaæ na oryginalnym systemie plików, ale je¶li chcemy
stworzyæ wiêkszy obraz (a po to w³a¶nie zwalniali¶my miejsce na p³ycie),
musimy stworzyæ nowy obraz. Tworzymy plik o po¿±danej wielko¶ci - musz± siê
na nim zmie¶ciæ wszystkie dane i aplikacje, które maj± siê znale¼æ na p³ycie,
musi zostaæ kilkaset (?) MB wolnego miejsca do dzia³ania systemu, a ca³o¶æ musi
siê zmie¶ciæ na p³ytce. Nie obejdzie siê zapewne bez eksperymentów. W ka¿dym
razie, aby stworzyæ obraz o wielko¶ci 3 GB, wykonujemy komendy:
<programlisting>
dd if=/dev/zero of=ubuntu-fs.ext2 bs=1M count=3000
mke2fs ubuntu-fs.ext2
mkdir new
mount -o loop ubuntu-fs.ext new
</programlisting>
mke2fs poskar¿y siê, ¿e ma do czynienia ze zwyk³ym plikiem, a nie urz±dzeniem,
potwierdzamy, ¿e tak ma byæ (ok). Ostatnim krokiem jest skopiowanie danych z
oryginalnego obrazu do nowego. Po tej operacji mo¿emy usun±æ stary obraz:
<programlisting>
cp -a old/. new
umount old
rm -rf old old-fs.ext2
</programlisting>
</para>
</section> <!-- livecd-decompress -->

<section id="livecd-aptget">
<title>Modyfikujemy obraz systemu plików</title>
<para>
W katalogu <filename>new</filename> mamy obraz systemu plików naszej
dystrybucji. Chcemy go zmodyfikowaæ, w tym celu <quote>chroot'ujemy</quote>
siê na nowy system plików:
<programlisting>
chroot new /bin/bash
</programlisting>
Je¶li chcemy korzystaæ z sieci, warto podmontowaæ system plików proc i
ewentualnie sysfs (je¶li korzystamy z niego):
<programlisting>
mount -t proc proc /proc
mount -t sysfs sysfs /sys
</programlisting>
W plikach <filename>/etc/apt/sources.list</filename> dodajemy odpowiednie wpisy
dla repozytoriów, z których bêdziemy chcieli korzystaæ - Ubuntu Universe i
Muliverse, SZARP Ubuntu. Konfigurujemy DNS'y
(nie zapomnijmy potem skasowaæ pliku <filename>/etc/hosts</filename>) lub
dodajemy wpisy do <filename>/etc/hosts</filename>.
</para>
<para>Nastêpnie za pomoc±
apt-get'a mo¿emy kasowaæ i dodawaæ oprogramowanie. Listê zainstalowanych
pakietów, w kolejno¶ci od najwiêkszego do najmniejszego, mo¿emy uzyskaæ
nastêpuj±ca komend±:
<programlisting>
dpkg-query -W --showformat='${Installed-Size;10} ${Package}\n' \
|sort -gr | less
</programlisting>
Mo¿na spokojnie skasowaæ OpenOffice'a, Gimp'a, wszystkie biblioteki zwi±zane z
Jav±, jedn± z przegl±darek (Galeon lub Firefox), program pocztowy Evolution, 
CUPS'a wraz ze sterownikami 
do drukarek, narzêdzia do systemu plików reiserfs, oprogramowanie do ³±czenia z 
Palmem itp., niepotrzebne nam pakiety jêzykowe, fonty dla jêzyków azjatyckich,
czê¶æ dokumentacji, s³owniki itp. Nie kasujemy na pewno GNOME, Metacity, Nautilusa.
</para>
<para>
Z dodatkowego oprogramowania instalujemy SZARP'a (pakiet szarp-viewer - wersjê
dla Ubuntu), ¶ci±gamy potrzebne bazy SZARP'a, warto tak¿e zainstalowaæ np.
polski pakiet jêzykowy dla Firefoksa. Aktualizacjê danych SZARP'a ustawiamy na
automatyczn±, z u¿ytkownikiem np. <quote>livecd</quote>.
</para>
<para>
Po skoñczeniu modyfikacji pakietów, czy¶cimy cache apt'a:
<programlisting>
apt-get clean
</programlisting>
Warto tak¿e zajrzeæ do katalogów <filename>/tmp</filename> czy
<filename>/var/log</filename>, ¿eby sprawdziæ czy nie przyros³y nam jakie¶
¶mieci. Na koniec, komend± <command>exit</command> wychodzimy z chroot'a. Pamiêtajmy,
¿e wcze¶niej musimy odmontowaæ wszystkie zamontowane dodatkowo systemy plików
(np. proc)!
</para>
</section> <!-- livecd-aptget-->

<section id="livecd-custom">
<title>Dodatkowa konfiguracja</title>
<para>
Jest jeszcze kilka rzeczy, które mo¿emy zmieniæ w naszej dystrybucji.
Chcieliby¶my na przyk³ad, aby na starcie uruchamia³a siê przegl±darka z
wy¶wietlon± stron± z informacj± o naszej dystrybucji. Mo¿emy to osi±gn±æ na
kilka sposobów. Je¶li chcemy korzystaæ z Firefoksa, do katalogu
<filename>/etc/X11/Xsession.d</filename> dodajemy plik
<filename>X99firefox</filename>, zawieraj±cy komendê:
<programlisting>
/usr/bin/firefox /opt/livecd/index.html &
</programlisting>
Oczywi¶cie podajemy ¶cie¿kê do naszej dokumentacji. Mo¿emy tak¿e w katalogu
<filename>/etc/skel</filename> daæ odpowiedni podkatalog
<filename>.mozilla/firefox/</filename> z wpisem dla profilu u¿ytkownika i z
ustawion± w pliku <filename>prefs.js</filename> stron± startow± przegl±darki
na nasz± dokumentacjê.
</para>
<para>
Je¶li chcemy wykorzystaæ Galeona, mo¿emy zapisaæ sesjê GNOME z uruchomionym
Galeonem i potem odpowiednie pliki skopiowaæ do
<filename>/etc/skel</filename>.
</para>
<para>
Je¶li w menu GNOME pojawiaj± siê jakie¶ martwe wpisy (po aplikacjach, które
usunêli¶my), mo¿emy skorzystaæ z edytora menu GNOME i usun±æ je, a nastêpnie
konfiguracjê menu skopiowaæ do <filename>/etc/skel</filename>. Menu GNOME
zapisane jest w katalogach <filename>.config</filename> i
<filename>.local</filename> w katalogu domowym.
<note><para>
Repozytorium SZARP zawiera pliki z dokumentacj± - w podkatalogu
<filename>doc</filename> - <filename>index.html</filename>,
<filename>draw.html</filename>.
</para></note>
</para>
</section> <!-- livecd-custom -->

<section id="livecd-close">
<title>Zamykanie systemu plików</title>
<para>
Kolejn± rzecz± do wykonania jest uaktualnienie spisu zainstalowanych pakietów:
<programlisting>
chroot new dpkg-query -W --showformat='${Package} ${Version}\n' \
> ubuntu-livecd/casper/filesystem.manifest
</programlisting>
<note><para>
W repozytorium SZARP'a dostêpny jest skrypt <filename>make_manifest.sh</filename>.
</para></note>
</para>
<para>
Nasz system plików jest gotowy, ale w miejscu wolnym (z punktu widzenia systemu
plików) nadal pozosta³y dane po usuniêtych plikach itp., które zostan±
umieszczone w skompresowanym systemie plików. Musimy je wyzerowaæ:
<programlisting>
dd if=/dev/zero of=new/dummy
rm new/dummy
</programlisting>
Zwróæmy uwagê na komunikat o ilo¶ci skopiowanych przez dd danych - tyle
w³a¶nie wolnego miejsca zostanie do pracy po uruchomieniu naszego systemu.
Je¶li ilo¶æ ta bêdzie za ma³a, nie bêd± mog³y siê uruchamiaæ aplikacje (w tym
Gnome) - brak miejsca na pliki tymczasowe i u¿ytkownika. Wyzerowany obszar,
niezale¿nie od wielko¶ci, kompresuje siê w³a¶ciwie w 100 procentach.
<emphasis>Uwaga!</emphasis> - je¶li dokonywali¶my wielu operacji na plikach
(zw³aszcza du¿o kasowania), system plików móg³ ulec czê¶ciowej defragmentacji.
W takim wypadku dobrze by³oby go zdefragmentowaæ, kopiuj±c ca³o¶æ do innego
katalogu, usuwaj±c ca³± zawarto¶æ i kopiuj±c na nowo, a dopiero po tym
wyzerowaæ.
<note><para>
W repozytorium SZARP'a dostêpny jest skrypt <filename>make_zero.sh</filename>.
</para></note>
Ostatnim krokiem jest odmontowanie naszego nowego systemu plików:
<programlisting>
umount new
</programlisting>
</para>
</section> <!-- livecd-close -->

<section id="livecd-compress">
<title>Kompresja nowego systemu plików</title>
<para>
Autorzy obu dokumentów, na których siê opiera³em, zalecali kompresjê w pamiêci,
ja jednak z sukcesem pos³u¿y³em siê prostym poleceniem:
<programlisting>
create_compressed_fs ubuntu-fs.ext2 ubuntu-livecd/casper/filesystem.cloop
</programlisting>
Kompresja, nawet na szybkim komputerze, mo¿e zaj±æ kilka minut.
<note><para>
W repozytorium SZARP'a dostêpny jest skrypt <filename>make_casper.sh</filename>.
</para></note>
</para>
</section> <!-- livecd-compress -->

<section id="livecd-iso">
<title>Tworzenie obrazu p³yty</title>
<para>
Zanim przyst±pimy do tworzenia obrazu, musimy jeszcze uaktualniæ sumê
kontroln± p³yty:
<programlisting>
find ubuntu-livecd -type f -print0 | xargs -0 md5sum > ubuntu-livecd/md5sum.txt
</programlisting>
<note><para>
W repozytorium SZARP'a dostêpny jest skrypt <filename>make_md5.sh</filename>.
</para></note>
</para>
<para>
Ostatni krok to stworzenie bootowalnego obrazu p³yty:
<programlisting>
mkisofs \
-o ubuntu-szarp.iso \
-b isolinux/isolinux.bin \
-c isolinux/boot.cat \
-no-emul-boot \
-boot-load-size 4 \
-boot-info-table \
-r \
-V "SZARP Demo LiveCD" \
-cache-inodes  \
-J \
-l \
ubuntu-livecd
</programlisting>
<note><para>
W repozytorium SZARP'a dostêpny jest skrypt <filename>make_iso.sh</filename>.
</para></note>
Obraz mo¿emy wypaliæ na p³ytce poleceniem:
<programlisting>
cdrecord speed=24 -v ubuntu-szarp.iso
</programlisting>
Je¶li nagrywamy na p³ytkê CD-RW (zalecane dopóki nie upewnimy siê, ¿e obraz
jest bez b³êdów), mo¿emy u¿yæ komendy:
<programlisting>
cdrecord blank=fast speed=10 -v ubuntu-szarp.iso
</programlisting>
</para>

</section> <!-- livecd-iso -->

<section id="livecd-test">
<title>Testowanie, poprawki</title>
<para>
Prawdopodobnie po uruchomieniu komputera z p³yty oka¿e siê, ¿e jeszcze nie
wszystko jest idealnie. Aby wprowadziæ zmiany w obrazie, musimy powtórzyæ
wszystkie czynno¶ci od generowania pliku
<filename>filesystem.manifest</filename> w³±cznie. Je¶li dokonujemy poprawek
na p³ycie, ale poza obrazem, nie zapomnijmy uaktualniæ sumy kontrolnej.
</para>
<para>
Warto tak¿e w³o¿yæ nasz± p³ytkê do komputera z Windows, aby upewniæ siê ¿e
poprawnie dzia³a autouruchamianie.
</para>
</section>

</section> <!-- livecd -->


<section id="skeleton">
<title>Szablony katalogów domowych (/etc/skel)</title>
<para>
Tworz±c nowych u¿ytkowników czêsto wykonujemy te same czynno¶ci, typu 
dodawanie polskich literek w KDE, kopiowanie pliku <filename>.vimrc</filename> itp.
Czynno¶ci tych mo¿na sobie oszczêdziæ przez odpowiednie skonfigurowanie
katalogu <filename>/etc/skel</filename>. Wszystkie zawarte w tym katalogu pliki
i podkatalogi s± przy tworzeniu nowego u¿ytkownika standardowo kopiowane 
do jego katalogu domowego, z automatyczn± zmian± w³a¶ciciela. Je¿eli chcemy
utrzymywaæ kilka rodzajów konfiguracji dla u¿ytkowników, mo¿na utworzyæ
kilka szablonów katalogów domowych i u¿ywaæ ich w nastêpuj±cy sposób (pod
RedHat'em):
<programlisting>
adduser -m -k katalog
</programlisting>
Zamiast "katalog" nale¿y wstawiæ oczywi¶cie nazwê odpowiedniego katalogu
z szablonem. Wiêcej informacji mo¿na znale¼æ w manualu do komendy
<command>adduser</command>.
</para>
<para>
Pod Debianem nie da siê z linii komend zmieniæ katalogu z domy¶lna
konfiguracj±, katalog ten jest konfigurowany w pliku
<filename>/etc/adduser.conf</filename>.
</para>

</section>


<section id="konfiguracjagruba" >
<title>Konfiguracja GRUB-a</title>
<para>
GRUB (GRand Unified Bootloader) jest stosunkowo nowym menad¿erem bootowania 
(ang. <emphasis>bootmanager</emphasis>) o znacznie wiêkszych mo¿liwo¶ciach ni¿ 
program LILO (LILO opisuje <xref linkend="konfiguracjalilo">).
Do¶æ wspomnieæ, ¿e wszystkie opcje bootowania mo¿na zmodyfikowaæ rêcznie
w trakcie procesu bootowania (GRUB ma w³asn± prost± <quote>pow³okê</quote>
dostêpn± w trakcie bootowania), oraz mo¿liwe jest (i stosunkowo ³atwe) 
robienie rzeczy niestandardowych (typu migracja z jednego dysku na inny,
prze³±czanie z mastera na slave'a itd.). Ponadto, GRUB jest 
dobrze udokumentowany - opis systemu jest standardowo obecny
we wspó³czesnych dystrybucjach w postaci <command>texinfo</command>
(mo¿na wiêc wydaæ komendê: <command>info grub</command>, ¿eby
dowiedzieæ siê czego¶ wiêcej o systemie).
Równie¿ w sieci nie brakuje interesuj±cych dokumentów. Przyk³ady to m.in.:
<ulink url="http://www.tldp.org/HOWTO/Multiboot-with-GRUB.html"
>Multiboot with GRUB Mini-HOWTO</ulink>
oraz
<ulink url="http://www.tldp.org/HOWTO/Linux+Win9x+Grub-HOWTO/index.html"
>Linux+Win9x+Grub HOWTO</ulink>. 
</para>

<para>
Podobnie jak w systemie LILO, na dzia³anie GRUB-a mo¿na wp³ywaæ modyfikuj±c 
pliki konfiguracyjne. W przeciwieñstwie do LILO jednak, pliki te odczytywane 
s± ka¿dorazowo z dysku, a nie instalowane do bootsectora zawsze, gdy zmieniane jest
cokolwiek w konfiguracji
(tak, tak - oznacza to, ¿e GRUB potrafi <quote>zajrzeæ</quote> wewn±trz systemu plików).
Z tego powodu pliki konfiguracyjne GRUB-a znajduj± siê w katalogu <filename>/boot</filename>.
</para>
<para>
Najbardziej istotnym plikiem konfiguracyjnym systemu GRUB jest 
<filename>/boot/grub/menu.lst</filename>. To tu
opisane s± wszystkie systemy operacyjne uruchamiane przez GRUB-a. 
Pierwsza czê¶æ pliku to opcje globalne - w tej czê¶ci nie nale¿y zwykle nic zmieniaæ.
<!-- TODO: dodaæ opis opcji (wybór kilku opcji przedstawiono poni¿ej). -->

W drugiej czê¶ci pliku opisane s± systemy operacyjne, które pojawi± siê w menu menad¿era
bootowania po uruchomieniu komputera. 
Ka¿da z sekcji rozpoczyna siê od s³owa <command>title</command>. Kolejno¶æ sekcji
jest istotna - wp³ywa na kolejno¶æ wierszy w menu menad¿era bootowania.

Przyk³adowa sekcja ma postaæ jak poni¿ej:

<programlisting>
title           Debian GNU/Linux, kernel 2.6.2-1-686
 root            (hd0,0)
 kernel          /boot/vmlinuz-2.6.2-1-686 root=/dev/sda1 ro
 initrd          /boot/initrd.img-2.6.2-1-686
 savedefault
 boot
</programlisting>
W lewej kolumnie s± zmienne (<command>title</command>, <command>root</command>, <command>kernel</command> itd.), 
a w prawej kolumnie ich warto¶ci. Znaczenie poszczególnych zmiennych jest nastêpuj±ce:

<itemizedlist>

<listitem><para>
<command>title</command> jest tekstem, który pojawi siê z menu wyboru menad¿era bootowania. 
Poniewa¿ tekst ów nie wp³ywa na funkcjonalno¶æ systemu, mo¿e byæ dowolnym ci±giem znaków
(np. 
<quote>Moj ulubiony system - Debian</quote>, 
<quote>RedHat Aurox, jadro 2.6.2</quote> itp.).
Warto jednak, szczególnie przy rozbudowanych menu, 
¿eby poszczególne wiersze by³y ³atwo rozró¿nialne.
</para></listitem>

<listitem><para>
<command>root</command> opisuje dysk i partycjê, na której znajduje siê katalog 
<filename>/boot/</filename> z konfiguracj± systemu GRUB 
(uwaga! Niekoniecznie bêdzie to g³ówna partycja systemu plików). 
</para>
<para>Nale¿y zwróciæ uwagê na to, ¿e GRUB korzysta ze specyficznego nazewnictwa dla
dysków i ich partycji. Kolejne dyski s± oznaczane jako
<command>hd&lt;numer&gt;</command>, gdzie <command>&lt;numer&gt;</command> 
to indeks twardego dysku (uwaga! Indeksujemy od zera!), np.:
<command>hd0</command> to linuksowy <command>/dev/hda</command>,
<command>hd1</command> to linuksowy <command>/dev/hdb</command> itd.
Grub nie rozró¿nia dysków ATA/SATA/SCSI - wszystkie s± nazywane
<command>hdX</command>. Do dyskietek odwo³ujemy siê przez
<command>fd0</command>.
</para>
<para>
Druga liczba (ta po przecinku) to oznaczenie numeru partycji (równie¿ liczone od zera).
W przyk³adzie powy¿ej (dysk oznaczony jako <command>(hd0,0)</command>)
odwo³ujemy siê do pierwszego dysku i jego pierwszej partycji 
(w standardowym linuksowym systemie plików do partycji tej odwo³ywaliby¶my
siê poprzez <filename>/dev/hda1</filename>).
</para>
<para>
Uwaga! Dyski z rozszerzonych partycji numerowane s± od czwórki - czyli pierwsz± partycj±
<emphasis>extended</emphasis> bêdzie <command>(hd0,4)</command>.
</para></listitem>

<listitem><para>
<command>kernel</command> to ¶cie¿ka do pliku z j±drem systemu operacyjnego.
</para></listitem>

<listitem><para>
<command>initrd</command> to ¶cie¿ka do ramdysku ³adowanego przy starcie systemu
(Uwaga! Ramdysk musi byæ w 100% kompatybilny z j±drem).
</para></listitem>

<listitem><para>
<command>savedefault</command> to opcja oznaczaj±ca, ¿e dla tego systemu operacyjnego 
nasz wybór zostanie zapamiêtamy i automatycznie pod¶wietlony nastêpnym razem 
(Uwaga! ¯eby ten mechanizm zadzia³a³ wymagana jest globalna opcja <command>default saved</command>).
</para></listitem>

</itemizedlist>

W przypadku dodawania systemów operacyjnych Windows nie okre¶lamy lokalizacji j±dra systemu,
a partycjê z lokalnym windowsowym programem bootuj±cym (umieszczonym w bootsektorze partycji).
Program ten nastêpnie uruchamia j±dro Windowsa i resztê systemu.
Poni¿ej pokazano konfiguracjê GRUB-a dla Windowsa zainstalowanego na trzeciej partycji
pierwszego dysku:

<programlisting>
title Windows 9x
 rootnoverify (hd0,2)
 chainloader +1
</programlisting>

<!--
Je¿eli chcemy instalowaæ system Windows ju¿ po zainstalowaniu i skonfigurowaniu Linuksa oraz GRUB-a
to mo¿emy u¿yæ pewnego triku, który ¿eby nam Windows nie napisa³ konfiguracji menad¿era bootowania.
Po tej operacji Windows bêdzie my¶la³, ¿e znajduje siê na pierwszej partycji (operacja ta zwana jest mapowaniem):

<programlisting>
title Windows 9x
 map (hd0,0) (hd0,2)
 map (hd0,2) (hd0,0)

 rootnoverify (hd0,2)
 chainloader +1
</programlisting>
-->
Uwaga! Je¿eli GRUB nie by³ wcze¶niej instalowany na danej maszynie (w sytuacji, gdy np.
przechodzimy z systemu LILO na system GRUB) to nale¿y GRUB-a zainstalowaæ.
Robi siê to przez wydanie komendy <command>grub-install &lt;partycja do zainstalowania&gt;</command>, 
np. <command>grub-install /dev/hda</command>.
</para>
<para>
Uwaga(2)! W celu konfiguracji GRUB-a w Debianie mo¿na siê pos³u¿yæ skryptem do generowania
pliku <filename>menu.lst</filename>. Opis znajduje siê <link linkend="update-grub">tutaj</link>.
</para>
</section> <!-- konfiguracjagruba -->

<section id="grub-rescue">
<title>Przywracanie GRUB'a po instalacji Windows</title>

<para>
Czêstym problemem spotykanym przez u¿ytkowników korzystaj±cych na tym samym
komputerze z Linuksa i Windows jest niemo¿no¶æ uruchomienia
Linuksa (a dok³adniej, wyboru uruchamianego systemu operacyjnego) po
reinstalacji Windows.
</para>
<para>
Na dysku komputera, zwykle w tzw. g³ównym sektorze uruchomieniowym (MBR -
Master Boot Record) znajduje siê program uruchomieniowy, odpowiedzialny za
³adowanie systemu operacyjnego. Linux instaluje tam zwykle program GRUB,
pozwalaj±cy na wybór ³adowanego systemu operacyjnego. Niestety, Windows przy
instalacji nie sprawdza czy na dysku s± inne systemy - po prostu zapisuje w
MBR program ³aduj±cy bezpo¶rednio w³a¶nie Windows.
</para>
<para>
Poni¿ej opisano sposób na odratowanie <quote>popsutej</quote> przez Windows
instalacji, przy za³o¿eniu, ¿e korzystali¶my z GRUB'a (zobacz te¿ 
<xref linkend="konfiguracjagruba">). Je¶li mamy do¶æ now± dystrybucjê Linuksa, to raczej na
pewno mamy do czynienia w³a¶nie z GRUB'em. 
</para>
<para>
Potrzebna nam bêdzie p³yta CD z Linuksem, z której bêdziemy mogli uruchomiæ
komputer. Mo¿e to byæ p³yta instalacyjna której¶ z dystrybucji (je¶li oferuje
tryb <emphasis>rescue</emphasis>), mo¿e to byæ jaka¶ dystrybucja typu
<emphasis>live</emphasis> (uruchamiana z p³yty CD/DVD) - np. Knoppix. Zak³adam
jednak, ¿e pos³u¿ymy siê <emphasis>Timo's Rescue CD Set</emphasis> -
niewielk± dystrybucj± Debiana, przygotowan±
specjalnie do ratowania systemu. Poni¿sza
instrukcja jest jednak do¶æ uniwersalna i mo¿e byæ wykorzystana z inn± p³yt±.
Aby zmniejszyæ ryzyko wyst±pienia problemów, warto pos³u¿yæ siê p³yt±,
zawieraj±c± podobn± wersjê j±dra, bibliotek systemowych i GRUB'a jak nasz
system (czyli - najlepiej ta sama dystrybucja i z podobnego okresu).
<warning>
<para>Nieumiejêtne pos³ugiwanie siê opisanymi narzêdziami mo¿e w najgorszym
przypadku doprowadziæ do niemo¿no¶ci za³adowania z dysku jakiegokolwiek
systemu czy te¿ utraty danych 
- przed zastosowaniem proszê dok³adnie przeczytaæ ca³y opis. Kopiê tej 
instrukcji nale¿y wydrukowaæ, albo mieæ otwart± na innym komputerze.</para>
<para>
W szczególno¶ci niniejsza instrukcja nie mo¿e byæ zastosowana dos³ownie,
je¿eli masz na dysku oddzieln± partycjê <filename>/boot</filename>. 
</para>
<para>
Nie zabieraj siê za wykonywanie opisanych tu czynno¶ci, je¶li nie znasz
znaczenia takich pojêæ, jak np. partycja lub nie znasz przynajmniej podstaw
korzystania z komend Linuksa - popro¶ kogo¶ o pomoc.
</para>
</warning>
Po kolei:
<itemizedlist>
<listitem>
<para>
Potrzebny nam bêdzie komputer z dostêpem do internetu i nagrywark± CD, a tak¿e
czysta nagrywalna p³yta CD.
</para>
</listitem>

<listitem>
<para>
Ze strony <ulink url="http://rescuecd.sourceforge.net/download.html">
http://rescuecd.sourceforge.net/download.html</ulink> ¶ci±gamy obraz p³yty -
plik z rozszerzeniem <emphasis>iso</emphasis>. Bêdziemy musieli wybraæ jeden z
serwerów lustrzanych, z którego chcemy ¶ci±gaæ p³ytê - bywa, ¿e jedne z nich
zapewni± nam du¿o wiêksz± prêdko¶æ ¶ci±gania ni¿ inne - je¶li ¶ci±ganie idzie
wolno, spróbujmy wybraæ inny.
</para>
</listitem>

<listitem>
<para>
¦ci±gniêty plik jest obrazem, który musimy wypaliæ na p³ycie CD. Uwaga! - to
nie jest plik, który nale¿y umie¶ciæ na p³ycie, ale obraz ca³ej p³yty! W
programie k3b odpowiednia opcja nazywa siê <command>Burn CD image</command>, w
innych programach powinna siê nazywaæ podobnie - np. <quote>Wypal obraz z
pliku</quote>.
</para>
</listitem>

<listitem>
<para>
Je¶li prawid³owo stworzyli¶my p³ytkê, to mo¿emy z niej uruchomiæ komputer z
<quote>popsutym</quote> GRUB'em. Je¿eli komputer nie uruchamia siê z p³ytki,
mo¿e byæ konieczne ustawienie w BIOS'ie jako pierwszego urz±dzenia do
³adowania systemu CD-ROM'u.
</para>
</listitem>

<listitem>
<para>
Po za³adowaniu systemu z p³yty Rescue-CD pojawi siê napis
<quote>ISOLINUX</quote> - mamy do wyboru menu, z którego wybieramy pierwsz±
opcjê - <emphasis>RescueCD</emphasis>. Robimy to przez wci¶niêcie
<command>Enter</command>. Mo¿emy te¿ po prostu chwilê poczekaæ, jest to opcja
domy¶lna i zostanie po chwili uruchomiona sama.
</para>
<para>
Je¿eli korzystamy z innej dystrybucji typu <emphasis>live</emphasis>, zwykle
wystarczy nacisn±æ Enter, ¿eby za³adowaæ system w domy¶lnej konfiguracji. Je¶li
korzystamy z p³yty instalacyjnej, za pomoc± klawiszy funkcyjnych mo¿emy
obejrzeæ opcje uruchamiania systemu, w¶ród których powinien byæ tryb
<emphasis>Rescue</emphasis>.
</para>
</listitem>

<listitem>
<para>
Czekamy cierpliwie a¿ uruchomi siê Linux. Powinni¶my w koñcu zobaczyæ zachêtê
do logowania 
<programlisting>rescuecd login:</programlisting>
Wpisujemy nazwê
u¿ytkownika <emphasis>root</emphasis>, system prosi nas o has³o. Dla
<emphasis>RescueCD</emphasis> has³o brzmi <emphasis>rescue</emphasis>; w
trakcie wpisywania nie bêdzie ono widoczne. Po zalogowaniu zobaczymy tekstow±
planszê tytu³ow± dystrybucji.
</para>
<para>
Je¶li korzystamy z dystrybucji <emphasis>Live</emphasis>, uruchomiony mo¿e
zostaæ tryb graficzny. Nastêpne kroki nale¿y wiêc wykonywaæ albo po
prze³±czeniu siê na konsolê tekstow± (za pomoc± kombinacji
<command>Ctrl+Alt+F1</command>), albo w oknie konsoli, ale zawsze jako
u¿ytkownik <emphasis>root</emphasis>. W Ubuntu nie ma dostêpnego u¿ytkownika
<emphasis>root</emphasis>, uprawnienia administratora zdobywamy poprzedzaj±c
ka¿d± komendê komend± <emphasis>sudo</emphasis> - wpisujemy j± i dopiero po
spacji w³a¶ciw± komendê. Je¶li korzystamy z p³yty instalacyjnej w trybie
<emphasis>rescue</emphasis>, to bardzo mo¿liwe, ¿e nie bêdziemy musieli siê
logowaæ - od razu dostaniemy konsolê u¿ytkownika <emphasis>root</emphasis>.
</para>
</listitem>

<listitem>
<para>
Po zalogowaniu wydajemy komendê
<programlisting>
fdisk -l
</programlisting>
Powinna ona nam wy¶wietliæ dostêpne dyski i partycje. 
<note><para>
Nazwa dysku pod Linuksem
wygl±da zwykle np. tak: <emphasis>/dev/hda</emphasis>. Pocz±tkowe
<emphasis>/dev/</emphasis> jest wspólne dla wszystkich urz±dzeñ. Od litery
<emphasis>h</emphasis> zaczynaj± siê nazwy dysków IDE (ATA), ostatnia litera
nazwy oznacza o który dysk chodzi - <emphasis>a</emphasis> to urz±dzenie
<emphasis>master</emphasis> na pierwszym kanale IDE, <emphasis>b</emphasis> to
urz±dzenie <emphasis>slave</emphasis>, <emphasis>c</emphasis> i
<emphasis>d</emphasis> do odpowiednio <emphasis>master</emphasis> i
<emphasis>slave</emphasis> na drugim kanale. Czyli np. dysk podpiêty jako
<emphasis>master</emphasis> na drugim kanale bêdzie siê nazywa³
<emphasis>/dev/hdc</emphasis>.
</para>
<para>
Dyski SCSI i Serial ATA (jak równie¿ urz±dzenia takie jak pendrive) 
maj± trochê inne nazewnictwo - zamiast
<emphasis>h</emphasis> bêdziemy mieli <emphasis>s</emphasis>, czyli kolejne
dyski bêd± siê nazywa³y <emphasis>/dev/sda</emphasis>,
<emphasis>/dev/sdb</emphasis> itd.
</para>
<para>
Kolejne partycje na dysku otrzymuj± kolejne numery (uwaga - Linux wy¶wietla
tak¿e oddzielnie partycjê <quote>rozszerzon±</quote>, na której umieszczone s±
dyski logiczne, widziane tak¿e jako partycje). Tak wiêc kolejne partycje na
pierwszym dysku IDE bêd± siê nazywa³y <emphasis>/deb/hda1</emphasis>,
<emphasis>/dev/hda2</emphasis> itp.
</para></note>
Mo¿emy otrzymaæ np. co¶ w stylu:
<programlisting>
Disk /dev/hda: 40.0 GB, 40007761920 bytes
255 heads, 63 sectors/track, 4864 cylinders
Units = cylinders of 16065 * 512 = 8225280 bytes

   Device Boot      Start         End      Blocks   Id  System
   /dev/hda1   *           1          50      400000    c  W95 FAT32 (LBA)
   Partition 1 does not end on cylinder boundary.
   /dev/hda2              50         949     7222811   83  Linux
   /dev/hda3             963        4788    30725730    5  Extended
   /dev/hda4            4789        4864      610470   82  Linux swap / Solaris
   /dev/hda5             964        2365    11261565   83  Linux
   /dev/hda6            2366        4788    19462716   83  Linux
</programlisting>
Przyk³adowy spis partycji zawiera dwie partycje podstawowe - jedn± z DOS'em
lub Windows (<emphasis>/dev/hda1</emphasis>), jedn± z Linuksem
(<emphasis>/dev/hda2</emphasis>) a nastêpnie partycjê rozszerzon±
(<emphasis>/dev/hda3</emphasis>), zawieraj±c± dwie partycje z Linuksem
(<emphasis>/dev/hda5</emphasis> i <emphasis>/dev/hda6</emphasis>) oraz
partycjê wymiany (<emphasis>/dev/hda4</emphasis>). Je¶li mamy wiêcej dysków,
partycje zostan± wy¶wietlone dla ka¿dego z nich. Istotne jest, aby ustaliæ, która z
partycji zawiera g³ówny system plików. W grê wchodz± partycjê z
identyfikatorem (Id) 83 - Linux. W naszym przyk³adzie s± to partycje 2, 5 i 6.
Mo¿emy zgadywaæ, ¿e g³ówny system znajduje siê na pierwszej z tych partycji.
Je¶li siê pomylimy nic siê nie stanie - trzeba bêdzie próbowaæ z kolejnymi
partycjami. Wypisan± przez program <command>fdisk</command> tabelkê warto
spisaæ - mo¿e siê przydaæ pó¼niej.
<note><para>
Mo¿e siê zdarzyæ, ¿e Twój system bêdzie u¿ywa³ zupe³nie innego schematu
nazewnictwa dysków i partycji - np.
<programlisting>
/dev/ide/host0/bus0/target0/lun0/part1
</programlisting>
Kolejne fragmenty ¶cie¿ek oznaczaj± typ urz±dzenia (IDE), szynê/kana³ 
(host0/bus0/target0), dysk (lun0) i partycjê (part1). Nazwa w takiej postaci
jest równie <quote>dobra</quote> jak <emphasis>/dev/hda2</emphasis> - nale¿y
nazwy te po prostu konsekwentnie stosowaæ zamiast przyk³adowych z tego opisu, 
prawdopodobnie wszêdzie, poza parametrem <emphasis>root=</emphasis> przy
³adowaniu j±dra (opisane du¿o ni¿ej).
</para></note>
</para>
</listitem>

<listitem>
<para>
Kolejnym krokiem jest zamontowanie partycji z g³ównym systemem plików tak, aby
by³a dla nas dostêpna. Tworzymy sobie tymczasowy katalog, np.
<programlisting>
mkdir /mnt/root
</programlisting>
i montujemy w nim partycjê, która powinna zawieraæ g³ówny system plików. W
naszym przyk³adzie bêdzie to komenda:
<programlisting>
mount /dev/hda2 /mnt/root
</programlisting>
Zamiast <emphasis>/dev/hda2</emphasis> musimy wpisaæ oczywi¶cie nazwê partycji
odpowiedni± dla naszego systemu.
</para>
<para>
Je¶li korzystamy z p³yty instalacyjnej w trybie <emphasis>rescue</emphasis> 
lub dystrybucji <emphasis>live</emphasis>, to byæ mo¿e system sam wykryje nasz±
g³ówna partycjê, lub te¿ podmontuje wszystkie dostêpne partycje, np. w
katalogach o nazwach odpowiadaj±cych nazwom partycji -
<filename>/mnt/hda1</filename> itp. W takim razie musimy odpowiednio
zmodyfikowaæ parametry podanych dalej komend.
</para>
</listitem>

<listitem>
<para>
Sprawdzamy czy dobrze trafili¶my - wy¶wietlamy zawarto¶æ naszej partycji za
pomoc± komendy:
<programlisting>
ls -l /mnt/root
</programlisting>
Je¶li w wy¶wietlonym spisie zobaczymy miêdzy innymi katalogi
<filename>bin</filename> i <filename>boot</filename>, to znaczy ¿e dobrze
trafili¶my. Je¶li nie, odmontowujemy partycjê za pomoc± komendy:
<programlisting>
umount /mnt/root
</programlisting>
i powtarzamy poprzedni punkt dla kolejnej partycji.
<note>
<para>
Wykrycie czy podmontowali¶my odpowiedni± partycjê mo¿e byæ trudniejsze, je¶li
na dysku mamy np. kilka wersji Linuksa. Trzeba siê upewniæ, ¿e podmontowali¶my
na pewno prawid³ow± partycjê - warto sprawdziæ na przyk³ad zawarto¶æ pliku
<filename>/boot/grub/menu.lst</filename> i obecno¶æ plików z j±drem (zwykle
<filename>/boot/vmlinuz2.X.Y...</filename> gdzie X i Y to odpowiednie numery
wersji j±dra).
Do szybkiego przegl±dania zawarto¶ci
dysku mo¿emy u¿yæ programu <command>mc</command> je¶li mamy do niego dostêp -
jest to klon programu Norton Commander. Pliki podgl±damy przez F3, wychodzimy
z programu przez F10.
</para>
</note>
</para>
</listitem>

<listitem>
<para>
Mamy ustalon± partycjê z g³ównym systemem plików. Podmieniamy teraz g³ówny
system plików na t± partycjê, wykonuj±c komendê:
<programlisting>
chroot /mnt/root
</programlisting>
Musimy jeszcze podmontowaæ system plików <emphasis>proc</emphasis>:
<programlisting>
mount -t proc proc /proc
</programlisting>
<note><para>
Je¿eli mamy oddzieln± partycjê <filename>/boot</filename>, to mo¿emy j± teraz
podmontowaæ w odpowiednie miejsce, na przyk³ad:
<programlisting>
mount /dev/hda2 /boot
</programlisting>
Nie gwarantuje to jednak sukcesu w instalacji za pomoc± skryptu
<emphasis>grub-install</emphasis>, byæ mo¿e bêdziemy musieli spróbowaæ sposobu
<quote>rêcznego</quote>.
</para></note>
</para>
</listitem>

<listitem>
<para>
Dokonujemy teraz
reinstalacji GRUB'a na dysku. Je¶li mamy wiêcej ni¿ jeden dysk, to jako
ostatni argument musimy podaæ nazwê dysku, z którego ³adowany jest system -
zwykle jest to ten sam dysk, na którym znajduje siê nasza partycja z Linuksem. Je¶li
¼le trafimy (i nadal ³aduje siê tylko Windows), mo¿emy albo ca³± procedurê
powtórzyæ od nowa wybieraj±c inny dysk, albo przestawiæ kolejno¶æ ³adowania
systemu z dysków w BIOS'ie.
</para>
<para>Wydajemy komendê (jeszcze raz - ostatni argument to nazwa naszego dysku,
podana tu jest przyk³adowa, choæ najczê¶ciej spotykana):
<programlisting>
grub-install --no-floppy --recheck /dev/hda
</programlisting>
Uwaga - zdarzaj± siê wersje skryptu grub-install, które nie obs³uguj± opcji
<quote>--nofloppy</quote> - je¿eli program poskar¿y siê na niew³a¶ciwe opcje,
po prostu wpiszmy polecenie bez tej opcji. 
</para>
</listitem>

<listitem>
<para>
Je¶li poprzedni krok zakoñczy³ siê bez b³êdu, to GRUB zosta³ ponownie 
zainstalowany na naszym dysku. Sprawd¼my czy nigdzie w wypisanych komunikatach
nie ma napisów <emphasis>Error</emphasis> albo na przyk³ad
<emphasis>Segmentation fault</emphasis>. Je¶li uwa¿asz, ¿e wszystko posz³o w
porz±dku, mo¿esz zresetowaæ komputer pamiêtaj±c, ¿eby uruchomi³
siê z dysku, a nie z p³ytki. Je¿eli GRUB wypisa³ informacjê o b³êdzie lub
komputer nie chce siê w ogóle uruchamiaæ, lub te¿ nadal dostêpny jest tylko
system Windows, uruchom ponownie komputer z p³yty CD
i spróbuj kroków opisanych w kolejnych
punktach. Je¶li po uruchomieniu widaæ tylko napis
<programlisting>
grub >
</programlisting>
zobacz punkt o rêcznym uruchamianiu systemu za pomoc± GRUB'a.
</para>
</listitem>

<listitem>
<para>
Je¿eli GRUB poinformowa³ nas o b³êdzie, mo¿emy spróbowaæ nieco innego sposobu
- powtarzamy wszystkie opisane kroki a¿ do komendy <command>chroot</command>,
ale ju¿ bez niej (montuj±c ewentualnie partycjê <filename>/boot</filename> w
<filename>/mnt/root/boot</filename>) i próbujemy zainstalowaæ GRUB'a
nastêpuj±c± komend±:
<programlisting>
grub-install --no-floppy --recheck --root-directory=/mnt/root /dev/hda
</programlisting>
Komenda ta wskazuje, ¿e g³ówny katalog naszej odratowywanej instalacji
znajduje siê w innym miejscu (<filename>/mnt/root</filename>). G³ówna ró¿nica
miêdzy tym sposobem a poprzednim polega na tym, ¿e teraz u¿ywamy GRUB'a
pochodz±cego z p³ytki, podczas gdy w poprzednim sposobie próbowali¶my u¿yæ
GRUB'a z naszej instalacji. Uwaga - pamiêtajmy, ¿e teraz, po
wykonaniu ostatniej komendy (o ile oczywi¶cie siê przynajmniej czê¶ciowo
powiod³a), w katalogu
<filename>/boot/grub</filename> naszej partycji mamy pliki z wersji GRUB'a z
p³ytki CD, a nie te z naszej instalacji.
</para></listitem>

<listitem><para>
Je¿eli nadal siê nie uda³o,
kolejnym krokiem mo¿e byæ powtórzenie obu poprzednich sposobów, ale podaj±c
jako ostatni argument nazwê urz±dzenia w formacie GRUB'a, czyli
<emphasis>(hdX)</emphasis>, gdzie zamiast <emphasis>X</emphasis> podstawiamy
odpowiedni numerek - pierwszy dysk ma 0, kolejne 1 itp., niezale¿nie od tego
czy s± tu urz±dzenia IDE (ATA), Serial ATA czy SCSI. Mo¿emy te¿ podejrzeæ
odpowiednie nazwy w pliku <filename>/boot/grub/menu.lst</filename>. Warto tego
spróbowaæ, je¿eli GRUB'owi nie podobaj± siê np. podawane przez nas nazwy
urz±dzeñ.
</para></listitem>

<listitem>
<para>
Je¿eli to te¿ nie pomog³o to, je¶li mamy stacjê dysków, mo¿emy spróbowaæ
wykonaæ dyskietkê uruchomieniow± za pomoc± komendy:
<programlisting>
grub-install --recheck (fd0)
</programlisting>
Próbujemy uruchomiæ komputer z przygotowanej dyskietki. Zobacz tak¿e ni¿ej
o rêcznym podawaniu GRUB'owi komend do uruchomienia systemu.
</para>
</listitem>

<listitem>
<para>
Je¿eli ¿aden z powy¿szych sposobów nie zadzia³a³ lub
GRUB wypisa³ informacjê o b³êdzie, zawieraj±c± co¶ w stylu
<quote>
/dev/hda does not have any corresponding BIOS drive
</quote> (nazwa urz±dzenia na pocz±tku bêdzie pewnie inna), to oznacza to, ¿e
GRUB nie jest w stanie wyci±gn±æ z BIOS'u poprawnej informacji o dyskach
zainstalowanych w systemie - zobacz w takim razie nastêpny punkt.
</para>
</listitem>

<listitem>
<para>
Powtarzamy wszystkie operacje, bez wywo³ania komendy
<command>grub-install</command>.
<warning><para>
Operacje opisane w tym punkcie i w nastêpnych mog± uniemo¿liwiæ za³adowanie z
dysku jakiegokolwiek systemu - nie wykonuj ich je¿eli nie rozumiesz co robisz,
lepiej popro¶ o pomoc kogo¶ z wiêksz± wiedz± na temat Linuksa i GRUB'a.
</para></warning>
Skoro GRUB ¼le wykrywa nasze dyski, musimy mu powiedzieæ który dysk jest
który. W tym celu edytujemy plik <filename>/boot/grub/menu.lst</filename>.
Mo¿emy u¿yæ dowolnego edytora tekstowego (na przyk³ad edytora dostêpnego z
Midnight Commander pod klawiszem <command>F4</command>), ale trzeba siê 
przygotowaæ, ¿e
bêdziemy mieli dostêp tylko do edytora <command>vim</command> lub nawet jego
starszego brata, <command>vi</command>.
<note><para>
Podstawy obs³ugi edytora vi(m):
<itemizedlist>
<listitem><para>
W dowolnym momencie dwukrotne wci¶niêcie <command>Esc</command> przenosi nas
do tzw. trybu komend.
</para></listitem>
<listitem><para>
W dowolnym trybie mo¿emy klawiszami strza³ek przesuwaæ kursor.
</para></listitem>
<listitem><para>
Bêd±c w trybie komend naciskamy <command>i</command> ¿eby wej¶æ do trybu
edycji, w którym mo¿emy wpisywaæ i kasowaæ tekst.
</para></listitem>
<listitem><para>
Je¶li nie dzia³aj± klawisze <command>Backspace</command> i
<command>Del</command>, kasowaæ znaki mo¿emy w trybie komend klawiszem
<command>x</command>.
</para></listitem>
<listitem><para>
Aby zapisaæ zmiany, w trybie komend wpisujemy <command>:w</command> i naciskamy
<command>Enter</command>.
</para></listitem>
<listitem><para>
Aby wyj¶æ z edytora, w trybie komend wpisujemy <command>:q</command> i
naciskamy <command>Enter</command>. Je¿eli wprowadzili¶my jakie¶ zmiany w
pliku to, ¿eby wyj¶æ bez ich zapisywania wpisujemy komendê
<command>:q!</command> i naciskamy <command>Enter</command>.
</para></listitem>
</itemizedlist>
</para></note>
Zak³adaj±c ¿e u¿ywamy edytora vim wpisujemy komendê:
<programlisting>
vim /boot/grub/menu.lst
</programlisting>
Mamy otwarty plik mapuj±cy urz±dzenia fizyczne na urz±dzenia w formacie
u¿ywanym przez grub'a, np.:
<programlisting>
(fd0)	/dev/fd0
(hd0)	/dev/hda
(hd1)	/dev/sda
</programlisting>
Musimy doprowadziæ go do sensownej postaci, tzn:
<itemizedlist>
<listitem><para>
Je¿eli nie zamierzamy tworzyæ dyskietki startowej, mo¿emy usun±æ liniê z
urz±dzeniem <emphasis>fd0</emphasis>.
</para></listitem>
<listitem><para>
Je¶li w pliku mamy jakie¶ urz±dzenia, których na pewno nie mamy w systemie
(czyli np. <emphasis>/dev/sda</emphasis> je¶li mamy tylko dyski IDE), to
usuwamy je.
</para></listitem>
<listitem><para>
Je¶li naszego dysku brakuje, musimy go dodaæ.
</para></listitem>
<listitem><para>
Pierwsza kolumna musi zawieraæ dla pierwszego dysku
<emphasis>(hd0)</emphasis>, dla kolejnych (je¶li mamy wiêcej ni¿ jeden dysk),
<emphasis>(hd1)</emphasis> itp. - musz± to byæ kolejne liczby.
</para></listitem>
<listitem><para>
Druga kolumna powinna zawieraæ nazwy urz±dzeñ w formacie
<emphasis>/deb/hda</emphasis> itp., przy czym dyski powinny byæ w takiej
kolejno¶ci jak s± widziane przez BIOS (czyli najpierw
<emphasis>master</emphasis> na pierwszym
kanale itp.), urz±dzenia SCSI czy Serial ATA po IDE - choæ mo¿e siê to zmieniæ
je¿eli ³adujemy system z dysku SCSI czy Serial ATA.
<note><para>
Je¿eli w komputerze mamy jakie¶ dyski, które nie s± nam potrzebne przy
³adowaniu systemu Linux - a wiêc np. dyski u¿ywane tylko przez Windows, czy
dysk na którym mamy partycjê <filename>/home</filename> to, aby u³atwiæ sobie
sprawê, mo¿emy na czas odratowywania GRUB'a odpi±æ je od zasilania - tak ¿eby
nie by³y widoczne w systemie.
</para></note>
</para></listitem>
</itemizedlist>
Je¶li plik z map± urz±dzeñ nie by³ poprawny i nanie¶li¶my jakie¶ poprawki,
zapisujemy go i wychodzimy z edytora.
</para>
</listitem>

<listitem><para>
Teraz zmuszamy GRUB'a do u¿ycia naszej prawid³owej mapy urz±dzeñ,
podaj±c komendê
<programlisting>
grub --device-map=/boot/grub/menu.lst
</programlisting>
Jeste¶my w pow³oce GRUB'a - wydajemy polecenia wykonywane przez GRUB'a, a nie
przez system operacyjny. Pierwszym poleceniem jest wskazanie partycji g³ównej -
tej na której jest zainstalowany grub. Partycjê podajemy w formacie urz±dzeñ
GRUB'a, czyli, w nawiasach, najpierw nazwê dysku (<emphasis>hd</emphasis> i
kolejny numerek), a potem po przecinku kolejny numer partycji. Partycje
numerowane s± od zera, tak wiêc np. partycji <emphasis>/dev/hda2</emphasis>
odpowiadaæ bêdzie <emphasis>(hd0,1)</emphasis> (oczywi¶cie przy za³o¿eniu, ¿e
pierwszy dysk to w³a¶nie <emphasis>/dev/hda</emphasis>). Ca³a komenda bêdzie
wiêc wygl±daæ na przyk³ad nastêpuj±co:
<programlisting>
root (hd0,1)
</programlisting>
Zwróæmy uwagê, ¿e w pow³oce GRUB'a dzia³a dope³nianie po naci¶niêciu klawisza
<command>Tab</command>. Je¶li wpiszemy:
<programlisting>
root (
</programlisting>
i wci¶niemy <command>Tab</command>, to GRUB podpowie nam dostêpne dyski, np.:
<programlisting>
grub> root (
  Possible disks are:  hd0 hd1
</programlisting>
Je¶li podamy dysk, mo¿e nam podpowiedzieæ tak¿e partycje:
<programlisting>
grub> root (hd0,
 Possible partitions are:
   Partition num: 0, Filesystem type is ext2fs, partition type 0x83
   Partition num: 4, Filesystem type unknown, partition type 0x6
   Partition num: 5, Filesystem type is reiserfs, partition type 0x83
</programlisting>
GRUB nie tylko wy¶wietli nam typ partycji i systemu plików, ale tak¿e pominie
te, które na pewno nie zawieraj± prawid³owych plików GRUB'a. U³atwia nam to
wybranie poprawnej partycji.
</para>
<para>
Druga komenda dokonuje w³a¶ciwej instalacji - jako parametr podajemy tylko
dysk, np.:
<programlisting>
setup (hd0)
</programlisting>
Wychodzimy z GRUB'a:
<programlisting>
quit
</programlisting>
Restartujemy system i uruchamiamy komputer z dysku. Powinien siê uruchomiæ
GRUB, ale bez menu do wyboru systemu - zobacz nastêpny punkt.
</para></listitem>

<listitem><para>
Je¶li nasze operacje doprowadzi³y do tego, ¿e po uruchomieniu komputera z
dysku zamiast menu widzimy pow³okê GRUB'a:
<programlisting>
grub>
</programlisting>
to oznacza, ¿e ogólnie instalacja GRUB'a siê powiod³a, ale brakuje mu
informacji, jaki system operacyjny ma za³adowaæ. Musimy podaæ nastêpuj±ce
komendy:
<programlisting>
root (hd0,1)
</programlisting>
Podajemy partycjê, na której znajduje siê j±dro systemu Linux, czyli nasz±
g³ówn± partycjê - zobacz uwagi wy¿ej o nazwach urz±dzeñ w GRUB'ie i o
dope³nianiu komend za pomoc± klawisza <command>Tab</command>.
</para>
<para>
Nastêpnie okre¶lamy po³o¿enie pliku z j±drem, które chcemy za³adowaæ. Komenda
ma postaæ:
<programlisting>
kernel /boot/vmlinuz-2.6.14-1-686 root=/dev/hda2
</programlisting>
Po wpisaniu pocz±tkowego <emphasis>kernel /</emphasis> warto u¿yæ klawisza
<command>Tab</command> - GRUB bêdzie nam podpowiada³ znalezione na dysku pliki
i katalogi. Je¶li j±dro jest na oddzielnej partycji
<filename>/boot</filename>, to oczywi¶cie ¶cie¿ka nie bêdzie zawiera³a
katalogu <filename>/boot</filename>. Je¶li w¶ród plików nie ma katalogu
<filename>/boot</filename> czy j±dra to znaczy, ¿e jako parametr do komendy
<emphasis>root</emphasis> GRUB'a podali¶my z³± partycjê - mo¿emy komendê
<emphasis>root</emphasis>
powtórzyæ z inn± partycj±. Mo¿emy mieæ te¿ kilka j±der do wyboru - wybierzmy to,
na którym zwykle pracowali¶my.
</para>
<para>
Bardzo wa¿ny jest parameter <emphasis>root=/...</emphasis> do j±dra. Oznacza
on co innego ni¿ wydawana przed chwil± komenda <emphasis>root</emphasis>
GRUB'a. Po znaku <quote>=</quote> musi wyst±piæ nazwa g³ównej partycji
naszego odratowywanego Linuksa. Partycja musi byæ podana
w postaci dla j±dra Linuksa, a nie GRUB'a, czyli np. w³a¶nie
<emphasis>/dev/hda2</emphasis>. Bêdzie to inna partycja ni¿ ta z GRUB'em i
j±drem tylko wtedy, je¶li mamy oddzieln± partycjê <filename>/boot</filename>.
Je¶li j±dro zacznie siê ³adowaæ, ale w trakcie ³adowania wy¶wietli siê b³±d,
¿e nie mo¿na znale¼æ g³ównego systemu plików (np. <emphasis>Kernel panic -
init not found</emphasis>), to znaczy ¿e podali¶my z³y parametr
<emphasis>root</emphasis> do j±dra - spróbujmy z inn± partycj±.
Oczywi¶cie, je¶li nasze j±dro do uruchomienia wymaga jaki¶ dodatkowych
parametrów, to tak¿e nale¿y je dopisaæ.
</para>
<para>
Kolejne polecenie to podanie ¶cie¿ki do pliku <filename>initrd</filename> z obrazem 
modu³ów j±dra. Wiêkszo¶æ wspó³czesnych dystrybucji wykorzystuje ten plik.
Powinien siê znajdowaæ w tym samym katalogu co j±dro i musi to byæ ta sama
wersja. Przyk³adowa komenda to:
<programlisting>
initrd /boot/initrd.img-2.6.14-1-686
</programlisting>
Oczywi¶cie znalezienie pliku u³atwia u¿ycie klawisza <command>Tab</command>.
Je¶li nie mo¿emy znale¼æ pliku <filename>initrd</filename>, to mo¿e mamy j±dro
skonfigurowane w ten sposób, ¿eby z niego nie korzystaæ - mo¿emy spróbowaæ
pomin±æ wiêc to polecenie.
</para>
<para>
Ostatni krok to polecenie za³adowania systemu:
<programlisting>
boot
</programlisting>
Je¶li siê nie powiod³o, to znaczy ¿e co¶ ¼le wpisali¶my - je¶li j±dro w ogóle
nie zaczyna siê ³adowaæ, sprawd¼my czy dobrze podali¶my partycjê i po³o¿enie
pliku z j±drem. Je¶li j±dro wypisuje b³±d ju¿ w trakcie uruchamiania Linuksa,
to sprawd¼my opcjê <emphasis>root=</emphasis> i po³o¿enie pliku
<filename>initrd</filename>.
</para></listitem>

<listitem><para>
Je¶li uruchomi³ siê nasz Linux, to jeste¶my prawie w domu. Oczywi¶cie nie
chcemy za ka¿dym razem wpisywaæ do GRUB'a poleceñ przy starcie systemu. Musimy
zainstalowaæ porz±dnie GRUB'a z naszej dystrybucji. Tym razem powinno
wystarczyæ co¶ w stylu:
<programlisting>
grub-install /dev/hda
</programlisting>
I jeszcze jedna rzecz - upewniamy siê, ¿e mamy prawid³owy plik
<filename>/boot/grub/menu.lst</filename> - taki jak przed reinstalacj± 
Windows. Je¶li plik zosta³ uszkodzony lub skasowany to musimy stworzyæ nowy. W
Debianie mo¿na do tego u¿yæ polecenia:
<programlisting>
update-grub
</programlisting>
Zwróæmy uwagê, ¿e plik ten zawiera dok³adnie takie same komendy, jak te, które
wpisywali¶my przed chwil± rêcznie.
</para></listitem>

<listitem><para>
Je¶li chcemy z jakiego¶ powodu <quote>rêcznie</quote> uruchomiæ z pow³oki
GRUB'a system Windows lub DOS, to potrzebna bêdzie sekwencja nastêpuj±cych
komend (oczywi¶cie, z odpowiednimi nazwami partycji):
<programlisting>
root (hd0,0)
makeactive
chainloader +1
</programlisting>
Je¶li Windows z jakiego¶ powodu uzna, ¿e uruchamia siê z nieodpowiedniego
dysku, to mo¿emy zamieniæ dyski albo w BIOS'ie (co bêdzie wymaga³o poprawek
tak¿e w konfiguracji ³adowania Linuksa), albo przez wpisanie po
<emphasis>makeactive</emphasis> polecenia do <quote>zamiany</quote> dysków:
<programlisting>
map (hd0) (hd1)
map (hd1) (hd0)
</programlisting>
</para></listitem>

<listitem><para>
Nie wszyscy wiedz±, ale mo¿emy te¿ modyfikowaæ polecenia wykonywane przez
GRUB'a przy starcie systemu tak¿e gdy mamy prawid³owe menu. W tym celu
naje¿d¿amy na pozycjê menu i naciskamy <command>e</command>. Potem wybieramy
liniê i naciskam ponownie <command>e</command> ¿eby j± edytowaæ. Mo¿emy
wpisywaæ oczywi¶cie dowolne komendy GRUB'a.
</para></listitem>

<listitem><para>
Je¶li nie uda³o nam siê ostatecznie przywróciæ uruchamiania Linuksa, a 
usunêli¶my mo¿liwo¶æ uruchamiania Windows, to mo¿na przeprowadziæ
odratowywanie systemu Windows z p³ytki instalacyjnej - w ten sposób bêdziemy
mogli przynajmniej uruchomiæ Windows.
</para></listitem>

</itemizedlist>
</para>
</section> <!-- grub-rescue -->

<section id="konfiguracjalilo" >
<title>Konfiguracja LILO</title>
<para>Ten opis dotyczy bootmanagera LILO, który w nowszych systemach 
zostaje wypierany przez potê¿niejszy manager GRUB.
</para>
<itemizedlist>
<listitem>
<para>
Je¶li zainstalowali¶my Linuksa, nale¿y zmodyfikowaæ bootmanagera.
Nale¿y uruchomiæ Linuksa, zalogowaæ siê jako root i wyedytowaæ plik
<filename>/etc/lilo.conf</filename>. Nastêpnie nale¿y uruchomiæ program <filename>/sbin/lilo</filename> i zresetowaæ system. Jak modyfikowaæ plik <filename>/etc/lilo.conf</filename> dowiesz siê:
<programlisting>
man lilo
man lilo.conf
</programlisting>
W skrócie: do <filename>/etc/lilo.conf</filename> trzeba dodaæ:
<programlisting>
	other=/dev/sda1
	label=dos
	table=/dev/sda
</programlisting>
</para>

<para>
Najprawdopodobniej sda1 trzeba zamieniæ na co¶, co odpowiada konfiguracji
konkretnego komputera. Dyski SCSI to: sda, sdb, sdc.... a dyski IDE to: hda,
hdb, hdc... Partycje oznaczane s± kolejnymi numerami, np. /dev/sda3. Aby
dowiedzieæ siê, na której partycji jest zainstalowany DOS, trzeba jako root
napisaæ: 
<programlisting>
/sbin/fdisk /dev/&lt;odpowiedni_dysk&gt; (np: /dev/sda),
</programlisting>
nacisn±æ p i obejrzeæ tablicê partycji. Aby wyj¶æ z <filename>fdisk</filename> nale¿y nacisn±æ q.
</para>
</listitem>

<listitem>
<para>
Czasami wystêpuje konieczno¶æ uruchamiania z jednego komputera raz Linuksa, raz Windows czy DOSa. Do tego s³u¿y lilo, gdzie przy starcie u¿ytkownik mo¿e napisaæ odpowiedni identyfikator ustawiany w <filename>/etc/lilo.conf</filename>, jednak dla lamerów potrzebne jest co¶ prostszego - lilo-colors. Nale¿y ¶ci±gn±æ <filename>lilo-0.21-110.src.rpm</filename>, jako root zainstalowaæ:
<programlisting>
rpm -ihv lilo-0.21-110.src.rpm
</programlisting>
To spowoduje rozpakowanie do katalogu <filename>/usr/src/redhat/SOURCES</filename> plików: <filename>lilo-21.tar.gz</filename> oraz <filename>lilo-colors-1.21.1.tar.gz</filename>. Nastêpnie nale¿y w katalogu <filename>/usr/local/src</filename> rozpakowaæ plik <filename>lilo-21.tar.gz</filename>: 
<programlisting>
tar -xzvf lilo-21.tar.gz
</programlisting>
co utworzy katalog <filename>/usr/local/src/lilo</filename>. Tam¿e nale¿y rozpakowaæ plik <filename>lilo-colors-1.21.1.tar.gz</filename>: 
<programlisting>
tar -xzvf lilo-colors-1.21.1.tar.gz
</programlisting>
co utworzy katalog <filename>/usr/local/src/lilo/lilo-colors-1.21.1</filename>. Tam¿e nale¿y uruchomiæ:
<programlisting>
make patch
</programlisting>
natomiast w pliku <filename>Makefile</filename> zmieniæ ostatni± linijkê:
<programlisting>
	install -m 644 sample.bootmsg ${rpm_build_dir}/boot/msg/bootmsg
</programlisting>
na linijkê:
<programlisting>
	install -m 644 bootmsg ${rpm_build_dir}/boot/msg/bootmsg
</programlisting>
nastêpnie w katalogu <filename>/usr/local/src/lilo</filename> uruchomiæ: 
<programlisting>
make
make install
</programlisting>
W katalogu <filename>/usr/local/src/lilo/lilo-colors-1.21.1</filename> nale¿y odpowiednio zmieniæ zawarto¶æ pliku <filename>bootcreator</filename>. Zamiast ostatnich linijek:
<programlisting>
     ${vlin1} linux  ..... Linux 2.2.4             runlevel 3     ${vline}${s2}
     ${vlin1} redhat ..... Original Redhat Kernel  runlevel 3     ${vline}${s2}
     ${vlin1} x      ..... XWindow 3.3.3           runlevel 5     ${vline}${s2}
     ${vlin1} dos    ..... Dos                                    ${vline}${s2}
</programlisting>
przyk³adowo na linijki:
<programlisting>
     ${vlin1} 1      ..... Linux 2.2.12            runlevel 5     ${vline}${s2}
     ${vlin1} 2      ..... DOS 6.22                               ${vline}${s2}
     ${vlin1} 3      ..... Windows 98                             ${vline}${s2}
     ${vlin1} 4      ..... Linux 2.2.14                           ${vline}${s2}
</programlisting>
Tak naprawdê ten tekst nic nie znaczy, jest tylko wy¶wietlan± na ekranie podpowiedzi± dla u¿ytkownika, co ma napisaæ na klawiaturze, aby uruchomiæ po¿±dany system operacyjny. Oryginalne napisy (pierwsza kolumna za <filename>${vlin1}</filename>) s± w porz±dku, ale za d³ugie. W zmienionej wersji s± krótkie - wystarczy nacisn±æ jeden klawisz z cyfr± i Enter. Aby tak by³o, musi byæ w³a¶ciwie skonfigurowane lilo. Nale¿y wiêc odpowiednio zmodyfikowaæ <filename>/etc/lilo.conf</filename>. Przyk³ad do¶æ rozbudowany zgodny z powy¿szym plikiem <filename>bootcreator</filename>:
<programlisting>
boot=/dev/hda
map=/boot/map
install=/boot/boot.b
prompt
timeout=100
default=2
message=/boot/msg/bootmsg

image=/boot/vmlinuz-2.2.12-20
	label=1
	initrd=/boot/initrd-2.2.12-20.img
	read-only
	root=/dev/hda3

other=/dev/hda1
	label=2
	change
	  partition=/dev/hda1
	    activate
	  partition=/dev/hda4
	    deactivate

other=/dev/hda4
	label=3
	change
	  partition=/dev/hda1
	    deactivate
	  partition=/dev/hda4
	    activate

image=/boot/vmlinuz-2.2.14
	label=4
	initrd=/boot/initrd-2.2.12-20.img
	read-only
	root=/dev/hda3
</programlisting>
Najwa¿niejsza jest linijka:
<programlisting>
message=/boot/msg/bootmsg
</programlisting>
Oprócz tego nale¿y odpowiednio zsynchronizowaæ pola <filename>label</filename> z zawarto¶ci± pliku <filename>bootcreator</filename>. Dobrze jest te¿ ustawiæ odpowiednio du¿y <filename>timeout</filename> podawany w 0.1 sekundy. Aby zakoñczyæ instalacjê, nale¿y jeszcze w katalogu <filename>/usr/local/src/lilo/lilo-colors-1.21.1</filename> uruchomiæ:
<programlisting>
make
make install
</programlisting>
i wreszcie uruchomiæ:
<programlisting>
/sbin/lilo
</programlisting>
W przypadku konieczno¶ci dalszych modyfikacji plików <filename>bootcreator</filename> i <filename>/etc/lilo.conf</filename> nale¿y powtórzyæ powy¿sze kroki od punktu edycji pliku <filename>bootcreator</filename>. 
</para>
</listitem>
</ItemizedList>
</section>


<section id="upsy">
<title>Opis konfiguracji UPS-ów</title>
<para>Ten rozdzia³ opisuje jak jak zainstalowaæ i skonfigurowaæ
UPS-y firm: 
APC (<xref linkend="ups-apc">),
EVER (<xref linkend="ups-ever">),
Fideltronik (<xref linkend="ups-fideltronik">),
Powerware (<xref linkend="ups-powerware">).
</para>

<section id="ups-apc">
<title>Konfiguracja UPS-a firmy APC</>
<para>
instalacja UPSa APC (wersja Smart 700): po instalacji rpm'a <filename>
smupsd.rpm</filename> - instalacja: 
<programlisting>
rpm -ivh smupsd.rpm
</programlisting>
zrobiæ link w <filename>/etc/rc.d/rc5.d/</filename> uruchomiæ 
<filename>/usr/lib/powerchute/Config.sh</filename>,
wybraæ: 2 (Smart-UPS); Measure-UPS - no; TCP/IP installed - yes,
Use Default Color Scheme; port <filename>/dev/ttyS1</filename>
(na <filename>/dev/ttyS0</filename> zwykle jest modem); 
execute command files as root - yes;
send e-mail as root - no; zatwierdziæ wybór; increment UpsTurnOffDelay;
ustawiæ has³o dla u¿ytkownika pwrchute.
</para>
</section>

<section id="ups-fideltronik">
<title>Konfiguracja UPS-a firmy Fideltronik</>

<para>
Instalacja oprogramowania polega na zainstalowaniu rpm'a 
<filename>fideltronik</filename> zawieraj±cego oprogramowanie UPSMonitor:
<programlisting>
rpm -i fideltronik-1.0.0-1.i386.rpm
</programlisting>
</para>
<para>
Po instalacji nale¿y jeszcze sprawdziæ, czy na koniec pliku 
<filename>/etc/rc.d/init.d/halt</filename>, przed komend±
<programlisting>
eval $command ...
</programlisting>
zosta³o dopisane polecenie <command>/etc/UPS/upsd/upsoff</command> tak, ¿e
ca³a linia wygl±da mniej wiêcej tak:
<programlisting>
/etc/UPS/upsd/upsoff; eval $command ...
</programlisting>
Podobnie, w pliku <filename>/etc/rc.d/rc.local</filename> pod koniec powinno
siê pojawiæ polecenie:
<programlisting>
/etc/UPS/upsd/upsd
</programlisting>
</para>
<para>
Je¿eli u¿ywan± dystrybucj± jest RedHat 6.1, mo¿e okazaæ siê konieczna zmiana
lokalizacji plików wykonywalnych z <filename>/etc/UPS/upsd</filename> do
<filename>/usr/bin</filename>. Nale¿y wiêc skopiowaæ tam pliki <filename>
upsd</filename> i <filename>upsoff</filename> i zmieniæ odpowiednie wpisy
w <filename>/etc/rc.d/init.d/halt</filename> i <filename>/etc/rc.d/rc.local</filename>
- zamieniæ katalog <filename>/etc/UPS/upsd</filename> na
<filename>/usr/bin</filename>.
</para>
<para>
Po zainstalowaniu rpm'a w katalogu <filename>/etc/UPS</filename> pojawi siê
tak¿e plik <filename>manual.txt</filename>, do którego mo¿na zajrzeæ w razie
problemów. Opisany jest tam jednak sposób instalacji z "czystego tgz'a", a nie
z rpm'a.
</para>
<para>
Nale¿y pamiêtaæ o odpowiednim ustawieniu dipswitchy na UPS Fideltronik:
<programlisting>
1 - OFF
2 - OFF
3 - OFF
4 - ON
</programlisting>
aby po zaniku napiêcia i ponownym jego powrocie UPS startowa³ automatycznie i 
podawa³ napiêcie na wyj¶cie dla komputera.
</para>

<para>
Testowanie UPS Fideltronik: wstawiæ <filename>upsd</> do 
<filename>/etc/rc.local</> i <filename>upsoff</> do 
<filename>/etc/init.d/halt</>, ustawiæ czas podtrzymania na 5 minut 
lub krócej i zresetowaæ maszynê. Wypi±æ UPS z zasilania i poczekaæ, 
czy maszyna zasygnalizuje brak zasilania. Nie czekaj±c 5-ciu minut 
w³±czyæ UPS do gniazdka - czekaæ a¿ maszyna zasygnalizuje powrót 
zasilania. Potem wy³±czyæ i sprawdziæ, czy nast±pi shutdown i 
wy³±czenie UPS-a, potem po w³±czeniu do pr±du UPS-a powinien wstaæ 
komputer.
</para>

</section>

<section id="ups-ever">
<title>Konfiguracja UPS-a firmy EVER</>
<para>
Oprogramowanie do tego UPS-a dostajemy razem z urz±dzeniem, b±d¼ te¿ mo¿emy
¶ci±gn±æ ze strony: 
<ulink url="http://www.ever.com.pl/pl/download.php">http://www.ever.com.pl/pl/download.php</>
Po ¶ci±gniêciu rozpakowujemy archiwum i uruchamiamy program
instalacyjny:
<programlisting>
tar xzvf powersoft-&lt;wersja&gt;.tar.gz
cd powersoft-&lt;wersja&gt;
./install
</programlisting>
W pliku <filename>/etc/powersoft/powersoft.conf</> dostosowujemy
konfiguracjê (najwa¿niejsze jest ustawienie w³a¶ciwego portu szeregowego). Po
tym mo¿emy ju¿ uruchomiæ demona steruj±cego:
<programlisting>
/sbin/psman init
</programlisting>
Mo¿emy w ka¿dym momencie podejrzeæ status UPS-a uruchamiaj±c komendê:
<programlisting>
/sbin/psman status
</programlisting>
Je¶li chcemy (a zapewne chcemy), by oprogramowanie uruchamia³o siê przy ka¿dym
starcie systemu, dodajemy dwie linijki do pliku <filename>/etc/rc.local</>:
<programlisting>
/bin/echo "Uruchomienie serwisu PowerSoft"
/sbin/psman init
</programlisting>
</para>
</section>

<section id="ups-powerware">
<title>Konfiguracja UPS-a firmy Powerware</>
<para>
Powerware produkuje szerok± gamê UPS-ów, do³±czaj±c do nich oprogramowanie
dla kilkunastu systemów operacyjnych, szczególnie Uniksów (w tym dla Linuksa). 
Oprogramowanie to wystêpuje w dwóch wariantach o uroczych nazwach 
<emphasis>FailSafe</> i <emphasis>LanSafe</>. LanSafe (opisany poni¿ej)
ma wiêksze mo¿liwo¶ci, ale niestety nie chodzi pod Windows. Opis instalacji 
dotyczy modelu Powerware 5115.
</para>

<para>
Hardware: UPS-a pod³±czamy do pr±du, w³±czamy (kilkakrotne popiskiwanie 
na pocz±tku jest normalne - to taki autotest) i czekamy kilkana¶cie 
godzin a¿ siê porz±dnie sformatuje. £±czymy UPS-a z COM-em w komputerze 
za pomoc± dostarczonego z zestawem kabelka. Obci±¿amy UPS-a: mo¿na 
do niego pod³±czyæ do czterech urz±dzeñ na raz.  
</para>
<para>
Software: mo¿e siê zdarzyæ, ¿e na do³±czonej p³ytce nie 
ma oprogramowania 
LanSafe dla modelu 5115, chocia¿ FailSafe (wersja uproszczona pod Windows)
dzia³a bez zarzutu. Nale¿y wiêc ze strony 
<Ulink URL="http://www.powerware.com"> http://www.powerware.com </Ulink> 
¶ci±gn±æ najnowsz± wersj± pakietu LanSafe dla Linuksa (w tym przypadku
by³a to wersja 4.16-1 w pliku <filename>ls3_416_linux.tar</>).
Rozpakowujemy archiwum i uruchamiamy instalacjê (<filename>./install.sh</>).
Na pytania odpowiadamy defaultowo. Na pytanie o ¼ród³o instalacji 
odpowiadamy wpisuj±c ¶cie¿kê i nazwê archiwum tar (w tym przypadku 
<filename>ls3_415_linux.tar</>). Na pytanie <quote>Is this computer
part of UPS group?</> odpowiadamy w zale¿no¶ci od konfiguracji sprzêtowej:
je¿eli do UPS-a jest pod³±czonych wiêcej ni¿ 1 komputer linuksowy i s± 
one po³±czone sieci± to odpowiadamy YES. W przeciwnym razie: NO (domy¶lne).
W przypadku YES-a zostaniemy zapytani czy nasz komputer jest kontrolerem
grupy (jest pod³±czony do UPS-a kabelkiem DB9), czy jedynie 
cz³onkiem grupy (ma kontakt z jakim¶ kontrolerem przez sieæ).
Pozosta³e pytania dotycz± konfiguracji modelu UPS-a, portu szeregowego 
oraz czasów:
po którym u¿ytkownicy s± informowani o zaniku pr±du; po którym zamykany jest
system; trwania procedur zamykania systemu.
</para>
<para>
Uwaga! W przypadku grupy nale¿y ustawiæ wszystkim cz³onkom grupy 
warto¶ci czasów takie same lub mniejsze ni¿ ma kontroler. Dlaczego? Otó¿
UPS po zamkniêciu systemu operacyjnego kontrolera wy³±cza siê. Je¿eli 
zwyk³y cz³onek grupy ma ustawione d³u¿sze czasy ni¿ 
kontroler, wtedy UPS mu odetnie zasilanie zanim ten zd±¿y siê bezpiecznie 
zamkn±æ.
</para>
<para>
Uwaga(2)! W grupie musi byæ przynajmniej 1 kontroler. 
</para>
<para>
Uwaga(3)! Windowsowy FailSafe
nie wspó³pracuje z innymi komputerami, wiêc w przypadku Windows nie 
nale¿y przy³±czaæ wiêcej ni¿ jednego komputera do UPS-a.
</para>
<para>
Uwaga(4)! Je¿eli LanSafe dzia³a w sieci, nale¿y na wszystkich komputerach identycznie ustawiæ <filename>/etc/hosts</filename> przypisuj±c aliasy do numerów IP interfejsu eth0, nie do interfejsu lo (127.0.0.1).
</para>
<para>
Ostatnim krokiem instalacji jest ustalenie has³a na UPS-a, wtedy uprawnieni
u¿ytkownicy (niekoniecznie root) bêd± mogli podgl±daæ stan UPS-a oraz
go konfigurowaæ. UPS Powerware mo¿e byæ ponownie skonfigurowany przy pomocy 
narzêdzi skryptu instalacyjnego <filename>install.sh</>, a w czasie 
dzia³ania  przy pomocy programów: konsolowego <filename>/usr/ls3/ls3con</> 
(w pewnym wersjach mo¿e wyrzucaæ core'a) oraz <filename>/usr/ls3/ls3conX</> 
(wersja pod iksy z animacjami i helpem). Narzêdzia ls3con powinny 
poprawnie dzia³aæ w przypadku kontrolera i zwyk³ego cz³onka. 
</para>
<para>
Instaluj±c oprogramowanie LanSafe w wersji 4.17a z p³ytki dostarczonej z 
UPS-em nale¿y zwróciæ uwagê, aby program instalacyjny uruchamiaæ z katalogu, 
w którym on siê znajduje (a wiêc np. <filename>/mnt/cdrom/LANSAFE</filename>),
a poza tym nie wolno zmieniaæ domy¶lnej ¶cie¿ki instalacyjnej.
</para>
</section>

</section> <!-- id="upsy" -->




<section id="lm-sensors">
<title>Wykorzystanie czujników z p³yt g³ównych - 
<command>lm_sensors</></title>

<para>
<command>lm_sensors</> jest pakietem umo¿liwiaj±cym wykorzystanie 
czujników obecnych na wspó³czesnych p³ytach g³ównych. Dotyczy to
czujników temperatury, napiêcia jak i ilo¶ci obrotów wiatraczka coolera.
Dziêki tym informacjom mo¿na sprawdzaæ stan hardware'u w trakcie pracy
i odpowiednio reagowaæ na niektóre awarie (np. nieodpowiednie napiêcie
pochodz±ce z zasilacza, spalony wiatraczek - je¿eli procesor siê jeszcze 
jako¶ trzyma, itd.). Mo¿liwe jest równie¿ takie skonfigurowanie pakietu,
by pewne dzia³ania by³y podejmowanie automatycznie (nieinteraktywnie).
</para>
<para>
Poni¿szy opis zawiera informacjê dotycz±c± g³ównie najnowszych dostêpnych
wersji lm_sensors, gdy¿ w³a¶ciwie tylko one maj± szansê obs³u¿yæ czujniki
obecne na nowych p³ytach g³ównych. W konfiguracji lm_sensors sporo siê zmienia,
wiêc opis ten mo¿e byæ nieadekwatny do starszych wersji.
</para>
<para>
Je¿eli mamy starsz± p³ytê, mo¿emy spróbowaæ u¿yæ lm_sensors z pakietów RPM.
Nale¿y u¿yæ pakietów o nazwach i2c, lm-sensors-drivers i lm-sensors o
odpowiadaj±cych sobie numerach wersji. W j±drach 2.4.x i2c jest standardowo
dostêpne i nie trzeba go instalowaæ o ile numer wersji jest zgodny z u¿ywan±
wersj± lm-sensors. Zwykle jednak bêdziemy potrzebowali skompilowaæ i2c i
lm_sensors ze ¼róde³.
</para>
<para>Ze stron 
<ulink url="http://www.lm-sensors.nu">http://www.lm-sensors.nu</ulink>
¶ci±gamy ¼ród³a do i2c (np. plik <filename>i2c-2.7.0.tar.gz</>) oraz ¼ród³a 
do lm_sensors (np. <filename>lm_sensors-2.7.0.tar.gz</>). 
</para>
<para>
Poniewa¿ skrypty instalacyjne korzystaj± z pliku 
<filename>/usr/src/linux/.config</filename> w przypadku j±dra instalowanego 
z rpm'ów, nale¿y ten plik utworzyæ (oczywi¶cie 
<filename>/usr/src/linux</filename> musi byæ prawid³owym linkiem na katalog 
z kernelem, np. <filename>/usr/src/linux-2.4.18-3</filename>):
<programlisting>
cd /usr/src/linux
cp configs/kernel-*-i386.config .config
</programlisting>
Musi byæ zainstalowany pakiet <filename>kernel-source-`uname -r`.i386.rpm</filename>
</para>
<para>Instalacja polega na rozpakowaniu ¼róde³, ich przekompilowaniu i przekopiowaniu w 
odpowiednie miejsce: 
<programlisting>
tar -xzf i2c-2.7.0.tar.gz -C &lt;katalog docelowy&gt;
cd &lt;katalog docelowy&gt;i2c-2.7.0/
make all
make install
</programlisting>
Poniewa¿ ¼ród³a i2c i lm_sensors nie u¿ywaj± autoconf'a, a w Red Hat v7.2 i 7.3 nieco zmieni³a 
siê organizacja plików, wiêc przed kompilacj±
nale¿y zmieniæ plik <filename>Makefile</filename> w obu katalogach ze 
¼ród³ami zamieniaj±c liniê:
<programlisting>
MODDIR := /lib/modules/`grep UTS_RELEASE $(LINUX_HEADERS)/linux/version.h|cut -f 2 \
-d'"'`/misc
</programlisting>
na liniê:
<programlisting>
MODDIR := /lib/modules/2.4.18-3/kernel/drivers/i2c
</programlisting>
lub odpowiedni± dla zainstalowanej wersji j±dra. Mo¿na tak¿e zmieniæ prefix 
na <emphasis>/usr</emphasis>, aby programy instalowa³y siê w katalogach
<filename>/usr/bin</filename> itp. zamiast <filename>/usr/local/bin</filename>.
Masê ostrze¿eñ w trakcie kompilacji mo¿na zignorowaæ. Je¿eli wszystko
posz³o dobrze, to w podanym katalogu z modu³ami 
pojawi³y siê nowe lub podmienione modu³y z przedrostkiem <filename>i2c-</> (np.
<filename>i2c-core</>, <filename>i2c-dev</>, <filename>i2c-isa</>, i in.).
</para>
<para>
Kompilujemy i instalujemy lm_sensors (razem ze sterownikami) ze ¼róde³
(podobnie nale¿y ustawiæ ¶cie¿kê do modu³ów w pliku
<filename>Makefile</filename>):
<programlisting>
tar -xzf lm_sensors-2.7.0.tar.gz -C &lt;katalog docelowy&gt;
cd &lt;katalog docelowy&gt;lm_sensors-2.7.0/
make all
make install
</programlisting>
</para>
<para>
Mo¿e siê zdarzyæ, ¿e mimo braku komunikatów o b³êdach modu³y nie zostan± 
poprawnie zainstalowane. Warto wiêc sprawdziæ, czy w katalogu z modu³ami i2c 
(a wiêc np. <filename>/lib/modules/2.4.18-3/kernel/drivers/i2c</filename>) 
znajduj± siê uaktualnione wersje modu³ów. Je¶li nie, nale¿y rêcznie
przekopiowaæ wszystkie pliki z rozszerzeniem <filename>.o</filename> z
podkatalogów <filename>kernel</filename>, <filename>kernel/busses</filename> i
<filename>kernek/chips</filename> katalogów ze ¼ród³ami i2c i lm-sensors.
</para>
<para>
Mo¿na teraz uaktualniæ zale¿no¶ci modu³ów i utworzyæ nowy obraz modu³ów j±dra
(w RH 7.3) przez wydanie jako root komend:
<programlisting>
depmod -a
cd /boot
mv initrd-`uname -r`.img initrd-`uname -r`.img.bak
mkinitrd initrd-`uname -r`.img `uname -r`
</programlisting>
Po tym nale¿y prze³adowaæ system.
</para>
<para>
Po starcie systemu uruchamiamy jako root program
<command>sensors-detect</command>, który powinien nam siê zainstalowaæ podczas
instalacji lm_sensors. Na wszystkie 
pytanie odpowiadamy naciskaj±c ENTER (domy¶lna odpowied¼). Je¿eli w trakcie
dzia³ania skrypt wykryje jakie¶ czujniki w systemie (Success!) to dobrze, 
w przeciwnym razie to znaczy, ¿e albo mamy nieobs³ugiwanego chipa, albo w ogóle nie
mamy chipów-czujników na p³ycie (bo jest na przyk³ad za stara), albo 
nie zainstalowali¶my poprawnie modu³ów i2c. W tym przypadku skrypt krzyczy,
¿e nie mo¿e za³adowaæ modu³ów i2c-*. Wtedy musimy zacz±æ czytaæ README do i2c, 
powinno pomóc. Przyk³adowo - pomocnym dzia³aniem mo¿e byæ rêczne za³adowanie 
modu³u <filename>i2c-core</filename>:
<programlisting>
insmod i2c-core
</programlisting>
Po tej operacji nale¿y jeszcze raz spróbowaæ uruchomiæ <command>sensors-detect</>. 
Skrypt <command>sensors-detect</> na samym koñcu wy¶wietli
nam informacje wpisów, które powinni¶my dodaæ do <filename>/etc/modules.conf</> 
oraz które modu³y powinni¶my za³adowaæ w skryptach startowych w 
<filename>/etc/rc.d</>. 
</para>
<para>
Uwaga! Przed uruchomieniem programu, albo w przypadku, gdy czujniki nie s±
wykrywane <command>sensors-detect</command>,
warto siê dowiedzieæ jakie chipy s± zainstalowane na danej p³ycie -
dobrym punktem startu jest serwis:
<ulink url="http://mbm.livewiredev.com/mobolist.html"
>http://mbm.livewiredev.com/mobolist.html</ulink>
</para>
<para>
Wpis do <filename>/etc/modules.conf</filename> dodajemy, natomiast ³adowanie
odpowiednich modu³ów mo¿emy zostawiæ skryptowi lm_sensors.init - nale¿y go
skopiowaæ do <filename>/etc/rc.d/init.d/lm_sensors</filename> i dodaæ do us³ug
uruchamianych podczas startu systemu. Po tych operacjach znów prze³adowujemy
system.
</para>
<para>Teraz uruchamiamy program <filename>sensors</>. 
Powinien wy¶wietliæ na
ekranie jakie¶ warto¶ci. Je¿eli nie wy¶wietli zupe³nie nic  
a skrypt <command>sensors-detect</> wykry³ uprzednio jakie¶ chipy, to oznacza,
¿e prawdopodobnie niepoprawnie zainstalowa³ siê pakiet lm_sensors.
W tym przypadku nale¿y go przekompilowaæ (poprzedni punkt) i spróbowaæ
powtórnie. Je¶li wszystko posz³o dobrze, program wypisze nam informacje o
wykrytych czujnikach i pokazywanych przez nie warto¶ciach.
Zdarza siê tak¿e, ¿e program <command>sensors</command> nie dzia³a (SIGSEGV),
ale nie przeszkadza to w dzia³aniu np. demona mondo. W takiej sytuacji trudno
jest jednak zweryfikowaæ, ¿e czujniki w ogóle dzia³aj±.
</para>
<para>
Wraz z pakietem dostarczana jest tak¿e biblioteka <command>libsensors</command>,
która umo¿liwia sprawdzanie stanu czujników z poziomu jêz. C.
</para>
<para>
Nastêpnie nale¿y przejrzeæ i ewentualnie poddaæ edycji plik konfiguracyjny
<filename>/etc/sensors.conf</filename> (nie jest to konieczne je¿eli bêdziemy
korzystali z <emphasis>mondo</emphasis> - zobacz dalej).
Zawiera one dane dotycz±ce czujników, 
które chcemy
obserwowaæ i dozwolonych warto¶ci dla obserwowanych parametrów. Dla ka¿dego
czujnika jest oddzielna sekcja (rodzaj czujnika jest wypisywany przez program
<filename>sensors</filename>). Po znalezieniu odpowiedniej sekcji mo¿emy
pozmieniaæ parametry. Zwykle bêdziemy chcieli ignorowaæ warto¶ci napiêæ
zasilaj±cych. Mo¿na to osi±gn±æ przez dodanie wpisów:
<programlisting>
	ignore in0
	ignore in1
	ignore in2
	...
</programlisting>
Podobnie mo¿emy zignorowaæ niepod³±czone lub niedzia³aj±ce prawid³owo czujniki
obrotów i temperatury:
<programlisting>
	ignore fan1
	ignore fan3
	ignore temp3
	...
</programlisting>
Aby zmiany w konfiguracji zosta³y uwzglêdnione, nale¿y wywo³aæ program sensors z
parametrem:
<programlisting>
sensors -s
</programlisting>
</para>
<para>
Je¿eli chcemy zmieniaæ dozwolone warto¶ci parametrów, to tak¿e dobrze jest
zrestartowaæ ca³e lm_sensors przez wydanie komend:
<programlisting>
service lm_sensors stop
service lm_sensors start
sensors -s
</programlisting>
Plik zmieniamy dopóki program <filename>sensors</filename> uruchamiany bez
parametrów nie wy¶wietli nam prawid³owych informacji o interesuj±cych nas
parametrach. Wiêcej informacji mo¿na znale¼æ na stronach manuala dla
<emphasis>sensors</emphasis> i <emphasis>sensors.conf</emphasis>.
</para>
<para>
Standardowa instalacja pakietu lm_sensors pozwala w³a¶ciwie tylko na interaktywne 
odpytywanie o warto¶ci parametrów oraz na zbieranie danych na dysku
przez demona <filename>sensord</filename>, kompilacja którego wymaga jednak
doci±gniêcia dodatkowych bibliotek.
Lepszym rozwi±zaniem jest wiêc skorzystanie z demona
<emphasis>mondo</emphasis>.
</para>
<para>
Mondo mo¿na ¶ci±gn±æ z <ulink url="http://mondo-daemon.sourceforge.net/download.html">
http://mondo-daemon.sourceforge.net</ulink>. Dostêpna jest wersja
RPM, niestety na RH 7.3 nie chce ona dzia³aæ, wobec tego lepiej jest ¶ci±gn±æ i
skompilowaæ ¼ród³a:
<programlisting>
tar xzf mondo-0.9.tar.gz
cd mondo-0.9
./configure --prefix=/usr --sysconfdir=/etc
make
make install
</programlisting>
Kolejnym krokiem jest utworzenie pliku konfiguracyjnego dla mondo. W tym celu
nale¿y uruchomiæ program <filename>mondo-setup</filename>, który wygeneruje
przyk³adowy plik konfiguracyjny. Standardowo program ten przez 2 godziny
obserwuje zachowanie komputera. Je¿eli nie mamy tyle czasu, nale¿y go zmusiæ do
pracy przez krótszy czas (np. 10 minut) przez wydanie komendy:
<programlisting>
mondo-setup -t 10 -s /etc/sensors.conf -o /etc/mondo.conf
</programlisting>
Przez czas dzia³ania programu mo¿na pograæ w jak±¶ zajmuj±c± du¿o zasobów
gierkê, np. <emphasis>chromium</emphasis>. Po zakoñczeniu pomiarów nale¿y
przejrzeæ plik <filename>/etc/mondo.conf</filename>. 
Parametr <emphasis>DELAY</emphasis> opisuje czas (w milisekundach), co jaki
sprawdzane s± czujniki. Nastêpnie nastêpuj± sekcje
opisuj±ce poszczególne obserwowane urz±dzenia i czujniki. Je¶li s± tu jakie¶
czujniki, których nie rozpoznajemy, nale¿y je po prostu usun±æ. Przyk³adowa
sekcja mo¿e mieæ postaæ:
<programlisting>
"w83627hf-isa-290:Processor FAN" {
	ABOVE 3096.00 "halt -fp"
	BELOW 3000.00 "halt -fp"
}
</programlisting>
Opisuje ona górny i dolny limit obrotów wentylatora na procesorze.
Przekroczenie którejkolwiek warto¶ci spowoduje wykonanie zdefiniowanej komendy,
w tym przypadku natychmiastowe wy³±czenie komputera. Dla danego czujnika mo¿e
byæ zdefiniowanych kilka linii <emphasis>ABOVE</emphasis> lub
<emphasis>BELOW</emphasis>, wykonane bêd± wszystkie dla których przekroczone
zostan± limity.
</para>
<para>
Nale¿y zwróciæ uwagê, ¿e domy¶lnie ustalone przez program
<filename>mondo-setup</filename> limity s± bardzo restrykcyjne i powinny zostaæ
zwiêkszone - w innym przypadku grozi ci±g³e podnoszenie alarmu.
</para>
<para>
W przypadku innego typu akcji, np. wysy³ania maili, niewskazane by³oby wysy³anie
ich co zadany czas sprawdzania czujników (domy¶lnie 4 sekundy). W zwi±zku z tym
mo¿na ustawiæ (globalnie lub dla konkretnej sekcji) dwie opcje: 
<programlisting>
GRACE &lt;clicks&gt;
THROTTLE &lt;clicks&gt;
</programlisting>
Pierwsza z nich mówi, ile razy alarm dla czujnika powinien byæ ignorowany.
Je¶li ustawimy j± na 5, a <emphasis>DELAY</emphasis> na standardowe 4000, to
alarm zostanie podniesiony dopiero po 20 sekundach. Je¿eli w tym czasie
obserwowany parametr powróci do akceptowanego stanu, alarm nie zostanie
podniesiony. Druga opcja - <emphasis>THROTTLE</emphasis> okre¶la, co ile
sprawdzeñ bêdzie wykonywana komenda przypisana do alarmu je¿eli parametr bêdzie
ca³y czas przekracza³ dopuszczalne warto¶ci. Np. ustawienie
<emphasis>THROTTLE</emphasis> na 450 spowoduje, ¿e akcja bêdzie wykonywana co
30 minut. Poni¿szy fragment pliku opisuje konfiguracjê, gdy w przypadku
przekroczenia temperatury 45 stopni wysy³any jest mail (co godzinê), a po
przekroczeniu 55 stopni system jest zamykany:
<programlisting>

DELAY 4000

"w83627hf-isa-290:temp1" {
	GRACE 2
	THROTTLE 900
	ABOVE 45.00 "echo 'Temperatura przekroczyla 45 stopni' \
		| mail -s 'Uwaga!' root@admin"
	ABOVE 55.00 "halt -fp"
}
</programlisting>
</para>
<para>
Przekroczenie stanów alarmowych jest tak¿e zapisywane w logach systemu. Po
przetestowaniu dzia³ania mo¿na dodaæ mondo do us³ug uruchamianych przy starcie
systemu (odpowiedni plik <filename>/etc/rc.d/init.d/mondo</filename> jest
tworzony przy instalacji programu). Uwaga: wpisanie zbyt restrykcyjnych
warto¶ci w pliku konfiguracyjnym mo¿e doprowadziæ do sytuacji, gdy komputer
bêdzie siê wy³±cza³ zaraz po starcie!
</para>
<para>Poniewa¿ plik konfiguracyjny mondo nie
respektuje limitów ustawionych w <filename>/etc/sensors.conf</filename>, wiêc
je¿eli lm_sensors bêd± u¿ywane tylko dla potrzeb mondo, mo¿na darowaæ sobie
edycjê pliku <filename>/etc/sensors.conf</filename>.
</para>

</section>


<section id="mirroring">
<title>Konfiguracja mirroringu - RAID-1</title>
<para>
Do obs³ugi macierzy s³u¿± programy z pakietu raidtools. Najlepiej jednak
(najpro¶ciej) zainstalowaæ macierz podczas instalacji RedHata. Oto krótki
opis jak to zrobiæ (RAID-1 z dwoma dyskami):
</para>

<itemizedlist>

<listitem>
<para>
Stworzyæ nastêpuj±cy uk³ad partycji:

<programlisting>
/dev/hda1 Linux RAID 3000M
/dev/hda5 Swap 256
/dev/hda6 DOS 256
/dev/hda7 Linux RAID reszta
</programlisting>

Takie same partycje nale¿y utworzyæ na drugim dysku (np. /dev/hdc).
</para>
</listitem>

<listitem>
<para>
Wybraæ opcjê "Make RAID Device".
</para>

<para>
Nale¿y tu po³±czyæ partycje /dev/hda(c)1 i /dev/hda(c)7 jak pokazano poni¿ej:

<programlisting>
/dev/md0 - /dev/hda1 + /dev/hdc1 - /
/dev/md1 - /dev/hda7 + /dev/hdc7 - /opt
</programlisting>

Oba s± typu RAID-1. W tej konfiguracji mamy po jednym swapie na ka¿dy dysk
(oba s± wykorzystane).
</para>
</listitem>

<listitem>
<para>
Zainstalowaæ w normalny sposób system.
</para>
</listitem>

<listitem>
<para>
Po resecie nie uruchomi siê Linux, poniewa¿ program instalacyjny ustawi³ w
<filename>/etc/lilo.conf</filename>, ¿e root to <filename>/dev/md0</filename>, a to nie zadzia³a. 
Trzeba jeszcze raz odpaliæ program instalacyjny RedHata z p³ytki, po starcie X nacisn±æ Ctrl-Alt-F2.
</para>

<para>
Nastêpnie wykonaæ komendy:

<programlisting>
mkdir /mnt2
mknod /dev/hda1 b 22 1
mount /dev/hda1 /mnt2
mv /mnt2/etc/lilo.conf /mnt2/etc/lilo.conf.old
cat /mnt2/etc/lilo.conf.old | sed -e "s/md0/hda1/" &gt; /mnt2/etc/lilo.conf
/mnt2/sbin/lilo -r /mnt2
</programlisting>
</para>
</listitem>

<listitem>
<para>
Mamy stworzon± macierz dyskow± z software'owym mirroringiem. Dane s±
równolegle zapisywane na dwa dyski, o synchronizacjê dba proces mdrecovery.
W pliku <filename>/proc/mdstat</filename> znajduje siê aktualny stan macierzy. Z niego mo¿na siê
dowiedzieæ o awarii.

Niestety w wersji 6.2 
<!-- TODO: a co z wersjami 7.x, 8.x, 9.x?) -->
nie jest zbyt wygodne naprawienie macierzy dyskowej po
awarii jednego z dysków. Co gorsza system nie zareaguje w specjalnie
widoczny sposób w tej sytuacji. Plik <filename>/proc/mdstat</filename> poka¿e, 
które dyski dzia³aj±, a które nie. Dysk awaryjny zostanie wy³±czony z macierzy.
Poni¿ej pokazano przyk³adowy wynik wydania komendy <command>cat /proc/mdstat</command>
(uwaga - przyk³ad jest dla innej konfiguracji ni¿ opisana powy¿ej):

<programlisting>
<![CDATA[
Personalities : [raid1]
read_ahead 1024 sectors
md0 : active raid1 sdb1[1]
      1052160 blocks [2/1] [_U]

md1 : active raid1 sdb2[1]
      5245120 blocks [2/1] [_U]

md2 : active raid1 sdb5[1] sda5[0]
      2096384 blocks [2/2] [UU]

md4 : active raid1 sdb6[1]
      1052160 blocks [2/1] [_U]

md3 : active raid1 sdb7[1]
      1052160 blocks [2/1] [_U]

md5 : active raid1 sdb8[1]
      25053248 blocks [2/1] [_U]

unused devices: <none>
]]>
</programlisting>

<quote>U</quote> (czyli <emphasis>up</emphasis>) oznacza, ¿e dysk dzia³a w macierzy. 
<quote>_</quote> oznacza, ¿e dysk jest wy³±czony lub go brakuje w macierzy.
</para>

<para>
Na przyk³adzie powy¿ej widaæ, ¿e tylko jedna partycja w macierzy ma dzia³aj±ce oba dyski 
([2/2] [UU]) - partycja md2 (sk³adaj±ca siê z partycji sdb5 i sda5). Reszta partycji macierzowych
ma tylko 1 dysk ([2/1] [_U]).

Co zrobiæ, by zainstalowaæ nowy dysk? Nale¿y go sformatowaæ w ten sam
sposób (utworzyæ te same partycje), co istniej±cy dysk. Powinien to byæ dysk o takim samym
rozmiarze, ale w przypadku trudno¶ci ze znalezieniem dysku o takiej samej
pojemno¶ci mo¿na w³o¿yæ wiêkszy, wolny obszar mo¿na przeznaczyæ na dodatkow±
partycjê, która powinna siê jednak znajdowaæ na koñcu (np. <filename>/dev/hdc9</filename>).
</para>
<para>
Po odpowiednim podzieleniu dysku na partycji i sformatowaniu go nale¿y wydaæ nastêpuj±ce
komendy (dodaj±ce do macierzy drugi dysk):

<programlisting>
raidhotadd /dev/md0 /dev/hdc1
raidhotadd /dev/md5 /dev/hdc7
</programlisting>
</para>

<para>
W tle (w wolnym czasie procesora) rozpocznie siê proces synchronizacji dysku
z macierz±. Nie nast±pi to od razu, ale po jakim¶ czasie (do kilku godzin
przy s³abo obci±¿onym systemie). Proces wykonuje siê ca³kowicie
przezroczy¶cie, nie koliduje to w ¿aden sposób z zapisami i odczytami z
macierzy. W pliku <filename>/proc/mdstat</filename> pokazywany jest aktualny stan 
synchronizacji wraz z przewidywanym czasem zakoñczenia (finish). Poni¿ej
pokazany jest wynik komendy <command>cat /proc/mdstat</command> po wywo³aniu
polecenia <command>raidhotadd /dev/md0 /dev/sda1</command>:

<programlisting>
<![CDATA[
Personalities : [raid1]
read_ahead 1024 sectors
md0 : active raid1 sda1[2] sdb1[1]
      1052160 blocks [2/1] [_U]
      [===>.................]  recovery = 18.0% (190500/1052160) finish=1.3min s
peed=10583K/sec
md1 : active raid1 sdb2[1]
      5245120 blocks [2/1] [_U]

md2 : active raid1 sdb5[1] sda5[0]
      2096384 blocks [2/2] [UU]

md4 : active raid1 sdb6[1]
      1052160 blocks [2/1] [_U]

md3 : active raid1 sdb7[1]
      1052160 blocks [2/1] [_U]

md5 : active raid1 sdb8[1]
      25053248 blocks [2/1] [_U]

unused devices: <none>
]]>
</programlisting>
</para>
</listitem>

</itemizedlist>
<para>
Uwaga! Nie wolno robiæ ¿adnych modyfikacji tablicy partycji, kiedy pracuje na nich
aktywna macierz. Aby zmieniæ uk³ad dysku, nale¿y zatrzymaæ obie macierze
(komend± raidstop). W konfiguracji, któr± pokaza³em powy¿ej system znajduje
siê na aktywnym urz±dzeniu <filename>/dev/md0</filename>, trzeba zatem oba dyski w³o¿yæ do
oddzielnego systemu z Linuksem i wtedy przeprowadzaæ modyfikacje. Zmiany
nale¿y uwzglêdniæ w plikach <filename>/etc/raidtab</filename> na obu dyskach.
</para>
</section>

<section id="konfiguracjaspec">
<title>Konfiguracja Specialixa</title>

<para>
<itemizedlist>

<listitem>
	<para>
		Modu³ do obs³ugi Specialixa nazywa siê <emphasis>sx</emphasis> i powinien
		byæ we wszystkich aktualnych j±drach automatycznie ³adowany przy starcie
		systemu (po wykryciu urz±dzenia). Z jaki¶ wzglêdów modu³ ten nie jest obecny
		przynajmniej w niektórych wersjach j±der SMP (dla systemów wieloprocesorowych).
	</para>
</listitem>

<listitem>
	<para>
		Do dzia³ania karty potrzebny jest jeszcze firmware oraz program ³aduj±cy
		ten firmware - <application>sxboot</application>. Instalacjê najpro¶ciej 
		przeprowadziæ ¶ci±gaj±c paczkê
		<emphasis>sx-base</emphasis> dostêpn± w repozytorium APT firmy Praterm. W paczce
		znajduje siê tak¿e program <application>sxmkdev</application>, tworz±cy nazwy 
		urz±dzeñ (uwaga - nie dzia³a to dla udev'a). W razie potrzeby program ten mo¿na
		zast±piæ nastêpuj±cym skryptem:

<programlisting>
#!/bin/sh
cd /dev
t=0
mknod specialix_sxctl c 10 167
while [ $t -lt 64 ]
do
echo -n "$t "
mknod ttyX$t c 32 $t
mknod cux$t c 33 $t
t=`expr $t + 1`
done
echo ""
rm /etc/psdevtab
ps &gt; /dev/null
</programlisting>
</para></listitem>
</itemizedlist>
</para>

</section>
<section id="moxa">
<title>Konfiguracja Moxy</title>
<para>
Instalacja karty pod
RedHat'em polega na uruchomieniu programu instalacyjnego, który sam kompiluje
modu³y do j±dra, instaluje je, tworzy urz±dzenia: dla C320Turbo
<filename>/dev/ttyAnn</filename>, dla C168H <filename>/dev/ttyMn</filename> i <filename>/dev/cumn</filename> i ustawia odpowiednie linki w /etc/rc.d/ (do
automatycznego startu podczas ³adowania systemu - tylko w C320Turbo; w C168H trzeba to zrobiæ rêcznie). Oprócz driver'ów,
oprogramowanie C320Turbo zawiera program diagnostyczny <filename>mxdiag</filename>, emulator terminala
<filename>mxterm</filename>, monitor transmisji na portach <filename>mxmon</filename>. Programem <filename>mxdiag</filename> mo¿na sprawdziæ
stan Moxy. Dla C168H s± to odpowiednio: <filename>msdiag</filename>, <filename>msterm</filename> i <filename>msmon</filename>. Ca³o¶æ nie przedstawia problemu i jest doskonale udokumentowana,
do dystrybucji do³±czony jest opis, który krok po kroku opisuje komendy
jakie trzeba wykonaæ. Jedynym odstêpstwem w stosunku do dokumentacji, które nale¿y wykonaæ, jest wstawienie do <filename>rc.local</filename> opó¼nienia po wywo³aniu driverów moxy po to, ¿eby modu³y zd±¿y³y siê za³adowaæ przed uruchomieniem <filename>S99parstart</filename>. Najpro¶ciej na koñcu <filename>rc.sysinit</filename> bezpo¶rednio wywo³aæ <filename>rc.moxa</filename> lub <filename>rc.mxser</filename>:
<programlisting>
/etc/rc.d/rc.moxa
/bin/sleep 3
</programlisting>
</para>
<para>
S³ów parê nale¿y jeszcze powiedzieæ o konwencji nazewnictwa urz±dzeñ Moxy. Dla serii C320Turbo jest to
<filename>/dev/ttyAxy</filename>, dla C168/H jest to <filename>/dev/ttyMx</filename>. Jest trochê odmienne podej¶cie ni¿ w
Specialixie. Do karty C320Turbo mo¿na pod³±czyæ kilka paneli po 8 portów,
<filename>x</filename> oznacza numer panelu, <filename>y</filename> oznacza
numer portu w panelu. W przypadku C168H <filename>x</filename> oznacza numer portu od 0 do 7. Nale¿y wiêc przypisaæ odpowiednie nazwy urz±dzeñ do
pod³±czonych sterowników w pliku
<filename>/opt/szarp/&lt;prefix&gt;config/parcook.cfg</filename>.
</para>
<para>
W przypadku instalowania karty C320Turbo w komputerze z zainstalowan± 
dystrybucj± <emphasis>SZARP DEBIAN</emphasis> sprawa jest jeszcze prostsza - 
wystarczy zainstalowaæ pakiety <emphasis>moxa-base</emphasis> i
<emphasis>moxa-utils</emphasis> z p³ytki instalacyjnej dystrybucji. Skrypty
konfiguracyjne zadbaj± o ³adowanie sterownika przy starcie systemu a tak¿e
utworz± odpowiednie urz±dzenia.
</para>
</section>


<section id="ip-alias">
<title>Przypisywanie wielu adresów IP jednej karcie sieciowej. Aliasy IP</title><para>
W rozdziale niniejszym opisane s± sposoby przypisywania wielu adresów
IP do jednej samej karty sieciowej. Dodatkowe adresy zwane s± niekiedy
<emphasis>aliasami IP</emphasis>.
</para>

<para>
<!--Tworzenie aliasów mo¿liwe jest dlatego, ¿e w jednej sieci Ethernet 
urz±dzenia identyfikowane s± przez adresy kart sieciowych 
(tzw. adres MAC), które s± niezale¿ne od adresów warstw wy¿szych (IP). 
Adres IP jest wiêc z punktu widzenia warstwy MAC 
adresem <quote>wirtualnym</quote>.-->
W warstwie IP mo¿liwe jest ustawienie wiêcej ni¿ jednego 
adresu z wiêcej ni¿ jednej podsieci IP. 
Na przyk³ad mo¿liwe jest wspó³istnienie w 
jednej fizycznie sieci Ethernet kilku sieci IP: 192.168.1.0, 192.9.200.0 itd. 
Je¿eli dane hosty s± od sieci publicznej oddzielone routerem, 
mo¿liwe jest równie¿ wspó³dzielenie przez hosty adresu publicznego 
i prywatnego zarazem.

<section id="ip-alias-redhat">
<title>Systemy RedHat, Mandake, Fedora i Aurox</title>
<para>
Dodanie kolejnego adresu IP (aliasu IP) w systemach pochodnych od RedHata
mo¿na wykonaæ rêcznie wywo³uj±c nastêpuj±ce komendy (adresy IP s± tu
przyk³adowe):

<programlisting>
ifconfig eth0:0 213.186.95.70 netmask 255.255.255.248
route add default gw 213.186.95.65
</programlisting>
Pierwsza komenda dodaje alias, druga ustawia domy¶ln± bramkê 
dla naszego hosta.
</para>

<para>
Je¿eli chcieliby¶my ustawiæ alias IP (ustawienia jak wy¿ej) w systemie
na sta³e, to musimy wykonaæ nastêpuj±ce operacje:
<itemizedlist>
<listitem><para>
Kopiujemy plik <filename>/etc/sysconfig/network-scripts/ifcfg-eth0</filename> 
do <filename>/etc/sysconfig/network-scripts/ifcfg-eth0:0</filename>
</para></listitem>
<listitem><para>
W pliku <filename>/etc/sysconfig/network-scripts/ifcfg-eth0:0</filename>
zmieniamy warto¶æ zmiennych: DEVICE z eth0 na eth0:0, IPADDR ustawiamy jako
213.186.95.70 oraz NETMASK jako 255.255.255.248.
</para></listitem>
<listitem><para>
W pliku <filename>/etc/sysconfig/network</filename> dopisujemy liniê:
<programlisting>
GATEWAY=213.186.95.65
</programlisting>
</para></listitem>
</itemizedlist>
Testujemy czy dzia³a. Prze³adowujemy sieæ 
<filename>/etc/rc.d/init.d/network restart</filename>, a nastêpnie wywo³ujemy 
komendê <command>ifconfig</command> i sprawdzamy czy 
obecne jest urz±dzenie eth0:0.
</para>
</section> <!-- ip-alias-redhat -->

<section id="ip-alias-debian">
<title>System Debian</title>
<para>
W systemie Debian nale¿y tylko dodaæ odpowiedni interfejs
do pliku <filename>/etc/network/interfaces</filename>
(konfiguracja jak dla przyk³adu powy¿ej):
<programlisting>
iface eth0:0 inet static
address 213.186.95.70
netmask 255.255.255.248
broadcast 213.186.95.71
gateway 213.186.95.65
</programlisting>
Po wprowadzeniu zmian nale¿y sieæ zrestartowaæ, np. wywo³uj±c
komendê <filename>/etc/init.d/networking restart</filename>.
I sprawdziæ programem <command>ifconfig</command> czy nowy
interfejs (urz±dzenie eth0:0) zosta³ dodany. 

</para>
</section> <!-- ip-alias-debian -->

</section> <!-- ip-alias -->

<section id="wlan">
<title>Konfiguracja sieci bezprzewodowych WLAN</title>

<section id="wlan-wstep">
<title>Wstêp</title>

<para>Sieci radiowe WLAN (Wireless Local Area Network) s± coraz popularniejsz±
alternatyw± dla tradycyjnych sieci lokalnych. Umo¿liwiaj± ³±czno¶æ na odleg³o¶æ
od kilkuset metrów nawet do kilku kilometrów (z u¿yciem specjalnej anteny), bez
potrzeby uk³adania kabli, za pomoc± fal radiowych.
</para>
<para>Urz±dzenia dzia³aj± w pa¶mie 2.4 GHz, zgodnie ze standardem IEEE 802.11.
Kolejne wersje tego standardu okre¶laj± coraz wiêksze przepustowo¶ci ³±cza
- wersja 802.11b zapewnia 11Mbit/s, 802.11 g
 22Mbit/s, a obecnie (maj 2006) dopracowywany jest standard 802.11n obs³uguj±cy transfer na poziomie przekraczaj±cym 500 Mbit/s. U¿ywanie wy¿ej wymienionego pasma nie wymaga w wiêkszo¶ci krajów
¶wiata (w tym w Polsce) ¿adnych zezwoleñ i koncesji.
</para>
<para>Mo¿liwa jest zarówno wspó³praca dwóch (lub wiêcej) urz±dzeñ w trybie 
'peer-to-peer', jak i tworzenie sieci z tzw. punktem dostêpowym, czyli
centraln± jednostk±, z któr± ³±cz± siê wszystkie urz±dzenia klienckie, ona za¶
sama czêsto pe³ni funkcjê switch'a ³±cz±cego sieæ radiow± z jak±¶ sieci± "tradycyjn±".
W pierwszym przypadku mamy do czynienia z typem sieci
<emphasis>Ad-Hoc</emphasis>, w drugim z <emphasis>Managed</emphasis> lub
<emphasis>Infrastructure</emphasis> (u¿ywane s± oba okre¶lenia).
</para>
<para>
W ramach u¿ywanej czêstotliwo¶ci wyró¿nianych jest zwykle kilkana¶cie kana³ów,
odpowiadaj±cych konkretnym czêstotliwo¶ciom w ramach ogólnego pasma.
Komunikuj±ce siê urz±dzenia musz± korzystaæ z tego samego kana³u. Mo¿liwe jest
ustawienie go na sta³e przy konfiguracji sieci, wiêkszo¶æ urz±dzeñ potrafi
tak¿e skanowaæ dostêpne czêstotliwo¶ci w poszukiwaniu punktu dostêpowego.
</para>
<para>
Kolejnym wa¿nym parametrem sieci jest jej identyfikator (zwykle okre¶lany
skrótem <emphasis>ESSID</emphasis>) - jest to dowolna nazwa (tekst), która
identyfikuje sieæ - wszystkie komunikuj±ce siê urz±dzenia musz± u¿ywaæ tego
samego identyfikatora (choæ niektóre punkty dostêpowe mo¿na skonfigurowaæ, aby
przyjmowa³y np. identyfikator 'any').
</para>
<para>
Nale¿y zwróciæ uwagê, ¿e (zw³aszcza w po³±czeniu ze skanowaniem kana³ów i
automatycznym uzyskiwaniem identyfikatora sieci) sieæ WLAN jest nara¿ona na
"nieautoryzowane" pod³±czanie siê do niej oraz pods³uchiwanie przesy³anych
danych.
Pewnym zabezpieczeniem mo¿e byæ
stosowanie szyfrowania WEP (Wireless Equivalent Privacy) bêd±cego czê¶ci± 
standardu 802.11, niemniej obecne
wersje uwa¿ane s± za zbyt s³abe, aby zapewniæ bezpieczeñstwo.
Kwestie bezpieczeñstwa sieci WLAN przekraczaj± jednak zakres tego dokumentu, 
wiêcej informacji mo¿na znale¼æ np. w 
<ulink url="http://www.iss.net/wireless/WLAN_FAQ.php">
Wireless LAN Security FAQ</ulink>.
</para>

</section> <!-- wlan-wstep -->


<section id="wlan-linux">
<title>Konfiguracja karty WLAN pod Linuksem</title>

<para>
Karty sieciowe WLAN maj± zwykle postaæ albo kart PCI, albo kart PCMCIA (w
przypadku notebooków), albo modu³ów pod³±czanych przez USB. Wiêkszo¶æ
producentów do³±cza sterowniki tylko dla ró¿nych wersji Windows. Niemniej
wiêkszo¶æ obecnie produkowanych kart mo¿na zmusiæ do wspó³pracy z Linuksem.
</para>
<para>
Producentów i modeli urz±dzeñ jest bardzo du¿o, natomiast wiele urz±dzeñ
opartych jest na tym samym chipsecie (uk³adzie). Sterowniki pisane s± nie dla konkretnych
modeli urz±dzeñ, ale dla poszczególnych chipsetów. St±d te¿ podstawow±
informacj± jak± musimy uzyskaæ o karcie, to na jakim chipsecie jest ona oparta.
Nastêpnie nale¿y ustaliæ, czy dla danego chipsetu istniej± sterowniki pod
Linuksa.
</para>
<para>
Pomocne mog± to byæ nastêpuj±ce strony internetowe:
</para>
<itemizedlist>

<listitem><para>
<ulink url="http://www.hpl.hp.com/personal/Jean_Tourrilhes/Linux/Wireless.html">
Jean Tourrilhes Linux Wireless HOWTO</ulink> - zawiera obszern± listê urz±dzeñ,
wraz z uwagami o ich wspó³pracy z Linuksem.
</para></listitem>

<listitem><para>
<ulink url="http://www.linux-wlan.org">http://www.linux-wlan.org</ulink> -
strona domowa projektu Linux WLAN, w ramach którego rozwijane s± linuksowe 
sterowniki do urz±dzeñ WLAN. W szczególno¶ci na stronie znajduje siê tak¿e link
do podobnej jak wy¿ej listy urz±dzeñ i ich chipsetów wraz z informacj±, czy s±
wspierane przez sterowniki tworzone w ramach projektu.
</para></listitem>

<!-- nieaktualne od 1 grudnia 2003
<listitem><para>
<ulink url="http://www.wireless.org.au/~jhecker/atmeldrv/usbtable.html">
http://www.wireless.org.au/~jhecker/atmeldrv/usbtable.html</ulink> - informacje
o urz±dzeniach z chipsetami Atmel.
</para></listitem>
-->

<!-- link nieaktualny
<listitem><para>
<ulink url="http://ndiswrapper.sourceforge.net/phpwiki/index.php/List">
http://ndiswrapper.sourceforge.net/phpwiki/index.php/List</ulink> - lista urz±dzeñ
wspieranych przez narzêdzie <emphasis>ndiswrapper</emphasis> (zobacz 
<xref linkend="wlan-ndiswrapper">).
</para></listitem>
-->
</itemizedlist>

<para>
W ustaleniu chipsetu karty mog± byæ pomocne polecenia <command>lspci</command> i
<command>lsusb</command> (dla urz±dzeñ USB). Polecenia te wypisuj± informacje
o zainstalowanych w komputerze urz±dzeniach. Szczególnie interesuj±cy mo¿e byæ
identyfikator PCI/USB (w postaci dwóch czterocyfrowych liczb szesnastkowych,
oddzielonych dwukropkiem, np. 8086:1050, gdzie pierwsza liczba jest
identyfikatorem producenta, w tym przyk³adzie jest to Intel, a druga -
konkretnego urz±dzenia). Aby uzyskaæ identyfikator w postaci numerycznej (a
nie tekstowego opisu, wy¶wietlanego w przypadku znanych urz±dzeñ), nale¿y do
wy¿ej wymienionych poleceñ daæ parametr <emphasis>-n</emphasis>.
</para>

<para>
Po ustaleniu chipsetu nale¿y ¶ci±gn±æ odpowiednie sterowniki. Mo¿e siê
zdarzyæ, ¿e sterowniki bêd± od razu obecne w u¿ywanym przez nas j±drze, ale
obecnie raczej trudno na to liczyæ. Je¿eli nie znajdziemy wersji sterowników
przystosowanej dok³adnie do u¿ywanej dystrybucji i j±dra, trzeba ¶ci±gn±æ
najlepiej ¼ród³a sterowników 
(gdy¿ sterowniki maj± postaæ modu³u do j±dra i mo¿e byæ problem z ich u¿yciem z
konkretn± u¿ywan± przez nas wersj± j±dra) i próbowaæ za³adowaæ modu³ zgodnie z
dokumentacj± do³±czon± do sterowników. Ten etap mo¿e ró¿nie wygl±daæ zale¿nie
od konkretnego modelu karty i sterowników. W szczególno¶ci urz±dzenia USB
wymagaj± tak¿e dzia³aj±cego wsparcia dla USB, podobnie jest z PCMCIA. Problemy
zwi±zane z ³adowaniem modu³u najlepiej ¶ledziæ analizuj±c logi, a wiêc plik
<filename>/var/log/messages</filename> (pod RedHat'em) lub
<filename>/var/log/kern.log</filename> (pod Debianem). Na przyk³ad u¿ywaj±c 
sterowników z
projektu linux-wlan nale¿y zwróciæ uwagê, jakie wersje modu³ów s± naprawdê
³adowane - zdarza siê, ¿e niektóre j±dra zawieraj± ju¿ starsze wersje u¿ywanych
sterowników i s± one ³adowane zamiast zainstalowanych przez nas nowych (w takim
przypadku nale¿y nadpisaæ pliki ze starymi wersjami).
</para>
<para>
Oczywi¶cie w przypadku zmian czy dodawania modu³ów warto wykonaæ komendê 
<command>depmod -a</command> (pod Debianem <command>update-modules</command>). 
Zak³adam przy tym, ¿e u¿ywamy do¶æ nowej wersji j±dra (wsparcie dla
urz±dzeñ WLAN pojawi³o siê w j±drach 2.4). W RedHat i dystrybucjach pochodnych
warto utworzyæ alias dla ³adowanego modu³u z nazw± u¿ywanego urz±dzenia
sieciowego, dodaj±c do pliku <filename>/etc/modules.conf</filename> wpis typu:
<programlisting>
alias eth1 8211
</programlisting>
czy
<programlisting>
alias wlan0 prism2_usb
</programlisting>
Umo¿liwi to automatyczne ³adowanie modu³u przez skrypty konfiguruj±ce sieæ.
Pod Debianem modu³ nale¿y dodaæ do pliku <filename>/etc/modules</filename>.
</para>
<para>
Ostatecznym testem na poprawno¶æ za³adowania modu³u powinno byæ uruchomienie
programu <application>iwconfig</application> z pakietu wireless-tools (obecny w
nowszych dystrybucjach, w razie czego nale¿y doinstalowaæ z 
<ulink url="http://www.hpl.hp.com/personal/Jean_Tourrilhes/Linux/Tools.html">
http://www.hpl.hp.com/personal/Jean_Tourrilhes/Linux/Tools.html</ulink>). Program ten jest
podobny do programu <application>ifconfig</application>, pozwala na ustawienie
parametrów dotycz±cych interfejsów bezprzewodowych, a tak¿e wy¶wietla
informacjê o nich. Po wywo³aniu bez parametrów powinien wy¶wietliæ informacjê o
wszystkich dostêpnych interfejsach sieciowych, sprawdzaj±c czy s± to interfejsy
WLAN. Wy¶wietlana przez program informacja mo¿e mieæ np. postaæ:
<programlisting>
lo        no wireless extensions.

wlan0     IEEE 802.11-b  ESSID:"SSID"  Nickname:""
          Mode:Managed  Frequency:2.437GHz  Access Point: 00:02:B3:93:28:9C
          Bit Rate:11Mb/s   Tx-Power:2346 dBm
          Retry min limit:8   RTS thr:off   Fragment thr:off
          Encryption key:off
          Link Quality:32/92  Signal level:-81 dBm  Noise level:-100 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

eth0      no wireless extensions.
</programlisting>
</para>
<para>
Poszczególne parametry mo¿na ustawiæ za pomoc± odpowiednich wywo³añ ifconfig:
<programlisting>
# iwconfig wlan0 essid "MOJ_INDENTYFIKATOR"
# iwconfig wlan0 mode ad-hoc
# iwconfig wlan0 channel 2
</programlisting>
</para>
<para>
Oddzieln± spraw± jest automatyczne uruchamianie interfejsu podczas startu
systemu. Sposób uzyskania tego ró¿ni siê zale¿nie od dystrybucji. Dok³adna
instrukcja opisuj±ca wiêkszo¶æ obecnych dystrybucji jest zawarta w pliku
<filename>DISTRIBUITIONS.txt</filename> 
wchodz±cym w sk³ad pakietu wireless-tools. Dla RedHata w
wersji 7.3 zaleca siê po prostu uruchomienie narzêdzia 
<application>redhat-config-network</application>, które posiada wsparcie dla
urz±dzeñ WLAN. Narzêdzie to dodaje odpowiedni wpis do
<filename>/etc/modules.conf</filename> oraz tworzy odpowiedni plik, np.
<filename>/etc/sysconfig/network-scripts/ifcfg-wlan0</filename> o zawarto¶ci:
<programlisting>
DEVICE=wlan0
BOOTPROTO=static
NETMASK=255.255.255.0
ONBOOT=yes
MODE=Ad-Hoc
ESSID=NAZWA
CHANNEL=2
IPADDR=192.168.2.101
</programlisting>
</para>
<para>
W Debianie interfejs konfiguruje siê w pliku
<filename>/etc/network/interfaces</filename> tak jak ka¿dy inny, z tym ¿e
nale¿y dodaæ wpisy specyficzne dla sieci WLAN. Przyk³adowo ca³a sekcja mo¿e
wygl±daæ nastêpuj±co:
<programlisting>
auto wlan0
iface wlan0 inet static
	address 10.4.0.26
	netmask 255.255.255.0
	wireless-essid IDENTYFIKATOR_SIECI
	wireless-mode Managed
	gateway 10.4.0.1
</programlisting>
</para>

<para>
Do diagnostyki po³±czenia do sieci bezprzewodowej przydatny mo¿e siê okazaæ
program <filename>wavemon</filename>, który mo¿na ¶ci±gn±æ z <ulink
url="http://www.janmorgenstern.de/projects-software.html">http://www.janmorgenstern.de/projects-software.html</ulink>.
Dostarcza on na bie¿±co informacji o poziome sygna³u i szumu dla po³±czenia.
Przydatne mo¿e te¿ byæ narzêdzie <command>iwlist</command> z pakietu
wireless-tools, które potrafi wy¶wietliæ listê widocznych punktów dostêpowych:
<programlisting>
# iwlist wlan0 scanning
wlan0     Scan completed :
          Cell 01 - Address: 00:06:25:BC:88:3B
                    ESSID:"IDENTYFIKATOR_SIECI"
                    Protocol:IEEE 802.11b
                    Mode:Managed
                    Frequency:2.412 GHz (Channel 1)
                    Quality:0/100  Signal level:-47 dBm  Noise level:-256 dBm
                    Encryption key:off
                    Bit Rate:1 Mb/s
                    Bit Rate:2 Mb/s
                    Bit Rate:5.5 Mb/s
                    Bit Rate:11 Mb/s
#
</programlisting>
</para>

</section> <!-- wlan-linux -->

<section id="wlan-ovwl1120pci">
<title>Instalacja i konfiguracja karty OvisLink AirLive 1120PCI</title>

<para>
Radiowa karta sieciowa OvisLink AirLive 1120PCI jest oparta na chipsecie
ADM 8211, koszt karty to ok. 170 z³ netto.
Poza sterownikami powinni¶my mieæ ¼ród³a j±dra oraz 
zainstalowany pakiet wireless-tools w wersji co najmniej 25.
</para>
<para>
Kartê instalujemy w wolnym slocie PCI, pod³±czamy antenê. Sterowniki do 
karty ¶ci±gamy ze strony  
<ulink url="http://list.driverguide.com/list/company2008/index.html">
http://list.driverguide.com/list/company2008/index.html</ulink> - 
¶ci±gamy najnowsz± wersjê pliku <filename>ADM8211_src_WERSJA.tar.gz</filename>,
np. podczas pisania tego rozdzia³u by³a to wersja 105. 
Rozpakowujemy i kompilujemy, czyli wykonujemy kolejno w katalogu z 
plikiem nastêpuj±ce komendy:
<programlisting>
# tar xzf ADM8211_src_105.tgz
# cd ADM8211
# make
</programlisting>
</para>
<para>
Otrzymujemy plik 8211.o, który kopiujemy do katalogu z modu³ami, zale¿nie 
od wersji j±dra powinno to byæ co¶ w stylu:
<programlisting>
# cp 8211.o /lib/modules/2.4.20-9/kernel/drivers/net/wireless
</programlisting>
Wykonujemy komendê:
<programlisting>
# depmod -a
</programlisting>
Komunikatem o b³êdzie nie przejmujemy siê - spowodowany jest on tym, ¿e 
modu³ 8211 nie jest rozprowadzany na licencji GPL.
</para>
<para>
Zak³adam, ¿e mamy ju¿ zwyk³± kartê sieciow± - interfejs eth0 i nasz 
interfejs radiowy ma mieæ nazwê eth1. Poni¿ej opisujê konfiguracjê rêczn±,
mo¿na te¿ skorzystaæ z narzêdzia
<application>redhat-config-network</application>.
</para>
<para>
Do pliku <filename>/etc/modules.conf</filename> dodajemy wpis:
<programlisting>
alias eth1 8211
</programlisting>
</para>
<para>
Nastêpnie tworzymy lub modyfikujemy plik 
<filename>/etc/sysconfig/network-scripts/ifcfg-eth1</filename>:
<programlisting>
DEVICE=eth1
BOOTPROTO=static
NETMASK=255.255.255.0
ONBOOT=yes
MODE=Ad-Hoc
ESSID=NAZWA
CHANNEL=2
IPADDR=192.168.2.101
</programlisting>
Parametry, które mo¿na modyfikowaæ to:
<itemizedlist>
<listitem><para>
<emphasis>DEVICE</emphasis> - nazwa interfejsu (musi byæ zgodna z nazw± 
edytowanego pliku).
</para></listitem>
<listitem><para>
<emphasis>NETMASK</emphasis> i <emphasis>IPADDR</emphasis> - 
maska i adres sieciowy, jak dla zwyk³ej karty 
sieciowej z tym, ¿e adres sieci wireless powinien byæ inny ni¿ innych 
interfejsów komputera.
</para></listitem>
<listitem><para>
<emphasis>MODE</emphasis> - warto¶æ 'Ad-Hoc' jest odpowiednia, je¶li 
mamy kilka komputerów z 
kartami radiowymi komunikuj±cych siê bezpo¶rednio. Je¿eli mamy punkt 
dostêpowy, ustawiamy 'Managed'.
</para></listitem>
<listitem><para>
<emphasis>CHANNEL</emphasis> - okre¶la czêstotliwo¶æ, na jakiej 
bêdzie siê odbywa³a 
komunikacja. Je¶li ustawimy 0, to karta bêdzie skanowaæ dostêpne 
czêstotliwo¶ci w celu wybrania odpowiedniej.
</para></listitem>
<listitem><para>
<emphasis>ESSID</emphasis> - unikalna nazwa identyfikuj±ca sieæ.
</para></listitem>
</itemizedlist>
Inne komputery w sieci musz± mieæ oczywi¶cie inne adresy IP, ale ten sam 
kana³ i t± sam± nazwê sieci. Je¶li chodzi o ewentualn± dalsz± 
konfiguracjê, nasza sieæ radiowa zachowujê siê jak normalny Ethernet.
</para>
<para>
Po dokonaniu zmian w plikach restartujemy sieæ (np. w RH komenda 
<command>service network restart</command>). Polecenie 
<application>ifconfig</application> powinno nam teraz wypisaæ tak¿e 
interfejs eth1 z ustawionym adresem IP. Aby obejrzeæ szczegó³y takie jak 
si³a sygna³u, przepustowo¶æ ³±cza itp., pos³ugujemy siê programem 
<application>iwconfig</application> z pakietu wireless-tools.
</para>

</section> <!-- wlan-ovwl1120pci -->

<section id="wlan-ar5212">
<title>Instalacja kart WLAN opartych na chipsecie Atheros Communications AR5212</title>
<para>
Opis zosta³ przygotowany dla karty Planet WL-8310, ale powinien sprawdziæ siê
dla wszystkich kart z chipem AR5212.
</para>
<para>
Do uruchomienia karty potrzebne s± modu³y dostêpne w pakiecie madwifi.
Mo¿na je pobraæ ze strony: <ulink url="http://madwifi.org/">http://madwifi.org</ulink>
lub w postaci pakietu madwifi-sources z repozytorium Debiana.
Przydatny mo¿e byæ równie¿ pakiet madwifi-tools.
</para>
<para>
W systemie Debian instalacjê modu³u przeprowadza siê wydaj±c polecenie:
<programlisting>
module-assistant a-i madwifi
</programlisting>
Powinny za³adowaæ siê modu³y: wlan, ath_hal, ath_pci i ath_rate_sample.
Mo¿na to sprawdziæ wydaj±c polecenie: <command>lsmod</command>.
Je¿eli nie ma ich na li¶cie, nale¿y za³adowaæ je rêcznie przy pomocy komendy
<command>modprobe</command>. Wystarczy za³adowaæ modu³ ath_pci, reszta powinna
zostaæ za³adowana automatycznie. Po restarcie systemu wszystkie potrzebne modu³y
powinny za³adowaæ siê automatycznie.
</para>
<para>
Konfiguracja karty nie wymaga szczególnych zabiegów. Nale¿y postêpowaæ
zgodnie z instrukcj± w rozdziale: <link linkend="wlan-linux">Konfiguracja
karty WLAN pod Linuksem</link>.
</para>
</section> <!-- wlan-ar5212 -->

<section id="wlan-ndiswrapper">
<title>Konfiguracja kart bezprzewodowych z wykorzystaniem sterowników
Windows</title>

<para>
System Windows posiada do¶æ dobrze wydzielon± warstwê odpowiedzialn± za
komunikacjê z urz±dzeniami sieciowymi, obs³ugiwan± przez API o nazwie
Network Driver Interface Specification (NDIS). Mo¿liwa jest emulacja tej
warstwy pod Linuksem, dziêki czemu mo¿na uruchamiaæ niektóre urz±dzenia,
korzystaj±c ze sterowników przeznaczonych dla systemu Windows. Istnieje kilka
projektów w ramach których powstaje oprogramowanie do emulacji NDIS, jednym z
nich jest <ulink url="http://ndiswrapper.sf.net">ndiswrapper</ulink>. Ten
rozdzia³ opisuje konfiguracjê kart bezprzewodowych z wykorzystaniem
ndiswrappera, opisany sposób zosta³ przetestowany z kartami na chipsecie
Realtek 8180 (uwaga - na niektórych komputerach karta nie dzia³a³a, na innych
ruszy³a) oraz z kart± D-Link DWL-520+ (chipset Texas Instruments ACX 100,
identyfikator PCI 104c:8400). 
<!-- nieaktualne ³±cze
Pe³n± listê kart, które próbowano uruchamiaæ
mo¿na znale¼æ pod adresem
<ulink url="http://ndiswrapper.sourceforge.net/phpwiki/index.php/List">
http://ndiswrapper.sourceforge.net/phpwiki/index.php/List</ulink>.-->
<note>
<para>
Karty na chipsecie TI ACX100, w tym D-Link DWL-520+ dzia³aj± tak¿e na
sterownikach tworzonych w ramach projektu 
<ulink url="http://acx100.sf.net">acx100.sf.net</ulink>.
</para>
</note>
</para>
<para>
Pierwszym elementem jest ¶ci±gniêcie ndiswrappera - narzêdzia i modu³u
odpowiedniego dla u¿ywanego j±dra. Warto tak¿e skorzystaæ z jak najnowszego j±dra
(zbyt stare nie bêd± wspierane przez ndiswrappera lub sprzêt mo¿e nie
dzia³aæ).
</para>
<para>W przypadku Debiana nale¿y upewniæ siê, ¿e mamy pakiet z nag³ówkami
dla u¿ywanego j±dra, a nastêpnie ¶ci±gn±æ narzêdzia i ¼ród³a do modu³ów:
<programlisting>
# apt-get install ndiswrapper-utils ndiswrapper-source wireless-tools
</programlisting>
¦ci±gniêtych zapewne zostanie kilka dodatkowych pakietów, w tym
module-assistant.
</para>
<para>Kolejnym krokiem jest zbudowanie modu³ów, co wykonujemy komend±:
<programlisting>
# module-assistant auto-install ndiswrapper
</programlisting>
Po kompilacji powinni¶my otrzymaæ automatycznie zainstalowane modu³y dla
aktualnie u¿ywanej wersji j±dra. 
</para>
<para>
Kolejnym krokiem jest ustalenie z jakim
urz±dzeniem mamy do czynienia (<command>lspci</command> i <command>lspci
-n</command>), oraz sprawdzenie na li¶cie kart, jakiego drivera powinni¶my
u¿yæ, oraz sk±d go ¶ci±gn±æ. Zwykle dobre efekty uzyskamy korzystaj±c ze
sterowników umieszczonych na p³ycie do³±czonej do karty - mamy przynajmniej
pewno¶æ, ¿e sterowniki bêd± pasowaæ do zakupionej wersji karty. Je¿eli do
wyboru s± sterowniki dla ró¿nych wersji Windows, warto wypróbowaæ te dla
Windows XP, 2000 lub NT (najlepiej w tej kolejno¶ci). Sterowniki mog± mieæ
postaæ archiwum zip (mo¿emy wtedy u¿yæ do rozpakowania programu
<command>unzip</command>), czasami jednak s± dostarczane w postaci pliku
wykonywalnego. Je¿eli próba u¿ycia na tym pliku narzêdzi do rozpakowywania
archiwów zip zawiedzie, mo¿emy byæ zmuszeni do uruchomienia programu pod
Windows, aby wydobyæ interesuj±ce nas pliki.
</para>
<para>
Te interesuj±ce nas pliki to plik z rozszerzeniem <emphasis>INF</emphasis>
(zawiera miêdzy innymi listê w³a¶ciwych plików ze sterownikiem) oraz pliki z
samym sterownikiem, zwykle o rozszerzeniach <emphasis>SYS</emphasis>,
<emphasis>BIN</emphasis> lub <emphasis>DAT</emphasis>. Wszystkie te pliki
powinni¶my umie¶ciæ w jednym katalogu, po czym wywo³aæ komendê instalacji
sterownika, podaj±c jako argument plik <emphasis>INF</emphasis>, np.
<programlisting>
# ndiswrapper -i RTL8180.INF
</programlisting>
Mo¿emy teraz sprawdziæ czy sterownik zainstalowa³ siê poprawnie:
<programlisting>
# ndiswrapper -l
Installed ndis drivers:
net8180 driver present, hardware present
# 
</programlisting>
Powinni¶my otrzymaæ informacjê, jak powy¿ej, o obecno¶ci zarówno sterownika,
jak i obs³ugiwanego sprzêtu.
</para>
<para>
Nastêpny krok to za³adowanie modu³u:
<programlisting>
# modprobe ndiswrapper
</programlisting>
W logach sprawdzamy czy wszystko posz³o poprawnie:
<programlisting>
# tail /var/log/kern.log
Mar 22 12:04:50 btw7 kernel: ndiswrapper version 1.0rc2 loaded (preempt=yes,smp=no)
Mar 22 12:04:50 btw7 kernel: PCI: Found IRQ 9 for device 0000:00:05.0
Mar 22 12:04:50 btw7 kernel: ndiswrapper: using irq 9
Mar 22 12:04:50 btw7 kernel: wlan0: ndiswrapper ethernet device 00:50:fc:d1:05:a4 \ 
using driver net8180
Mar 22 12:04:50 btw7 kernel: wlan0: encryption modes supported: WEP, WPA with TKIP,\  
WPA with AES/CCMP
Mar 22 12:04:50 btw7 kernel: ndiswrapper: driver net8180 (Realtek,10/07/2004, \
5.173.1007.2004) added
</programlisting>
Przyk³adowe komunikaty donosz± o pomy¶lnym wykryciu i zainstalowaniu
sterownika dla karty. Je¿eli na tym etapie napotkamy problemy, to mog± byæ
spowodowane z³± wersj± sterowników (niedostosowan± do sprzêtu), za star±
wersj± j±dra lub po prostu oznaczaæ, ¿e karta nie chce pracowaæ pod kontrol±
ndiswrappera. Je¿eli za¶ wszystko wydaje siê OK, to nale¿y zapewniæ, ¿e modu³
ndiswrapper bêdzie ³adowany przy starcie systemu (w Debianie umieszczamy nazwê
modu³u w pliku <filename>/etc/modules</filename>).
</para>
<para>
Ostatni krok to konfiguracja interfejsu sieciowego (zwykle wlan0). Dokonujemy
tego standardowo za pomoc± narzêdzi <command>ifconfig</command> i 
<command>iwconfig</command> lub w sposób specyficzny dla danej dystrybucji,
np. w Debianie umieszczaj±c w pliku
<filename>/etc/network/interfaces</filename> nastêpuj±ce linie:
<programlisting>
auto wlan0
iface wlan0 inet static
	address 192.168.3.47
	netmask 255.255.255.0
	broadcast 192.168.3.255
	gateway 192.168.3.1
	wireless-essid IDENTYFIKATOR_SIECI
	wireless-mode Managed
	wireless-key restricted KLUCZ_WEP
</programlisting>
Po podaniu komendy <command>ifup wlan0</command> powinni¶my mieæ dzia³aj±c±
sieæ bezprzewodow±. Sprawdzamy to za pomoc± polecenia
<command>iwconfig</command>, które powinno wy¶wietliæ informacje w stylu:
<programlisting>
wlan0     IEEE 802.11b  ESSID:"IDENTYFIKATOR SIECI"
          Mode:Managed  Frequency:2.412 GHz  Access Point: 00:06:25:BC:88:3B
          Bit Rate:11 Mb/s   Tx-Power:20 dBm   Sensitivity=0/3
          RTS thr:2432 B   Fragment thr:2432 B
          Encryption key:off
          Power Management:off
          Link Quality:100/100  Signal level:-53 dBm  Noise level:-256 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0
</programlisting>
Uwaga - interfejs mo¿e nie byæ prawid³owo skonfigurowany dopóki nie znajdzie 
siê w zasiêgu punktu dostêpowego.
</para>
</section> <!-- wlan-ndiswrapper -->

</section> <!-- wlan -->


<section id="point-to-point">
<title>Tworzenie po³±czeñ sieciowych w oparciu 
o protoko³y point-to-point</title>

<para>
Rozdzia³ niniejszy dotyczy zagadnieñ zwi±zanych ³±czeniem siê przy pomocy 
protoko³ów point-to-point z u¿yciem protoko³u PPP. Wykorzystywany tu program
<command>pppd</command> (czyli <quote>demon PPP</quote>) jest najbardziej popularnym 
(czy nie jedynym?) narzêdziem tego typu. Po³±czenia PPP stosowane s± zarówno w klasycznych
modemowych po³±czeniach telefonicznych (dial-up), jak i w przypadku innych metod dostêpu
(xDSL, ISDN, dostêp radiowy).
</para>
<para>
Rozdzia³ nie jest jednolity: opisano tu ró¿ne podej¶cia do konfiguracji demona
<command>pppd</command>. Ich zró¿nicowanie wynika w g³ównej mierze z tego, ¿e program
jest ca³y czas rozwijany, zmieniaj± siê jego opcje i mo¿liwo¶ci.
Obecnie najwygodniejsz± metod± zarz±dzania konfiguracj± i zachowaniem programu 
<command>pppd</command> jest wywo³ywanie go w nastêpuj±cy sposób:
<programlisting>
pppd call &lt;konfiguracja&gt;
</programlisting>
Wywo³anie takie spowoduje rozpoczêcie po³±czenia opisanego w pliku 
<filename>/etc/ppp/peers/&lt;konfiguracja&gt;</filename>.
Zastosowanie tego mechanizmu pozwala wyodrêbniæ czê¶ci wspólne oraz czê¶ci specyficzne dla
ró¿nych po³±czeñ (ma to du¿± wagê szczególnie w dzisiejszych czasach, 
kiedy to jedna maszyna czêsto wykorzystuje wiele ró¿nych metod dostêpu do sieci).
Mechanizm <quote>pppd call</quote> wykorzystano w opisie konfiguracji
po³±czenia z sieci± przez Sferiê (<xref linkend="sferia">) oraz
opisu konfiguracji systemów GPRS (<xref linkend="gprs">).
W systemie Debian standardowo obecna jest nak³adka upraszczaj±ca korzystanie
z tego mechanizmu - skrypty <command>pon</command> i <command>poff</command>:
pierwszy z nich rozpoczyna po³±czenie i wywo³ywany jest nastêpuj±co:
<programlisting>
pon &lt;konfiguracja&gt;
</programlisting>
Drugi ze skryptów  po³±czenie zamyka.
</para>

<para>

</para>

<section id="internalmodem">
<title>Instalacja modemu wewnêtrznego PCI z chipem Conexant</title>

<para>
Jak to opisano w rozdziale <xref linkend="modem">, zalecanym rozwi±zaniem dla
Linuksa jest modem zewnêtrzny. Jego instalacja sprowadza siê do pod³±czenia
modemu do komputera. Sprawa komplikuje siê powa¿nie je¿eli mamy do czynienia z
modemem wewnêtrznym, nie bêd±cym "prawdziwym" modemem, a tzw. soft-modemem,
wymagaj±cym wsparcia oprogramowania dzia³aj±cego na komputerze. Wiêkszo¶æ tego
typu urz±dzeñ bêdzie dzia³aæ tylko pod Windows, ale s± chlubne wyj±tki.
</para>
<para>
Nale¿± do nich modemy oparte na uk³adach kanadyjskiej firmy Conexant, takie jak
np. Pentagram Hex2 56I. Modem ma postaæ karty PCI, któr± nale¿y w³o¿yæ w wolny
slot na p³ycie g³ównej. Posiada dwa wyj¶cia na skrêtkê telefoniczn±, do których
w typowy dla modemów sposób pod³±cza siê kabel do gniazdka telefonicznego
(wyj¶cie oznaczone jako LINE) i do telefonu (oznaczenie PHONE).
</para>
<para>
Kolejnym krokiem jest instalacja sterowników. Sterowniki mo¿na znale¼æ na
stronie <ulink url="http://www.linuxant.com/drivers">
http://www.linuxant.com/drivers</ulink>. 
Sterowniki tworzone s± przez firmê Linuksant, nie maj±c± nic wspólnego z
producentem chipsetu, czyli firm± Conexant. St±d te¿ Linuksant, aby zdobyæ
finanse na rozwój sterowników zmieni³ licencjê na czê¶ciowo p³atn±. Wersja
bezp³atna umo¿liwia ³±czenie z prêdko¶ciami do 14400 bps, nie obs³uguje tak¿e
funkcji g³osowych. Aby wykorzystaæ pe³ne mo¿liwo¶ci modemu, nale¿y zakupiæ
licencjê w cenie oko³o 15 $ za jeden modem.
</para>
<para>
Dostêpne s± sterowniki dla dwóch typów modemów - HSF (software modems) i HCF
(controlled modems). Pierwsze z nich s± tañsze, nale¿y do nich np. wspomniany
modem Hex2, do drugiego typu nale¿y np. Pentagram Diablo 56I. Je¿eli nie wiemy,
jakiego typu mamy modem, nie nale¿y siê przejmowaæ tylko spróbowaæ instalowaæ
sterowniki po kolei dla obu typów - je¿eli ¼le trafimy, instalator poinformuje
nas, ¿e mamy modem innego typu. Typ modemu mo¿na tak¿e sprawdziæ za pomoc±
dostêpnego na stronach Linuksant skryptu. Wiêkszo¶æ wspó³czesnych j±der Linuksa
potrafi tak¿e poprawnie zidentyfikowaæ typ modemu. Wywo³anie komendy
<command>lspci</command> dla modemu Hex2 mo¿e daæ w wyniku np. liniê postaci:
<programlisting>
0000:00:08.0 Communication controller: Conexant HSF 56k HSFi Modem (rev 01)
</programlisting>
</para>
<para>
Naj³atwiej jest wybraæ do ¶ci±gniêcia wersjê binarn± sterownika - s± one 
dostêpne dla czê¶ci popularniejszych dystrybucji Linuksa. Nale¿y przy tym zwróciæ
uwagê na wybranie wersji odpowiedniej dla procesora, jaki jest zainstalowany w
komputerze. W szczególno¶ci istnieje oddzielna wersja dla procesorów Athlon -
sterowniki wykorzystuj± specyficzne dla procesorów instrukcje MMX, SSE czy
3DNow!. Sterowniki musz± te¿ byæ dopasowane do konkretnej wersji j±dra (mo¿na
j± sprawdziæ przez wydanie komendy <command>uname -r</command>).
</para>
<para>
Po ¶ci±gniêciu odpowiedniego pakietu RPM (w przypadku RedHata) instalujemy go
przez wydanie komendy <command>rpm -i &lt;nazwapakietu&gt;</command>. Je¿eli
wszystko posz³o dobrze, powinni¶my mieæ skonfigurowany i dzia³aj±cy modem.
Link <filename>/dev/modem</filename> powinien wskazywaæ na urz±dzenie
<filename>/dev/ttySHSF0</filename> lub <filename>/dev/ttySHCF0</filename>
zale¿nie od typu modemu (HSF czy HCF).
</para>
<para>
Pod Debianem nale¿y ¶ci±gn±æ paczkê 'deb' ze ¼ród³ami.
Musimy mieæ zainstalowany pakiet z
plikami nag³ówkowymi j±dra dla aktualnie u¿ywanej wersji j±dra. Przyk³adowo,
je¿eli komenda 'uname -r' wypisuje '2.6-11-1-686', to musimy zainstalowaæ
pakiet kernel-headers-2.6.11-1-686 (od j±dra 2.6.12 jest to pakiet o przyk³adowej nazwie linux-headers-2.6.14-1-686). Nastêpnie za pomoc± komendy 'dpkg -i'
instalujemy ¶ci±gniêt± paczkê ze sterownikami. Skrypt instalacyjny powinien
sam wykryæ katalog z konfiguracj± j±dra, w naszym przyk³adzie by³by to 
<filename>/lib/modules/2.6.11-1-686/build</filename>. Akceptujemy
zaproponowan± lokalizacjê, podajemy swój adres e-mail i klucz licencji (FREE -
chyba, ¿e zakupili¶my wersjê pe³n±).
</para>
<para>
Je¿eli modem nie chce odbieraæ po³±czeñ przychodz±cych, powodem mo¿e byæ z³y
string inicjalizuj±cy wysy³any przez mgetty.
Prawid³owy string inicjalizacyjny mo¿na podaæ albo w pliku
<filename>/etc/mgetty+sendfax/mgetty.config</filename> (w Debianie
<filename>/etc/mgetty/mgetty.config</filename>)  przez dodanie linii:
<programlisting>
<![CDATA[
init-chat "" \dATQ0V1H0[0d] OK ATS0=0Q0&D2&C1 OK AT&K3 OK ATL0 OK
]]>
</programlisting>
albo przez podanie parametru do programu <filename>mgetty</filename> w pliku
<filename>/etc/inittab</filename>. Wówczas odpowiednia linia mo¿e mieæ postaæ:
<programlisting>
<![CDATA[
m:345:respawn:/sbin/mgetty -x 0 -m '"" \dATQ0V1H0[0d] OK ATS0=0Q0&D2&C1 OK AT&K3 OK \
ATL0 OK' /dev/modem
]]>
</programlisting>
(w Debianie zamiast 'm:345' podajemy 'm:23', bo domy¶lny 'runlevel' to 2).
Zobacz te¿ rozdzia³ o konfigurowaniu po³±czeñ przychodz±cych - 
<xref linkend="konfmodemu">.
<note>
<para>
Starsze wersje sterowników Conexanta ¼le wspó³pracowa³y z j±drami z serii 2.6.
Nie mo¿na siê by³o dodzwoniæ do komputera z modemem Conexant
(np. sesja zawiesza³a siê po podaniu nazwy u¿ytkownika). Rozwi±zaniem by³o
uruchomienie na komputerze odbieraj±cym po³±czenia j±dra z serii 2.4.
Nowsze wersje sterowników nie kompiluj± siê w ogóle pod j±drem 2.4 
(przynajmniej te z pakietu .deb), za to pod 2.6 dzia³aj± poprawnie.
</para>
</note>
</para>

</section>

<section id="konfmodemu" >
<title>Konfiguracja modemu do przyjmowania po³±czeñ przychodz±cych</title>

<para>
Ten rozdzia³ zawiera opis konfiguracji modemu do obs³ugi po³±czeñ 
przychodz±cych. Konfiguracja serwera / klienta ppp 
znajduje siê w nastêpnych rozdzia³ach. 
</para>

<para>
Co trzeba zrobiæ? Po kolei:

<itemizedlist>
<listitem>

<para>
pod³±czyæ modem do komputera.
</para>
</listitem>
<listitem>

<para>
Przygotowaæ drugi komputer z dzia³aj±cym modemem i przetestowan± mo¿liwo¶ci±
dzwonienia do ISP (np. do TPSA: 0w202122):
w przypadku komputera z dos'em lub windows'ami powinni¶my mieæ
zainstalowany program term95 (rozprowadzany razem z NC)
lub inny odpowiedni program komunikacyjny.
W przypadku komputera z Linuksem wystarczy nam minicom.
</para>
</listitem>
<listitem>

<para>
Do obu komputerów (modemów) pod³±czyæ centralkê telefoniczn±
(centralka ma 4 numery: 1,2,3,4).
</para>
</listitem>
<listitem>

<para>
Zalogowaæ siê jako root.
</para>
</listitem>

<listitem>
<para>
Zrobiæ linka (o ile jeszcze nie istnieje) z portu, do którego jest pod³±czony modem (/dev/ttyS0 = COM1, /dev/ttyS1 = COM2) do /dev/modem:
<programlisting>
ln -s /dev/ttyS0 /dev/modem
</programlisting>
</para>
</listitem>

<listitem>
<para>
Teraz nale¿y zainstalowaæ program jaki¶ program z rodziny getty 
otwieraj±cy/czuwaj±cy na porcie szeregowym. Tu opisano dwa takie 
programy <command>mgetty</> i <command>uugetty</>.
Najpopularniejszym i polecanym tutaj rozwi±zaniem jest 
<command>mgetty</>.

</para>
<para>
<command>mgetty</>. Jest on prostszy w konfiguracji, powszechnie u¿ywany,
umo¿liwia nawi±zywanie po³±czeñ wychodz±cych w trakcie czuwania
(u¿ywa plików blokuj±cych).
</para>
<itemizedlist>
<listitem><para>
W <filename>/etc/inittab</filename> na koñcu dodaæ liniê:
<programlisting>
m:345:respawn:/sbin/mgetty -x 0 /dev/modem
</programlisting>
lub pod Debianem (który dzia³a domy¶lnie w runlevel'u 2):
<programlisting>
m:23:respawn:/sbin/mgetty -x 0 /dev/modem
</programlisting>
opcja <filename>-x 0</filename> oznacza brak logowania; standardowo <filename>mgetty</filename> zapisuje logi do pliku <filename>/var/log/mgetty.log.modem</filename>; standardowo tych logów jest du¿o, w przypadku wy³±czenia zasilania modemu zewnêtrznego s± znacznie wiêksze - ok. 100kB-300kB dziennie.
</para>
</listitem>

<listitem>
<para>
Teraz uruchamiamy mgetty: 
<programlisting>
	kill -1 1
	ps ax | grep mgetty
</programlisting>
i patrzymy czy jest linia z mgetty. Jak jest to znaczy ¿e dzia³a, je¶li 
nie dzia³a to musieli¶my co¶ pomyliæ (mgetty na prawdê nie wymaga wielkiej
filozofii!)
</para>
</listitem>
</ItemizedList>

<para>
<command>uugetty</command>. Jest standardowo obecny w RedHacie, je¶li go nie ma 
to nale¿y zainstalowaæ go wraz z pakietem <command>getty_ps</>. Wymaga 
dodatkowych plików
konfiguracyjnych, ale mo¿e byæ jeszcze elastyczniej konfigurowalny 
ni¿ mgetty. Pozwala na bezpieczne nawi±zywanie po³±czeñ 
wychodz±cych. Podobnie jak mgetty stosuje standard blokowania UUCP, 
czyli pliki 
<filename>/var/lock/LCK..&lt;nazwa urz±dzenia&gt;</filename>, standard
u¿ywany przez minicoma, kppp oraz pppd (gdy podamy opcjê lock), itp.
Co robimy:
</para>
<itemizedlist>

<listitem><para>
Tworzymy plik <filename>conf.uugetty.modem</> z zawarto¶ci±:
<programlisting>
#ALTLOCK=ttyS0
TIMEOUT=60
INIT="" AT\r OK\r\n
WAITFOR=RING
CONNECT="" ATA\r CONNECT\s\A
DELAY=1
#DEBUG=010
</programlisting>
Pierwsza linia (tu zakomentowana) oznacza, ¿e alternatywn± nazw± dla naszego
urz±dzenia bêdzie ttyS0. Jest to przydatne, gdy zdarza nam siê 
odwo³ywaæ bezpo¶rednio do urz±dzeñ <filename>/dev/ttySx</> 
a niekoniecznie przez linka <filename>/dev/modem</>.
</para></listitem>

<listitem><para>
W <filename>/etc/inittab</filename> na koñcu dodajemy liniê:
<programlisting>
uu:345:respawn:/sbin/uugetty modem
</programlisting>
Uwaga! Jako parametr do uugetty podajemy nazwê urz±dzenia bez poprzedzaj±cego
katalogu <filename>/dev/</filename>. Jest to jedna z ró¿nic miêdzy mgetty
i uugetty.
</para></listitem>

<listitem>
<para>
Teraz niech zadzia³a uugetty: 
<programlisting>
	init q
	ps ax | grep uugetty
</programlisting>
i patrzymy czy jest linia z uugetty. Jak jest to znaczy ¿e dzia³a. Je¶li 
nie to mogli¶my zrobiæ b³±d w pliku konfiguracyjnym albo jest jaki¶
inny problem. Przy usuwaniu problemów pomocny jest parametr DEBUG w pliku 
<filename>/etc/conf.uugetty.&lt;nazwa urz±dzenia&gt;</filename>. Flaga 010
(jak w proponowanym pliku powy¿ej) wystarcza do znalezienia wiêkszo¶ci b³êdów. 
Najmocniejsz± flag± jest 777.
Logi generowane przez uugetty s± przekazywane do sysloga.
</para>
</listitem>

<listitem><para>
<emphasis>Testujemy</emphasis></para>
<para>
Na drugim komputerze uruchomiamy minicoma (dla Linuksa) lub inny program 
(np. dla DOS-a mo¿e to byæ term95) i dzwonimy do naszego komputera:
<programlisting>
minicom
</programlisting>
W przypadku niektórych modemów mog± wystêpowaæ problemy, je¶li na maszynie, na której
uruchomili¶my minicom'a, dzia³a ju¿ mgetty.
Wtedy przed prób± po³±czenia powinni¶my wydaæ w minicomie polecenie:
<programlisting>
atz
</programlisting>
W minicomie nastêpnie wydajemy polecenie:
<programlisting>
atdt"numer"
</programlisting>
gdzie "numer" oznacza 1, 2, 3, lub 4 w zale¿no¶ci od
tego, do którego numeru centralki podpiêli¶my serwer.
</para>
<para>
Po krótkiej chwili (komutacja ³±czy, popiskiwanie modemów) powinni¶my
po stronie klienckiej (dzwoni±cej) dostaæ zg³oszenie siê zdalnego 
systemu (login prompt): login:
Teraz mo¿emy siê zalogowaæ i od tej chwili powinni¶my 
byæ w stanie wydawaæ polecenia. Oznacza to, ¿e wszystko jest O.K.
Mo¿emy ju¿ siê roz³±czyæ (np. komend± exit).
</para></listitem>

</ItemizedList>
</listitem>
</ItemizedList>
</para>
</section>

<section id="pppserver">
<title>Konfiguracja serwera ppp (po³±czenia przychodz±ce)</>
<para>Ten rozdzia³ opisuje sposób konfiguracji serwera ppp.
Zak³ada, ¿e uda³o siê poprawnie skonfigurowaæ modem (np. wed³ug
instrukcji z poprzedniego rozdzia³u). Zak³ada równie¿, ¿e mamy
mo¿liwo¶æ przetestowania po³±czenia (na przyk³ad przy pomocy centralki
telefonicznej - tak jak w poprzednim rozdziale).
</para>
<para>
Co robimy? Po kolei:
<itemizedlist>

<listitem>
<para>
W pliku: <filename>/etc/ppp/options</filename> dla Red Hat'a wpisujemy:
<programlisting>
115200
defaultroute
lock
noauth
/dev/modem
</programlisting>
a dla Debiana:
<programlisting>
asyncmap 0
noauth
crtscts
lock
hide-password
modem
proxyarp
lcp-echo-interval 30
lcp-echo-failure 4
noipx
/dev/modem
defaultroute
replacedefaultroute
</programlisting>

W systemie Red Hat 7.x dla prawid³owego dzia³ania konieczne mo¿e byæ usuniêcie opcji <filename>noauth</filename>. Czasem tak¿e wymagane jest zmniejszenie prêdko¶ci portu z <filename>115200</filename> na <filename>38400</filename>.
Uwaga! Plik <filename>/etc/ppp/options</filename> jest podstawowym 
plikiem konfiguracyjnym dla pppd. Mo¿na tam ustawiaæ wiele ró¿nych
opcji, charakterystycznych dla poszczególnych systemów. 
Na przyk³ad w przypadku modemu GSM Siemens M20 w sieci Era, opisanego 
w rozdziale <xref linkend="modem-gsm">, nale¿a³o dodaæ opcjê:

<Programlisting>
lcp-max-configure 30
</Programlisting>
..ewentualnie mo¿na j± nawet zwiêkszyæ.

</para>
</listitem>

<listitem>
<para>
Tworzymy plik <filename>/etc/ppp/options.server</filename> i wpisujemy w nim:
<programlisting>
-detach
netmask 255.255.254.0
proxyarp
192.168.8.1:192.168.8.8
</programlisting>
Ostatnia linia oznacza numery IP przydzielane po³±czeniu, odpowiednio po
stronie serwera i klienta. Mo¿na ustawiæ je na inne, niekoliduj±ce z numeracj±
innych dostêpnych sieci.
</para>
</listitem>

<listitem>
<para>
Tworzymy plik <filename>/etc/ppp/ppplogin</filename> z zawarto¶ci±:
<programlisting>
#!/bin/bash
mesg n
stty -echo
exec /usr/sbin/pppd file /etc/ppp/options.server -detach modem crtscts
</programlisting>
</para>
</listitem>

<listitem>
<para>
Zmieniamy prawa do pliku <filename>/etc/ppp/ppplogin</filename>
<programlisting>
chmod +x /etc/ppp/ppplogin
</programlisting>
</para>
</listitem>
<listitem>

<para>
Dodajemy u¿ytkownika ppp bez has³a:
<programlisting>
adduser -d /tmp -s /etc/ppp/ppplogin ppp
passwd -d ppp
</programlisting>
Pod Debianem komendy do wpisania s± nieco inne:
<programlisting>
adduser --home /tmp --shell /etc/ppp/ppplogin ppp
passwd -d ppp
</programlisting>
Je¿eli system nie pozwala na logowanie bez has³a przez ³±cze szeregowe, nale¿y
oczywi¶cie ustawiæ jakie¶ has³o, standardowo 'ppp'.
</para>
</listitem>
<listitem>

<para>
Zmieniamy prawa do pliku <filename>/usr/sbin/pppd</filename>:
<programlisting>
chmod +s /usr/sbin/pppd
</programlisting>
Ponadto nale¿y zadbaæ, by u¿ytkownik ppp posiada³ prawo wykonania pliku <filename>/usr/sbin/pppd</filename>. Np. w Debianie mo¿na to osi±gn±æ dodaj±c u¿ytkownika ppp do grupy dip.
</para>
</listitem>
	

<listitem>
<para>
<emphasis>Testujemy</emphasis>
<itemizedlist>
<listitem> 
<para>£±czymy siê za pomoc± minicoma ze zdalnym komputerem
(opis tej procedury znajduje siê w poprzednim rozdziale).
Logujemy siê na u¿ytkownika ppp.
</para>
</listitem>

<listitem>
<para>
Wychodzimy z minicoma bez resetu modemu: Crtl-A Q
</para>
</listitem>

<listitem>

<para>
Nadal na tym samym komputerze uruchamiamy:
<programlisting>
/usr/sbin/pppd -detach lock noauth /dev/modem
</programlisting>
komputery powinny siê po³±czyæ i podaæ ip oraz remote-ip.
</para>
</listitem>
<listitem>

<para>
W przypadku testu przez Internet powinni¶my dodaæ do pliku 
<filename>/etc/resolv.conf</filename> serwery nazw:
<programlisting>
nameserver 194.204.159.1
nameserver 194.204.152.34
</programlisting>

</para>
</listitem>
<listitem>

<para>
Na innej konsoli nale¿y sprawdziæ programem <command>ifconfig</command> 
czy jest zarejestrowany interfejs ppp0. Je¶li po³±czenie PPP zosta³o
nawi±zane, to na wyj¶ciu z programu <command>ifconfig</command> powinna
siê pojawiæ sekcja jak ni¿ej (z dok³adno¶ci± do niektórych warto¶ci
liczbowych):
<programlisting>
ppp0      Link encap:Point-to-Point Protocol
inet addr:192.168.8.8  P-t-P:192.168.8.1  Mask:255.255.255.255
UP POINTOPOINT RUNNING NOARP MULTICAST  MTU:1500  Metric:1
RX packets:5 errors:1 dropped:0 overruns:0 frame:0
TX packets:5 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:30
RX bytes:72 (72.0 b)  TX bytes:78 (78.0 b)
</programlisting>
Uwaga! Zauwa¿my, ¿e adresem IP przydzielonym naszemu hostowi jest 
ten oznaczony jako <quote>inet addr</quote> (na przyk³adzie powy¿ej jest to
192.168.8.8), natomiast adres serwera to <quote>P-t-P</quote>
(tu 192.168.8.1). Naturalnie, je¶li chcemy siê zalogowaæ na hosta 
<quote>po drugiej stronie</quote> to powinni¶my wpisaæ adres 
<quote>P-t-P</quote>.
</para>

</listitem>

<listitem>

<para>
Mo¿emy dodatkowo przetestowaæ czy poprawnie dzia³aj± programy oparte o 
protokó³ TCP:

<programlisting>
	ping &lt;ip-drugiego-komputera&gt;
	telnet &lt;ip-drugiego-komputera&gt;
	
</programlisting>

</para>
</listitem>
</ItemizedList>

</para>
</listitem>
</ItemizedList>

</para>
</section>


<section id="kppp">
<title>Klient ppp (po³±czenia wychodz±ce) przy u¿yciu <command>kppp</></title>

<para>
To jest opis konfiguracji ppp po stronie klienta tak, aby¶my mogli np. ³±czyæ
siê z internetem.
(Warto przeczytaæ tak¿e rozdzia³y <xref linkend="konfmodemu"> i 
<xref linkend="pppserver">).
</para>

<para>

<itemizedlist>
<listitem>

<para>
Upewnij siê, ¿e modem jest dobrze pod³±czony i skonfigurowany. Najlepiej
sprawd¼ to na tym samym komputerze pod innym systemem operacyjnym
(dos, windows). Je¶li na twoim komputerze nie ma innego systemu ni¿
linux, pomiñ ten punkt.

</para>
</listitem>
<listitem>

<para>
W Linuksie porty szeregowe nazywaj± siê inaczej ni¿ w dosie i windowsach:
<programlisting>
com1 = /dev/ttyS0
com2 = /dev/ttyS1
com3 = /dev/ttyS2
com4 = /dev/ttyS3
itd.
</programlisting>

</para>
</listitem>
<listitem>

<para>
Dalej zak³adam, ¿e modem jest pod³±czony do /dev/ttyS1. Je¶li tak nie jest,
zmieñ wszystkie wyst±pienia ttyS1 na odpowiednie inne.

</para>
</listitem>
<listitem>

<para>
Wersja kppp, której ja u¿ywam, wymaga znajomo¶ci przez u¿ytkownika has³a root'a.
Jest to niewygodne (w rzeczywisto¶ci dzwoniæ mo¿e tylko administrator
systemu), ale bezpieczne rozwi±zanie. Starsze wersje nie mia³y tego
ograniczenia. Je¶li twoja wersja kppp pyta ciê o has³o root'a przed
rozpoczêciem dzia³ania, i jest to dla ciebie uci±¿liwe lub
niedopuszczalne rozwi±zanie (bo np. chcia³by¶ daæ mo¿liwo¶æ dzwonienia
innym, ale nie dawaæ im has³a root'a), spróbuj u¿yæ starszej wersji kppp
lub innych podobnych programów, które najprawdopodobniej znajduj± siê
na twoim komputerze: gnome-ppp, rp3. Ja osobi¶cie u¿ywam rp3.
Konfiguracja tych programów jest podobna do kppp i nie bêdê jej
opisywa³.

</para>
</listitem>
<listitem>

<para>
Je¶li u¿ywasz starszej wersji kppp i chcesz, aby mogli z niej korzystaæ
u¿ytkownicy inni ni¿ root, zmieñ prawa (zalogowany jako root):
<programlisting>
chmod a+r+w /dev/modem
chmod a+r+w /dev/ttyS1
chmod +s /usr/sbin/pppd
chmod +s /usr/bin/kppp
</programlisting>

</para>
</listitem>
<listitem>

<para>
Test modemu:
napisz:
<programlisting>
minicom
</programlisting>
Powinien uruchomiæ siê program, napisaæ: Initializing Modem,
i na koñcu ok.
Sprawd¼my czy komunikujemy siê z modemem, napisz:
<programlisting>
at
</programlisting>

powiniene¶ dostaæ odpowied¼ ok.
Je¶li jest inaczej, to albo modem jest  ¼le pod³±czony, albo ¼le
skonfigurowany.
Z programu minicom zadzwonimy do TP SA. 
<itemizedlist>
<listitem>
<para>
Napisz: 
<programlisting>
atdt0w202122
</programlisting>
</para>
</listitem>
<listitem>
<para>
Powiniene¶ us³yszeæ wybieranie numeru i charakterystyczne
piszczenie (oczywi¶cie numer mo¿e byæ zajêty i wtedy operacjê
nale¿a³oby powtórzyæ).
</para>
</listitem>
<listitem>
<para>
Powiniene¶ otrzymaæ prompt Username:
</para>
</listitem>
<listitem>
<para>
Roz³±cz siê: Ctrl + A , X (pomoc Ctrl + A, Z).
</para>
</listitem>
</itemizedlist>

</para>
</listitem>
<listitem>
<para>
kppp jest dostêpne w KDE z menu Internet-&gt;Kppp.
Uruchom je.
</para>
</listitem>
<listitem>

<para>
Skonfiguruj kppp:
<itemizedlist>
<listitem>
<para>
w kppp wybierz Opcje...
pojawi siê nowe okno: Konfiguracja kppp.
</para>
</listitem>
<listitem>
<para>
W oknie Konfiguracja kppp wybierz zak³adkê Po³±czenia i dodaj nowe
po³±czenie: Nowe...
pojawi siê nowe okno: Nowe po³±czenie.
</para>
</listitem>
<listitem>
<para>
W oknie Nowe po³±czenie ustaw:
<itemizedlist>

<listitem>
<para>
zak³adka Dzwonienie:
<programlisting>
nazwa: tpsa
numer telefonu: 0w202122
identyfikacja: oparta na terminalu
zapamiêtaj has³o: tak
Zmiana opcji pppd: w polu Opcja wpisaæ: noauth i nacisn±æ Dodaj
</programlisting>
pozosta³e puste.
</para>
</listitem>

<listitem>
<para>
Zak³adka Adres IP:
<programlisting>
zmienny adres: tak
</programlisting>
pozosta³e puste.
</para>
</listitem>

<listitem>
<para>
Zak³adka DNS:
<programlisting>
lista serwerów: 194.204.159.1
194.204.152.34
</programlisting>
pozosta³e puste.
</para>
</listitem>

<listitem>
<para>
Zak³adka Router:
<programlisting>
domy¶lny router: tak
ustaw IP routera: nie
przypisz domy¶lny routing: tak
</programlisting>
</para>
</listitem>

<listitem>
<para>
Zak³adka Skrypt logowania:
<programlisting>
Expect		Password:ppp
Expect		name:
Send		ppp
Expect		word:
Send		ppp
</programlisting>
</para>
</listitem>

<listitem>
<para>
zak³adka koszty - mo¿na nie wype³niaæ.
</para>
</listitem>

</itemizedlist>
</para>
</listitem>
<listitem>
<para>	
W oknie Konfiguracja kppp ustaw:
<itemizedlist>
<listitem>
<para>
zak³adka Port:
<programlisting>
port szeregowy: /dev/modem
kontrola przep³ywu: CRTSCTS
znak koñca linii: CR/LF
szybko¶æ portu: 115200 (najczê¶ciej, je¶li masz stary
komputer podziel t± warto¶æ przez 2 lub 4)
u¿ywaj pliku blokuj±cego: tak
limit czasu modemu: 60
</programlisting>
</para>
</listitem>
<listitem>
<para>
zak³adka Modem:
<programlisting>
czekaj, gdy zajêty: 0
reszty mo¿na u¿yæ do testowania komunikacji z modemem	
zak³adka PPP:
limit czasu pppd: 30
poka¿ na panelu po po³±czeniu: tak
dzwoñ ponownie po roz³±czeniu: tak
poka¿ czas po³±czenia na pasku zadañ: tak
roz³±cz przy zamkniêciu X-serwera: tak
zakoñcz przy roz³±czeniu: nie
minimalizuj okno w czasie po³±czenia: tak
</programlisting>
</para>
</listitem>
<listitem>
<para>
Pozosta³e zak³adki:</para><para>wg. uznania.
</para>
</listitem>
</itemizedlist>		
Wybierz ok, aby zachowaæ ustawienia.
</para>
</listitem>
<listitem>
<para>
W g³ównym oknie kppp wybierz:
<programlisting>
po³±cz z: tpsa
u¿ytkownik: ppp
has³o: ppp (wy¶wietlane jako gwiazdki)
poka¿ podgl±d: tak
</programlisting>
</para>
</listitem>
<listitem>
<para>
Wybierz: Po³±cz
</para><para>
Powiniene¶ po³±czyæ siê teraz z serwerem TP SA i mieæ dostêp do
internetu.
</para>
</listitem>
<listitem>
<para>
Je¶li co¶ nie zadzia³a, warto poczytaæ pomoc do kppp ( w g³ównym oknie
naci¶nij przycisk Pomoc), lub PPP-HOWTO
(plik: <filename>/usr/doc/HOWTO/PPP-HOWTO</filename>, to jest do¶æ stare HOWTO i
opisuje sposób ³±czenia siê z internetem za pomoc± skryptów.
Czasami takie skrypty s± bardzo wygodne i warto wiedzieæ jak
dzia³aj±).
</para>
</listitem>
</itemizedlist>
</para>
</listitem>

</ItemizedList>

</para>
</section>

<section id="ppp-skrypty">
<title>Klient ppp (po³±czenia wychodz±ce) oparty o skrypty</title>
<para>
Jest to sposób na uruchomienie ppp po stronie klienta równowa¿ny opisanemu 
w rozdziale <xref linkend="kppp">. Skonfigurowanie skryptów w opisany tu
sposób <quote>nie gryzie</quote> siê z konfiguracj± kppp, mog± byæ stosowane
wymiennie. Zak³ada siê, ¿e modem jest poprawnie skonfigurowany 
jako <filename>/dev/modem</filename>.
</para>
<para>
Skrypty s± mniej wygodne i trudniejsze do konfiguracji ni¿ klienci X/KDE,
lecz mog± byæ stosowane w sytuacji padniêtych X-ów, lub niezainstalowanych
klientów X-owych (np. kppp, gppp).
</para>
<para>
¯eby uruchomiæ dialupa ppp, dzwoni±cego za tepsê, nale¿y stworzyæ 3 pliki
(istniej±ce pliki o tych nazwach mo¿na wyrzuciæ lub zbackupowaæ):
<itemizedlist>

<listitem><para>
Plik: <filename>/etc/ppp/ppp-on</> o nastêpuj±cej tre¶ci:

<Programlisting>
<![CDATA[
#!/bin/sh

TELEPHONE=0202122	# The telephone number for the connection
ACCOUNT=ppp		# The account name for logon (as in 'George Burns')
PASSWORD=ppp		# The password for this account (and 'Gracie Allen')
LOCAL_IP=0.0.0.0	# Local IP address if known. Dynamic = 0.0.0.0
REMOTE_IP=0.0.0.0	# Remote IP address if desired. Normally 0.0.0.0
NETMASK=255.255.255.0	# The proper netmask if needed

export TELEPHONE ACCOUNT PASSWORD

DIALER_SCRIPT=/etc/ppp/redialer

exec /usr/sbin/pppd noauth debug lock modem crtscts /dev/modem 57600 \
	asyncmap 20A0000 escape FF kdebug 24 $LOCAL_IP:$REMOTE_IP \
	noipdefault netmask $NETMASK defaultroute connect $DIALER_SCRIPT
]]>
</Programlisting>
</para></listitem>

<listitem><para>

Plik: <filename>/etc/ppp/ppp-off</> o nastêpuj±cej tre¶ci:

<Programlisting>

#!/bin/sh

if [ "$1" = "" ]; then
	DEVICE=ppp0
else
	DEVICE=$1
fi


if [ -r /var/run/$DEVICE.pid ]; then
        kill -INT `cat /var/run/$DEVICE.pid`

        if [ ! "$?" = "0" ]; then
                rm -f /var/run/$DEVICE.pid
                echo "ERROR: Removed stale pid file"
                exit 1
        fi

        echo "PPP link to $DEVICE terminated."
        exit 0
fi

echo "ERROR: PPP link is not active on $DEVICE"
exit 1

</Programlisting>
</para></listitem>

<listitem><para>
Oraz plik: <filename>/etc/ppp/redialer</> o nastêpuj±cej tre¶ci:

<Programlisting>

#!/bin/sh

MAX_ATTEMPTS=20
SLEEP_DELAY=10s

function initialize
{
    chat -v TIMEOUT 3 '' AT 'OK-+++\c-OK'
    return
}

function callnumber
{
chat -v							\
	TIMEOUT		3				\
	ABORT		'\nBUSY\r'			\
	ABORT		'\nNO ANSWER\r'			\
	ABORT		'\nRINGING\r\n\r\nRINGING\r'	\
	''		ATL1				\
	''		ATM1				\
	''		\rAT				\
	'OK-+++\c-OK'	ATH0				\
	TIMEOUT		250				\
	OK		ATDT$1				\
	CONNECT		''				\
	sername:	$ACCOUNT			\
	assword:	$PASSWORD


    if [ "$?" = "0" ]; then
       exit 0
    fi

    return
}


initialize
if [ ! "$?" = "0" ]; then
   exit 1
fi


attempt=0
while : ; do
    attempt=`expr $attempt + 1`
    callnumber $TELEPHONE
    if [ "$attempt" = "$MAX_ATTEMPTS" ]; then
	exit 1
    fi	
    sleep "$SLEEP_DELAY"
done

</Programlisting>
</para></listitem>

</ItemizedList>

Pliki <filename>/etc/ppp/ppp-on</>, <filename>/etc/ppp/ppp-off</>
<filename>/etc/ppp/redialer</> powinny mieæ ustawione flagi wykonywalno¶ci:
<programlisting>
chmod +x /etc/ppp/ppp-o* /etc/ppp/redialer
</> 
</para>
<para>Od tej pory mo¿na dzwoniæ 
poprzez 
uruchamianie skryptu <filename>/etc/ppp/ppp-on</> a roz³±czanie nastêpuje
po wywo³aniu skryptu <filename>/etc/ppp/ppp-off</>. Plikiem konfiguracyjnym
dla pppd jest plik <filename>/etc/ppp/options</>. Powinien mieæ 
on zawarto¶æ tak± jak opisana w rozdziale <xref linkend="pppserver">, czyli:
<programlisting>
	defaultroute
	lock
	noauth
	/dev/modem
</programlisting>
W systemie Red Hat 7.x dla prawid³owego dzia³ania konieczne mo¿e byæ usuniêcie opcji <filename>noauth</filename>. Mo¿na modyfikowaæ konfiguracjê poprzez zmiany w skryptach
<filename>/etc/ppp/ppp-on</>,
<filename>/etc/ppp/ppp-off</> i
<filename>/etc/ppp/redialer</>
(np. zmiana ISP przez 
odpowiednie ustawienie <varname>TELEPHONE</>, <varname>ACCOUNT</> i
<varname>PASSWORD</>). Plik <filename>/etc/ppp/redialer</> odpowiada za
dzwonienie <quote>do skutku</>, lub do przekroczenia maksymalnej ilo¶ci prób
(np. w przypadku zajêto¶ci linii). Ta ilo¶æ prób jest ustalana w zmiennej
<varname>MAX_ATTEMPTS</> w pliku <filename>/etc/ppp/redialer</>.
</para>


</section>

<section id="modem-gsm">
<title>Konfiguracja klienta i serwera ppp w przypadku modemu GSM 
(model Siemens M20 + sieæ Era)</title>
<para>
Je¶li chodzi o fizyczne pod³±czenie modemu, to jego instalacja jest
analogiczna do zwyk³ego modemu - tworzymy link
<filename>/dev/modem</filename> wskazuj±cy na port szeregowy, do którego jest
pod³±czony modem. Komunikacja nastêpuje z prêdko¶ci± 19200 kBps (8N1), jest
kontrola przep³ywu RTS/CTS.
</para>
<para>
Problem komplikuje siê nieco, kiedy chcemy ustawiæ odpowiadanie modemu na
po³±czenie przy u¿yciu programu <filename>mgetty</filename>. Otó¿ zanim
mo¿na wykonywaæ jakiekolwiek operacje, modem musi siê zalogowaæ do sieci
GSM, ale do tego potrzebny jest kod PIN. Do wprowadzenia kodu PIN s³u¿y
komenda AT+CPIN="nnnn". Po wprowadzeniu prawid³owego PIN dioda na modemie
przestaje migaæ i zapala siê na sta³e. Zatem program <filename>mgetty</filename>
przy inicjalizacji modemu musi wprowadzaæ prawid³owy kod PIN. Mo¿na tego
dokonaæ za pomoc± opcji -m. Do <filename>/etc/inittab</filename> nale¿y
dopisaæ nastêpuj±c± linijkê (xxxx oznacza oczywi¶cie kod PIN):

<programlisting>
m:345:respawn:/sbin/mgetty -m '"" AT&amp;F&amp;C1&amp;D2S7=55 OK ATS0=1 OK
AT+CPIN="xxxx"' -s 19200 /dev/modem
</programlisting>

Po prawid³owym skonfigurowaniu <filename>mgetty</filename> komputer bêdzie
automatycznie podawa³ kod PIN. Pora teraz na skonfigurowanie po³±czeñ z
sieci± Internet. Sieæ EraGSM ma numer dostêpowy 0604010101, pod którym
znajduje siê protokó³ PPP z autoryzacj± PAP. Do katalogu
<filename>/etc/ppp</filename> nale¿y skopiowaæ nastêpuj±ce pliki (wersja dla
Era GSM):
</para>

<para>
Plik <filename>pap-secrets</filename>:
<programlisting>
# Secrets for authentication using PAP
# client	server	secret			IP addresses

eranet "*" eranet
</programlisting>
</para>

<para>
Plik <filename>ppp-on-dialer</filename>:
<programlisting>
#!/bin/sh
#
exec chat -v						\
	TIMEOUT		3				\
	ABORT		'\nBUSY\r'			\
	ABORT		'\nNO ANSWER\r'			\
	ABORT		'\nRINGING\r\n\r\nRINGING\r'	\
	''		\rAT				\
	'OK-+++\c-OK'	ATH0				\
	TIMEOUT		30				\
	OK		ATDT$TELEPHONE			\
	CONNECT		'\n'				

</programlisting>
</para>

<para>
Plik <filename>ppp-on</filename>:
<programlisting>
#!/bin/sh

TELEPHONE=604010101	# The telephone number for the connection
LOCAL_IP=0.0.0.0	# Local IP address if known. Dynamic = 0.0.0.0
REMOTE_IP=0.0.0.0	# Remote IP address if desired. Normally 0.0.0.0
NETMASK=255.255.255.0	# The proper netmask if needed
ACCOUNT=eranet

export TELEPHONE ACCOUNT

DIALER_SCRIPT=/etc/ppp/ppp-on-dialer

exec /usr/sbin/pppd lock crtscts /dev/ttyS1 19200 \
	defaultroute connect $DIALER_SCRIPT user $ACCOUNT
</programlisting>

Plik <filename>ppp-off</filename>:
<programlisting>
#!/bin/sh
######################################################################
#
# Determine the device to be terminated.
#
if [ "$1" = "" ]; then
	DEVICE=ppp0
else
	DEVICE=$1
fi

######################################################################
#
# If the ppp0 pid file is present then the program is running. Stop it.
if [ -r /var/run/$DEVICE.pid ]; then
        kill -INT `cat /var/run/$DEVICE.pid`
#
# If the kill did not work then there is no process running for this
# pid. It may also mean that the lock file will be left. You may wish
# to delete the lock file at the same time.
        if [ ! "$?" = "0" ]; then
                rm -f /var/run/$DEVICE.pid
                echo "ERROR: Removed stale pid file"
                exit 1
        fi
#
# Success. Let pppd clean up its own junk.
        echo "PPP link to $DEVICE terminated."
        exit 0
fi
#
# The ppp process is not running for ppp0
echo "ERROR: PPP link is not active on $DEVICE"
exit 1
</programlisting>
</para>

<para>
Wa¿na jest opcja user programu <filename>pppd</filename>, która mówi jaki
u¿ytkownik ma siê ³±czyæ z sieci± Internet. Dla sieci Era jest to eranet.
</para>
</section>

<section id="linux-sdi"><title>Instalacja i konfiguracja SDI</title>
<para>
Ten rozdzia³ opisuje sposób instalacji SDI 
(Szybkiego Dostêpu do Internetu). Opis podzielono na 3 fazy.
</para>


<para>
<itemizedlist>
<listitem><para> 
Przygotowania
</para>
<para>
Poniewa¿ komputer z SDI jest dostêpny z ca³ego Internetu, musimy go
zabezpieczyæ przed atakami z zewn±trz.
</para>
<para>Co robimy? 
<itemizedlist>
<listitem><para> 
Korzystaj±c z narzêdzia <command>ntsysv</command> usuwamy 
niepotrzebne serwisy w ten sposób, ¿eby pozosta³y tylko serwisy:
<command>atd</command>, <command>crond</command>, <command>gpm</command>,
<command>identd</command>, <command>(x)inet</command>, 
<command>network</command>, <command>random</command>, 
<command>sshd</command>, <command>syslog</command>, 
<command>xfs</command>, <command>xntpd</command>
</para></listitem>

<listitem><para> 
Mo¿na wyrzuciæ tak¿e <command>xfs</command>, ale wówczas nale¿y zmodyfikowaæ <filename>/etc/X11/XF86Config</filename> wpisuj±c tam jako kolejne sekcje <command>FontPath</command> wszystkie ¶cie¿ki podane w pliku <filename>/etc/X11/fs/config</filename> w sekcji <command>catalogue</command>.
</para><para>
Mo¿na te¿ wyrzuciæ <command>xntpd</command>, o ile dany komputer nie pe³ni roli <link linkend="ntp">serwera ntp</link>.
</para></listitem>

<listitem><para> 
Czê¶æ us³ug jest uruchamianych przy u¿yciu superdemona (x)inetd.
Nale¿y wiêc jego konfiguracjê delikatnie zmodyfikowaæ (w przypadku
inetd bêdzie to modyfikacja pliku <filename>/etc/inetd.conf</filename>).
Wykomentowaæ nale¿y nieu¿ywane i niepotrzebne serwisy; w standardowym
RH 6.2 nie stwierdzono ¿adnych potrzebnych serwisów, wiêc nale¿y 
wykomentowaæ <emphasis>wszystko</emphasis>.
</para></listitem>

</itemizedlist>

</para></listitem>

<listitem><para> 
Konfiguracja urz±dzenia
</para>

<para><itemizedlist>
<listitem><para> 
Pod³±czamy modem do komputera oraz do przygotowanej wcze¶niej linii 
abonenckiej.
</para></listitem>

<listitem><para> 
Tworzymy linka o nazwie <filename>/dev/modem</filename> wskazuj±cego
na odpowiednie urz±dzenie znakowe w katalogu <filename>/dev</filename>.
</para></listitem>

<listitem><para> 
Przystêpujemy do w³a¶ciwej konfiguracji komputera. 
Tworzymy (ew. modyfikujemy) odpowiednie pliki:
</para>

<para>
<filename>/etc/ppp/options</filename> o tre¶ci:
<programlisting>
<![CDATA[
115200
modem
defaultroute
lock
noauth
user <nazwa u¿ytkownika>
/dev/modem
persist
]]>
</programlisting>
</para>

<para>
<filename>/etc/ppp/pap-secrets</filename> o tre¶ci:
<programlisting>
<![CDATA[
<nazwa u¿ytkonika> * <has³o tego¿ u¿ytkownika> <numer IP uzyskany od TPSA>
]]>
</programlisting>
</para>

<para>
<filename>/etc/rc.d/init.d/his</filename> o tre¶ci:
<programlisting>
<![CDATA[
#!/bin/bash
. /etc/rc.d/init.d/functions

[ -f /usr/sbin/pppd ] || exit 0
[ -f /etc/ppp/options ] || exit 0
RETVAL=0
case "$1" in
  start)
	echo -n 'Starting HIS connection... '
	daemon /usr/sbin/pppd
		RETVAL=$?
		echo
		[ $RETVAL -eq 0 ] && touch /var/lock/subsys/pppd
  ;;
  stop)
	echo -n 'Shutting HIS connection... '
		killproc pppd
	RETVAL=$?
		echo
		[ $RETVAL -eq 0 ] && rm -f /var/lock/subsys/pppd
	echo
  ;;
  reload|restart)
	$0 stop
	$0 start
		RETVAL=$?
  ;;
  *)
	echo "Usage: /etc/rc.d/init.d/his {start|stop|reload|restart}"
	exit 1
esac
exit $RETVAL
]]>
</programlisting>

Uwaga! Temu skryptowi nale¿y dodaæ atrybuty wykonywalno¶ci
(<command>chmod +x /etc/rc.d/init.d/his</command>). Nale¿y go 
równie¿ dodaæ do skryptów startowych w po¿±danym runlevelu.
</para>

<para>Plik <filename>/etc/ppp/chap-secrets</filename> powinien 
byæ pusty.
</para></listitem>
</itemizedlist>

</para>
</listitem>

<listitem><para> Udostêpnianie po³±czenia innym u¿ytkownikom sieci lokalnej
</para>

<para>
Jak to zrobiæ opisuje <xref linkend="nat-masq">.

</para>


</listitem>

</itemizedlist>
</para>

<section id="linux-sdi-debian">
<title>Konfiguracja SDI pod Debianem</title>

<para>
Mo¿na u¿yæ sposobu opisanego powy¿ej, ale bardziej elegancki i zgodny z duchem
Debiana bêdzie nastêpuj±cy:
<itemizedlist>
<listitem><para>
Tworzymy plik <filename>/etc/ppp/peers/sdi</filename> o zawarto¶ci:
<programlisting>
<![CDATA[
115200
modem
defaultroute
lock
noauth
user NAZWA
/dev/modem
persist
]]>
</programlisting>
Zamiast NAZWA wpisujemy przydzielon± przez TP S.A. nazwê u¿ytkownika.
</para></listitem>

<listitem><para>
Do pliku <filename>/etc/ppp/pap-secrets</filename> dodajemy liniê postaci:
<programlisting>
<![CDATA[
NAZWA * HASLO IP
]]>
</programlisting>
Oczywi¶cie zamiast NAZWA, HAS£O i IP podajemy otrzymane od TP S.A. parametry -
nazwê u¿ytkownika, has³o i przydzielony numer IP.
</para></listitem>

<listitem><para>
Do pliku <filename>/etc/network/interfaces</filename> dodajemy linie:
<programlisting>
<![CDATA[
auto ppp0
iface ppp0 inet ppp
        provider sdi
]]>
</programlisting>
</para></listitem>

<listitem><para>
Ta elegancka konfiguracja ma jednak jedn± wadê - mimo opcji 'persist' nie
zawsze demon pppd bêdzie podtrzymywa³ po³±czenie. Jako zabezpieczenie tworzymy
wiêc plik <filename>/etc/cron.d/ppp.cron</filename> o zawarto¶ci:
<programlisting>
<![CDATA[
#
# Every 10 minutes check if ppp0 is up.

9,19,29,39,49,59 * * * *      root    /sbin/ifconfig ppp0 || /sbin/ifup ppp0
]]>
</programlisting>
Podane tu warto¶ci s± przyk³adowe - tu sprawdzanie odbywa siê na minutê
przed ka¿dymi pe³nymi 10 minutami.
</para></listitem>

</itemizedlist>
</para>
<para>
Je¿eli nasz komputer ma byæ u¿yty jako po¶rednik dostêpu do Internetu 
dla innych komputerów w sieci, powinni¶my u¿yæ mechanizmu NAT/Masquarading,
który opisuje <xref linkend="nat-masq">.
</para>
</section> <!-- linux-sdi-debian -->

</section> <!-- linux-sdi -->

<section id="neostrada-usb">
<title>Instalacja us³ugi Neostrada z wykorzystaniem modemu USB</title>
<para>
Poni¿ej przedstawiono opis instalacji i konfiguracji us³ugi Neostrada TP 
z modemem USB Sagem F@st 800 lub Thomson SpeedTouch 330 pod systemem Debian.
Dla osób, które u¿ywaj± innych systemów operacyjnych lub/i innego typu modemu polecamy stronê
<ulink url="http://neostrada.info/instalacja.php">http://neostrada.info/instalacja.php</ulink>,
gdzie zebrano teksty dotycz±ce ró¿nych sposobów instalacji Neostrady TP.
</para>

<para>
    Uruchomienie Neostrady (zw³aszcza w przypadku modemu Sagem) 
    wymaga zainstalowania kilku dodatkowych pakietów.
    Naj³atwiej jest to zrobiæ przy u¿yciu narzêdzia <command>apt-get</command>,
    które automatycznie rozwi±¿e zale¿no¶ci miêdzy pakietami.
    Je¶li to mo¿liwe, nale¿y zapewniæ komputerowi, na którym odbywa siê 
    instalacja,
    tymczasowy dostêp do Internetu. Pozwoli to na u¿ycie repozytoriów
    z najnowszymi wersjami pakietów oraz ¶ci±gniecie plików nag³ówkowych j±dra
    (instalacja z modemem Sagem). Je¶li tymczasowy dostêp do sieci nie jest
    mo¿liwy,
    potrzebne pakiety wraz z zale¿no¶ciami nale¿y pobraæ w innym miejscu
    i dostarczyæ na przyk³ad na p³ycie CD. Niezale¿nie od typu modemu bêdziemy
    potrzebowali pakietów <emphasis>hotplug</emphasis>, 
    przyda siê te¿ <emphasis>usbutils</emphasis>.
</para>

<para>
<emphasis>Uwaga!</emphasis>
Nale¿y dopilnowaæ, aby pakiet hotplug by³ w wersji co najmniej 0.0.20040329-22. Wcze¶niejsze
wersje uniemo¿liwiaj± wznawianie utraconego po³±czenia mimo zastosowania opcji
<quote>persist</quote>. Szczegó³owy opis problemu mo¿na znale¼æ na stronie:
<ulink url="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=302709">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=302709</ulink>.
</para>
			     
<para>
Uruchomienie neostrady wymaga rejestracji - dokonujemy jej po wstêpnym
skonfigurowaniu po³±czenia z domy¶lnym u¿ytkownikiem
<emphasis>rejestracja@neostrada.pl</emphasis> i has³em
<emphasis>rejestracja</emphasis> na stronie: 
<ulink url="http://rejestracja.neostrada.pl">rejestracja.neostrada.pl</ulink>.
Potrzebne bêd± dane takie, jak numer zg³oszenia (taki sam jak pierwsze litery i
6 pierwszych cyf numeru umowy), numer linii telefonicznej, na której jest
instalowana us³uga, numer PESEL (w przypadku osoby fizycznej) lub NIP nabywcy (w
przypadku firmy). Po ich podaniu otrzymujemy identyfikator i numer PIN,
podaj±c je z kolei otrzymujemy nazwê u¿ytkownika i has³o. Poni¿szy opis
zak³ada, ¿e rejestracji dokonujemy na tym samym komputerze, na którym
instalujemy us³ugê. Wymaga to wiêc pó¼niejszego przekonfigurowania po³±czenia
z otrzyman± w procesie rejestracji nazw± u¿ytkownika i has³em. Rejestracji
mo¿na tak¿e dokonaæ wcze¶niej, na innym komputerze. Wtedy na etapie
konfiguracji powinni¶my od razu podawaæ prawid³ow± nazwê u¿ytkownika i has³o.
Nazwa u¿ytkownika ma zawsze postaæ
<emphasis>identyfikator@neostrada.pl</emphasis>, podajemy je zawsze w pe³nej
postaci (a nie sam <emphasis>identyfikator</emphasis>).
</para>

<section id="neostrada-usb-telefon">
<title>Przygotowanie linii telefonicznej</title>
<para>
    Do prawid³owego dzia³ania modemy ADSL wymagaj±, aby wszystkie telefony pod³±czone
    do tej samej linii co modem zosta³y odseparowane przy pomocy odpowiednich filtrów.
    Dwa takie filtry do³±czone s± do zestawu instalacyjnego. W wypadku gdy do linii,
    z której ma korzystaæ modem, pod³±czone s± wiêcej ni¿ dwa aparaty telefoniczne
    mo¿na zainstalowaæ filtr przed gniazdkiem (puszk±), do której doprowadzona jest linia
    zewnêtrzna, a do modemu poprowadziæ stamt±d dodatkowy przewód.
</para>
</section> <!-- neostrada-usb-telefon -->

<section id="neostrada-usb-sagem">
<title>Modem Sagem F@st 800</title>
<para>
Poni¿szy opis dotyczy j±dra o wersji co najmniej 2.6.15.
Opis dla starszych j±der znajduje siê w kolejnej
<link linkend="neostrada-usb-sagem-old">sekcji.</link>
<para>
Modem F@st 800 obs³ugiwany jest przez modu³ ueagle-atm.
Jest on standardowo dostêpny w j±drach Debiana.
Do uruchomienia go konieczne jest pobranie i zainstalowanie
firmware'u. Jest on dostêpny na stronie:
<ulink url="http://eagle-usb.org/ueagle-atm/non-free/">
http://eagle-usb.org/ueagle-atm/non-free/</ulink>
Mo¿na te¿ skorzystaæ z paczki dostêpnej na stronie SZARPa
<ulink url="http://szarp.com.pl/download.php">
http://szarp.com.pl/download.php</ulink>
</para>
<para>
Za za³adowanie firmware'u potrzebny jest jeszcze <emphasis>udev</emphasis>
lub <emphasis>hotplug</emphasis>. Aby sprawdziæ czy s± zainstalowane,
nale¿y wykonaæ polecenia:
<programlisting>
dpkg -l udev hotplug
</programlisting>
O zainstalowaniu pakietu ¶wiadczy litera 'i' na pocz±tku wiersza z nazw±
pakietu. Gdyby ¿aden z nich nie by³ zainstalowany, nale¿y zainstalowaæ
np. udev
<programlisting>
apt-get install udev
</programlisting>
</para>
<para>
Po przygotowaniu firmware'u mo¿na pod³±czyæ modem. Je¶li by³ pod³±czony
wcze¶niej, nale¿y od³±czyæ go i pod³±czyæ ponownie. Po wywo³aniu polecenia
<filename>dmesg</filename> powinno pojawiæ siê:
<programlisting>
[ueagle-atm] pre-firmware device, uploading firmware
[ueagle-atm] loading firmware ueagle-atm/eagleII.fw
[ueagle-atm] firmware uploaded 
</programlisting>
</para>
<para>
Nastêpnie nale¿y przygotowaæ plik <filename>/etc/ppp/peers/neostrada</filename>
z nastêpuj±c± zawarto¶ci±:
<programlisting>
debug
kdebug 1
user rejestracja@neostrada.pl
asyncmap 0
lcp-echo-interval 2
lcp-echo-failure 7
plugin pppoatm.so
0.35
noauth
usepeerdns
noipdefault
defaultroute
holdoff 4
persist
maxfail 25
</programlisting>
Je¿eli rejestracja zosta³a ju¿ wykonana, nale¿y podaæ otrzyman± nazwê
u¿ytkownika w miejsce <emphasis>rejestracja@neostrada.pl</emphasis>.
</para>
<para>
Do plików <filename>/etc/ppp/pap-secrets</filename>
i <filename>/etc/ppp/chap-secrets</filename> nale¿y wpisaæ
nazwê u¿ytkownika i has³o. Dla rejestracji bêdzie to:
<programlisting>
rejestracja@neostrada.pl	*   rejestracja	*
</programlisting>
</para>
<para>
Kolejn± czynno¶ci± jest edycja pliku
<filename>/etc/network/interfaces</filename>.
Nale¿y dodaæ do niego sekcjê:
<programlisting>
auto pppoa
iface pppoa inet ppp
    provider neostrada
</programlisting>
Je¿eli istnieje plik <filename>/etc/ppp/resolv.conf</filename>, to nale¿y wykonaæ kopiê 
zapasow± pliku <filename>/etc/resolv.conf</filename> a na jego miejsce podlinkowaæ 
<filename>/etc/ppp/resolv.conf</filename>:
<programlisting>
mv /etc/resolv.conf /etc/resolv.conf.old
ln -s /etc/ppp/resolv.conf /etc/resolv.conf
</programlisting>
Po wykonaniu powy¿szych czynno¶ci mo¿na nawi±zaæ po³±czenie. 
W tym celu wykonujemy polecenie:
<programlisting>
ifup pppoa
</programlisting>
Je¶li wszystko zasta³o wykonane prawid³owo po wykonaniu polecania 
<command>ifconfig</command> powinny pojawiæ siê komunikaty tej postaci:
<programlisting>
ppp0      Link encap:Point-to-Point Protocol  
          inet addr:83.27.227.217  P-t-P:213.25.2.37  Mask:255.255.255.255
          UP POINTOPOINT RUNNING NOARP MULTICAST  MTU:9178  Metric:1
          RX packets:175922 errors:0 dropped:0 overruns:0 frame:0
          TX packets:144799 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:3 
          RX bytes:18388453 (17.5 MiB)  TX bytes:19310312 (18.4 MiB)
</programlisting>
</para>
</section>

<section id="neostrada-usb-sagem-old">
<title>Modem Sagem F@st 800 - j±dra < 2.6.15</title>
<para>
Modem Sagem F@st 800 w j±drach starszych ni¿ 2.6.15 obs³ugiwany by³
przez modu³ ueagle-usb. Poni¿ej zamieszczamy opis uruchomienia
neostrady z wykorzystaniem tego modu³u.
</para>
<para>
Zanim rozpoczniemy w³a¶ciw± instalacjê, musimy przygotowaæ pakiety
z nag³ówkami do u¿ywanej wersji j±dra oraz programy narzêdziowe.
Dodatkowo, u¿yjemy pakietu <command>module-assistant</command>, ¿eby zautomatyzowaæ proces 
konfiguracji i instalacji sterowników modemu. Wydajemy zatem komendy:
<programlisting>
apt-get install module-assistant
apt-get install eagle-usb-modules-source
</programlisting>
<note><para>Uwaga! Je¶li nie mamy dostêpu do sieci, pakiety musz± byæ zainstalowane na 
komputerze rêcznie, co jest dosyæ k³opotliwe, bo np. pakiet
<command>eagle-usb-modules-source</command> ma kilka zale¿no¶ci, które nale¿y równie¿ 
¶ci±gn±æ i zainstalowaæ.</para></note>
</para>
<para>
Gdy mamy zainstalowane oba pakiety, nale¿y przygotowaæ modu³y dla naszego systemu.
Wywo³ujemy nastêpuj±ce komendê:
<programlisting>
module-assistant -t auto-install eagle-usb
</programlisting>
Nastêpnie pod³±czamy modem do portu USB 
i instalujemy programy narzêdziowe do modemu:
<programlisting>
apt-get install eagle-usb-utils
</programlisting>
Po zainstalowaniu uruchomi siê konfigurator:
<itemizedlist>
<listitem><para>
W pierwszym oknie wybieramy opcjê <quote>Polska</quote> (je¿eli mamy
odpowiednio now± wersjê pakietu eagle-usb-utils, to od razu bêdziemy mogli
wybraæ neostradê TP S.A.).
</para></listitem>
<listitem><para>
W kolejnym oknie musimy wpisaæ nazwê u¿ytkownika podan± w procesie rejestracji do Neostrady
(je¿eli logujemy siê po raz pierwszy nale¿y tu wpisaæ <quote>rejestracja@neostrada.pl</quote>).
</para></listitem>
<listitem><para>
W nastêpnym oknie podajemy has³o (przy pierwszym logowaniu siê do sieci podajemy
has³o <quote>rejestracja</quote>).
</para></listitem>
<listitem><para>
Na pytanie <quote>Does your ISP supports password encryption?</quote> odpowiadamy <quote>Yes</quote>.
</para></listitem>
<listitem><para>
Na pytanie <quote>Start DSL connection automatically?</quote> odpowiadamy
<quote>onplug</quote>.
</para></listitem>
<listitem><para>
Teraz modem bêdzie próbowa³ stworzyæ sesjê ADSL, co mo¿e trochê potrwaæ.
Je¿eli wszystko przebieg³o OK, powinni¶my otrzymaæ komunikat 
<programlisting>
Konfiguracja zakoñczona z powodzeniem.

Mo¿esz teraz wydaæ komendê "startadsl", aby nawi±zaæ po³±czenie
</programlisting>
</para></listitem>

<listitem><para>
Teraz powinni¶my zmodyfikowaæ plik <filename>/etc/ppp/options</filename>,
najlepiej tak, ¿eby jego zawarto¶æ by³a identyczna z plikiem
<filename>/etc/eagle-usb/scripts/options</filename>.
</para></listitem>
<listitem><para>
Powinni¶my równie¿ sprawdziæ czy w pliku <filename>/etc/ppp/chap-secrets</filename> mamy
poprawnie wpisany podany przez nas login i has³o.
</para></listitem>
<listitem><para>
Wydajemy komendê <command>startadsl</command> i powinni¶my uzyskaæ po³±czenie z sieci±.
</para></listitem>
<listitem><para>
Po³±czenie mo¿na zakoñczyæ poleceniem: <command>stopadsl</command>
</para></listitem>
</itemizedlist>
<para>
Uwaga! Czasami zdarza siê, ¿e konfigurator nie ustawi odpowiednio konfiguracji 
(skrypt <command>startadsl</command> zawiesza siê wówczas na d³u¿szy czas po czym
informuje, ¿e nie mo¿e nawi±zaæ po³±czenia).
Nale¿y wtedy rêcznie uruchomiæ skrypt <command>eagleconfig</command> (jest
to konsolowy konfigurator modemu) i skonfigurowaæ po³±czenie powtórnie. 
</para>
<para>
Je¿eli logujemy siê po raz pierwszy (u¿ywamy loginu/has³a: rejestracja@neostrada.pl/rejestracja),
to po uzyskaniu po³±czenia bêdziemy mogli wej¶æ tylko na stronê 
<ulink url="http://rejestracja.neostrada.pl">http://rejestracja.neostrada.pl</ulink>.
Nale¿y wówczas przej¶æ przez kilka kroków wg. instrukcji ze strony.
Otrzymamy tu nasze nowe, indywidualne has³o i nazwê u¿ytkownika. 
Wtedy nale¿y zakoñczyæ po³±czenie i powtórnie uruchomiæ skrypt <command>eagleconfig</command>, 
¿eby wprowadziæ nowo otrzyman± nazwê u¿ytkownika i has³o.
</para>
<para>
</section> <!-- neostrada-usb-sagem -->
<section id="neostrada-usb-speedtouch">
<title>Modem Thomson SpeedTouch 330</title>
<para>
Uruchomienie Neostrady przy u¿yciu modemu SpeedTouch wymaga zainstalowania pakietu 
hotplug. Instalujemy go (je¿eli nie jest zainstalowany) przez wydanie
polecenia:
<programlisting>
apt-get install hotplug
</programlisting>
Sterownik do modemu (modu³ <emphasis>speedtouch</emphasis>) we wszystkich
nowszych j±drach powinien byæ ju¿ obecny, trzeba natomiast zadbaæ o ³adowanie
firmware'u modemu. Firmware naj³atwiej skopiowaæ z p³ytki instalacyjnej
dostarczanej przez TP S.A. wraz z zestawie instalacyjnym. Kopiujemy z niej 
np. do katalogu <filename>/tmp</filename> plik 
<filename>neostrada_tp.tgz</filename> i rozpakowujemy go:
<programlisting>
mount /media/cdrom
cp /media/cdrom/Linux/ST330/neostrada_tp.tgz /tmp
cd /tmp
tar xzf neostrada_tp.tgz
</programlisting>
Wchodzimy do powsta³ego po rozpakowaniu katalogu <filename>neostrada_tp</filename>
i rozpakowujemy w nim archiwum ST330_firmware_3012.zip (potrzebny jest do tego
program <command>unzip</command> - je¶li nie jest zainstalowany to oczywi¶cie
wydajemy komendê <command>apt-get install unzip</command>):
<programlisting>
cd neostrada_tp
unzip ST330_firmware_3012.zip
</programlisting>
Pliki z firmware s± dwa do wyboru. Wszystkie obecnie sprzedawane modele modemu
wymagaj± pliku <filename>ZZZL_03.012</filename>. Pliku
<filename>KQD6_3.012</filename> u¿ywamy, je¿eli mamy starsz± wersjê modemu, co
mo¿na rozpoznaæ przez wydanie komendy (potrzebna jest program
<command>lsusb</command> z pakietu <emphasis>usbutils</emphasis>):
<programlisting>
lsusb -d 0x06b9:0x4061 -v | grep bcdDevice
</programlisting>
W przypadku starszych modemów powinien zostaæ wypisany numer wersji 2.00,
w przypadku nowszych otrzymujemy 4.00. Mo¿na bezpiecznie za³o¿yæ, ¿e mamy
nowsz± wersjê i sprawdzaæ tylko je¿eli co¶ nie dzia³a.
</para>
<para>
Objawem wskazuj±cym, ¿e próbujemy za³adowaæ z³± wersjê firmware'u, jest
nastêpuj±cy komunikat pojawiaj±cy siê w pliku <filename>/var/log/syslog</filename>.
<programlisting>
... speedtch_upload_firmware: read BLOCK2 from modem failed (-110)!
</programlisting>
</para>
<para>
Dalsze postêpowanie zale¿y od u¿ywanej przez nas wersji j±dra (sprawdzamy
poleceniem: <command>uname -r</command>):
<itemizedlist>
<listitem><para>
Je¿eli korzystamy z wersji wcze¶niejszej ni¿ 2.6.10, to
konieczny bêdzie pakiet <emphasis>usbutils</emphasis>, a tak¿e
musimy zainstalowaæ pakiet <emphasis>speedtouch</emphasis>
(uwaga - obecnie znajduje siê on w
repozytorium <emphasis>stable</emphasis>):
<programlisting>
apt-get install speedtouch
</programlisting>
Nastêpnie tworzymy katalog <filename>/usr/local/lib/speedtouch</filename> 
i kopiujemy do niego plik z firmware'em:
<programlisting>
mkdir /usr/local/lib/speedtouch
cp ZZZL_3.012 /usr/local/lib/speedtouch
</programlisting>
</para></listitem>
<listitem><para>
Je¿eli korzystamy z j±dra 2.6.10 lub nowszego, to j±dro samo za³aduje dla nas
firmware, musimy go tylko odpowiednio przygotowaæ, czyli podzieliæ na dwa pliki -
kod ³aduj±cy i w³a¶ciwy. W tym celu do naszego tymczasowego katalogu ¶ci±gamy
plik spod adresu: 
<ulink url="http://prdownloads.sourceforge.net/speedtouch/speedtouch-1.3.1.tar.gz?download">
http://prdownloads.sourceforge.net/speedtouch/speedtouch-1.3.1.tar.gz?download</ulink>.
Rozpakowujemy go a nastêpnie rozpakowujemy kolejny plik umieszczony wewn±trz
¶ci±gniêtego archiwum:
<programlisting>
tar xzf speedtouchconf-06-03-2006.tar.gz
cd speedtouchconf-06-03-2005
tar xzf speedtouch-1.3-sgp.tar.gz
speedtouch-1.3-sgp
</programlisting>
Nastêpnie kompilujemy ma³y programik s³u¿±cy do dzielenia pliku z firmware na
dwa:
<programlisting>
cd src
gcc -o firmware firmware.c -DSTANDALONE_EXTRACTER
</programlisting>
Powinni¶my otrzymaæ w aktualnym katalogu program
<filename>firmware</filename>. Uruchamiamy go, podaj±c jako argument
oryginalny plik z firmware:
<programlisting>
./firmware ../../../ZZZL_3.012
</programlisting>
Powinni¶my otrzymaæ dwa pliki wyj¶ciowe - <filename>boot.bin</filename> i
<filename>firmware.bin</filename>. Zmieniamy im nazwy i kopiujemy do
odpowiedniego katalogu:
<programlisting>
mv boot.bin /usr/local/lib/firmware/speedtch-1.bin
mv firmware.bin /usr/local/lib/firmware/speedtch-2.bin
</programlisting>
Oczywi¶cie mo¿na te¿ skopiowaæ te pliki np. z innego komputera z
zainstalowanym modemem SpeedTouch.
</para></listitem>
</itemizedlist>
</para>
<para>
Po wykonaniu powy¿szych czynno¶ci mo¿emy pod³±czyæ modem. 
W pliku <filename>/var/log/syslog</filename>
powinny pojawiæ siê informacje o zarejestrowaniu sterownika:
<programlisting>
... kernel: usbcore: registered new driver speedtch
</programlisting>
W przypadku j±dra 2.6.10 lub nowszego powinni¶my te¿ zobaczyæ komunikaty o
pozytywnym za³adowaniu firmware:
<programlisting>
... kernel: usb 2-3: found stage 1 firmware speedtch-1.bin
... kernel: usb 2-3: found stage 2 firmware speedtch-2.bin
</programlisting>
Nastêpnie nale¿y przygotowaæ plik <filename>/etc/ppp/peers/neostrada</filename>
z nastêpuj±c± zawarto¶ci±:
<programlisting>
debug
kdebug 1
user rejestracja@neostrada.pl
asyncmap 0
lcp-echo-interval 2
lcp-echo-failure 7
plugin pppoatm.so
0.35
noauth
usepeerdns
noipdefault
defaultroute
holdoff 4
persist
maxfail 25
</programlisting>
Mo¿emy tak¿e dodaæ opcjê <emphasis>replacedefaultroute</emphasis> je¿eli
chcemy, aby uruchomienie po³±czenia przez neostradê powodowa³o zast±pienie
ewentualnie u¿ywanej innej bramy domy¶lnej. Nale¿y tak¿e zwróciæ uwagê na
ewentualne opcje zawarte w pliku <filename>/etc/ppp/options</filename> -
najlepiej, aby by³ on pusty, ¿eby opcje przeznaczone np. dla modemu
telefonicznego nie psu³y nam konfiguracji.
</para>
<para>
Do plików <filename>/etc/ppp/pap-secrets</filename>
i <filename>/etc/ppp/chap-secrets</filename> dodajemy liniê:
<programlisting>
rejestracja@neostrada.pl	*   rejestracja	*
</programlisting>
Kolejn± czynno¶ci± jest edycja pliku
<filename>/etc/network/interfaces</filename>.
Nale¿y dodaæ do niego sekcjê:
<programlisting>
auto pppoa
iface pppoa inet ppp
    provider neostrada
</programlisting>
Je¿eli istnieje plik <filename>/etc/ppp/resolv.conf</filename>, to nale¿y wykonaæ kopiê 
zapasow± pliku <filename>/etc/resolv.conf</filename> a na jego miejsce podlinkowaæ 
<filename>/etc/ppp/resolv.conf</filename>:
<programlisting>
mv /etc/resolv.conf /etc/resolv.conf.old
ln -s /etc/ppp/resolv.conf /etc/resolv.conf
</programlisting>
Po wykonaniu powy¿szych czynno¶ci mo¿na wykonaæ pierwsze po³±czenie 
w celu zarejestrowania siê i otrzymania identyfikatora i has³a.
W tym celu wykonujemy polecenie:
<programlisting>
ifup pppoa
</programlisting>
Je¶li wszystko zasta³o wykonane prawid³owo po wykonaniu polecania 
<command>ifconfig</command> powinny pojawiæ siê komunikaty tej postaci:
<programlisting>
ppp0      Link encap:Point-to-Point Protocol  
          inet addr:83.27.227.217  P-t-P:213.25.2.37  Mask:255.255.255.255
          UP POINTOPOINT RUNNING NOARP MULTICAST  MTU:9178  Metric:1
          RX packets:175922 errors:0 dropped:0 overruns:0 frame:0
          TX packets:144799 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:3 
          RX bytes:18388453 (17.5 MiB)  TX bytes:19310312 (18.4 MiB)
</programlisting>
</para>
<para>
Nale¿y teraz przeprowadziæ rejestracjê zgodnie z instrukcj± dostarczon±
w zestawie instalacyjnym. Uzyskany w jej trakcie identyfikator u¿ytkownika
i has³o nale¿y zapisaæ.
</para>
<para>
Nastêpnie nale¿y wyedytowaæ pliki <filename>/etc/ppp/pap-secrets</filename>
i <filename>/etc/ppp/chap-secrets</filename> zastêpuj±c
<command>rejestracja@neostrada.pl</command> przez pe³n± nazwê u¿ytkownika
a <command>rejestracja</command> przez has³o. Plik po edycji powinien wygl±daæ
w nastêpuj±cy sposób:
<programlisting>
login@neostrada.pl	*   haslo   *
</programlisting>
Uzyskan± nazw± u¿ytkownika nale¿y tak¿e zast±piæ napis
<quote>rejestracja</quote> w pliku
<filename>/etc/ppp/peers/neostrada</filename>.
</para>
<para>
Kolejnym krokiem jest wy³±czenie i ponowne w³±czenie interfejsu pppoa:
<programlisting>
ifdown pppoa
ifup pppoa
</programlisting>
</para>
<para>
W tym momencie Neostrada powinna byæ w pe³ni skonfigurowana i gotowa do u¿ycia.
Mo¿na to sprawdziæ wydaj±c ponownie polecenie: <command>ifconfig</command>,
które powinno, jak poprzednio, pokazaæ informacje o skonfigurowanym interfejsie ppp0,
lub wydaj±c np. polecenie:
<programlisting>
ping google.pl
</programlisting>
które powinno wy¶wietliæ komunikaty:
<programlisting>
PING google.pl (216.239.39.99) 56(84) bytes of data.
64 bytes from 216.239.39.99: icmp_seq=1 ttl=236 time=130 ms
64 bytes from 216.239.39.99: icmp_seq=2 ttl=236 time=131 ms
64 bytes from 216.239.39.99: icmp_seq=3 ttl=236 time=132 ms
</programlisting>
Aby przerwaæ wy¶wietlanie nale¿y nacisn±æ Crtl-C.
</para>
<para>
Ze wzglêdu na d³ugi czas synchronizacji modemu, interfejs mo¿e 
nie zd±¿aæ skonfigurowaæ siê podczas startu systemu. Mo¿na temu zapobiec 
zmieniaj±c plik <filename>/etc/network/interfaces</filename>
na przyk³ad w nastêpuj±cy sposób:
<programlisting>
auto pppoa
iface pppoa inet ppp
    provider neostrada
    pre-up while ! grep 'Line up' '/proc/net/atm/speedtch:0' \
        &> /dev/null ; do sleep 1; done
    post-up while ! ifconfig ppp0 &> /dev/null ; do sleep 1; done
</programlisting>
</para>
</section> <!-- neostrada-usb-speedtouch -->
</section> <!-- neostrada-usb -->

<section id="internet-dsl">
<title>Instalacja us³ugi Internet DSL</title>
<para>
Us³uga <quote>Internet DSL</quote> jest us³ug± oferowan± przez Telekomunikacjê
Polsk±. Podobnie jak us³ugi SDI i Neostrada (Plus) technologi± dostêpow±
jest tu xDSL (a dok³adnie ADSL). 
W zale¿no¶ci od wersji, u¿ytkownik otrzymuje od jednego 
do czterech numerów IP z klasy publicznej oraz modem ADSL z wyj¶ciem Ethernet. 
Dziêki interfejsowi Ethernet u¿ytkownik musi skonfigurowaæ komputery w sieci
korzystaj±c ze standardowych ustawieñ sieci w sieci Ethernet
(por. <link linkend="netconf">opis dla systemów pochodnych od RedHata</link>, 
<link linkend="debian-network">opis dla systemu Debian</link>). 
Od dostawcy us³ugi
powinni¶my dostaæ wszystkie potrzebne dane na temat sieci:
numer IP lub pulê numerów IP, adres maski podsieci i adres rozg³oszeniowy.
Dostajemy te¿ adres IP interfejsu Ethernet modemu ADSL. Ten oto adres nale¿y 
ustawiæ jako adres bramki (gateway). 
Dodatkowo powinni¶my ustawiæ adres serwera DNS w pliku <filename>/etc/resolv.conf</filename>, np. dodaj±c liniê:
<programlisting>
nameserver 194.204.152.34
</programlisting>
Po skonfigurowaniu sieci nale¿y sprawdziæ czy nasz komputer widzi interfejs 
w modemie (<quote>bramkê</quote>). W kolejnym kroku mo¿emy spróbowaæ
ju¿ <quote>spingowaæ</quote> jakiego¶ hosta w Internecie.
</para>
<para>
Uwaga! Us³ugê DSL czêsto zak³ada siê w miejscach, gdzie istnieje dzia³aj±ca
sieæ lokalna. Je¶li nie mamy do dyspozycji dwóch kart sieciowych, mo¿emy 
spróbowaæ pod³±czyæ <quote>bramkê</quote> jak i hosta do huba w naszej sieci
lokalnej a na ho¶cie dodaæ nowy adres internetowy jako tzw. alias IP.
Procedurê jak to nale¿y zrobiæ opisuje sekcja <xref linkend="ip-alias">.
</para>
<para>
Dodatkowo, je¿eli nasz komputer ma byæ u¿yty jako po¶rednik dostêpu do Internetu 
dla innych komputerów w sieci lokalnej, powinni¶my u¿yæ mechanizmu NAT/Masquarading,
który opisuje <xref linkend="nat-masq">.
</para>
</section>

<section id="linux-cdi"><title>Instalacja i konfiguracja CDI</title>
<para>
CDI jest to dostêp do Internetu oferowany przez firmê Dialog (<ulink url="http://www.dialog.pl/dialoginternet_glowna.php">szczegó³y</ulink>). Wykorzystywana jest tutaj technologia ISDN (a nie xDSL jak w przypadku SDI). Adres IP przydzielany jest w tym przypadku dynamicznie (przy ka¿dym zestawieniu po³±czenia u¿ytkownik mo¿e otrzymaæ inny adres IP). Poni¿ej przyk³ad konfiguracji CDI z Dialogu z urz±dzeniem koñcowym Aethra NT-IP 1197<!-- link nieaktualny (wiêcej o kofiguracji modemów Aethra pod Linuksem mo¿na znale¼æ <ulink url="http://www.lgm.cl/documentos/Aethra-Linux-HOWTO.en.html">tutaj</ulink>)-->. Zak³adamy, ¿e operator przydzieli³ nam nastêpuj±ce parametry:
</para>
<para>
<programlisting>
identyfikator (uzytkownik): 2384012483D
haslo: SHDKWP
numer dostepowy: 2401383 
</programlisting>
</para>

<para>
Nale¿y utworzyæ nastêpuj±ce pliki:
</para>

<para>
<filename>/etc/ppp/dialog</filename> (w tym pliku za lini± <filename>'ATZ'</filename> mo¿na wstawiaæ dodatkowe komendy: dla zakoñczenia Aethra NT-IP: 'ATB41CL2048', 'ATB40&#38;J3', 'ATB40&38;H3&#38;J3JA1JS1KAS1KSS30CE1'; dla zakoñczenia Elcon NT-IP NT1+2ab+V24: 'ATB41CL2048', albo: 'ATZB40&#38;J3!X22=0', 'ATS7=60S30=0&#38;H3'):
</para>
<para>
<programlisting>
'ABORT' 'BUSY' 
'ABORT' 'ERROR' 
'ABORT' 'NO CARRIER' 
'ABORT' 'NO DIALTONE' 
'ABORT' 'Invalid Login' 
'ABORT' 'Login incorrect' 
'' 'ATZ' 
'OK' 'ATD2401383'
'CONNECT' '' 
</programlisting>
</para>

<para>
<filename>/etc/ppp/options</filename> (poni¿szy ustawia automatycznie DNSy Dialogu: 217.30.129.149 i 217.30.137.200; domena to: dialog.net.pl):
</para>
<para>
<programlisting>
115200
debug 
defaultroute 
name 2384012483D
/dev/modem
lock 
crtscts 
receive-all 
connect '/usr/sbin/chat -f /etc/ppp/dialog' 
usepeerdns 
persist 
</programlisting>
</para>

<para>
<filename>/etc/ppp/chap-secrets</filename>:
</para>
<para>
<programlisting>
# Secrets for authentication using CHAP 
# client server secret IP addresses 
2384012483D * SHDKWP
</programlisting>
</para>
<para>
Je¿eli powy¿sza konfiguracja nie bêdzie dzia³a³a, mo¿na spróbowaæ
zamieniæ 'name' na 'user' a tak¿e utworzyæ plik
<filename>/etc/ppp/pap-secrets</filename> o takiej samej zawarto¶ci jak
<filename>/etc/ppp/chap-secrets</filename>.
</para>
<para>
Dla automatycznego startu pppd nale¿y utworzyæ skrypt <filename>/etc/rc.d/init.d/his</filename> i dodaæ go do skryptów startowych, jak to opisano w rozdziale <link linkend="linux-sdi">o konfiguracji SDI</>, gdzie opisano te¿ udostêpnianie po³±czenia innym u¿ytkownikom.
</para>

<para>
Mo¿na te¿ ³±czyæ siê z wykorzystaniem <filename>wvdial</filename>, który pozwala na bardzo szybko dzia³aj±c± konfiguracjê, która jednak ma tê wadê, ¿e przy BODASie ka¿dorazowy zrzut danych na serwer praterm.com.pl powoduje utworzenie nowej sesji pppd i przydzia³u innego adresu IP (przeciêtny czas ¿ycia jednej sesji to ok. 4 minuty). Nie jest mo¿liwy wiêc zdalny dostêp do takiego systemu. Przy konfiguracji pppd opisanej powy¿ej, adres IP bêdzie zmienny za ka¿dym uruchomieniem pppd (np. po zawi¶niêciu po stronie Dialoga), czyli stosunkowo rzadko (w ideale tylko przy restarcie komputera).
</para>
<para>
Aby skonfigurowaæ <filename>wvdial</filename> (s³u¿±cy do tego celu <filename>wvdialconf</filename> sam nie wykryje zakoñczenia CDI), nale¿y utworzyæ plik <filename>/etc/wvdial.conf</filename>:
</para>
<para>
<programlisting>
<![CDATA[
[Dialer Defaults]
Modem = /dev/modem
Baud = 115200
Init1 = ATZ
# Ponizsze dwie linie sa opcjonalne dla zakonczenia Aethra NT-IP 1197
# moze ich nie byc
Init2 = ATB41CL2048
Init3 = ATB40&J3
# Ponizsza linia jest opcjonalna dla zakonczenia Elcon NT-IP NT1+2ab+V24
# moze jej nie byc
# Init2 = ATB41CL2048
# Ponizej jeszcze dwie linie opcjonalne
# Init2 = ATZB40&J3!X22=0
# Init3 = ATS7=60S30=0&H3
Phone = 2401383
Username = 2384012483D
Password = SHDKWP
]]>
</programlisting>
</para>
<para>
i na koniec <filename>/etc/rc.d/rc.local</filename> dodaæ linijkê:
</para>
<para>
<programlisting>
/usr/bin/wvdial &
</programlisting>
</para>

<para>
wvdial przy zestawieniu ka¿dego po³±czenia ustawia odpowiednio <filename>/etc/ppp/pap-secrets</filename>:
</para>
<para>
<programlisting>
UZYTKOWNIK * HASLO 
</programlisting>
</para>

<para>
Dodatkowo trzeba rêcznie ustawiæ DNS Dialogu w <filename>/etc/resolv.conf</filename>.
</para>

</section>

<section id="linux-isdn">
<title>Konfiguracja po³±czenia przy wykorzystaniu ISDN</title>
<para><!-- wstêp, bleble ... -->
ISDN to system telefonii cyfrowej dostêpny ju¿ na rynku od d³u¿szego czasu.
Urz±dzenia do jego obs³ugi mog± wystêpowaæ w kilku formach:
<itemizedlist>
<listitem><para>terminale pod³±czane przez port szeregowy (rs232) albo
ethernet</para></listitem>
<listitem><para>terminale w formie kart rozszerzeñ (ISA/PCI)</para></listitem>
</itemizedlist>
Tutaj zajmiemy siê przypadkiem drugim - kart rozszerzeñ, oraz konfiguracj±
do dzia³ania zarówno jako serwer i klient dla po³±czeñ przy wykorzystaniu sieci ISDN.
</para>

<section id="linux-isdn-card">
<title>Konfiguracja karty</title>

<para>
Pierwszym etapem jest konfiguracja samej karty ISDN. Obecnie w j±drze
Linuksa istniej± dwa podsystemy do obs³ugi urz±dzeñ ISDN: isdn4linux
oraz mISDN (modular ISDN). Konfiguracjê oprzemy na pierwszym z nich
poniewa¿ jest standardowo dostêpny w j±drach Debiana, natomiast mISDN
wymaga kompilacji dodatkowych modu³ów.
</para>

<para>
Musimy odnale¼æ modu³ odpowiedni dla danej karty. Wiêkszo¶æ kart jest
wspieranych przez modu³ HiSax. Na podstawie pliku
<filename>/usr/src/linux/Documentation/isdn/README.HiSax</filename> lub strony
<ulink url="http://www.linuxpowered.com/html/editorials/isdn/hisaxreadme.html">
http://www.linuxpowered.com/html/editorials/isdn/hisaxreadme.html</ulink>
musimy odnale¼æ odpowiedni identyfikator typu dla posiadanej karty (np. dla karty
opartej na uk³adzie HFC 2BDS0 PCI bêdzie to 35).
<para>

<para>
Lista przetestowanych kart: <xref linkend="hw-isdn">.
</para>

<para>
W Debianie nale¿y utworzyæ plik w katalogu <filename>/etc/modprobe.d/</filename>
o nazwie np. <emphasis>isdn</emphasis> z zawarto¶ci±:
<programlisting>
options hisax protocol=2 type=35
</programlisting>
gdzie w miejsce 35 wpisujemy znaleziony typ.
Po utworzeniu pliku mo¿na za³adowaæ modu³ poleceniem:
<programlisting>
modprobe hisax
</programlisting>
</para>

<para>
W RedHacie tworzymy plik <filename>/etc/sysconfig/isdncard</filename> o zawarto¶ci:
<programlisting>
MODULE=hisax
RESOURCES="protocol=2 type=35"
</programlisting>
po czym restartujemy serwis isdn:
<programlisting>
service isdn restart
</programlisting>
(musimy tak¿e pamiêtaæ o tym, by serwis ten by³ ³adowany w czasie uruchamiania
komputera - mo¿emy to zrobiæ np. przy u¿yciu narzêdzia
<filename>ntsysv</filename>).
</para>

<para>
Po tych operacjach karta terminala ISDN jest ju¿ gotowa do dalszej konfiguracji.
</para>

</section><!-- linux-isdn-card -->

<section id="linux-isdn-debian">
<title>Konfiguracja systemu Debian</title>

<para>
Nale¿y zadbaæ o to, by by³y zainstalowane nastêpuj±ce pakiety:
<programlisting>
isdnutils-base
isdnlog
ipppd
</programlisting>
(s± one dostarczone z nasz± dystrybucj±).
</para>

<para>
Poni¿ej zamieszczamy zalecane odpowiedzi na pytania zadawane w trakcie
instalacji tych pakietów:

<itemizedlist>
<listitem><para>
<emphasis>isdnutils</emphasis>
Na pytanie o ³adowanie firmware'u - nale¿y wybraæ odpowied¼ 'none'.
</para></listitem>

<listitem><para>
<emphasis>isdnlog</emphasis>
Nale¿y wybraæ 'other' a nastêpnie wpisaæ kod <emphasis>PL</emphasis>
oraz wpisaæ numer kierunkowy.
</para></listitem>

<listitem><para>
<emphasis>ipppd</emphasis>
Instalator pyta o numer telefonu, z którym bêdziemy siê ³±czyæ.
Nale¿y pozostawiæ warto¶æ domy¶ln± <emphasis>manual</emphasis>
i rêcznie skonfigurowaæ po³±czenie.
</para></listitem>
</itemizedlist>

<para>
Po zakoñczeniu instalacji konieczne jest równie¿ poprawienie pliku
<filename>/etc/isdn/isdn.conf</filename> poniewa¿ kod kraju ustawiany
jest nieprawid³owo. Nale¿y wpisaæ:
<programlisting>
COUNTRYCODE = 48
</programlisting>
</para>

<para>
Pliki konfiguracyjne ISDN znajduj± siê w katalogu <filename>/etc/isdn/</filename>.
Z ka¿d± kart± powi±zane s± dwa interfejsy ippp, które mog± byæ wykorzystywane
niezale¿nie. Dla ka¿dego interfejsu potrzebne s± dwa pliki konfiguracyjne
device.ipppX i ipppd.ipppX. Pierwszy z nich ustawia parametry urz±dzenia,
drugi zawiera opcje dla daemona ipppd. Poni¿ej zamieszczamy przyk³adow±
konfiguracjê. Pliki te mo¿na równie¿ utworzyæ przy pomocy narzêdzia
<command>isdnconfig</command>. Tworzy ono przyk³adow± konfiguracjê,
któr± nale¿y dostosowaæ do w³asnych potrzeb. 
</para>

<para>
Najpierw omówiona zostanie konfiguracja po³±czeñ wychodz±cych. Zwykle sprawia
ona mniej problemów mo¿e wiêc pos³u¿yæ do przetestowania karty.
</para>

<section id="linux-isdn-debian-out">
<title>Po³±czenia wychodz±ce</title>
<para>
Konfiguracja urz±dzenia <filename>device.ipppX</filename>
<programlisting>
#!/bin/sh

set -e

# Adresy IP.
# Jezeli sa przydzielane dynamicznie nalezy pozostawic wartosci
# domyslne. W wypadku gdy sa statyczne nalezy je wpisac.
LOCALIP=169.255.255.169	# IP klienta
REMOTEIP=10.0.0.2	# IP serwera

# Numery telefonow
LOCALMSN=203123456 	# numer lokalny
REMOTEMSN=221345789	# numer serwera z kierunkowym, bez 0
			# moze byc lista rozdzielona spacjami
LEADINGZERO=0		# dodawane do numeru serwera

# Tryb pracy urzadzenia, nie zmieniac.
DIALMODE=auto

# Czy ustawiac default route na to urzadzenie?
DEFROUTE=1

# urzadzenie - ipppX
devnums=`basename $0`; devnums=${devnums##device.ippp}
device=ippp$devnums


dowhat="$1"

masterslave="$2"
case "x$masterslave" in
    xmaster)	master=true;  slave=false;;
    xslave)	master=false; slave=true; masterdevice="$3";;
    x)		master=false; slave=false;;
    *)		echo "Error, $0 called with unknown 2nd arg '$masterslave', aborting!"
    		exit 1;;
esac

# Configuration (start)

case "$dowhat" in
start)
    [ -f /proc/sys/net/ipv4/ip_dynaddr ] && echo 5 > /proc/sys/net/ipv4/ip_dynaddr

    # Utworzenie interfejsu
    if $slave
    then	isdnctrl addslave ${masterdevice} ${device}
    else	isdnctrl addif ${device}
    fi

    # Ustawienie MSN
    isdnctrl eaz ${device} $LOCALMSN

    # Ustawienie numeru, pod ktory dzwonimy
    if [ ! -z "$REMOTEMSN" ]; then
	for MSN in $REMOTEMSN; do
	    isdnctrl addphone ${device} out $LEADINGZERO$MSN
	done
    fi

    # Rozlaczanie po X sekund nieaktywnosci, 0 wylaczone
    isdnctrl huptimeout ${device} 0

    # Enkapsulacja
    isdnctrl encap ${device} syncppp

    # Protokoly
    isdnctrl l2_prot ${device} hdlc
    isdnctrl l3_prot ${device} trans

    # Gadatliwosc isdn, UWAGA dotyczy wszystkich urzadzen
    isdnctrl verbose 2

    # zwiazanie z deamonem ipppd
    bindnum=`expr $device : 'ippp\(.*\)'` || true
    if [ ! -z "$bindnum" ]; then
	isdnctrl pppbind ${device} $bindnum
    fi

    # KONFIGURACJA SIECI

    if ! $slave; then
	ifconfig ${device} $LOCALIP pointopoint $REMOTEIP netmask 255.255.255.255
	set +e	# ignore errors from here on

	route del -host $REMOTEIP ${device} 2>/dev/null
	route add -host $REMOTEIP ${device}

	# default route
	if [ "$DEFROUTE" = 1 ]; then
	    route del default 2>/dev/null
	    route add default netmask 0 ${device}
	fi

    fi # not slave

    if $slave
    then	isdnctrl dialmode $device auto      >/dev/null 2>&1
    else	isdnctrl dialmode $device $DIALMODE >/dev/null 2>&1
    fi
    ;;

# Usuwanie interfejsu
stop)
    set +e

    isdnctrl dialmode $device off >/dev/null 2>&1

    if ! $slave; then
	route del $REMOTEIP $device	2> /dev/null

	# usuwanie default route
	if [ "$DEFROUTE" = 1 ]; then
	    route del default netmask 0 2>/dev/null
	fi
	ifconfig $device down	2> /dev/null
	isdnctrl delif $device	2> /dev/null
    fi
    ;;

*)
    echo "Usage: $0 {start|stop}"
    exit 1
    ;;
esac

exit 0
</programlisting>
W docelowym pliku nale¿y ustawiæ:
<itemizedlist>
<listitem><para>
numery telefonów w zmiennych LOCALMSN i REMOTEMSN - odpowiednio lokalny i zdalny,
</para></listitem>

<listitem><para>
adresy ip - je¶li s± znane, w przeciwnym wypadku pozostawiæ domy¶lne,
</para></listitem>

<listitem><para>
czy urz±dzenie ma byæ wykorzystywane jak domy¶la brama (zmienna DEFROUTE).
</para></listitem>
</itemizedlist>
</para>

<para>
Konfiguracja daemona ipppd <filename>ipppd.ipppX</filename>
<programlisting>
# Komunikaty daemona
debug			# wlacz dodatkowe komunikaty
kdebug 1		# poziom logowanych komunikatow

lcp-restart 1		# Set timeout for LCP 

# Autoryzacja
user ppp		# nazwa uzytkownika
noauth			#

# Kompresja wylaczona
noccp
nolzs

# Adresy IP
noipdefault
netmask 255.255.255.255

# Routing
nohostroute		# nie ustawiaj routingu

#usepeerdns		# uzyj serwerow dns podanych przez interfejs

mru 1524		# maksymalny rozmiar odbieranych pakietow
mtu 1500		# maksymalny rozmiar wysylanych pakietow

ipcp-accept-local	# Accept peer's address for us 
ipcp-accept-remote	# Accept peer's address for it 
</programlisting>
Przedstawione ustawienia powinny umo¿liwiæ nawi±zanie po³±czenia.
Konieczne jest ustawienie nazwy u¿ytkownika (user) oraz dodatnie
wpisu z has³em do pliku <filename>/etc/ppp/pap-secrets</filename>
w postaci:
<programlisting>
nazwa_u¿ytkownika   *	has³o *
</programlisting>
na przyk³ad:
<programlisting>
ppp * ppp *
</programlisting>
Nie nale¿y dodawaæ opcji defaultroute nawet gdy po³±czenie ISDN
bêdzie podstawowym ³±czem. Routing ustawiany jest przez skrypt
device.ipppX. Do bardziej zaawansowanej konfiguracji routingu
wykorzystuje siê skrypty:
<programlisting>
/etc/ppp/ip-up.d/00-ipppd
/etc/ppp/ip-down.d/99-ipppd
</programlisting>
</para>

</section> <!-- linux-isdn-debian-out -->

<section id="linux-isdn-debian-in">
<title>Po³±czenie przychodz±ce</title>
<para>
Konfiguracja urz±dzania <filename>device.ipppX</filename>
<programlisting>
#!/bin/sh

set -e

# Adresy IP.
LOCALIP=192.168.8.1	# IP serwera
REMOTEIP=192.168.8.8	# IP klienta

# Numery telefonow
LOCALMSN=203123456 	# numer serwera bez 0
REMOTEMSN='*'		# akceptowane numery klientow, * - wszystkie

LEADINGZERO=0		# dodawane do numeru serwera

# Tryb pracy urzadzenia, nie zmieniac.
DIALMODE=auto

# Czy ustawiac default route na to urzadzenie?
DEFROUTE=0

# urzadzenie - ipppX
devnum=`basename $0`; devnums=${devnum##device.ippp}
device=ippp$devnum


dowhat="$1"

masterslave="$2"
case "x$masterslave" in
    xmaster)	master=true;  slave=false;;
    xslave)	master=false; slave=true; masterdevice="$3";;
    x)		master=false; slave=false;;
    *)		echo "Error, $0 called with unknown 2nd arg '$masterslave', aborting!"
    		exit 1;;
esac

# Configuration (start)

case "$dowhat" in
start)
    [ -f /proc/sys/net/ipv4/ip_dynaddr ] && echo 5 > /proc/sys/net/ipv4/ip_dynaddr

    # Utworzenie interfejsu
    if $slave
    then	isdnctrl addslave ${masterdevice} ${device}
    else	isdnctrl addif ${device}
    fi

    # Ustawienie MSN
    isdnctrl eaz ${device} $LOCALMSN

    # Ustawienie numeru, pod ktory dzwonimy
    if [ ! -z "$REMOTEMSN" ]; then
	for MSN in $REMOTEMSN; do
	    isdnctrl addphone ${device} out $LEADINGZERO$MSN
	done
    fi

    # Rozlaczanie po X sekund nieaktywnosci, 0 wylaczone
    isdnctrl huptimeout ${device} 0

    # Enkapsulacja
    isdnctrl encap ${device} syncppp

    # Protokoly
    isdnctrl l2_prot ${device} hdlc
    isdnctrl l3_prot ${device} trans

    # Gadatliwosc isdn, UWAGA dotyczy wszystkich urzadzen
    isdnctrl verbose 2

    # zwiazanie z deamonem ipppd
    bindnum=`expr $device : 'ippp\(.*\)'` || true
    if [ ! -z "$bindnum" ]; then
	isdnctrl pppbind ${device} $bindnum
    fi

    # KONFIGURACJA SIECI

    if ! $slave; then
	ifconfig ${device} $LOCALIP pointopoint $REMOTEIP netmask 255.255.255.255
	set +e	# ignore errors from here on

	route del -host $REMOTEIP ${device} 2>/dev/null
	route add -host $REMOTEIP ${device}

	# default route
	if [ "$DEFROUTE" = 1 ]; then
	    route del default 2>/dev/null
	    route add default netmask 0 ${device}
	fi

    fi # not slave

    if $slave
    then	isdnctrl dialmode $device auto      >/dev/null 2>&1
    else	isdnctrl dialmode $device $DIALMODE >/dev/null 2>&1
    fi
    ;;

# Usuwanie interfejsu
stop)
    set +e

    isdnctrl dialmode $device off >/dev/null 2>&1

    if ! $slave; then
	route del $REMOTEIP $device	2> /dev/null

	# usuwanie default route
	if [ "$DEFROUTE" = 1 ]; then
	    route del default netmask 0 2>/dev/null
	fi
	ifconfig $device down	2> /dev/null
	isdnctrl delif $device	2> /dev/null
    fi
    ;;

*)
    echo "Usage: $0 {start|stop}"
    exit 1
    ;;
esac

exit 0
</programlisting>
Podobnie jak przy po³±czeniach wychodz±cych nale¿y ustawiæ prawid³owy
numer telefonu linii, do której pod³±czony jest modem, oraz adresy
IP. Zmienna REMOTEMSN odpowiada za numery, z których po³±czenia bêd±
akceptowane. <emphasis>*</emphasis> oznacza, ¿e przyjmowane bêd± wszystkie
po³±czenia.
</para>

<para>
<emphasis>Uwaga!</emphasis>
Komunikaty
<programlisting>
kernel: isdn_net: ippp0: No phone number, signalling dst_link_failure
...
kernel: isdn_tty: Incoming call without CPN, assuming '0'
kernel: isdn_tty: call from 846385042 -> 0 ignored
</programlisting>
oznaczaj±, ¿e modem odbieraj±cy po³±czenie nie otrzymuje
informacji pod jaki numer dzwoni modem nawi±zuj±cy po³±czenie.
W tej sytuacji nale¿y ustawiæ LOCALMSN na 0.
</para>

<para>
Konfiguracja daemona <filename>ipppd.ipppX</filename>
<programlisting>
# Komunikaty daemona
debug			# wlacz dodatkowe komunikaty
kdebug 1		# poziom logowanych komunikatow

lcp-restart 1		# Set timeout for LCP 

# Autoryzacja
auth
+pap

# Kompresja wylaczona
noccp
nolzs

# Adresy IP
192.168.8.1:192.168.8.8	# serwer:klient
netmask 255.255.255.255

# Routing
nohostroute		# nie ustawiaj routingu

#usepeerdns		# uzyj serwerow dns podanych przez interfejs

mru 1524		# maksymalny rozmiar odbieranych pakietow
mtu 1500		# maksymalny rozmiar wysylanych pakietow
</programlisting>
Przed uruchomieniem nale¿y sprawdziæ czy adres IP w pliku
<filename>device.ipppX</filename> jest zgodny
z <filename>ipppd.ipppX</filename>.
</para>
</section> <!-- linux-isdn-debian-out -->

</section> <!-- linux-isdn-debian -->

<section id="linux-isdn-redhat">
<title>Konfiguracja systemu RedHat</title>
<para>
Poni¿ej omówiona zostanie konfiguracja dla systemu RedHat 7.3.
Ten sposób konfiguracji mo¿e byæ równie¿ wykorzystany jako alternatywa
dla Debiana w wypadku, gdy podany wy¿ej opis nie zadzia³a.
</para>

<para><!-- po³±czenia wychodz±ce ... -->
Maj±c skonfigurowany terminal, mo¿emy spróbowaæ po³±czyæ siê
z czym¶ na zewn±trz. Do po³±czenia siê z naszym ulubionym dostawc±
(TPSA - numer 0-202422) mo¿na wykorzystaæ nastêpuj±cy skrypt
(<filename>/opt/szarp/bin/isdn-up-out.sh</filename>):
<programlisting>
#!/bin/sh

if [ x$1 = x ]; then
  devicenum=0
  device=ippp0
else
  devicenum=$1
  device=ippp$1
fi

#numer telefonu
number=0202422

#konfiguracja dla dial-out
isdnctrl addif $device
isdnctrl addphone $device out $number
isdnctrl huptimeout $device 0
isdnctrl l2_prot $device hdlc
isdnctrl l3_prot $device trans
isdnctrl encap $device syncppp
/usr/sbin/ipppd \
  user ppp \
  ipcp-accept-local ipcp-accept-remote noipdefault lock \
  mru 1500 mtu 1500 usepeerdns useifip \
  /dev/$device
isdnctrl pppbind $device $devicenum
ifconfig $device up
</programlisting>
i mo¿emy go wywo³aæ np. tak:
<programlisting>
/opt/szarp/bin/isdn-up-out.sh 0
</programlisting>
</para>

<para>
Musimy jeszcze skonfigurowaæ has³o dla u¿ytkownika ppp. Robimy to poprzez
dodanie do pliku <filename>/etc/ppp/pap-secrets</filename> linijki:
<programlisting>
ppp "*" ppp
</programlisting>
W tym momencie terminal ju¿ jest skonfigurowany do po³±czeñ z tpsa.
W celu dokonania w³a¶ciwego po³±czenia wywo³ujemy komendê:
<programlisting>
isdnctrl dial ippp0
</programlisting>
Mo¿emy jeszcze ustawiæ w³a¶ciwy routing:
<programlisting>
route add default ippp0
</programlisting>
Je¶li bêdziemy chcieli siê roz³±czyæ, to wystarczy wywo³aæ co¶ takiego:
<programlisting>
isdnctrl hangup ippp0
</programlisting>
</para>

<para><!-- po³±czenia przychodz±ce ... -->
Uruchomienie po³±czeñ przychodz±cych wymaga trochê innego skryptu:
(<filename>/opt/szarp/bin/isdn-up-in.sh</filename>):
<programlisting>
#!/bin/sh

if [ x$1 = x ]; then
  devicenum=0
  device=ippp0
else
  devicenum=$1
  device=ippp$1
fi

#konfiguracja dla dial-in
isdnctrl addif $device
isdnctrl eaz $device 19
isdnctrl addphone $device in "*"
isdnctrl huptimeout $device 0
isdnctrl l2_prot $device hdlc
isdnctrl l3_prot $device trans
isdnctrl encap $device syncppp
/usr/sbin/ipppd \
  auth +pap \
  proxyarp netmask 255.255.224.0 192.168.8.1:192.168.8.8 \
  mru 1500 mtu 1500 usepeerdns useifip \
  /dev/$device
isdnctrl pppbind $device $devicenum
ifconfig $device up
</programlisting>
Wywo³ujemy go podobnie jak poprzedni:
<programlisting>
/opt/szarp/bin/isdn-up-in.sh 0
</programlisting>
Musimy jeszcze skonfigurowaæ has³o dla u¿ytkownika ppp. Robimy to poprzez
dodanie do pliku <filename>/etc/ppp/pap-secrets</filename> linijki:
<programlisting>
ppp "*" ppp
</programlisting>
W tym momencie terminal ju¿ jest skonfigurowany do przyjmowania po³±czeñ
przychodz±cych.
</para>
<para>
Mo¿e siê tak¿e zdarzyæ, i¿ chcemy, by na danej maszynie istnia³y obydwie
konfiguracje. Wtedy wystarczy, i¿ wywo³amy co¶ takiego:
<programlisting>
/opt/szarp/bin/isdn-up-out.sh 0
/opt/szarp/bin/isdn-up-in.sh 1
</programlisting>
</para>
<para>
W tym momencie powinni¶my ju¿ mieæ mo¿liwo¶æ jednoczesnego dzwonienia
i przyjmowania po³±czeñ.
</para>

<para>
Je¶li chcemy, by po³±czenia by³y konfigurowane przy starcie systemu
musimy dodaæ wywo³ania skryptów isdn-up-*.sh do <filename>/etc/rc.local</filename>
(RedHat). Mo¿liwe jest jednoczesne u¿ywanie po³±czeñ przychodz±cych
i wychodz±cych. Nale¿y tylko zadbaæ aby numer urz±dzeñ w wywo³aniach
skryptów by³y ró¿ne (np. 0 - wychodz±ce, 1 - przychodz±ce).
</para>

<para>
W Debianie uruchomienie po³±czeñ przy starcie systemu mo¿na uzyskaæ tworz±c
skrypt<filename>/etc/isdn/device.ipppX</filename> o nastêpuj±cej zawarto¶ci:
<programlisting>
#!/bin/sh

#prefix - sk±d skrypty do isdn (kopiowane z palca)
prefix=
#dir - kierunek (in/out)
dir=out
#id - nr device'a (0/1 - ippp0/ippp1)
id=0

case "$1" in
    start)
        /opt/szarp/$prefix/isdn-up-$dir.sh $id
    ;;
    stop)
        /opt/szarp/bin/isdn-down.sh $id
    ;;
    *)
        echo "$0: (start|stop)"
        exit 1
    ;;
esac
</programlisting>
W miejsce X i do zmiennej <emphasis>id</emphasis> przypisujemy
numer urz±dzenia. By przetestowaæ konfiguracjê wywo³ujemy:
<programlisting>
invoke-rc.d isdn restart
</programlisting>
</para>

</section> <!-- linux-isdn-redhat -->
</section> <!-- id="linux-isdn" -->

<section id="sferia">
<title>Konfiguracja po³±czeñ z Internetem przez Sferiê</title>

<para>
Ten rozdzia³ opisuje jak ³±czyæ siê z Internetem za pomoc± Sferii.
Wszystkie ustawienia pokazano dla terminala Dowtel WS-2100 (przy³±czany
do komputera PC przez ³±cze szeregowe).
Dla innych typów terminali konfiguracja powinna ró¿niæ siê tylko nieznacznie.
</para>

<para>
Po³±czenia z Internetem przy pomocy Sferii 
(<ulink url="http://www.sferia.pl">http://www.sferia.pl</ulink>) przypominaj±
<quote>zwyk³e</quote>, wdzwaniane po³±czenia dial-up. Nie jest to wiêc sta³e
po³±czenie z Internetem, przed skorzystaniem z Internetu nale¿y po³±czyæ siê 
za pomoc± programu <command>kppp</command>, skryptu <command>szppp-on</command> itd.
Ka¿dy u¿ytkownik otrzymuje od operatora w³asny login/has³o (poni¿ej stosujemy 
przyk³adowy login <quote>uzytkow111</quote> oraz has³o <quote>haslo111</quote>).
</para>
<para>
¯eby skonfigurowaæ <command>pppd</command> do tworzenia po³±czeñ internetowych
poprzez Sferiê, nale¿y stworzyæ nastêpuj±ce pliki:
<itemizedlist>
<listitem><para>
Plik <filename>/etc/ppp/peers/sferia</filename> o zawarto¶ci:
<programlisting>
connect "/usr/sbin/chat -v -f /etc/chatscripts/sferia-connect-chat"
disconnect "/usr/sbin/chat -v -f /etc/chatscripts/sferia-disconnect-chat"

115200
updetach
/dev/modem
crtscts
local
ipcp-accept-local
ipcp-accept-remote
defaultroute
usepeerdns
noccp

user "uzytkow111"
password "haslo111"
</programlisting>
</para>
<para>
Uwaga! Dwie ostatnie linie w pliku powy¿ej nale¿y zmodyfikowaæ odpowiednio
do podanej w umowie nazwy u¿ytkownika i has³a.
</para></listitem>

<listitem><para>
Plik <filename>/etc/chatscripts/sferia-connect-chat</filename> o zawarto¶ci:
<programlisting>
<![CDATA[
TIMEOUT		3
''		'AT&C2+CMUX=C,2;AT+CRM=150'  
ABORT		'\nBUSY\r'
ABORT		'\nNO ANSWER\r'
ABORT		'\nRINGING\r\n\r\nRINGING\r'
'OK-+++\c-OK'	\AT
'OK-+++\c-OK'	ATH0
TIMEOUT		120
OK		ATDT#777
CONNECT		''
TIMEOUT		5
]]>
</programlisting>
</para></listitem>

<listitem><para>
Plik <filename>/etc/chatscripts/sferia-disconnect-chat</filename> o zawarto¶ci:
<programlisting>
<![CDATA[
ABORT		"BUSY"
ABORT		"ERROR"
ABORT		"NO DIALTONE"
SAY		"\nReset modemu\n"
""		"\K"
""		"+++ATH"
]]>
</programlisting>
</para></listitem>

</itemizedlist>

Warto równie¿ dopisaæ skrypty ustawiaj±ce zawarto¶æ pliku <filename>/etc/resolv.conf</filename> (czyli
serwery DNS) w taki sposób, ¿e zawarto¶æ pliku bêdzie zawsze aktualizowana na czas po³±czenia.
W tym celu tworzymy 2 skrypty 
(Uwaga! musz± one mieæ ustawion± flagê wykonywalno¶ci):

<itemizedlist>
<listitem><para>
Plik <filename>/etc/ppp/ip-up.local</filename> o zawarto¶ci:
<programlisting>
mv /etc/resolv.conf /etc/resolv.conf-pppbackup
cp -f /etc/ppp/resolv.conf /etc/resolv.conf
chmod a+r /etc/resolv.conf
</programlisting>
</para></listitem>

<listitem><para>
Plik <filename>/etc/ppp/ip-down.local</filename> o zawarto¶ci:
<programlisting>
mv /etc/resolv.conf-pppbackup /etc/resolv.conf
</programlisting>
</para></listitem>
</itemizedlist>

Ewentualnie mo¿na ustawiæ rêcznie plik <filename>/etc/resolv.conf</filename> jak ni¿ej:
<programlisting>
nameserver	193.41.112.18
</programlisting>

Po³±czenia rozpoczynane s± w nastêpuj±cy sposób:
<programlisting>
pppd call sferia
</programlisting>
a koñczone jak poni¿ej:
<programlisting>
killall pppd
</programlisting>

</para>

</section>


<section id="linux-plip">
<title>Konfiguracja po³±czenia PLIP</title>
<para>
Czasem istnieje konieczno¶æ zestawienia prostej sieci dla dwóch maszyn. Nie
zawsze niestety mamy dostêpne karty sieciowe - wtedy istnieje kilka metod,
takich jak:
<itemizedlist>
<listitem><para>poprzez port szeregowy (rs232)</para></listitem>
<listitem><para>poprzez port równoleg³y (drukarkowy)</para></listitem>
<listitem><para>poprzez port usb</para></listitem>
</itemizedlist>
Tutaj opiszemy metodê wykorzystuj±c± do tego port równoleg³y i odpowiednio
spreparowany w tym celu kabel. Prêdko¶æ transmisji uzyskanej w ten sposób wynosi ¶rednio ok. 60kB/s.
</para>
<para>
Do po³±czenia nale¿y u¿yæ kabla zakoñczonego z obydwu stron 25-pin wtyczk± mêsk±, takiego samego jak do np. po³±czenia kablowego w Windows, czy Windows Commander, Norton Commander. Po³±czenia miêdzy poszczególnymi pinami kabla (s± symetryczne, wiêc obojêtne z której strony siê patrzy):
</para>
<para>
<emphasis>Kabel drukarkowy do po³±czenia miêdzy dwoma komputerami</>
<programlisting>
2 - 15
3 - 13
4 - 12
5 - 10
6 - 11
10 - 5
11 - 6
12 - 4
13 - 3
15 - 2
16 - 16
17 - 17
25 - 25
</programlisting>
</para>

<para>
Po z³±czeniu komputerów wystarczy wykonaæ kilka poleceñ.
Wspólne dla obu stron:
<programlisting>
<![CDATA[
insmod parport
insmod parport_pc io=0x378 irq=7 #warto¶ci z ustawieñ BIOSu
insmod plip
]]>
</programlisting>
nastêpnie po jednej stronie:
<programlisting>
<![CDATA[
ifconfig plip0 172.20.0.1 pointopoint 172.20.0.2 netmask 255.255.255.255 up
]]>
</programlisting>
(uwaga na pojedyncze <quote>t</quote> w s³owie <quote>pointopoint</quote>),
za¶ po drugiej:
<programlisting>
<![CDATA[
ifconfig plip0 172.20.0.2 pointopoint 172.20.0.1 netmask 255.255.255.255 up
]]>
</programlisting>

Po tych operacjach ³±cze powinno ju¿ dzia³aæ. Zostaje nam tylko przetestowanie
przy u¿yciu np. polecenia <filename>ping</filename>.
</para>
</section>

<section id="gprs">
<title>£±czenie siê z Internetem przez GPRS</title>
<para>
Ten rozdzia³ opisuje jak po³±czyæ siê z Internetem za pomoc± telefonu
komórkowego wykorzystuj±c system GPRS. <emphasis>General Packet Radio 
System</emphasis> (GPRS)
jest metod± dostêpu do Internetu w sieciach GSM, która, w przeciwieñstwie
do zwyk³ego po³±czenia komutowanego (<xref linkend="modem-gsm">) 
oraz po³±czenia HSCSD, charakteryzuje siê pakietow± transmisj± danych. 
Trzy cechy odró¿niaj± system GPRS od pozosta³ych metod dostêpu: 
po pierwsze, u¿ytkownik p³aci
tylko za ilo¶æ przes³anych danych a nie za czas po³±czenia.
Po drugie, GPRS jest szybszy od zwyk³ego po³±czenia dial-up z sieci± 
przez telefon komórkowy (9,6 kbps), bo pozwala na ³±czenie kilku kana³ów 
i osi±gniêcie przep³ywu do abonenta (<emphasis>downstream</emphasis>) 
do 115 kbps (na razie ani sieci, ani telefony nie wspieraj± jeszcze tak du¿ych
prêdko¶ci transmisji). Po trzecie, system GPRS pozwala odbieraæ po³±czenia
i SMS-y w trakcie trwania sesji (po³±czenia) GPRS. Sesja jest wówczas na
czas po³±czenia zawieszana, a po jego zakoñczeniu - wznawiana.
Dodatkowym atutem jest czas nawi±zywania po³±czenia - jest kilkakrotnie
krótszy ni¿ w przypadku zwyk³ych modemów dial-up.
</para>

<para>
Us³uga GPRS musi byæ aktywowana u operatora telefonii komórkowej 
(w niniejszym opisie, dla uproszczenia wszystkie przyk³ady 
i konfiguracja bêd± przedstawione dla sieci Era).
W Erze aktywacja us³ugi jest za darmo, standardowo nie ma równie¿ 
¿adnej op³aty miesiêcznej w abonamencie. Koszt: 49 gr (+VAT) za 100 kB 
wys³anych i (oddzielnie) odebranych danych (na poziomie protoko³u IP).
<quote>Kwantem rozliczeniowym</quote> jest w³a¶nie 100 kB. 
Oznacza to, ¿e minimalna op³ata za sesjê GPRS wynosi 49 gr (dane odebrane) 
+ 49 gr (dane wys³ane) = 98 gr (kilkaset bajtów musi byæ zawsze 
wys³anych i odebranych w ramach nawi±zywania po³±czenia).
Sesja GPRS przerwana po³±czeniem przychodz±cym i (automatycznie) wznowiona, 
jest traktowana jak pojedyncza sesja (choæby trwa³a nawet ca³y dzieñ :-) ).
GPRS jest bardzo u¿yteczny przy po³±czeniach shellowych.
Po³±czenie tekstowe/konsolowe z serwerem jest relatywnie tanie (chocia¿ do 
ka¿dego znaku nale¿y doliczyæ nag³ówek IP) i nie ma ci±g³ej presji czasu
jak w przypadku zwyk³ego po³±czenia dial-up przez telefon komórkowy.
</para>

<para>
Naturalnie, system GPRS musi byæ wspierany przez telefon. 
Aktualnie coraz wiêcej telefonów ma wbudowanego GPRS-a, s± to m.in.: 
Nokia 6310, 6310i, 7650, 8310;
Ericsson R520, T65i, T39, T68;
Siemens ME45, M50, S55 
i wiele innych.
</para>

<para>
Sesje GPRS mog± byæ uruchamiane na dwa sposoby: 
<itemizedlist>
<listitem><para>Z poziomu telefonu, wówczas telefon pe³ni
funkcjê terminala:
<programlisting>
Telefon ---- GPRS ---- sieæ GSM ---- Internet
</programlisting>
Mo¿liwe zastosowania to m.in. WAP over GPRS  (tu op³ata jest z regu³y wy¿sza
ni¿ przy dostêpie do Internetu), SMS over GPRS (z rzadka wspierany), 
dostêp do Internetu przez MIDlety (programy w Javie na telefony komórkowe).
Niewielkie mo¿liwo¶ci terminalowe telefonów (przede wszystkim ma³y 
wy¶wietlacz) ograniczaj± mo¿liwo¶ci zastosowañ.
</para></listitem>
<listitem><para>Z poziomu komputera (wówczas telefon spe³nia funkcjê
modemu):
<programlisting>
Komputer PC ----  RS-232  ---- Telefon ---- GPRS ---- sieæ GSM ---- Internet
Komputer PC ----   IrDA   ---- Telefon ---- GPRS ---- sieæ GSM ---- Internet
Komputer PC ---- Bluetooth ---- Telefon ---- GPRS ---- sieæ GSM ---- Internet
</programlisting>
Klasyczn± ju¿ metod± po³±czenie telefonu do komputera specjalnym kablem
(RS-232), który jest przy³±czany do portu szeregowego (czyli COM-a). 
Ceny takich kabli s± z regu³y dosyæ wysokie (ok. 150 z³), poza
tym ka¿dy producent ma w³asne standardy (Nokia ma ich kilka!), wiêc
nie jest to rozwi±zanie przeno¶ne. Ostatnio rosn±c± popularno¶ci± ciesz± 
siê po³±czenia bezprzewodowe - IrDA, oraz, wci±¿ jeszcze
ma³o popularny - bo drogi - Bluetooth. 
Wybranie IrD-y jako medium komunikacyjnego z telefonem ma w przypadku
GPRS-u pewien mankament: otó¿ gdy odbieramy rozmowê telefoniczn±
w trakcie po³±czenia GPRS to z regu³y musimy podnie¶æ telefon i tym samym
zerwaæ komunikacjê w podczerwieni. Nawet, gdy po zakoñczeniu rozmowy
od³o¿ymy telefon na miejsce, to sesja GPRS nie mo¿e byæ wznowiona.
Tego problemu nie ma w przypadku zastosowania kabla ani (najprawdopodobniej)
w przypadku systemu Bluetooth.
</para></listitem>
</itemizedlist>
</para>
<section id="irda"><title>IrDA</title>
<para>
W podrozdziale tym opisany jest sposób instalacji i konfiguracji 
systemu IrDA na Linuksie z jednym z nowszych systemów RedHat (rodzina
7.x, 8.x, 9.x). Starsze systemy RedHat wymaga³y ³at na j±dro (teraz IrDA
jest ju¿ standardowo wspierana) oraz doinstalowania pakietu 
<command>irda-utils</command>
(obecnego w nowszych wersjach systemu).
</para>

<para>
IrDA jest obecna we wszystkich obecnie produkowanych laptopach 
a wyposa¿enie komputera stacjonarnego w system IrDA (dioda podczerwieni 
pod³±czana do p³yty g³ównej) to kwestia kilkudziesiêciu z³otych. 
</para>
<para>
Zanim zaczniemy konfigurowaæ IrD-ê na Linuksie, powinni¶my dok³adnie
dowiedzieæ siê jakie s± ustawienie w naszym systemie (sprawdziæ w BIOS-ie).
Czêsto nale¿y uaktywniæ system IrDA, poniewa¿ mo¿e byæ standardowo wy³±czony.
Nale¿y sprawdziæ pod którym portem komunikacyjnym bêdzie widoczna IrDA.
W przypadku laptopów bêdzie to zwykle COM2, czyli 
<filename>/dev/ttyS1</filename>. Co ciekawe, niektóre systemy biurkowe,
wyposa¿one w dwa porty COM, podpinaj± IrD-ê pod COM2 - prawdopodobnie
wy³±czaj±c standardowy, <quote>kablowy</quote> port szeregowy. Warto tak¿e
sprawdziæ numer portu i przerwanie przydzielone przez BIOS.
</para>

<para>
Po w³±czeniu IrD-y w BIOS-ie i odczytaniu jej parametrów
uruchamiany Linuksa. 
Nastêpnie:
<itemizedlist>
<listitem><para>
Za pomoc± komendy <command>dmesg | grep tty</command> sprawdzamy, które
przerwanie przydzieli³o interesuj±cemu nas portowi komunikacyjnemu j±dro
Linuksa. Otrzymamy informacjê typu:
<programlisting>
ttyS00 at 0x03f8 (irq = 4) is a 16550A
ttyS01 at 0x02f8 (irq = 3) is a 16550A
</programlisting>
W tym przypadku port zosta³ skonfigurowany do u¿ywania portu 0x02f8 i
przerwania 3. Je¿eli nie zgadza siê to z ustawieniami w BIOS'ie, nale¿y
zmieniæ ustawienia portu za pomoc± komendy <command>setserial</command>, np.
je¿eli chcemy zmieniæ przerwania na 10, mo¿emy to uczyniæ komend±:
<programlisting>
# setserial /dev/ttyS1 port 0x02f8 irq 10
</programlisting>
Sprawdzamy czy wszystko posz³o tak jak zamierzali¶my:
<programlisting>
# setserial -g /dev/ttyS1
/dev/ttyS1, UART: 16550A, Port: 0x02f8, IRQ: 10
</programlisting>
Niestety, w wiêkszo¶ci przypadków je¿eli j±dro automatycznie nie przydziela
portowi dobrego przerwania, odpowiednie wywo³ania <command>setserial</command>
trzeba wykonywaæ przy ka¿dym starcie systemu, przed uruchomieniem IrD-y
(najlepiej dodaæ je do skryptów startowych systemu).
</para></listitem>
<listitem><para>
Dodajemy po pliku <filename>/etc/modules.conf</filename> wpis:
<programlisting>
alias tty-ldisc-11 irtty
alias char-major-161 ircomm-tty
</programlisting>
</para></listitem>

<listitem><para>
Modyfikujemy plik <filename>/etc/sysconfig/irda</filename> tak, 
¿eby wygl±da³ jak poni¿ej:
<programlisting>
IRDA=yes
DEVICE=/dev/ttyS1
DISCOVERY=yes
</programlisting>
Je¿eli u nas IrDA jest na innym porcie szeregowym ni¿ 
<filename>/dev/ttyS1</filename>, to nale¿y odpowiednio zmodyfikowaæ
zmienn± <filename>DEVICE</filename>.
</para></listitem>

<listitem><para>
Uruchamiamy IrD-ê:
<programlisting>
service irda start
</programlisting>
.. i sprawdzamy czy zosta³ uruchomiony proces <command>irattach</command>:
<programlisting>
ps auxw | grep irattach
</programlisting>
Je¶li tak - to wszystko w porz±dku. Je¶li nie - to problem. Najczêstsz±
przyczyn± jest z³y port szeregowy lub z³e ustawienia tego portu 
(np. przerwanie). Komunikat b³êdu mo¿na odczytaæ z 
<filename>/var/log/messages</filename>.
</para></listitem>

<listitem><para>
Dodajemy us³ugê <command>irda</command> do us³ug uruchamianych przy starcie
przez system RedHat (np. przy pomocy narzêdzia <command>ntsyv</command>).
</para></listitem>
</itemizedlist>
Teraz sprawdzamy czy nasz telefon zostanie wykryty przez system: w³±czamy
IrD-ê w telefonie i stawiamy naprzeciwko nadajnika 
(ang. <emphasis>transceiver</emphasis>) IrD-y.
Wywo³ujemy komendê:
<programlisting>
cat /proc/net/irda/discovery
</programlisting>
Je¶li telefon zosta³ wykryty, to program <command>cat</command> powinien
na wyj¶ciu na wyj¶ciu zwróciæ informacjê jak poni¿ej:
<programlisting>
IrLMP: Discovery log:

nickname: Nokia 6310i, hint: 0xb125, saddr: 0xb4bd12f0, daddr: 0x0000b624
</programlisting>
Warto¶ci nickname, hint, saddr i daddr mog± siê ró¿niæ w zale¿no¶ci od modelu 
telefonu - wa¿ny jest fakt pojawienia siê tej ca³ej linii. W przypadku 
niewykrycia urz±dzenia zostanie zwrócony pusty log:
<programlisting>
rLMP: Discovery log:

</programlisting>
Powodem jest zwykle niew³±czenie IrD-y w telefonie lub niewidzenie siê
czytnika IrD-y w telefonie i w komputerze (niektóre telefony maj± podczerwieñ
na czubku, a inne - z boku obudowy).
</para>
<para>
Je¶li telefon zosta³ wykryty, mo¿emy spróbowaæ siê po³±czyæ z telefonem 
za pomoc± programu
<command>minicom</command> (tu drobna dygresja: <command>minicom</command>
jest programem do komunikacji przez porty/³±cza szeregowe. W nomenklaturze
komputerowej cz³on <quote>com</quote>, <quote>COM</quote> lub 
<quote>comm</quote>, pochodz±cy zapewne od s³owa <quote>communication</quote>,
oznacza komunikacjê szeregow± (ang. <emphasis>serial 
communications</emphasis>), kojarzon± zwykle z portami szeregowymi, 
tzw. COM-ami w pececie i interfejsem RS-232. 
Jak siê ma IrDA to komunikacji szeregowej?
Otó¿ wiele standardów, w tym tak¿e bezprzewodowych, wspiera tryb komunikacji,
który jest identyczny do tego znanego z RS-232. W przypadku IrD-y tryb ten
zwie siê <emphasis>IrCOMM</emphasis> (<emphasis>Infared COMM</emphasis>)
a w przypadku Bluetootha <emphasis>RFCOMM</emphasis> (<emphasis>Radio Frequency COMM</emphasis>). Dziêki temu istnieje prosta 
mo¿liwo¶æ przeniesienia setek programów wykorzystuj±cych komunikacjê 
szeregow± do nowych zastosowañ oraz mo¿liwo¶æ tworzenia nowych aplikacji, 
w oparciu
o tradycyjny i opanowany sposób komunikacji. Program <command>minicom</command>
nie wie i nie musi wiedzieæ, ¿e porozumiewa siê
poprzez ³±cze bezprzewodowe. Koniec dygresji). 
Tu uwaga! Urz±dzeniem, które nale¿y wskazaæ programowi 
<command>minicom</command> jest <filename>/dev/ircomm0</filename> 
a nie <filename>/dev/ttyS1</filename>.
Sprawdzamy czy odpowiada na komendy Hayesa (AT). Odpowiada? 
Wiêc IrDA zosta³a zainstalowana.
</para>
</section> <!--  IrDA -->

<section><title>GPRS - Konfiguracja <command>pppd</command></title>
<para>
Opisany tu sposób konfiguracji po³±czenia przez GPRS zosta³ zaczerpniêty 
z dokumentu Mikko Rapeliego pt.: <quote>Of Linux, GPRS Phones, Serial Cable,
IrDA, Bluetooth and USB</quote>
(<ulink url="http://www.iki.fi/mikko.rapeli/linux_gprs.html"
>http://www.iki.fi/mikko.rapeli/linux_gprs.html</ulink>)
i zmodyfikowany na potrzeby po³±czenia z sieci± Era przez telefon 
Nokia 6310i. W plikach pozostawiono angielskie komentarze autora, 
¿eby u³atwiæ ich dostosowanie do innych konfiguracji (np. Plus GSM, telefony
Siemensa itd.). Thank you, Mikko. Good job.
</para>
<para>
¯eby skonfigurowaæ program <command>pppd</command> w celu obs³ugi
systemu GPRS, nale¿y stworzyæ 4 pliki:

<itemizedlist>

<listitem><para>
Plik <filename>/etc/ppp/peers/gprs</filename> o zawarto¶ci:
<programlisting>
# File: gprs
#
# Description:
# Serial cable, IrDA, Bluetooth and USB pppd options for GPRS phones.

# Keep pppd attached to the terminal:
# Comment this to get daemon mode pppd
#nodetach
updetach
# Opcja updatach oznacza, ze pppd odlaczy siê od terminala dopiero
# gdy zostanie nawiazane polaczenie.

# Debug info from pppd:
# Comment this off, if you don't need more info
debug

# Show password in debug messages
show-password

# Connect/Disconnect scripts:

connect "/usr/sbin/chat -v -f /etc/chatscripts/gprs-connect-chat"

disconnect "/usr/sbin/chat -v -f /etc/chatscripts/gprs-disconnect-chat"

# Serial device to which the GPRS phone is connected:
# /dev/ttyS0 for serial port (COM1 in Windows), 
/dev/ircomm0 
# /dev/ircomm0 for IrDA,
# /dev/ttyUB0 for Bluetooth (Bluez with rfcomm running) and
# /dev/ttyUSB0 for USB
#/dev/ttyS0	# serial port one
#/dev/ttyS1	# serial port two
#/dev/ircomm0	# IrDA serial port one
#/dev/rfcomm0	# Bluetooth serial port one
#/dev/ttyUSB0	# USB serial device, for example Orange SPV

# Serial port line speed
#115200	# fast enough
57600	# perhaps usefull with IrDA

# Hardware flow control:
# Use hardware flow control with cable, Bluetooth and USB but not with IrDA.
#crtscts  # serial cable, Bluetooth and USB
nocrtscts # IrDA

# Ignore carrier detect signal from the modem:
local

# IP addresses:
# - accept peers idea of our local address and set address peer as 10.0.0.1 
# (any address would do, since IPCP gives 0.0.0.0 to it)
# - if you use the 10. network at home or something and pppd rejects it,
# change the address to something else 
:10.0.0.1

# pppd must not propose any IP address to the peer!
noipdefault

# Accept peers idea of our local address
ipcp-accept-local

# Add the ppp interface as default route to the IP routing table
defaultroute

# DNS servers from the phone:
# some phones support this, some don't.
usepeerdns

novj
nobsdcomp
novjccomp
nopcomp
noaccomp

# The phone is not required to authenticate:
noauth

# Username and password:
# If username and password are required by the APN, put here the username 
# and put the username-password combination to the secrets file: 
# /etc/ppp/pap-secrets for PAP and /etc/ppp/chap-secrets for CHAP 
# authentication. See pppd man pages for details.
# Example, Radiolinja operator pap-secrets: 
# "rlnet"         *       "internet"	*
user "erainternet"

# Asyncmap:
# some phones may require this option.
#asyncmap 0xa0000

# No magic:
# some phones may require this option.
#nomagic

# Require PAP authentication:
# some phones may require this option.
#require-pap
</programlisting>
</para></listitem>

<listitem><para>
Plik <filename>/etc/chatscripts/gprs-connect-chat</filename> o nastêpuj±cej tre¶ci:
</para>
<para>
Uwaga! Pod tre¶ci± skryptu jest kilka s³ów wyja¶nienia. Przeczytaæ koniecznie!  
</para>
<para>
Zawarto¶æ pliku:
<programlisting>
# File: gprs-connect-chat
#
# Description: 
#
# Set PDP context CID=1, protocol=IP, APN=internet:
# AT+CGDCONT=1,"IP","internet","",0,0
#
# Set CID=1 QoS requirements from the network, not supported by Nokia:
# AT+CGQREQ=1,0,0,0,0,0
#
# Set CID=1 minimum acceptable QoS parameters, not supported by Nokia:
# AT+CGQMIN=1,0,0,0,0,0
#
# 'Call' CID=1 (activate PDP context one, perform GPRS attach):
# ATD*99***1#
#
# Some phones like the Orange SPV (yes, the Microsoft Smartphone) use this 
# dial string to start GPRS connection:
# ATD*99#
#
# The actual chat script:

TIMEOUT		5
ECHO 		ON
ABORT		'\nBUSY\r'
ABORT		'\nERROR\r'
ABORT		'\nNO ANSWER\r'	
ABORT		'\nNO CARRIER\r'
ABORT		'\nNO DIALTONE\r'
ABORT		'\nRINGING\r\n\r\nRINGING\r'
''		\rAT
TIMEOUT		12
SAY		"Press CTRL-C to close the connection at any stage!"
SAY		"\ndefining PDP context...\n"
OK		ATH
OK		ATE1
OK		'AT+CGDCONT=1,"IP","erainternet"'
OK		ATD*99***1#
TIMEOUT		22
SAY		"\nwaiting for connect...\n"
CONNECT		""
SAY		"\nConnected."
SAY		"\nIf the following ppp negotiations fail,\n"
SAY		"try restarting the phone.\n"
</programlisting>
</para>

<para>
Uwaga! W skrypcie powy¿ej wystêpuje nastêpuj±ca linia:
<programlisting>
	OK		'AT+CGDCONT=1,"IP","erainternet"'
</programlisting>
Jest ona specyficzna tylko dla operatora ERA (nazwa APN to <quote>erainternet</quote>).
Nale¿y j± zmieniæ w przypadku innych operatorów. Ustawienia dla polskich operatorów s±
nastêpuj±ce:
<itemizedlist>
<listitem><para>
Plus APN: <quote>www.plusgsm.pl</quote> (u¿ytkownik: brak, has³o: brak).
</para></listitem>
<listitem><para>
Idea APN: <quote>www.idea.pl</quote> (u¿ytkownik: ppp, has³o: ppp).
</para></listitem>
<listitem><para>
Era APN: <quote>erainternet</quote> (u¿ytkownik: erainternet, has³o: erainternet).
</para></listitem>
</itemizedlist>
</para>
<para>
Poni¿sza linia to wywo³anie odpowiedniego numeru GPRS:
<programlisting>
	OK		ATD*99***1#
</programlisting>
Ogólna sk³adnia polecenia wygl±da nastêpuj±co:
<programlisting>
ATD*99[*APN[*Protocol[*CID]]]# 
</programlisting>
gdzie zarówno <quote>APN</quote>, <quote>Protocol</quote> jak i <quote>CID</quote> 
s± opcjonalne (przyjmuj± wówczas warto¶ci domy¶lne). Warto¶ci <quote>Protocol</quote> 
nie nale¿y ustawiaæ nigdy - domy¶lne <quote>PPP</quote> jest jak najbardziej OK. 
Sk³adnia minimalna wygl±da nastêpuj±co:
<programlisting>
ATD*99# 
</programlisting>
Jest to jednak sk³adnia niezalecana przez niektórych producentów telefonów, szczególnie tych, które wspieraj± 
mo¿liwo¶æ wpisania wiêcej ni¿ jednego aktywnego punktu dostêpu (APN-a). 
Ka¿dy taki punkt jest wpisany w telefonie pod okre¶lon± pozycj± (1, 2, ..) - ta pozycja to jest w³a¶nie CID (connection ID).
Niektórzy operatorzy wpisuj± swoje ustawienia w sprzedawanych telefonach, zwykle trzeba to jednak zrobiæ rêcznie. 
Najbezpieczniejsz± sk³adni± jest taka, jak zaproponowano w pliku powy¿ej:
<programlisting>
	OK		ATD*99***1#
</programlisting>
czyli domy¶lny (lub ustawiony wcze¶niej komend± AT+CGDCONT) APN, protokó³ PPP i CID o numerze 1. 
Czasami jednak CID=1 mo¿e byæ zarezerwowany dla np. WAP-u po GPRS-ie (a nie pe³nego, modemowego dostêpu 
po Internetu). Wówczas mo¿e byæ konieczne ustawienie CID=2 lub CID=3, np.
<programlisting>
	OK		ATD*99***2#
</programlisting>

</para>

</listitem>

<listitem><para>
Plik <filename>/etc/chatscripts/gprs-disconnect-chat</filename> o zawarto¶ci:
<programlisting>
# File: gprs-disconnect-chat
#
# send break
exec /usr/sbin/chat -V -s -S
ABORT		"BUSY"
ABORT		"ERROR"
ABORT		"NO DIALTONE"
SAY		"\nSending break to the modem\n"
""		"\K"
""		"+++ATH"
SAY		"\nPDP context detached\n"
</programlisting>
</para></listitem>

<listitem><para>
Plik <filename>/etc/ppp/chap-secrets</filename> o zawarto¶ci:
<programlisting>
# Secrets for authentication using PAP
# client	server	secret			IP addresses
"erainternet" * "erainternet" *
</programlisting>
</para></listitem>
</itemizedlist>
Warto równie¿ stworzyæ 2 skrypty (z flag± wykonywalno¶ci), które
automatycznie ustawi± nam przekazane prze Erê adresy DNS-ów:

<itemizedlist>
<listitem><para>
Plik <filename>/etc/ppp/ip-up.local</filename> o zawarto¶ci:
<programlisting>
mv /etc/resolv.conf /etc/resolv.conf-pppbackup
cp -f /etc/ppp/resolv.conf /etc/resolv.conf
chmod a+r /etc/resolv.conf
</programlisting>
</para></listitem>

<listitem><para>
Plik <filename>/etc/ppp/ip-down.local</filename> o zawarto¶ci:
<programlisting>
mv /etc/resolv.conf-pppbackup /etc/resolv.conf
</programlisting>
</para></listitem>
</itemizedlist>

</para>
<para>
Uwaga! W przypadku telefonów Nokia 6310/6310i (mo¿e te¿ innych?) stwierdzili¶my objaw zrywania
po³±czenia GPRS po ok. dwóch minutach. ¯eby siê go pozbyæ, nale¿y 
otworzyæ plik <filename>/etc/ppp/options</filename> i sprawdziæ czy w pliku jest nastêpuj±ca 
linia (lub podobna):

<programlisting>
lcp-echo-failure 4
</programlisting>

Je¶li jest - nale¿y j± usun±æ albo wykomentowaæ. 
Nale¿y siê równie¿ upewniæ czy opcji tej nie ma w innych plikach odczytywanych przy po³±czeniu,
mo¿na to sprawdziæ np. programem <command>grep</command>:

<programlisting>
grep -r lcp-echo-failure /etc/ppp
</programlisting>

</para>

<para>
Teraz czas na przetestowanie po³±czenia. Wywo³anie komendy:
<programlisting>
pppd call gprs
</programlisting>
spowoduje odczytanie przez <command>pppd</command> pliku 
<filename>/etc/ppp/peers/gprs</filename> i uruchomienie 
zawartych tam instrukcji.
<!-- TODO: wiecej o mechanizmie call i peers/ ? -->
Na wyj¶ciu powinni¶my otrzymaæ komunikaty drukuj±ce kolejne fazy
po³±czenia: komendy AT, wybieranie numeru i otrzymanie adresu IP.
Powinny nam zostaæ równie¿ przes³ane adresy IP serwerów DNS (ostatni
komunikat przed od³±czeniem siê od terminala).
Za obs³ug± opcja adresów IP serwerów DNS stoi opcja 
<command>usepeerdns</command>, dziêki której adresy
IP zostan± umieszczone w pliku <filename>/etc/ppp/resolv.conf</filename>,
a nastêpnie przekopiowane przez nasz skrypt 
<filename>/etc/ppp/ip-up.local</filename> 
do <filename>/etc/resolv.conf</filename>.
Zakoñczenie po³±czenia nastêpuje przez wywo³anie:
<programlisting>
killall pppd
</programlisting>
Ta barbarzyñska z pozoru metoda zakoñczenia po³±czenia sprawuje 
siê wy¶mienicie, w tym wywo³uje skrypty <filename>/etc/ppp/if-down</filename>
i <filename>/etc/ppp/if-down.local</filename> (czyli zamyka po³±czenie
w sposób, jaki by¶my oczekiwali).
</para>

<para>
W przypadku po³±czenia GPRS istotna jest ilo¶æ wys³anych i odebranych
bajtów. Informacjê tê mo¿na zdobyæ wywo³uj±c komendê 
<command>pppstats</command> (przed zakoñczeniem po³±czenia!).
</para>

</section> <!-- pppd/gprs -->


<section id="gcxx"><title>Instalacja modemów Sony Ericsson GC75, GC75e, GC85, GC89</title>

<para>
W tym podrozdziale zostanie opisana instalacja modemów GPRS Sony Ericsson GC75
i GC75e oraz konfiguracja pppd dla po³±czenia GPRS IDEA.
</para>

<para>
Obie karty PCMCIA s±  standardowo wykrywane. Je¶li nasz modem nie jest wykrywany, powinni¶my siê upewniæ czy nasze j±dro jest odpowiednio skonfigurowane. 
Przyk³ad poprawnej konfiguracji j±dra.
</para>

<para>
I tak dla:
<itemizedlist>
<listitem><para>
J±der serii 2.4 :
<programlisting>
General setup  --->
  [*] Support for hot-pluggable devices
  PCMCIA/CardBus support  --->
    [M] PCMCIA/CardBus support
    [*]   CardBus support
    [*]   Databook TCIC host bridge support
    [ ]   i82092 compatible bridge support
    [*]   i82365 compatible bridge support
Character devices  --->
  PCMCIA character devices  --->
    [M] PCMCIA serial device support
    [ ] SyncLink PC Card support
</programlisting></para>
</listitem>
<listitem><para>
J±der serii 2.6 :
<programlisting>
General setup  --->
  [*] Support for hot-pluggable devices
Bus options (PCI, PCMCIA, EISA, MCA, ISA)  --->  
  PCCARD (PCMCIA/CardBus) support  --->
      [M] PCCard (PCMCIA/CardBus) support          
      [ ]   Enable PCCARD debugging    
      [ ]   Enable obsolete PCCARD code 
      [M]   16-bit PCMCIA support    
      [*]   32-bit CardBus support    
      --- PC-card bridges    
      [M] CardBus yenta-compatible bridge support  
      [ ] Cirrus PD6729 compatible bridge support   
      [M] i82092 compatible bridge support 
      [M] i82365 compatible bridge support 
      [ ] Databook TCIC host bridge support
Device Drivers  ---> 	  
   Character devices  --->
      Serial drivers     ---> 
          [*] 8250/16550 and compatible serial support
          [*]   Console on 8250/16550 and compatible serial port   
          [M]   8250/16550 PCMCIA device support  
          [ ]   8250/16550 device discovery via ACPI namespace   
</programlisting>
</para>
</listitem>
</itemizedlist>
</para>
<para>
Przy tak skonfigurowanym j±drze po wsuniêciu karty PCMCIA do slotu powinni¶my  
zobaczyæ komunikat wygl±daj±cy mniej wiêcej tak:
<programlisting>ttyS0 at I/O 0x3f8 (irq = 3) is a 16550A</programlisting>
Je¶li korzystamy z X'ów mo¿emy skorzystaæ  z polecenia <command>dmesg</command>.
Je¶li nasz modem zostanie wykryty np. jako ttyS14, a w /dev nie ma takiego urz±dzenia nale¿y je utworzyæ np.
<programlisting>
# mknod /dev/ttyS14 c 4 78
</programlisting>

</para>
<para>
WA¯NE: W przypadku gdy nasz modem to GC89, musimy wykonaæ nastêpuj±ce czynno¶ci.
</para>
<para>
Musimy zainstalowaæ setserial, w przypadku Debiana mo¿emy pos³u¿yæ siê apt-get.
<programlisting>
# apt-get install setserial
</programlisting>
Nasza karta jest "do¶æ wybredna" je¶li chodzi o prêdko¶æ z jak± bêdzie chcia³a z nami rozmawiaæ.
Mamy dwie mo¿liwo¶ci:
<itemizedlist>
<listitem>
<para><programlisting>
# setserial /dev/ttyS14 spd_shi
# setserial /dev/ttyS14 baud_base 460800
</programlisting>
Teraz nasz port szeregowy powinien rozmawiaæ z prêdko¶ci± 38400 (standardowo ustawiona w minicomie).
</para>
</listitem>
<listitem>
<para><programlisting>
# setserial /dev/ttyS14 baud_base 460800
</programlisting>
Teraz nasz port szeregowy powinien rozmawiaæ z prêdko¶ci± 230400 (dzia³a w wiêkszo¶ci przypadków.)</para></listitem>
</itemizedlist>
Pamiêtajmy o wpisaniu poprawnej prêdko¶ci do plików konfiguracyjnych pppd.
</para>
<para>
Aby uruchomiæ modu³ wlan, musimy skorzystaæ z ndiswrapper'a. Dok³adny opis instalacji ndiswrappera
znajdziemy w <xref linkend="wlan-linux">. 
Nasze drivery znajdziemy na do³±czonej p³ycie do SE GC89 (Wlan-2k/semwl5.inf). 
</para>

<para>
W tym momencie nasz modem PCMCIA jest gotowy do pracy. Zosta³a nam jeszcze konfiguracja
pppd.

</para>
<para> 
Je¶li jeste¶my u¿ytkownikami Debiana, mo¿emy pomin±æ nastêpne rozdzia³y i zainstalowaæ paczkê edge-gprs udostêpnian± przez PRATERM S.A. Konfiguracja jest bardzo prosta i na pewno ka¿dy sobie poradzi, wystarczy odpowiedzieæ na kilka pytañ. 
</para>
</section>

<section id="ogtf">
<title>Instalacja OptionGlobeTrotter Fusion+ </title>
<para>
Modem korzysta ze sterowników nozomi, które s± obecne w nowszych j±drach (na pewno 2.6.26).
Je¶li mamy starszy modem, musimy ¶ci±gn±æ sterowniki ze strony 
<filename>http://www.pharscape.org/3G/nozomi_060209.tar.gz</filename>,
a nastêpnie je skompilowaæ. Aby tego dokonaæ, powinni¶my zaopatrzyæ siê w ¼ród³a/nag³ówki j±dra. 
</para>
<para>
Nastêpnie standardowo <command>make</command> i powinni¶my otrzymaæ plik <filename>nozomi.ko</filename>.
W przypadku problemów ze znalezieniem katalogu ze ¼ród³ami, mo¿emy u¿yæ opcji <command>-I/path/to/kernel
</command>.
Po za³adowaniu modu³u nasz modem jest dostêpny jako /dev/noz0 ... /dev/noz3. Je¶li urz±dzenia nie zosta³y automatycznie stworzone, musimy zrobiæ to rêcznie:
</para>
<para><programlisting>
mknod /dev/noz0 c 241 0
mknod /dev/noz1 c 241 1
mknod /dev/noz2 c 241 2
mknod /dev/noz3 c 241 3
</programlisting></para>
<para>
Transmisja danych odbywa siê na urz±dzeniu /dev/noz0, jednak w tym samym czasie mo¿emy komunikowaæ siê z modemem w /dev/noz2. Jest to pewne udogodnienie, poniewa¿ teoretycznie pozwala na badanie si³y sygna³u podczas transmisji (czego nie umo¿liwiaj± modemy Sony Ericsson GC8X) oraz np. dostêp do skrzynki sms, spisu telefonów itp. 
</para>
<para>
Ostatnim etapem, opcjonalnym jest umieszczenie nozomi.ko w katalogu z modu³ami. Robimy to w zale¿no¶ci od posiadanej przez nas dystrybucji, zazwyczaj <filename>/lib/modules/2.X.X/...</filename>
</para>
<para> 
Je¶li jeste¶my u¿ytkownikami Debiana, mo¿emy pomin±æ nastêpne rozdzia³y i zainstalowaæ paczkê edge-gprs udostêpnian± przez PRATERM S.A. Konfiguracja jest bardzo prosta i na pewno ka¿dy sobie poradzi, wystarczy odpowiedzieæ na kilka pytañ. 
</para>

</section>

<section id="gprs-reset">
<title>Resetowanie modemów GPRS (GCXX i OGTFusion+) </title>
<para>
W przypadku modemów Sony Ericsson GCXX sprawa jest bardzo prosta. Po zaopatrzeniu siê w pakiet pcmcia-cs wydajemy po prostu polecenie: <command>cardctl eject</command> a nastêpnie <command>cardctl insert</command>.
</para>
<para>
Gdy posiadamy OptionGlobeTrotter Fusion+, sprawa nieco siê komplikuje. Gdyby¶my u¿yli metody z GCXX, nast±pi³by kernel panic. Poprawnym rozwi±zaniem jest najpierw zabicie pppd, a nastêpnie usuniêcie w odpowiedniej kolejno¶ci modu³ów. I tak:
<programlisting>
killall pppd
rmmod ppp_async
rmmod ppp_generic
rmmod nozomi
cardctl eject
cardctl insert
modprobe nozomi
</programlisting>
</para>
</section>

<section id="gprs-login">
<title>Logowanie siê do sieci GPRS</title>
<para>
Aby zalogowaæ siê do sieci gprs, musimy w w przypadku Sony Ericsson GCXX podczas komunikacji z modemem wpisaæ:
<programlisting>
AT+CFUN=1,1
AT+CPIN=TWÓJ_PIN
</programlisting>
</para>
<para>
W przypadku OptionGlobeTrotter Fusion+:
<programlisting>
AT+CPIN=TWÓJ_PIN
</programlisting>
</para>
</section>

<section id="pppd-gprs">
<title> Ogólna konfiguracja pppd dla modemów GCXX i OGTFusion+.</title>
<para>
Poni¿ej jest zamieszczony najogólniejszy zestaw plików ppp, który powinien dzia³aæ zarówno dla GCXX jak i OGTFusion+.
</para>
<para>
<filename>/etc/ppp/peers/edge-gprs</filename>
<programlisting>
debug

# Max speed
230400

# Do not use hardware flow control
nocrtscts

# Don't keep pppd attached to the terminal:
updetach

# Connection options
nodeflate

lcp-echo-interval 0
# Path to chat script connect/disconnect
connect "/usr/lib/edge-gprs/edge-gprs-connect-chat"

# IP address configuration
:20.0.0.1
noipdefault
usepeerdns

novj
novjccomp
nobsdcomp
defaultroute
# Enter below your path to modem
/dev/ttyS1

</programlisting>
<filename>/usr/lib/edge-gprs/edge-gprs-connect-chat</filename>
<programlisting>
/usr/sbin/chat \
TIMEOUT  20 \
ECHO     ON \
ABORT    '\nBUSY\r' \
ABORT    '\nERROR\r' \
ABORT    '\nNO ANSWER\r' \
ABORT    '\nNO CARRIER\r' \
ABORT    '\nNO DIALTONE\r' \
ABORT    '\nRINGING\r\n\r\nRINGING\r' \
SAY      "Press CTRL-C to close the connection at any stage!" \
TIMEOUT  60       \
''       '\rAT'   \
OK       'ATE1'   \
OK       'AT+CGDCONT=1,"IP","AP_OPERATORA"' \
OK       'ATD*99***1#'  \
TIMEOUT  30   \
CONNECT  ""    \
SAY      "\nConnected."  
</programlisting>
Teraz tylko pppd call edge-gprs i powinni¶my uzyskaæ po³±czenie.
</section>

<section id="gprs-isp">
<title>Operatorzy GPRS.</title>
<itemizedlist>
<listitem>
<para>

<filename>ERA - </filename> AP_OPERATORA to <quote>erainternet</quote>. Dodatkowo wpisujemy do <filename>/etc/ppp/pap-secrets</filename><quote>erainternet * erainternet </quote>oraz do <filename>/etc/ppp/peers/edge-gprs</filename><quote>user erainternet</quote> oraz <quote>auth</quote>
</para></listitem>
<listitem>
<para>
<filename>IDEA(ORANGE) - </filename> AP_OPERATORA to <quote>www.idea.pl</quote>. Dodatkowo do /etc/ppp/peers/edge-gprs dopisujemy <quote>noauth</quote>.
</para></listitem>
<listitem>
<para>
<filename>PLUS - </filename> AP_OPERATORA to <quote>www.plusgsm.pl</quote>. Dodatkowo do /etc/ppp/peers/edge-gprs dopisujemy <quote>noauth</quote>.
</para>
<para>
<filename>PLAY - </filename> AP_OPERATORA to <quote>internet</quote>. Dodatkowo do /etc/ppp/peers/edge-gprs dopisujemy <quote>noauth</quote>.
</para>
</listitem>
</itemizedlist>
</section> <!-- gprs-isp -->

<section id="gprs-forcegprs">
<title>Wymuszanie GPRS/UMTS</title>
<para>
	W przypadku np. s³abego zasiêgu mo¿emy chcieæ wymusiæ korzystanie z wolniejszej technologii
	GPRS zamiast szybszego UMTS. W takich sytuacjach do skryptu chat po³±czenia musimy 
	dodaæ (np. przed komend± AT+CGDCONT) jedn± z nastêpuj±cych komend:
<itemizedlist>
	<listitem><para>Aby wymusiæ korzystanie z GPRS:<programlisting>OK  'AT_OPSYS=0,2' \</programlisting></para></listitem>
	<listitem><para>Aby wymusiæ korzystanie z UMTS:<programlisting>OK  'AT_OPSYS=1,2' \</programlisting></para></listitem>
	<listitem><para>Aby ustawiæ preferowanie GPRS przed UMTS:<programlisting>OK  'AT_OPSYS=2,2' \</programlisting></para></listitem>
	<listitem><para>Aby ustawiæ preferowanie UMTS przed GPRS:<programlisting>OK  'AT_OPSYS=3,2' \</programlisting></para></listitem>
</itemizedlist>
</para>
</section> <!-- grps-forcegprs -->

<section id="gprs-debian">
<title>Konfiguracja po³±czenia GPRS w systemach Debian</title>
<para>
Je¶li mamy w miarê aktualn± dystrybucjê Debian/Ubuntu, konfiguracja po³±czenia GPRS powinna byæ
do¶æ prosta i dobrze integrowaæ siê z mechanizmem zarz±dzania po³±czeniami sieciowymi. Modem powinien
byæ wykryty automatycznie (co mo¿na sprawdziæ komend± <command>dmesg</command>), w razie problemów 
nale¿y tylko upewniæ siê ¿e korzystamy z w miarê nowego j±dra.
</para>
<para>
	W pliku <filename>/etc/network/interfaces</filename> umieszczamy wpis typu (podana ni¿ej jest 
	przyk³adowa konfiguracja dla Era GSM i modemu Huawei E160):
<programlisting>
iface ppp0 inet ppp
	provider e160
</programlisting>
Nazwa <emphasis>e160</emphasis> mo¿e byæ dowolnie wybrana, pó¼niej tylko nale¿y u¿yæ jej konsekwentnie
w nazwach skryptów z opcjami PPP i skryptu chat.
</para>
<para>
Zamiast zmieniaæ globalne opcje PPP, tworzymy plik <filename>/etc/ppp/peers/e160</filename> o zawarto¶ci:
<programlisting>
# Debug info from pppd:
# You can comment this off, if you don't need more info
debug

# Max speed
#230400

# Use hardware flow control
nocrtscts

# Don't keep pppd attached to the terminal:
updetach

# Connection options
nodeflate

lcp-echo-interval 0
# Path to chat script connect/disconnect
connect "/etc/ppp/peers/e160-chat"
# we don't need special script for that modem
#disconnect "/etc/ppp/peers/e160-disconnect"

# IP address configuration 
:20.0.0.1
noipdefault
usepeerdns

novj
novjccomp
nobsdcomp
defaultroute
/dev/ttyUSB0
user erainternet
noauth
</programlisting>
</para>
<para>
Na koniec potrzebujemy jeszcze skryptu chat - <filename>/etc/ppp/peers/e160-chat</filename> o zawarto¶ci:
<programlisting>
OP=erainternet
PIN=9999
SLEEP=5

/usr/sbin/chat \
TIMEOUT	20 \
ABORT    '\nERROR\r' \
ECHO	ON \
SAY	"\r\nSetting PIN - this can fail" \
''	'\rAT' \
OK	 'ATZ' \
'OK'	"AT+CPIN=$PIN" \
'OK'	'' \
SAY	"\r\nWaiting $SLEEP seconds" && sleep $SLEEP

/usr/sbin/chat \
TIMEOUT  20 \
ECHO     ON \
ABORT    '\nBUSY\r' \
ABORT    '\nERROR\r' \
ABORT    '\nNO ANSWER\r' \
ABORT    '\nNO CARRIER\r' \
ABORT    '\nNO DIALTONE\r' \
ABORT    '\nRINGING\r\n\r\nRINGING\r' \
TIMEOUT  30       \
''       '\rAT'   \
OK       'ATE1'   \
OK	 'AT+IFC=0,0' \
OK       "AT+CGDCONT=1,\"IP\",\"$OP\",\"\",0,0" \
OK       'ATD*99***1#'  \
TIMEOUT  30   \
CONNECT  ""    \
SAY      "\nConnected.\n"  \
</programlisting>
</para>
<para>
Przy takiej konfiguracji w³±czanie i wy³±czanie po³±czenia mo¿emy robiæ standardowymi komendami 
<command>ifup ppp0</command> oraz <command>ifdown ppp0</command>.
</para>
</section> <!-- gprs-debian -->

<section id="uno-gprs">
<title>Modemy GPRS w komputerach UNO </title>

<para>
Je¶li zauwa¿ymy, ¿e nasz modem dzia³a bardzo wolno, albo ¿e nie dzia³a prawie w ogóle (szczególnie w przypadku komputerów UNO), najprawdopodobniej jest to wina przerwañ. W przypadku komputerów UNO, musimy w Bios'ie zmieniæ ustawienia przerywania IRQ 9 z ISA/PNP na PCI/Legacy. Modem powinien zacz±æ dzia³aæ z normaln± prêdko¶ci±. Dotyczy to zarówno modemów GCXX, jak i OGTFusion+. 

</para>

</section>

</section> <!-- gprs --> 

<section id="pppd-debug">

<title>Diagnozowanie problemów z pppd</title>

<para>
Czasami pojawia siê potrzeba dok³adnego ¶ledzenia dzia³añ wykonywanych przez demona pppd.
Je¿eli korzystamy z w³asnych skryptów 'chat', wiêkszo¶æ komunikacji z modemem znajdzie
siê w logach systemowych. Nieco inaczej jest np. w przypadku konfigurowania po³±czenia SDI.
</para>

<para>
Aby zmusiæ demona pppd do wypisywania szczegó³ów komunikacji z modemem, nale¿y:
<itemizedlist>

<listitem><para>
Upewniæ siê ¿e w pliku <filename>/etc/ppp/options</filename> jest opcja <emphasis>debug</emphasis> - 
je¶li jej nie ma, trzeba dopisaæ liniê ze s³owem <emphasis>debug</emphasis>.
</para></listitem>

<listitem><para>
Zmodyfikowaæ ewentualnie plik konfiguracyjny demona syslog - <filename>/etc/syslog.conf</filename>
tak, aby przekierowaæ do logów tak¿e komunikaty o poziomie wa¿no¶ci <emphasis>debug</emphasis>. 
Szczegó³y zale¿± od dystrybucji - pod Debianem zwykle komunikaty te domy¶lnie l±duj± w 
/var/log/debug. Pod RedHatem i pochodnymi nale¿y dopisaæ raczej gdzie¶ z ty³u pliku liniê postaci:
<programlisting>
*.debug                            /var/log/messages
</programlisting>
Nale¿y pamiêtaæ, aby po usuniêciu problemu przywróciæ poprzedni± postaæ pliku.
</para></listitem>

<listitem><para>
Aby zmiany zosta³y zauwa¿one, nale¿y zrestartowaæ demona syslogd lub wys³aæ do dzia³aj±cego procesu
sygna³ SIGHUP. Je¿eli nie chcemy restartowaæ dzia³aj±cego demona pppd, mo¿na, zamiast dodawaæ opcjê
<emphasis>debug</emphasis> do pliku <filename>/etc/ppp/options</filename>, wys³aæ do dzia³aj±cego
procesu sygna³ SIGUSR1 (1). Wys³anie sygna³u dzia³a jak prze³±cznik - w³±cza i wy³±cza opcjê 
<emphasis>debug</emphasis>.
</para></listitem>

</itemizedlist>
</para>

<section id="gprs-hwerr">
<title>Lista niekompatybilnego sprzêtu</title>

<para>
<itemizedlist>
<listitem><para>
Sony Ericsson GC89 + Przej¶ciówka PCI->PCMCIA + P³yta G³owna Intel'a oparta na i915.
</para></listitem>
</itemizedlist>
</para>

</section>

</section> <!-- pppd-debug -->

</section> <!-- id="point-to-point" -->

<section id="ssh">

<title>Konfigurowanie <command>ssh</command> (klient, serwer, tunelowanie)</title>
<para>
Program <command>ssh</command> (<emphasis>Secure Shell</emphasis>) s³u¿y do logowania siê
na zdalne komputery (przez sieæ) i zdalnego wykonywania komend. W 
przeciwieñstwie do programów typu <command>rsh</command> czy 
<command>telnet</command> oferuje bezpieczn±, szyfrowan± komunikacjê, 
uniemo¿liwia wiêc ewentualne pods³uchiwanie transmisji. Autoryzacja
u¿ytkownika mo¿e siê odbywaæ na kilka sposobów. Najprostszym jest autoryzacja
przy pomocy podawanego przez u¿ytkownika has³a. Po uruchomieniu komendy:
<programlisting>
ssh login@host
</programlisting>
program pyta siê o has³o. <emphasis>login</emphasis> oznacza tu nazwê u¿ytkownika,
a <emphasis>host</emphasis> nazwê komputera, np. <emphasis>kazik@mail.praterm.com.pl</emphasis>.
Czêsto przydatne jest, aby <command>ssh</command> nie pyta³ siê o has³o - umo¿liwia
to miêdzy innymi wygodne u¿ywanie <command>ssh</command> z programów 
nieinterakcyjnych (np. przez system BODAS).
</para>

<para>
Skonfigurowanie <command>ssh</command> wymaga kilku prostych kroków:
<itemizedlist>

<listitem>
<para>
W systemie musz± byæ zainstalowane odpowiednie pakiety, zawieraj±ce miêdzy
innymi program <command>ssh</command> (pod Debianem s± to pakiety
openssh-client dla programu ssh i openssh-server dla serwera ssh). Praktycznie
wszystkie wspó³czesne dystrybucje Linuksa zawieraj± domy¶lnie te pakiety.
</para>
</listitem>

<listitem>
<para>
Nastêpnie mo¿na skonfigurowaæ <command>ssh</command> tak, ¿eby nie by³o 
konieczne podawanie has³a.
</para>

<para>
Za³ó¿my, ¿e np. u¿ytkownik <emphasis>janosik</emphasis> na komputerze
<emphasis>alpha</emphasis> chce siê logowaæ na komputer 
<emphasis>beta</emphasis> jako
u¿ytkownik <emphasis>ondraszek</emphasis>. W tym celu 
<emphasis>janosik</emphasis> musi sprawdziæ, czy w jego katalogu domowym, w
podkatalogu <filename>.ssh</filename> znajduj± siê pliki
<filename>id_rsa</filename> i <filename>id_rsa.pub</filename>. Pliki te
zawieraj± klucz prywatny i publiczny. Je¿eli ich nie mamy, to mo¿emy
je stworzyæ przez wywo³anie:
<programlisting>
ssh-keygen -t rsa
</programlisting>
Na zadawane przez program pytania
nale¿y odpowiadaæ naciskaj±c po prostu <emphasis>Enter</emphasis>,
czyli wybieraj±c warto¶ci domy¶lne.
</para>
<para>
Plik <filename>.ssh/id_rsa</filename> jest naszym kluczem publicznym - nale¿y
go chroniæ i nikomu nie udostêpniaæ. Natomiast plik
<filename>.ssh/id_rsa.pub</filename> kopiujemy na konto u¿ytkownika
<emphasis>ondraszek</emphasis> na komputerze <emphasis>beta</emphasis> i
dodajemy do pliku <filename>.ssh/authorized_keys2</filename> - je¿eli tego
pliku nie ma, musimy go stworzyæ. Sekwencja komend do wykonania mog³aby
wygl±daæ tak:
<programlisting>
scp .ssh/id_rsa.pub ondraszek@beta:
ssh ondraszek@beta
mkdir -p .ssh
cat id_rsa.pub >> .ssh/authorized_keys2
</programlisting>
Wa¿ne jest te¿ ustawienie odpowiednich praw zapisu - katalog
<filename>.ssh</filename> powinien
mieæ tylko prawa odczytu i zapisu dla w³a¶ciciela, a plik
<emphasis>authorized_keys2</emphasis> dodatkowo prawa odczytu dla innych.
Je¿eli uprawnienia bêd± nieprawid³owe,
ssh odmówi u¿ycia klucza. W³a¶ciwe uprawnienia u¿ytkownik
<emphasis>ondraszek</emphasis> mo¿e ustawiæ przez wykonanie komend:
<programlisting>
chmod 0700 ~/.ssh
chmod 0644 ~/.ssh/authorized_keys2
</programlisting>
</para>
<para>
Teraz, po wpisaniu przez u¿ytkownika <emphasis>janosik</emphasis> na komputerze
<emphasis>alpha</emphasis> polecenia
<programlisting>
ssh ondraszek@beta
</programlisting>
powinno nast±piæ zalogowanie na komputer <emphasis>beta</emphasis>, bez pytania o has³o.
</para>
<para>
W razie wyst±pienia problemów z autoryzacj± trzeba uruchomiæ ssh 
w trybie verbose (ssh -v). Program wy¶wietli wtedy b³êdy, co znacznie 
u³atwia rozpoznanie problemu.
</para>
<para>
Powy¿szy opis odnosi siê do wersji drugiej protoko³u SSH. W starszych
dystrybucjach Linuksa domy¶lnie u¿ywana by³a wersja 1 protoko³u. Dla wersji
tej zamiast pliku <filename>authorized_keys2</filename> u¿ywany by³ plik
<filename>authorized_keys</filename>, generowany by³ klucz typu RSA1 (czyli
do generacji klucza wywo³anie <command>ssh-key -t rsa1</command>), klucz
domy¶lnie umieszczany by³ w plikach <filename>identity</filename> i
<filename>identity.pub</filename>. U¿ywan± wersjê protoko³u mo¿na wymusiæ
przez wpis <emphasis>Protocol 2,1</emphasis> w pliku
<filename>/etc/ssh/ssh_config</filename> (wa¿na jest kolejno¶æ liczb, mo¿na
te¿ zostawiæ tylko jedn± liczbê) lub przez opcjê w linii poleceñ ssh, np.
<emphasis>-1</emphasis>. Obecnie u¿ywanie wersji 1 protoko³u nie jest
zalecane, ze wzglêdu na mniejsze bezpieczeñstwo.
</para>
</listitem>

</itemizedlist>
</para>
<para>
Plikiem konfiguracyjnym dla klienta ssh jest 
<filename>/etc/ssh/ssh_config</filename>. Oprócz wspomnianej wy¿ej wersji
protoko³u mo¿emy ustawiæ globalnie kilka innych parametrów, miêdzy innymi.:
<itemizedlist>

<listitem><para>
StrictHostKeyChecking - ustawienie, czy klient ssh mo¿e automatycznie
dodawaæ hosty do pliku <filename>~/.ssh/known_hosts</filename>.
Przyjmuje jedn± z trzech warto¶ci: 'yes', 'no' lub 'ask' (warto¶æ domy¶lna).
Je¿eli ustawimy na 'yes', to wpisy bêd± dodawane automatycznie, 'no' 
oznacza, ¿e bêdziemy musieli wpisy dodawaæ rêcznie,
natomiast 'ask' oznacza, ¿e ssh sam bêdzie dodawa³ wpisy po potwierdzeniu u¿ytkownika.
</para>
<para>
Uwaga - je¶li dodamy klucz jakiego¶ komputera do pliku
<filename>known_hosts</filename> i bêdziemy próbowali po³±czyæ siê z innym
komputerem (o innym kluczu) u¿ywaj±cym z jakiego¶ powodu tego samego IP (czêste, je¶li np.
lokalne adresy IP w ró¿nych sieciach, z których korzystamy siê pokrywaj±), ssh
podniesie alarm, podejrzewaj±c ¿e kto¶ <quote>podmieni³</quote> komputer, na
który chcemy siê zalogowaæ. W szczególno¶ci nie pozwoli na zalogowanie siê na
taki komputer z u¿yciem has³a (logowanie po wymianie kluczy mimo ostrze¿enia
bêdzie mo¿liwe). Aby zalogowaæ siê za pomoc± has³a, musimy rêcznie w edytorze
tekstowym usun±æ odpowiedni± liniê z pliku
<filename>.ssh/known_hosts</filename>. Ka¿dy klucz trzymany jest w osobnej
linii, ssh poda w ostrze¿eniu numer linii, o któr± chodzi.
</para>
</listitem>
</itemizedlist>
Warto¶ci opcji z pliku konfiguracyjnego mo¿na tak¿e ustawiaæ bezpo¶rednio w
linii poleceñ, przy wywo³aniu program ssh, u¿ywaj±c nastêpuj±cej sk³adni:
<programlisting>
ssh -o StrictHostKeyChecking=no ondraszek@beta
</programlisting>
</para>
<para>
Plikiem konfiguracyjnym dla serwera SSH jest plik
<filename>/etc/ssh/sshd_config</filename>.
</para>

<section id="ssh-tunnel">
<title>Tunel zwrotny SSH</title>

<para>Czêsto jest potrzeba do dostania siê maszyny <quote>schowanej</quote> za bramk± 
internetow±. W przypadku rozwi±zañ typu NAT lub Masquarading, bezpo¶rednie po³±czenie siê 
ze schowanym komputerem z zewn±trz nie jest mo¿liwe. Mo¿liwa jest natomiast
inicjalizacja po³±czenia ssh z docelowego komputera i zalogowanie siê na niego
przez tak zwany tunel zwrotny.
</para>

<para>
Tunel ten tworzymy wywo³uj±c na docelowym komputerze nastêpuj±ce polecenie:
<programlisting>
ssh user@server -R 7777:localhost:22
</programlisting>
Podany numer portu - 7777 - jest przyk³adowy. Mo¿e byæ to dowolny numer portu
nieu¿ywany na komputerze <emphasis>server</emphasis>. Takie polecenie
spowoduje utworzenie tunelu zwrotnego - na docelowy komputer mo¿na siê
zalogowaæ z komputera <emphasis>server</emphasis> przez wydanie polecenia:
<programlisting>
ssh localhost -p 7777
</programlisting>
Je¿eli tunel ma byæ aktywny przez d³u¿szy czas, warto uruchamiaj±c tunel podaæ
dodatkowe polecenie, którego aktywno¶æ zabezpieczy przez zerwaniem po³±czenia
uznanego za nieu¿ywane. Przyk³adowo:
<programlisting>
ssh user@server -R 7777:localhost:22 "/bin/sh -c 'while true; do sleep 5; \
echo +; done'"
</programlisting>
</para>
<para>
Jeszcze lepszym rozwi±zaniem jest u¿ycie programu <command>autossh</command>
(w Debianie paczka o takiej samej nazwie). Program ten pozwala na uruchomienie
tunelu z wykorzystaniem dodatkowego portu monitoruj±cego - zerwane lub
zablokowane po³±czenia s± automatycznie wznawiane. Przyk³adowe wywo³anie
autossh mog³oby wygl±daæ nastêpuj±co:
<programlisting>
autossh -fN -M 7778 -R 7777:localhost:22 user@server
</programlisting>
Opcja -f powoduje przej¶cie autossh w t³o,
opcja -N jest przekazywana do ssh - zakazuje wykonywania komend - tylko
przekierowywanie portów (zwiêksza to bezpieczeñstwo). Numer portu do
monitorowania, tu przyk³adowo 7778, mo¿e byæ równie¿ dowolny, ale unikalny.
</para>
<para>
Oczywi¶cie pozostaje problem, jak na docelowym komputerze, który jest
niedostêpny, uruchomiæ tunel. Mo¿emy podyktowaæ odpowiednie polecenie przez
telefon, ale na d³u¿sz± metê warto dodaæ albo odpowiednie wywo³anie ssh np. do
crontaba, albo uruchomienie autossh przez skrypty startowe systemu.
<note>
<para>
Oprogramowanie SZARP zawiera zarówno gotowy skrypt
<command>ssh_tunel.sh</command>, jak i paczkê <command>szarp-tunnel</command>,
wykorzystuj±c± autossh do uruchomienia tunelu zwrotnego.
</para>
</note>
</para>

</section> <!-- ssh-tunnel -->

<section id="ssh-x11"> <!-- ssh-x11 -->
<title>Tunelowanie po³±czeñ X-Windows</title>
<para>
Programu ssh mo¿na u¿yæ w celu zdalnego uruchamiania programów
<quote>iksowych</quote>. W tym celu zarówno klient, jak i serwer musz± mieæ
w³±czon± opcjê <emphasis>X11Forwarding</emphasis> 
(ustawion± na <emphasis>yes</emphasis>). Na serwerze musimy to zrobiæ w pliku
<filename>/etc/ssh/sshd_config</filename> (po zmianie opcji konieczny jest 
restart sshd), po stronie klienta albo w pliku
<filename>/etc/ssh/ssh_config</filename>, albo przez opcjê
<emphasis>-X</emphasis> w linii poleceñ:
<programlisting>
ssh -X user@server
</programlisting>
Opcja <emphasis>-x</emphasis> wy³±cza przekierowywanie po³±czeñ X-Windows -
mo¿e to byæ przydatne, np. vim w trybie tekstowym uruchamia siê szybciej.
</para>
<para>
Je¿eli logujemy siê przez kilka komputerów, wszystkie po³±czenia
<quote>po drodze</quote> musz± mieæ w³±czone przekierowywanie po³±czeñ X-Windows.
Najpro¶ciej pierwsze po³±czenie rozpocz±æ z terminala uruchomionego w
trybie graficznym - dziêki temu ssh odpowiednio ustawi nam zmienn±
¶rodowiskow± DISPLAY. Wtedy po prostu gdy uruchamiamy aplikacjê graficzn±, jej
okno pojawi siê na naszym lokalnym ekranie.
</para>
<para>
Nale¿y zwróciæ uwagê, ¿e protokó³ X11 zaprojektowany by³ do wykorzystywania w
sieci lokalnej i praca przez wolne ³±cze jest bardzo nieefektywna, czasami
wrêcz niemo¿liwa. Warto wiêc rozwa¿yæ wykorzystanie protoko³u VNC. Opis
tunelowania VNC przez ssh znajduje siê w <xref linkend="ssh-vnc">.
</para>
</section> <!-- ssh-x11 -->

<section id="ssh-vnc">
<title>Tunelowanie po³±czeñ VNC</title>
<para>
Program ssh mo¿na tak¿e wykorzystaæ do tunelowania protoko³u VNC. Je¶li na
docelowym komputerze serwer VNC wykorzystuje port 5900, to logujemy siê na
niego podaj±c do ssh opcjê <emphasis>-L 5900:localhost:5900</emphasis>:
<programlisting>
ssh -L 5900:localhost:5900 user@host
</programlisting>
Je¶li musimy logowaæ siê <quote>na kilka razy</quote> (przez kilka komputerów
po¶rednich), opcjê t± podajemy za ka¿dym razem. Mamy teraz uruchomiony tunel
dla po³±czeñ VNC.
</para>
<para>
Na docelowym komputerze uruchamiamy serwer VNC. Przyk³adowo, aby
pod³±czyæ siê do dzia³aj±cej sesji u¿ytkownika <emphasis>user</emphasis>,
musimy mieæ na zdalnym komputerze zainstalowany
pakiet <emphasis>x11vnc</emphasis> i wydaæ polecenie:
<programlisting>
x11vnc -localhost -auth /home/user/.Xauthority
</programlisting>
Opcja <emphasis>-auth</emphasis> ze ¶cie¿k± do pliku
<filename>.Xauthority</filename> u¿ytkownika jest potrzebna tylko je¿eli
wydajemy polecenie jako inny u¿ytkownik ni¿ ten, do którego sesji chcemy siê
pod³±czyæ. Ma to sens g³ówne dla u¿ytkownika root, gdy¿ inni i tak nie bêd±
mieli praw odczytu do pliku <filename>.Xauthority</filename>.
</para>
<para>
Je¿eli chcemy siê pod³±czyæ do sesji mened¿era logowania (np. kdm), czyli w
sytuacji je¶li ¿aden u¿ytkownik nie jest zalogowany, parametr do opcji
<emphasis>-auth</emphasis> powinien wskazywaæ na plik <quote>Cookie</quote>
mened¿era logowania, np. <filename>/var/run/xauth/XXXX</filename>, gdzie zamiast
XXXX wystêpuje ci±g losowych znaków. Lokalizacjê
pliku mo¿na czêsto zobaczyæ przez wydanie polecenia:
<programlisting>
ps axw | grep auth
</programlisting>
</para>
<para>
Ostatnim krokiem jest uruchomienie lokalnie klienta VNC, podaj±c adres lokalny
i numer portu 5900 - localhost:5900. Na przyk³ad w przypadku program
<command>krdc</command> adres ten musimy wpisaæ po uruchomieniu programu, inni
klienci VNC mog± wymagaæ podania go w linii poleceñ.
</para>
</section>

</section> <!-- ssh -->

<section id="linux-redir">
<title>Przekierowywanie portów</title>
<para>
Czasem, w przypadku gdy serwer SZARP'a znajduje siê za bramk± dokonuj±c± operacji maskowania adresów,
nie posiada on numeru IP daj±cego mo¿liwo¶æ pod³±czenia siê do niego z zewn±trz (tzn. z internetu).
Wtedy, w przypadku potrzeby dostêpu do jego us³ug ze ¶wiata (np. netpard), mo¿e okazaæ siê konieczne
wykorzystaæ mechanizm przekierowania portów.
</para>
<section><title>Za³o¿enia wstêpne</>
<para>
Za³ó¿my, ¿e mamy nastêpuj±cy uk³ad:
<programlisting>
serwer SZARPA&gt;-----&lt;bramka&gt;-----[INTERNET]-----&lt;zdalny klient
</programlisting>
i chcemy mieæ dostêp do netpard'a na serwerze SZARP z naszego zdalnego klienta.
Dane:
<itemizedlist>
<listitem><para>Adres maszyny z SZARP'em: 192.168.100.24</></listitem>
<listitem><para>Numer portu netpard'a: 2390</></listitem>
<listitem><para>Bramka jest maszyn± dzia³aj±c± pod kontrol± systemu unix-podobnego (np. linux)</></listitem>
</itemizedlist>
</para>
</section>
<section><title>Instalacja i uruchomienie</>
<para>
Uwaga: wszystkie te operacje wykonujemy na bramce.
</para>
<para>
Przyk³adowym programikiem mog±cym dokonywaæ zadawanej operacji jest redir. Jego ¼ród³a mo¿na ¶ci±gn±æ np. z
<ulink url="ftp://sunsite.icm.edu.pl/pub/linux/debian/pool/main/r/redir/redir_2.1.orig.tar.gz">
ftp://sunsite.icm.edu.pl/pub/linux/debian/pool/main/r/redir/redir_2.1.orig.tar.gz</ulink>
rozpakowujemy i kompilujemy:
<programlisting>
tar xzf redir_2.1.orig.tar.gz
cd redir-2.1
make 
</programlisting>
je¶li posiadamy uprawnienia administratora (choæ nie jest to wymagane) wykonujemy jeszcze:
<programlisting>
make install
</programlisting>
Teraz wystarczy tylko uruchomiæ redir'a:
<programlisting>
redir\
  --lport=&lt;port, na którym bêdzie dana us³uga dostêpna na zewn±trz&gt;\
  --cport=&lt;port na serwerze wewnêtrznym, na którym dostêpna jest potrzebna us³uga&gt;\
  --caddr=&lt;adres serwera w sieci lokalnej, którego port udostêpniamy na zewn±trz&gt;\
  --debug
</programlisting>
Przyk³adowo dla danych w naszym przyk³adzie bêdzie to:
<programlisting>
redir --lport=2930 --cport=2930 --caddr=192.168.100.24 --debug
</programlisting>
Je¶li chcemy zapewniæ automatyczne uruchamianie w tle redir'a, to mo¿emy skorzystaæ z nastêpuj±cej sztuczki:
Edytujemy crontaba:
<programlisting>
crontab -e
</programlisting>
i dodajemy nastêpuj±c± liniê:
<programlisting>
*/15 * * * * screen -mdS redir &lt;¶cie¿ka do redir'a&gt;redir --lport=2930 --cport=2930 \
--caddr=192.168.100.24 --debug
</programlisting>
</para>
</section>
</section>

<section id="nat-masq">
<title>Udostêpnianie Internetu komputerom w sieci lokalnej: NAT/IP Masquarading</title>
<para>
Czêsto komputer ze skonfigurowanym dostêpem do Internetu jest u¿ywany przez komputery 
w jego sieci lokalnej jako po¶rednik w dostêpie do Internetu. Jest to rozwi±zanie
bardzo popularne, gdy¿ pozwala korzystaæ wielu osobom z tego samego publicznego 
adresu IP. 
Mechanizm, który pozwala korzystaæ z tej funkcjonalno¶ci, jest nazywany 
NAT-em (ang. <emphasis>Network Address Translation</emphasis>) lub maskowaniem IP
(ang. <emphasis>IP masquerading</emphasis>). 
Schemat systemu wygl±da jak poni¿ej:
<programlisting>
Internet - Publiczny IP=Host=Prywatny IP - Komputery wewn±trz sieci
</programlisting>
Jak widaæ, host-po¶rednik ma 2 interfejsy (2 adresy IP): jeden do sieci publicznej
(Internetu) a drugi do sieci prywatnej.
Poni¿ej opisano sposoby konfiguracji NAT-a na ho¶cie-po¶redniku dla systemów Debian 
i pochodnych od RedHata. Reszta komputerów w sieci powinna jako adres bramki 
ustawiæ prywatny adres IP hosta-po¶rednika.
</para>
<para>
Debian
</para>
<para>
Pod Debianem jest wiele sposobów konfigurowania systemu NAT. Najprostszy
polega na zainstalowaniu pakietu o nazwie <emphasis>ipmasq</emphasis>.
Najczê¶ciej nie s± potrzebne ¿adne modyfikacje konfiguracji -
interfejs zewnêtrzny ustalany jest na podstawie adresu bramki ustawionej 
na ho¶cie-po¶redniku.
Automatycznie obs³ugiwane s± sytuacje podnoszenia i wy³±czania interfejsów, 
nale¿y tylko podczas instalacji wybraæ opcjê rekonfiguracji firewalla przy tworzeniu
po³±czenia PPP. Wiêcej informacji mo¿na znale¼æ miêdzy innymi na stronach 
manuala do <command>iptables</command> i <command>ipmasq</command>.
</para>
<para>
RedHat 6.2
</para>
<para>
W RH 6.2 wykonujemy nastêpuj±ce komendy w celu inicjalizacji NAT-a 
(s± one wykonywane rêcznie i jednorazowo):
<programlisting>
<![CDATA[
ipchains -P forward DENY
ipchains -A forward -i ppp0 -j MASQ
ipchains-save > /etc/sysconfig/ipchains
]]>
</programlisting>
Nastêpnie do pliku <filename>/etc/rc.d/rc.local</filename> dodajemy na koñcu nastêpuj±ce polecenia:
<programlisting>
<![CDATA[
echo -n "1" > /proc/sys/net/ipv4/ip_forward
ipchains-restore < /etc/sysconfig/ipchains
]]>
</programlisting>
</para>
<para>
RehHat 7.x, 8.x, Fedora, Aurox itd
</para>
<para>
W systemach RH 7.x zarzucono u¿ywanie pakietu <command>ipchains</command>, zamiast niego wprowadzono nowszy mechanizm 
<command>iptables</command> (kernel 2.4.x). 
Nale¿y wiêc zamiast powy¿szych dzia³añ stworzyæ rêcznie plik <filename>/etc/sysconfig/iptables</filename> 
o zawarto¶ci (skrypt ten dodatkowo ustawia podstawow± konfiguracjê filtra pakietów) 
(zak³adamy, ¿e ppp0 jest interfejsem <quote>na zewn±trz</quote>, 
za¶ eth0 - interfejsem <quote>na sieæ lokaln±</quote>):
<programlisting>
<![CDATA[
*nat
:PREROUTING ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A POSTROUTING -o ppp0 -j MASQUERADE
COMMIT
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT DROP [0:0]
:allowed_in - [0:0]
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -i ! ppp0 -m state --state NEW -j ACCEPT
-A INPUT -m state --state NEW -j allowed_in
-A INPUT -i ! ppp0 -p udp --dport 177 -j ACCEPT
-A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -i ! ppp0 -m state --state NEW -j ACCEPT
-A FORWARD -p udp --dport 53 -j ACCEPT
-A FORWARD -p udp --dport 123 -j ACCEPT
-A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A OUTPUT -m state --state NEW -j ACCEPT
-A OUTPUT -p udp --dport 123 -j ACCEPT
-A allowed_in -p icmp --icmp-type echo-request -j ACCEPT
-A allowed_in -p tcp --dport 22 -j ACCEPT
-A allowed_in -p udp --dport 123 -j ACCEPT
COMMIT
]]>
</programlisting>
Nastêpnie do pliku <filename>/etc/rc.d/rc.local</filename> dodajemy na koñcu nastêpuj±ce polecenia:
<programlisting>
<![CDATA[
echo -n "1" > /proc/sys/net/ipv4/ip_forward
iptables-restore < /etc/sysconfig/iptables
]]>
</programlisting>
</section> <!-- nat-masq -->

<section id="linux-mail"><title>Konfiguracja lokalnego serwera poczty (SMTP)</>
<para>
Operacja ta jest przydatna w przypadku, gdy w sieci lokalnej chcemy mieæ mo¿liwo¶æ wysy³ania poczty na ¶wiat,
a z jaki¶ powodów nie chcemy korzystaæ z zewnêtrznych serwerów poczty wychodz±cej.
Poni¿szy opis instalacji oraz konfiguracji serwera dotyczyæ bêdzie exim'a v4.
</para>
<section><title>Instalacja</title>
<para>
Musimy zaopatrzyæ siê w odpowiednie pakiety.
<programlisting>
apt-get install exim4-base exim4-daemon-heavy  exim4-config
</programlisting>
Warto równie¿ zaopatrzyæ siê w filtr spam'u oraz program antywirusowy.
<programlisting>
apt-get install spamassassin clamav clamav-base clamav-daemon clamav-freshclam
</programlisting>
Pakiet clamav-freshclam jest odpowiedzialny za automatyczn± aktualizacjê bazy sygnatur wirusów z internetu. 
</para>
<para>
W trakcie instalacji pakietów exim'a mog± zostaæ zadane pytania, ich opis znajdziemy w nastêpnym rozdziale. 
</para>
</section>
<section><title>Konfiguracja serwera</title>
<para>
Najlepiej po zainstalowaniu pakietów wydaæ polecenie:
<programlisting>
dpkg-reconfigure exim4-config
</programlisting>
W trakcie konfiguracji bêdziemy musieli odpowiedzieæ na nastêpuj±ce pytania:
<itemizedlist>
<listitem><para>
Podzieliæ konfiguracjê na ma³e pliki? - Odpowiadamy tak. Taka konfiguracja jest ³atwiejsza w utrzymaniu.
</para></listitem>
<listitem><para>
Typ konfiguracji - Wybieramy o¶rodek internetowy, chyba ¿e cel jaki chcemy osi±gn±æ jest inny.
</para></listitem>
<listitem><para>
Nazwa pocztowa systemu - np example.com.pl
</para></listitem>
<listitem><para>
Adresy IP na których system bêdzie nas³uchiwa³ po³±czeñ? - naciskamy enter, spowoduje to ¿e system bêdzie nas³uchiwa³ na wszystkich skonfigurowanych adresach w systemie.
</para></listitem>
<listitem><para>
Inne systemu docelowe dla których poczta jest akceptowana - np mail.example.com.pl:example.com.pl:poczta.exapmle.com.pl
</para></listitem>
<listitem><para>
Domeny dla których dozwolone jest przekazywanie poczty - zostawiamy puste
</para></listitem>
<listitem><para>
Systemy dla których przekazujesz pocztê - zostawiamy puste, chyba ze chcemy inaczej
</para></listitem>
<listitem><para>
Utrzymywaæ ilo¶æ zapytañ DNS na minimalnym poziomie? - odpowiadamy NIE
</para></listitem>
</itemizedlist>

Pliki konfiguracyjne exim'a sa podzielone na nastêpuj±ce sekcje:
<itemizedlist>
<listitem><para>
main - podstawowe ustawienia
<para></listitem>
<listitem><para>
acl - odrzucanie i akceptowanie poczty, filtrowanie (spam, wirusy etc...)
<para></listitem>
<listitem><para>
routers - regu³y kierowania poczty do odpowiednich transporterów (podobnie jak route)
<para></listitem>
<listitem><para>
retry - ponawianie
<para></listitem>
<listitem><para>
rewrite - regu³y do przepisywania nag³ówków
<para></listitem>
<listitem><para>
auth - autoryzacja
<para></listitem>
<listitem><para>
transports - sposoby dorêczania poczty przekierowanej przez router'y
<para></listitem>
</itemizedlist>

</para>
<para>
Nastêpnie musimy w³±czyæ filtrowanie poczty pod k±tem spam'u i wirusów. W tym celu edytujemy najpierw plik 
<filename>/etc/exim4/conf.d/main/02_exim4-config_options</filename>
i ustawiamy zmienn± <command>av_scanner</command> na 
<programlisting>av_scanner = amavisd:/var/lib/amavis/amavisd-new-milter.sock
</programlisting>
Kolejna zmienna <command>spamd_address</command> powinna byæ ustawiona na 
<programlisting>
spamd_address = 127.0.0.1 783
</programlisting>
To s± wszystkie zmiany jakich musimy dokonaæ w tej sekcji
</para>
<para>
W sekcji AUTH, a dok³adniej w pliku <filename>/etc/exim4/conf.d/30_exim4-config_examples</filename> mamy przyk³ady autoryzacji u¿ytkowników tak by nasz serwer nie by³ "open relay". Mo¿emy odszukaæ interesuj±cy nas przyk³ad lub wpisaæ :
<programlisting>
 plain_saslauthd_server:
    driver = plaintext
    public_name = PLAIN
    server_condition = ${if saslauthd{{$2}{$3}}{1}{0}}
    server_set_id = $2
    server_prompts = :
    .ifndef AUTH_SERVER_ALLOW_NOTLS_PASSWORDS
    server_advertise_condition = ${if eq{$tls_cipher}{}{}{*}}
    .endif

 login_saslauthd_server:
    driver = plaintext
    public_name = LOGIN
    server_prompts = "Username:: : Password::"
    server_condition = ${if saslauthd{{$1}{$2}}{1}{0}}
    server_set_id = $1
    .ifndef AUTH_SERVER_ALLOW_NOTLS_PASSWORDS
    server_advertise_condition = ${if eq{$tls_cipher}{}{}{*}}
    .endif
</programlisting>
Podana konfiguracja wymaga zainstalowanych kilku pakietów:
<programlisting>
apt-get install sasl2-bin libsasl2-modules
</programlisting>
</para>
<para>
Same wpisy odno¶nie spamassassina i clamav nie wystarcz±. W sekcji ACL, dok³adnie w pliku 
<filename>/etc/exim4/conf.d/acl/40_exim4-config_check_data</filename> musimy dopisaæ :
<programlisting>
   deny
     malware = *
     message = This message was detected as possible malware ($malware_name).

   deny
     spam = nobody
     message = X-Spam_score: $spam_score
</programlisting>
</para>
<para>
Po wykonaniu wszystkich zmian, aby zosta³y one wczytane musimy wykonaæ nastêpuj±ce polecenia
<programlisting>
update-exim4.conf
/etc/init.d/exim restart
</programlisting>

</para>
</section>

</section>

<section id="windowmaker">
<title>Konfiguracja Window Makera</title>
<para>
Window Maker jest mened¿erem okien mog±cym zast±piæ KDE. W porównaniu z nim
charakteryzuje siê du¿o wiêksz± szybko¶ci± dzia³ania i mniejszym
zapotrzebowaniem na zasoby komputera. Warto wiêc rozwa¿yæ jego stosowanie w
instalacjach, gdzie pojawiaj± siê problemy z wydajno¶ci± stosowanego sprzêtu
lub przepustowo¶ci± sieci (zw³aszcza przy stosowaniu X terminali).
Poza tym jest stabilniejszy od KDE w sytuacji, gdy  korzysta z niego na raz 
wielu tak samo zalogowanych u¿ytkowników (sytuacja taka prowadzi czêsto do
za³amania stabilno¶ci KDE w wersji 3). Ma tak¿e logiczny, ³atwy do edycji
schemat plików konfiguracyjnych.
</para>
<para>
W porównaniu do przestarza³ego ju¿ IceWm'a Window
Maker nie wymaga specjalnych zasobów polonizacyjnych, oferuje wsparcie dla
mechanizmów wykorzystywanych przez programy napisane dla KDE lub Gnome, poza
tym dobrze integruje siê z kdm. Wad± jest wygl±d i zachowanie odbiegaj±ce nieco
od KDE czy desktopu Windows. Po przyzwyczajeniu siê mo¿e siê jednak podobaæ i
okazuje siê ca³kiem wygodny.
</para>
<para>
WindowMaker jest dostêpny standardowo w dystrybucjach RedHata od wielu wersji,
nie wymaga wiêc oddzielnej instalacji.
</para>
<para>
Poni¿szy opis nie obejmuje wszystkich zagadnieñ zwi±zanych z konfiguracj±
WindowMakera, skupia siê na elementach potrzebnych w jego wspó³dzia³aniu z
systemem SZARP.
</para>
<para>
Aby umo¿liwiæ u¿ytkownikom korzystanie z WindowMakera jako alternatywnego
mened¿era okien, nale¿y wykonaæ kilka prostych kroków. Zak³adam, ¿e system
uruchamiany jest w runlevelu 5 i kdm jest skonfigurowany w sposób typowy dla
instalacji systemu SZARP. Wystarczy zalogowaæ siê jako root, uruchomiæ
<command>Centrum Sterowania</command>, po czym wybraæ <command>System</command>,
<command>Menad¿er Logowania</command> i zak³adkê <command>Sesje</command>. W
polu obok napisu <command>Typ sesji</command> wpisujemy
<emphasis>windowmaker</emphasis> lub <emphasis>wmaker</emphasis> (to musi byæ nazwa programu wykonywalnego mened¿era okien, ró¿na w ró¿nych wersjach) i naciskamy przycisk <command>Dodaj</command>.
Innym sposobem jest rêczna edycja pliku /etc/kde/kdm/kdmrc i dodanie 
wpisu <emphasis>windowmaker</emphasis> lub <emphasis>wmaker</emphasis> do parametru <emphasis>SesionsTypes</emphasis>. 
Powy¿szy sposób dzia³a dla RedHatów 7.X i pó¼niejszych oraz Debiana. 
Dla wcze¶niejszych wersji nale¿y
zadbaæ, aby windowmaker by³ uruchamiany w pliku
<filename>.Xsessions</filename> odpowiednim dla u¿ywanego mened¿era logowania
(np. kdm lub xdm). 
</para>
<para>
Od tej pory u¿ytkownicy przy logowaniu przez kdm bêd± mieli dostêpny w¶ród
typów sesji typ <emphasis>windowmaker</emphasis>. 
Nale¿y zwróciæ uwagê, ¿e kdm zawsze
loguje u¿ytkownika domy¶lnie z ostatnio u¿ytym typem sesji, a wiêc po
jednokrotnym u¿yciu WindowMakera bêdzie on u¿ywany domy¶lnie, dopóki u¿ytkownik
przy starcie nie wybierze innego typu sesji.
</para>
<para>
Rzecz± któr± mo¿emy chcieæ skonfigurowaæ w WindowMakerze jest menu aplikacji
pojawiaj±ce siê po klikniêciu prawym przyciskiem myszki. Istnieje specjalny
program do konfiguracji tego menu, ale lepiej i pro¶ciej jest chyba robiæ to
bezpo¶rednio przez edycjê pliku.
</para>
<para>
Je¿eli chcemy zmieniæ domy¶lnie instalowane dla ka¿dego u¿ytkownika menu nale¿y
wyedytowaæ plik <filename>/usr/X11R6/share/WindowMaker/plmenu.pl</filename>
(po³o¿enie tego pliku mo¿e byæ inne dla wcze¶niejszych wersji).
Format tego pliku jest bardzo prosty, sk³ada siê z zagnie¿d¿onych nawiasów
opisuj±cych kolejne poziomy menu (wtedy po nazwie menu i przecinku wystêpuje
nawias z zawarto¶ci± podmenu) lub komendy do wykonania (wtedy po przecinku mamy
s³owo <emphasis>Exec</emphasis>, przecinek a potem w cudzys³owie komendê do
wykonania). 
<!-- To chyba nie jest prawda
Nale¿y zwróciæ uwagê, ¿e w przeciwieñstwie np. do plików kdelnk
wpisana komenda nie jest wykonywana przez pow³okê systemu tylko jest traktowana jako nazwa i parametry programu, nie mo¿na wiêc u¿ywaæ komend z³o¿onych. 
Ograniczenie to w razei potrzeby mo¿na ³atwo obej¶æ u¿ywaj±c sk³adni
<emphasis>sh -c 'komenda z³o¿ona'</emphasis>.
-->
</para>
<para>
Oto przyk³adowa zawarto¶æ pliku konfiguracyjnego:
<programlisting>
("WindowMaker",
  ("Informacja",
    ("Informacja o WMaker...", INFO_PANEL),
    ("Legalno¶æ...", LEGAL_PANEL),
    ("Konsola Systemu", EXEC, "xconsole"),
    ("Obci±¿enie Systemu", EXEC, "xosview || xload"),
  ),
  ("Konfiguracja",
  	("Edycja menu", EXEC, "xterm -T 'Edycja menu' -e vi \
		$HOME/GNUstep/Library/WindowMaker/menu"),
	("Ustawienie fontów", EXEC, "xterm -T 'Ustawienie fontów' -e vi \
		$HOME/GNUstep/Defaults/WMGLOBAL"),
  )
)
</programlisting>
</para>
<para>
Przy pierwszym u¿yciu WindowMakera przez danego u¿ytkownika w jego katalogu
domowym tworzony jest podkatalog
<filename>GNUstep/Defaults</filename>. W katalogu tym znajduje siê
plik WMRootMenu z konfiguracj± menu w podanym powy¿ej formacie. Alternatywnie,
menu w starszym, mniej eleganckim, ale bardziej elastycznym formacie, mo¿e byæ
umieszczone w innym pliku. ¦cie¿kê do niego podajemy w cudzys³owie w pliku
<filename>WMRootMenu</filename>.
</para>
<para>
W pakiecie z WindowMakerem znajduje siê program
<filename>wmenukde.pl</filename>, s³u¿±cy do konwersji istniej±cego menu KDE do
postaci u¿ywanej przez WindowMakera. Np. aby stworzyæ plik zawieraj±cy menu
systemu SZARP, nale¿y wydaæ komendê 
<command>wkdemenu.pl -d /usr/share/applnk/SZARP</command> i przekierowaæ jej
wyj¶cie do pliku, np. <filename>/etc/szarp/wmszarp.menu</filename>. Nastêpnie
w katalogach domowych u¿ytkowników nale¿y w plikach
<filename>GNUstep/Default/WMRootMenu</filename> umie¶ciæ w cudzys³owie ¶cie¿kê
do pliku, np. <emphasis>"~/GNUstep/Library/WindowMaker/menu"</emphasis>, w
którym nale¿y umie¶ciæ wywo³anie podmenu w postaci:
<programlisting>
("External Menu", OPEN_MENU, "/etc/szarp/wmszarp.menu"),
</programlisting>
Wersja skryptu <filename>wkdemenu</filename> rozprowadzana w dystrybucjach do
RedHata 7.3 w³±cznie (a mo¿e i pó¼niej) posiada sporo b³êdów. Dlatego zaleca
siê u¿ywanie zmodyfikowanej wersji, dostêpnej w katalogu
<filename>script</filename> w dystrybucji SZARPa.
</para>
<para>
WindowMaker automatycznie wykrywa zmiany w swoich plikach konfiguracyjnych,
tak¿e automatycznie te zmiany zapisuje. Mo¿e to powodowaæ problemy w sytuacji,
je¶li jest uruchomionych kilka kopii programu dla tego samego u¿ytkownika
(sytuacja taka jest czêsta je¶li na kilku terminalach z Windows u¿ytkownicy
korzystaj± z tego samego u¿ytkownika na serwerze). W takiej sytuacji kolejne
kopie programu <filename>wmaker</filename> powinny byæ uruchamiane z
parametrem <emphasis>--static</emphasis>. Rozwi±zaniem jest skopiowanie pliku
<filename>/usr/bin/wmaker</filename> do
<filename>/usr/bin/wmaker.bin</filename> i utworzenie skryptu
<filename>/usr/bin/wmaker</filename> o nastêpuj±cej zawarto¶ci:
<programlisting>
#!/bin/bash

[ -d $HOME/GNUstep ] || wmaker.inst

if ps axw | grep 'wmaker.bin' ; then {
	/usr/bin/wmaker.bin --static "$@"
} else {
	/usr/bin/wmaker.bin "$@"
} fi
</programlisting>
Instalacjê menu WindowMakera zawieraj±cego odpowiednie pozycje dla systemu
SZARP i zainstalowanie powy¿ej opisanego skryptu w systemie RedHat 7.3 mo¿e
byæ wykonane tak¿e przez wywo³anie komendy <command>make wmmenu</command> w
podkatalogu <filename>resources</filename> w katalogu ze ¼ród³ami SZARPa.
</para>
<para>
Wiêcej informacji mo¿na znale¼æ w plikach w katalogu
<filename>/usr/share/doc/WindowMaker</filename> i
<filename>/usr/X11R6/share/WindowMaker</filename> lub odpowiednich (dok³adne
¶cie¿ki mog± siê trochê ró¿niæ zale¿nie do wersji).
</para>
</section>

<section id="ntp">
<title>Synchronizacja czasu</title>

<para>
¯eby skonfigurowaæ (x)ntp na serwerze, nale¿y mieæ zainstalowany serwer ntp 
i stworzyæ plik 
<filename>/etc/ntp.conf</filename> z zawarto¶ci±:
<programlisting>
server	62.233.142.85 prefer

server	127.127.1.0	# local clock
fudge	127.127.1.0 stratum 10	

driftfile /etc/ntp/drift
authenticate no

</programlisting>

oraz plik <filename>/etc/ntp/step-tickers</filename> z zawarto¶ci±:

<programlisting>
62.233.142.85
</programlisting>
..i uruchomiæ demona (x)ntpd.
Je¶li wystêpuj± jakiekolwiek problemy, chcemy poeksperymentowaæ lub ustawiæ
niestandardowe parametry, to nale¿y przeczytaæ wszystko co jest poni¿ej.
</para>

<para>
W przypadku dystrybucji Debian odpowiednie pakiety maj± nazwy ntp-server i
ntpdate, a pliki konfiguracyjne to <filename>/etc/ntp.conf</filename> i
<filename>/etc/default/ntpdate</filename>. Domy¶lna konfiguracja korzysta z
serwerów dostêpnych pod adresem <emphasis>pool.ntp.org</emphasis>, je¿eli
chcemy korzystaæ z innego serwera, nale¿y zast±piæ podany adres adresem
po¿±danego serwera.
</para>

<para>
Produkowane obecnie komputery s± wyposa¿one w podtrzymywane bateryjnie
zegary czasu rzeczywistego (RTC - Real Time Clock). Zwykle jednak ich
dok³adno¶æ pozostawia wiele do ¿yczenia (potrafi± "rozje¿d¿aæ" siê w tempie
sekundy na dobê). Rêczne ustawianie ich i pilnowanie jest uci±¿liwe i 
problematyczne (nie ka¿dy przecie¿ ma dok³adnie chodz±cy zegarek).
</para>
<para>
Rozwi±zaniem tego problemu jest wykorzystanie NTP - Network Time Protocol.
Jest to protokó³ pozwalaj±cy na synchronizacjê zegarów komputerów pod³±czonych
do Internetu. Jego dzia³anie opiera siê na istnieniu kilku "wzorcowych"
komputerów, których zegary synchronizowane s± z zegarami atomowymi, drog±
radiow± lub satelitarn±. Pozosta³e komputery synchronizujê siê od nich i od 
kolejnych po¶redników, tworz±c strukturê drzewiast±. Zegary komputerów nie
tylko s± przestawiane, ale tak¿e przyspieszane / opó¼niane, aby same 
,,trzyma³y dok³adno¶æ''.
</para>
<para>
W Polsce znajduje siê jeden po¶rednik "drugiego poziomu" (tzw. server stratum
2). Jest to serwer www.cyf-kr.edu.pl (IP 149.156.4.11). Przy synchronizowaniu
kilku komputerów (np. firmowej sieci) zaleca siê wydzielenie jednego komputera,
który bêdzie synchronizowa³ siê z cyf-kr, pozosta³e za¶ komputery powinny
siê synchronizowaæ ju¿ z tym wewnêtrznym serwerem. Do dobrych obyczajów nale¿y
wys³anie przed rozpoczêciem synchronizacji z danym serwerem mail'a do jego
administratora.
</para>
<para>
Typowa konfiguracja "na ciep³owni", to kilka komputerów (serwerów i terminali),
z których jeden pod³±czony jest do Internetu przez ³±cze sta³e lub modem. Ten
komputer powinien siê synchronizowaæ z jakim¶ zewnêtrznym ¼ród³em - najlepiej
z g³ównym serwerem Pratermu.
</para>
<para>
Ten wydzielony komputer z dostêpem do Internetu nazwijmy wewnêtrznym serwerem
(dla odró¿nienia od zewnêtrznego, czyli np. praterm.com.pl), za¶ pozosta³e
komputery w sieci to klienci.
</para>
<para>
Zarówno na serwerze, jak i na klientach, musi byæ zainstalowany odpowiedni
pakiet o nazwie albo ntp, albo xntp. Je¿eli go nie ma, trzeba go 
doinstalowaæ.
W dystrybucji RedHat znajduje siê zwykle na p³ytce "contrib".
</para>
<para>
Teraz przystêpujemy do konfiguracji klientów. Pierwszym krokiem jest edycja
pliku <filename>/etc/ntp.conf</filename>. Powinien on mieæ na wszystkich klientach nastêpuj±c± 
zawarto¶æ:
</para>
<para>
<programlisting>
server 127.127.1.0	# local clock
fudge  127.127.1.0 stratum 10

server X.X.X.X prefer

driftfile /etc/ntp/drift
authenticate no
</programlisting>
</para>
<para>
X.X.X.X zastêpujemy numerem IP naszego planowanego wewnêtrznego serwera.
Pozosta³e linie nale¿y wykasowaæ lub lepiej wykomentowaæ.
</para>
<para>
Nastêpnie w katalogu <filename>/etc/ntp</filename> tworzymy plik o 
nazwie <filename>step-tickers</filename>, zawieraj±cy
tylko IP wewnêtrznego serwera. Bêdzie on wykorzystywany do ustawiania czasu
przy starcie systemu.
</para>
<para>
Ostatnim krokiem jest upewnienie siê, ¿e w katalogu ze skryptami startowymi
(zwykle <filename>/etc/rc.d/rc5.d</filename>) jest link na plik 
<filename>/etc/rc.d/init.d/ntp</> lub <filename>/etc/rc.d/init.d/xntp</>.
</para>
<para>
Teraz przystêpujemy do konfigurowania naszego wewnêtrznego serwera. Je¿eli ma
on sta³y dostêp do Internetu, to konfiguracja wygl±da tak samo jak na kliencie,
z tym ¿e zamiast swojego IP, zarówno w pliku <filename>/etc/ntp.conf</> jak i 
<filename>/etc/ntp/step-tickers</>, wstawiamy IP zewnêtrznego serwera 
(np. mail.praterm.com.pl) i jest to koniec konfiguracji.
</para>
<para>
Sprawa jest bardziej skompilowana, je¿eli serwer ma dostêp do internetu przez
modem i PPP, a nie SDI. Wówczas nie tworzymy na nim pliku 
<filename>/etc/ntp/step-tickers</>,
a z pliku <filename>/etc/ntp.conf</> usuwamy (wykomentowujemy) linijkê
<programlisting>
server X.X.X.X prefer
</programlisting>
</para>
<para>
Teraz mamy serwer, z którym inne mog± siê synchronizowaæ, ale on sam nie ma
zewnêtrznego ¼ród³a synchronizacji. Synchronizacja bêdzie robiona okresowo,
po po³±czeniu z Internetem, za pomoc± programu ntpdate.
</para>
<para>
Jego wywo³anie mo¿na wstawiæ albo do pliku <filename>/etc/ppp/ip-up.local</>, albo zapisaæ
w pliku konfiguracyjnym SZARP'a przy wywo³aniu BODAS'a, po nawi±zaniu po³±czenia
PPP.
</para>
<para>
Poniewa¿ jednak program ntpdate odmówi dzia³ania, je¿eli na danym komputerze
dzia³a demon ntp/xntp, trzeba go najpierw wy³±czyæ a potem ponownie wy³±czyæ.
Ca³a linia komend bêdzie wiêc mia³a nastêpuj±c± postaæ:
</para>
<para>
<programlisting>
/etc/rc.d/init.d/ntpd stop; ntpdate -t 3 -s mail.praterm.com.pl; \
/etc/rc.d/init.d/ntpd start
</programlisting>
</para>
<para>
Je¿eli u¿ywamy demona xntpd, nale¿y oczywi¶cie zamieniæ wywo³ania ntpd na
xntpd. Podana nazwa serwera jest przyk³adowa. Powy¿sz± komendê wpisujemy
albo do pliku <filename>/etc/ppp/ip-up.local</>, albo jako czê¶æ parametru 
"command_line"
odpowiedniej sekcji BODASa w pliku <filename>/etc/szarp/szarp.cfg</>.
</para>
<para>
Uruchomienie ca³o¶ci zaczynamy od uruchomienia demona ntpd/xntpd na serwerze
wewnêtrznym. Je¿eli mamy do czynienia z po³±czeniem przez PPP, najpierw 
nale¿y dokonaæ wstêpnej synchronizacji. Je¶li wywo³anie programu ntpdate
wstawili¶my do <filename>/etc/ppp/ip-up.local</>, to wystarczy po³±czyæ siê z Internetem.
Je¿eli za¶ chcemy wywo³ywaæ synchronizacjê za pomoc± meanera, to po po³±czeniu
trzeba uruchomiæ rêcznie ntpdate, na przyk³ad przez komendê:
<programlisting>
ntpdate -b mail.praterm.com.pl
</programlisting>
</para>
<para>
Powinni¶my otrzymaæ komunikat typu:
<programlisting>
ntpdate[1243]: step time server mail.praterm.com.pl offset 48.340123 sec
</programlisting>
</para>
<para>
Kolejnym krokiem, ju¿ niezale¿nie od tego czy mamy sta³e po³±czenie z sieci±,
jest uruchomienie demona ntp/xntp na wewnêtrznym serwerze przez komendê:
<programlisting>
/etc/rc.d/init.d/ntpd start
</programlisting>
(ew. xntpd zamiast ntpd).
</para>
<para>
I ostatnie co pozosta³o, to uruchomienie demonów ntpd/xntpd na komputerach
- klientach. Normalnie bêdzie siê to odbywa³o przy starcie komputerów.
</para>
<para>
Prawid³owe dzia³anie ca³ego mechanizmu mo¿na ¶ledziæ przez wpisy w pliku
<filename>/var/log/messages</>. Jest przy tym normalne, ¿e przez parê minut od startu
demona na wewnêtrznym serwerze synchronizacja nie bêdzie siê udawa³a -
demon musi siê ,,rozgrzaæ''. Po tych paru minutach mo¿emy siê ju¿ cieszyæ
milisekundow± precyzj± zegarów komputerów w ca³ej sieci.
</para>
<para>
Programy ntpd/xntpd i ntpdate nie maj± swoich stron manuala, dokumentacja
ca³ego pakietu znajduje siê w formacie HTML w katalogach z dokumentacj±,
zwykle <filename>/usr/share/doc</filename>.
</para>
</section>

<section id="drukowanie">
<title>Konfiguracja drukowania</title>
<para>
Drukowanie pod Linuksem jest obecnie obs³ugiwane przez system o nazwie
<emphasis>CUPS</emphasis> - Common Unix Printing System. Niniejszy rozdzia³
opisuje:
<itemizedlist>
<listitem><para>Instalacjê CUPS'a <xref linkend="cups-install"></para></listitem>

<listitem><para>Konfigurowanie drukarki <xref linkend="cups-printer"></para></listitem>

<listitem><para>Konfigurowanie drukarki za pomoc± Mened¿era Drukowania KDE
<xref linkend="cups-kdeprint"></para></listitem>

<listitem><para>Udostêpnianie drukarek dla komputerów z Windows
<xref linkend="cups-samba"></para></listitem>

</itemizedlist>
</para>

<section id="cups-install">
<title>Instalacja systemu CUPS</title>
<para>
System CUPS jest dostêpny prawdopodobnie we wszystkich obecnych dystrybucjach
Linuksa. Poza samym demonem CUPS (w dystrybucji Debian jest to pakiet
<filename>cupsys</filename>) warto zainstalowaæ (w nawiasach nazwy pakietów
Debiana):
<itemizedlist>
<listitem><para>Programy klienckie - lp, lpstat itp.
(<filename>cupsys-client</filename>).</para></listitem>

<listitem><para>Programy klienckie <quote>BSD</quote> - lpr, lpq, lprm
(<filename>cupsys-bsd</filename>).</para></listitem>

<listitem><para>Sterowniki dla drukarek, w tym:
<itemizedlist>
<listitem><para>baza sterowników drukarek (<filename>foomatic-db
foomatic-filters foomatic-filters-ppd</filename>),</para></listitem>
<listitem><para>sterowniki dla drukarek HP (<filename>hpijs hplib-base hpoj
foomatic-db-hpijs</filename>),</para></listitem>
<listitem><para>sterowniki z projektu Gutenprint (dawniej
Gimp-Print) (<filename>cupsys-driver-gutenprint foomatic-db-gutenprint</filename>),</para></listitem>
<listitem><para>sterownik dla drukarek GDI HP wykorzystuj±cych protokó³ PPA
(np. DeskJet 7XX, DeskJet 820, DeskJet 100)(<filename>pnm2ppa</filename>),</para></listitem>
<listitem><para>sterownik dla drukarek GDI wykorzystuj±cych protokó³ ZjStream (np.
modele Minolta magicolor 2300DL lub HP LaserJet 1000)
(<filename>foo2zjs</filename>),</para></listitem>
<listitem><para>BlueZ - sterownik dla drukarek ³±cz±cych siê przez Bluetooth
(<filename>bluez-cups</filename>).</para></listitem>
</itemizedlist>
</para></listitem>

<listitem><para>Dodatkowe narzêdzia:
<itemizedlist>
<listitem><para>podsystem drukowania dla KDE (<filename>kdeprint</filename>),</para></listitem>
<listitem><para>printconf - narzêdzie automatycznie rozpoznaj±ce i instaluj±ce,
drukarki pod³±czone bezpo¶rednio do komputera przez port USB lub równoleg³y
(<filename>printconf</filename>),</para></listitem>
<listitem><para>Narzêdzia dla drukarek Epson Stylus - czyszczenie g³owic,
sprawdzanie poziomu tuszu (<filename>escputil</filename>).</para></listitem>
</itemizedlist>
</para></listitem>

</itemizedlist>
Wiêkszo¶æ potrzebnych pakietów/narzêdzi jest obecna w dystrybucji
Debian/SZARP pod wybraniu opcji <emphasis>cups</emphasis> w oknie
<emphasis>Dodatki</emphasis> podczas instalacji. Mo¿emy te¿ zainstalowaæ
brakuj±ce pakiety, np. za pomoc± komendy <command>apt-get install
nazwa_pakietu</command>. 
</para>
<para>
Po instalacji CUPS'a warto go uruchomiæ - np. komend±:
<programlisting>
/etc/init.d/cupsys start
</programlisting>
(pod Debianem) lub analogiczn± dla innych dystrybucji.
</para>
</section> <!-- cups-install -->

<section id="cups-printer">
<title>Konfiguracja drukarki</title>

<para>
System CUPS umo¿liwia skonfigurowanie zarówno drukarki lokalnej, sieciowej, jak
i udostêpnionej drukarki Windows - niniejszy rozdzia³ opisuje pokrótce wszystkie te
mo¿liwo¶ci. Konfiguracji drukarki pod CUPS'em mo¿na dokonaæ na bardzo wiele
sposobów - istnieje wiele narzêdzi graficznych u³atwiaj±cych to zadanie. W tym
rozdziale opisujemy sposób najbardziej uniwersalny i dostêpny na ka¿dym
komputerze, tak¿e podczas pracy zdalnej. Wygodny interfejs do CUPS'a
udostêpniany przez ¶rodowisko KDE jest opisany w rozdziale 
<xref linkend="cups-kdeprint">.
</para>
<para>
Pierwsza rzecz, któr± musimy zrobiæ, to po³±czyæ siê z serwerem CUPS.
Zak³adamy, ¿e CUPS jest zainstalowany i uruchomiony. Uruchamiamy wiêc dowoln±
przegl±darkê WWW i ³±czymy siê z serwerem CUPS, wpisuj±c w pasku adresu
przegl±darki adres
serwera z CUPS'em i podaj±c po dwukropku numer portu - 631. Je¿eli przegl±darka jest
uruchomiona na tym samym komputerze, na którym dzia³a CUPS, to adres bêdzie
mia³ postaæ <ulink url="http://localhost:631">http://localhost:631</ulink>.
</para>
<para>Je¿eli prawid³owo wpisali¶my
adres i CUPS jest uruchomiony, to po chwili zobaczymy ekran z opcjami
administracyjnymi. W celu dodania drukarki wybieramy link <emphasis>Manage
Printers</emphasis>. Je¿eli na komputerze s± ju¿ skonfigurowane jakie¶
drukarki, to pojawi siê ich lista z krótkim opisem, informacj± o stanie,
adresie, oraz przyciskami pozwalaj±cymi wydrukowaæ stronê testow±
(<emphasis>Print test page</emphasis>), zatrzymaæ drukarkê (<emphasis>Stop
printer</emphasis>), usun±æ wszystkie zadania wydruku (<emphasis>Reject
jobs</emphasis>), zmodyfikowaæ typ/adres drukarki (<emphasis>Modify
Printer</emphasis>), zmieniæ opcje drukarki takie, jak jako¶æ druku
(<emphasis>Configure printer</emphasis>), wreszcie usun±æ drukarkê z systemu
(<emphasis>Delete printer</emphasis>) lub te¿ ustawiæ j± jako domy¶ln±
(<emphasis>Set As Default</emphasis>).
</para>
<para>
Nas jednak interesuje umieszczony na dole przycisk <emphasis>Add
printer</emphasis>. Po jego klikniêciu CUPS mo¿e poprosiæ nas o podanie nazwy
u¿ytkownika i has³a. Nazwa dotyczy u¿ytkownika na komputerze na którym dzia³a
CUPS, mo¿e to byæ <emphasis>root</emphasis> lub dowolny inny u¿ytkownik maj±cy
prawa do administrowania drukarkami. W dystrybucji Debian prawa te nadawane s±
przez dodanie u¿ytkownika do grupy <emphasis>lpadmin</emphasis> (mo¿na to
zrobiæ dopisuj±c u¿ytkownika do grupy w pliku
<filename>/etc/group</filename>).
</para>
<para>
Je¿eli podamy prawid³ow± nazwê u¿ytkownika i has³o, zostaniemy poproszeni o
podanie nazwy drukarki (pole <emphasis>Name</emphasis>) oraz jej lokalizacji i
opisu (<emphasis>Location</emphasis> i <emphasis>Description</emphasis>). Dwa
ostatnie pola s± tylko opisem dla u¿ytkownika, w szczególno¶ci mog± zostaæ
puste. Istotna jest natomiast nazwa. Tradycyjnie nazwa powinna sk³adaæ siê z
ma³ych liter i ewentualnie cyfr, np. <quote>hp690</quote> czy
<quote>minolta2300</quote>. Najczê¶ciej
u¿ywanej drukarce warto nadaæ nazwê <quote>lp</quote> - niektóre stare
programy mog± nie honorowaæ ustawienia domy¶lnej drukarki i zawsze domy¶lnie
drukowaæ na drukarkê o w³a¶nie takiej nazwie.
</para>
<para>
Po podaniu nazwy klikamy przycisk <emphasis>Continue</emphasis> i przechodzimy
do wyboru typu drukarki, a w³a¶ciwie sposobu dostêpu do niej.  Do wyboru mamy:
<itemizedlist>
<listitem><para><emphasis>AppSocket/HP JetDirect</emphasis> - wybieramy t±
opcjê w przypadku wiêkszo¶ci drukarek tzw. <quote>sieciowych</quote>
(wyposa¿onych w kartê sieciow± - nie myliæ z drukarkami udostêpnionymi). 
Wtedy na
nastêpnym ekranie proszeni jeste¶my o podanie adresu, który zwykle bêdzie w
postaci <filename>socket://XXX.XXX.XXX.XXX:9100</filename>, gdzie zamiast
XXX... nale¿y podaæ adres IP drukarki. Je¿eli nie znamy adresu IP drukarki,
mo¿emy spróbowaæ przeskanowaæ sieæ lokaln±, korzystaj±c np. z programu
<command>nmap</command>. Nastêpuj±ca komenda powinna pokazaæ nam wszystkie
dostêpne w sieci drukarki nas³uchuj±ce na porcie 9100:
<programlisting>
nmap -p 9100 192.168.1.*
</programlisting>
Oczywi¶cie zamiast <quote>192.168.1.*</quote> nale¿y podaæ maskê dla swojej
sieci lokalnej. 
Program powinien nas poinformowaæ, pod którym adresem znajduje siê otwarty port
9100, np.:
<programlisting>
Interesting ports on 192.168.1.49:
PORT     STATE SERVICE
9100/tcp open  jetdirect
</programlisting>

</para></listitem>

<listitem><para><emphasis>Internet Printing Protocol (http/ipp)</emphasis> -
wybieramy, je¿eli wiemy, ¿e nasza drukarka obs³uguje taki protokó³ lub je¿eli
chcemy mieæ dostêp do drukarki zainstalowanej na innym serwerze z CUPS.
</para></listitem>

<listitem><para><emphasis>LPD/LPR Host or Printer</emphasis> -
wybieramy, je¿eli chcemy drukowaæ na drukarce skonfigurowanej na innym serwerze
Linux/Unix z uruchomionym serwerem druku LPD (poprzednik CUPS'a).
</para></listitem>

<listitem><para>Port lokalny - USB, równoleg³y lub szeregowy. Je¿eli CUPS
wykryje pod³±czone do portu urz±dzenie, jego nazwa pojawi siê obok portu,
u³atwiaj±c nam wybór.
</para></listitem>

<listitem><para><emphasis>Windows Printer via SAMBA</emphasis> - wybieramy
je¿eli chcemy skorzystaæ z drukarki pod³±czonej do komputera z Windows
obecnego w naszej sieci lokalnej.
</para>
<para>
Je¿eli ta opcja nam siê nie pojawi, mo¿e to oznaczaæ, ¿e nie mamy poprawnie
zainstalowanego klienta Samby (pakiet <filename>smbclient</filename> w
Debianie).
</para>
<para>
Na nastêpnym ekranie musimy podaæ adres udzia³u Windows, pod którym widoczna
jest dana drukarka. Adres ten naj³atwiej sprawdziæ na komputerze z Windows, do
którego pod³±czona jest dana drukarka. Adres ma postaæ
<filename>smb://NAZWA_KOMPUTERA/NAZWA_DRUKARKI</filename>. Nazwê komputera
sprawdzamy klikaj±c w Windows prawym przyciskiem myszy na ikonie <emphasis>Mój
komputer</emphasis> i wybieraj±c <emphasis>W³a¶ciwo¶ci</emphasis> a nastêpnie
zak³adkê <emphasis>Nazwa</emphasis>. Nazwê drukarki mo¿na sprawdziæ wybieraj±c
<emphasis>Udostêpnianie</emphasis> we w³a¶ciwo¶ciach drukarki. Inn± metod±
mo¿e byæ przeszukanie ca³ej sieci Microsoft Network za pomoc± polecenia
<command>smbtree</command> (has³o podajemy puste) - powinny siê wy¶wietliæ
wszystkie widoczne w sieci udzia³y, w tym drukarki.
</para>
<para>
Je¶li komunikacja z drukark± nie dzia³a i dostajemy komunikat
NT_STATUS_ACCESS_DENIED, to trzeba bêdzie w nazwie zasobu podaæ u¿ytkownika
i has³o. Sytuacja taka wystêpowa³a przy starszych wersjach Samby i systemie
Windows XP, obecnie raczej nie powinna mieæ miejsca. Gdyby jednak siê to
zdarzy³o, to najlepiej utworzyæ w Windows specjalnego u¿ytkownika tylko do
drukowania korzystaj±c z Panelu Sterowania, opcja 
<emphasis>Zarz±dzanie Kontami U¿ytkowników</emphasis> 
i upewniæ siê, ¿e ma mo¿liwo¶æ drukowania na udostêpnionej
drukarce. Mo¿na tak¿e ustawiæ has³o. W takiej sytuacji adres zasobu wpisywany
przy konfiguracji drukarki powinien mieæ postaæ
<filename>smb://user:haslo@NAZWA_KOMPUTERA/NAZWA_DRUKARKI</filename>, gdzie 
<emphasis>user</emphasis> oznacza nazwê
u¿ytkownika, a <emphasis>has³o</emphasis> jest ustawionym has³em.
</para></listitem>
</itemizedlist>
</para>
<para>
Nastêpnym krokiem, po wybraniu sposobu dostêpu do drukarki, jest podanie jej
typu/modelu. Na pierwszym ekranie wybieramy producenta drukarki, np. HP,
Epson czy Minolta. Na kolejnym wybieramy konkretny model wraz z typem
sterownika (czasami dla drukarki dostêpny jest wiêcej ni¿ jeden sterownik).
Zwykle jeden ze sterowników bêdzie oznaczony jako
<emphasis>recommended</emphasis> - i jest to zazwyczaj najlepszy wybór.
<note>
	<para>
		Je¶li dostajemy komunikat, ¿e KDE nie mo¿e przebudowaæ
		bazy sterowników, prawdopodobnie oznacza to brak
		zainstalowanego pakietu
		<emphasis>foomatic-db-engine</emphasis> - nale¿y go
		doinstalowaæ.
	</para>
</note>
Sterowniki ró¿ni± siê ilo¶ci± dostêpnych opcji i jako¶ci± druku. Je¿eli nie
bêdziemy zadowoleni z wybranego sterownika, zawsze mo¿emy zmieniæ go
uruchamiaj±c ponownie konfiguracjê drukarki (przycisk <emphasis>Modify
Printer</emphasis> na ekranie CUPS'a z list± drukarek).
<note><para>Je¿eli mamy drukarkê obs³uguj±c± PostScript, to zwykle najlepszym
wyj¶ciem bêdzie wybranie typu drukarki <emphasis>Generic</emphasis> i
sterownika <emphasis>Generic PostScript Printer</emphasis>. Wyj±tkiem mog± byæ
drukarki atramentowe, gdzie czasem warto mieæ dostêp do specyficznych dla
drukarki ustawieñ dotycz±cych np. jako¶ci druku. Podobne ogólne sterowniki
istniej± dla drukarek korzystaj±cych z ró¿nych wersji jêzyka PCL firmy HP.
</para></note>
Je¿eli mamy problem z wyborem lub ze znalezieniem sterownika do naszej
drukarki, b±d¼ te¿ zastanawiamy siê jaki model wybraæ przy zakupie, warto
zajrzeæ na stronê 
<ulink url="http://www.linuxprinting.org">www.linuxprinting.org</ulink>.
Link <emphasis>Database</emphasis> / <emphasis>Printer Listings</emphasis>
daje nam dostêp do opisów praktycznie wszystkich spotykanych na rynku
drukarek, wraz z informacj± o wspó³pracy z Linuksem i o sugerowanym
sterowniku. 
</para>
<para>
Po zaakceptowaniu rodzaju sterownika CUPS poinformuje nas o utworzeniu nowej
drukarki, mo¿emy klikn±æ na link z jej nazw± aby wy¶wietliæ stronê opisuj±c±
stan drukarki i daj±c± dostêp do opcji drukarki. Na pocz±tek warto wydrukowaæ
stronê testow± (<emphasis>Print Test Page</emphasis>). Je¿eli siê to nie
powiedzie, przyczyny b³êdu mo¿emy szukaæ w linii z opisem stanu drukarki, choæ
zwykle trzeba bêdzie zajrzeæ do logów (w katalogu
<filename>/var/log/cups</filename>). Je¿eli problem dotyczy drukarki
udostêpnianej przez Sambê, warto te¿ sprawdziæ, czy mo¿emy siê
<quote>zalogowaæ</quote> na drukarkê za pomoc± polecenia
<command>smbclient</command> (jako argument podaj±c nazwê udzia³u). Je¶li
jeste¶my niezadowolenie z jako¶ci czy prêdko¶ci druku warto sprawdziæ opcje
udostêpnianie po klikniêciu przycisku <emphasis>Configure Printer</emphasis>.
</para>
</section> <!-- cups-printer --> 

<section id="cups-kdeprint">
<title>Konfiguracja drukarki z wykorzystaniem Mened¿era Drukowania KDE</title>
<para>
Je¿eli mamy dostêp do komputera ze ¶rodowiskiem KDE, to trochê mniej pracy
bêdziemy musieli wykonaæ konfiguruj±c drukarkê za pomoc± narzêdzia
dostarczanego przez KDE - Mened¿era Drukowania. Mo¿na go uruchomiæ z menu KDE
(menu <emphasis>Ustawienia</emphasis>) - wtedy klikamy na ikonie
<emphasis>Dodaj</emphasis> i wybieramy <emphasis>Dodaj drukarkê/klasê</emphasis> 
lub te¿ klikaj±c na ikonê z <quote>ró¿d¿k±</quote> w oknie wydruku dowolnej
aplikacji KDE (okno to mo¿na te¿ uruchomiæ komend±
<command>kdeprint</command>).
</para>
<para>
Powinni¶my zobaczyæ ¶liczny kreator. Na ekranie startowym naciskamy
<guibutton>Nastêpny</guibutton> i wybieramy typ drukarki, podobnie jak przy
standardowej konfiguracji za pomoc± przegl±darki (zobacz 
<xref linkend="cups-printer">. 
<itemizedlist>
<listitem><para>
W przypadku udostêpnionej drukarki Windows na
nastêpnym ekranie mo¿emy podaæ u¿ytkownika Windows na którego bêdziemy siê
logowaæ (konieczne dla Windows XP), a potem podaæ adres udzia³u. U³atwieniem
jest guzik <guibutton>Przeszukaj</guibutton>, pozwalaj±cy nam wybraæ drukarkê
klikaj±c na jedn± z drukarek udostêpnionych w sieci.
</para></listitem>
<listitem><para>
Mo¿liwo¶æ przeszukania sieci mamy tez wybieraj±c drukarkê sieciow± (TCP -
wiêkszo¶æ drukarek sieciowych lub IPP). Na ekranie <emphasis>Informacja o
drukarce sieciowej</emphasis> sprawdzamy, czy zaproponowana przez mened¿era
podsieæ jest zgodna z adresem naszej sieci lokalnej - w szczególno¶ci nie
powinna to byæ czasem proponowana sieæ 127.0.0.1. W razie potrzeby zmieniamy
sieæ przyciskiem <guibutton>Ustawienia</guibutton> (mo¿emy te¿ wybraæ inny
numer portu ni¿ zwykle u¿ywany przez drukarki 9100, a tak¿e ograniczyæ
przeszukiwane adresy IP). Nastêpnie klikamy na
<guibutton>Szukaj</guibutton> (je¿eli pojawi siê ostrze¿enie o niezgodno¶ci
adresu sieci, mo¿emy je bezpiecznie zignorowaæ). W g³ównym okienku kreatora
powinna pojawiæ siê lista znalezionych drukarek sieciowych. 
</para></listitem>
<listitem><para>
Je¿eli chcemy skorzystaæ z drukarki skonfigurowanej na innym komputerze z
CUPS'em, wybieramy <emphasis>Zdalny serwer CUPS</emphasis>. Na kolejnym
ekranie mo¿emy podaæ u¿ytkownika na którego chcemy siê logowaæ i has³o, a na
jeszcze nastêpnym wpisaæ adres komputera z serwerem CUPS. Powinni¶my zobaczyæ
listê dostêpnych skonfigurowanych drukarek.
</para></listitem>
<listitem><para>
Je¿eli mamy w sieci skonfigurowany serwer LPD, wybieramy <emphasis>Zdalny
serwer LPD</emphasis> i podajemy jego adres oraz nazwê kolejki (drukarki), np.
lp.
</para></listitem>
<listitem><para>
Je¿eli konfigurujemy drukarkê lokaln± (pod³±czon± prze port równoleg³y,
szeregowy lub USB), pod³±czone drukarki powinny byæ od razu wy¶wietlone, nie
bêdziemy musieli tak¿e zwykle samodzielnie wybieraæ producenta i sterownika.
</para></listitem>
</itemizedlist>
</para>
<para>
Kolejnym krokiem jest wybór producenta i modelu/sterownika drukarki, mo¿emy
te¿ zaznaczyæ ¿e chcemy korzystaæ z drukarki PostScriptowej. Ciekaw± opcjê
udostêpnia guzik <guibutton>Inne</guibutton>, pozwalaj±cy za³adowaæ plik PPD z
opisem drukarki, ¶ci±gniêty np. z 
<ulink url="http://www.linuxprinting.org">www.linuxprinting.org</ulink>. Mo¿e
to byæ przydatne je¿eli nasza drukarka nie jest obecna jeszcze w
zainstalowanej w systemie wersji bazy sterowników drukarek.
</para>
<para>
Po wyborze typu drukarki mo¿emy zmieniæ ustawienia drukarki takie, jak tryb
druku, rozdzielczo¶æ, rodzaj papieru itp. klikaj±c przycisk
<guibutton>Ustawienia</guibutton> lub wydrukowaæ stronê testow± klikaj±c
<guibutton>Test</guibutton>.
</para>
<para>
Zostaje jeszcze kilka opcjonalnych ustawieñ takich, jak drukowanie winiet,
ograniczenia na ilo¶æ stron dla u¿ytkowników, zdefiniowanie u¿ytkowników,
którzy maj± mieæ dostêp do drukarki.
</para>
<para>
W ostatnim kroku podajemy nazwê dla drukarki, mo¿emy podaæ tak¿e opis
lokalizacji. Zatwierdzamy parametry nowej drukarki (mo¿emy byæ poproszeni o
podanie nazwy i has³a u¿ytkownika maj±cego uprawnienia do drukowania) i
gotowe.
</para>
</section> <!-- cups-kdeprint -->

<section id="cups-samba">
<title>Konfiguracja serwera drukowania opartego o SMB</title>
<para>
Je¿eli chcemy, aby skonfigurowane w CUPS'ie drukarki widoczne by³y w sieci dla
komputerów z Windows, musimy upewniæ siê ¿e:
<itemizedlist>
<listitem><para>
Na komputerze linuksowym uruchamiane s± demony samby. Pod Debianem odpowiednia
komenda dodaj±ca sambê do plików startowych systemu to:
<programlisting>
update-rc.d samba defaults
</programlisting>
</para></listitem>
<listitem><para>
Upewniæ siê, ¿e w pliku konfiguracyjnym Samby
<filename>/etc/samba/smb.conf</filename> mamy odkomentowane nastêpuj±ce wpisy:
<programlisting>
printing = cups
printcap name = cups
</programlisting>
W tym samym pliku nale¿y te¿ ustawiæ nazwê grupy dla sieci Windows, np.
<programlisting>
[global]

## Browsing/Identification ###

# Change this to the workgroup/NT-domain name your Samba server will part of
   workgroup = MYGROUP
   
</programlisting>
i upewniæ siê, ¿e mamy udzia³ z drukarkami, np.:
<programlisting>
[printers]
   comment = All Printers
   browseable = no
   path = /tmp
   printable = yes
   public = no
   writable = no
   create mode = 0700
</programlisting>
<note><para>
Uwaga! Powy¿szy wpis udostêpnia wszystkie skonfigurowane na danym
ho¶cie drukarki (równie¿ drukarki sieciowe, nie pod³±czone bezpo¶rednio
do tego hosta). Je¿eli nie chcemy udostêpniaæ wszystkiego,
to mo¿emy utworzyæ sekcjê o nazwie takiej, jak identyfikator danej drukarki 
(mo¿na je sprawdziæ za pomoc± polecenia <command>lpstat -a</command>). 
Na przyk³ad je¶li chcemy udostêpniæ jedynie drukarkê <command>lp</command> to tworzymy sekcjê:
<programlisting>
[lp]
	comment = My favourite printer
	path = /tmp
	printable = Yes
</programlisting>
</para></note>
</para></listitem>
<listitem><para>
Je¿eli Samba nie by³a uruchomiona, nale¿y jeszcze j± uruchomiæ (lub uruchomiæ
ponownie je¿eli by³a uruchomiona, a dokonywali¶my zmian w plikach
konfiguracyjnych Samby):
<programlisting>
/etc/init.d/samba start
</programlisting>
</para></listitem>
</itemizedlist>
To wszystko - nasze drukarki powinny byæ widoczne dla wszystkich komputerów
w sieci jako udostêpnione drukarki Windows.
</para>

</section> <!-- "cups-samba" -->

</section><!-- id="drukowanie" -->

<section id="samba-share">
<title>Katalog wspó³dzielony z wykorzystaniem Samby</title>

<para>
Czasami zachodzi potrzeba wymiany danych miêdzy u¿ytkownikami loguj±cymi siê
na komputery linuksowe i windowsowe. Jednym z rozwi±zañ jest udostêpnienie
publicznego katalogu, który bêdzie widoczny ze wszystkich komputerów w sieci i
bêdzie pozwala³ wszystkim u¿ytkownikom na zapisywanie w nim danych.
</para>
<para>
Niniejszy opis dotyczy przyk³adowej konfiguracji, w której sieæ lokalna ma
adres IP 192.168.1.0, istnieje jeden serwer linuksowy o nazwie 
<emphasis>linserv</emphasis>, kilka terminali linuksowych i windowsowych.
Wszystkie komputery linuksowe musz± mieæ zainstalowan± Sambê.
Kolejno:
<orderedlist>
<listitem><para>
Na serwerze linserv tworzymy now± grupê <emphasis>wspolne</emphasis> 
i dodajemy do niej u¿ytkowników,
którzy bêd± mieli mieæ dostêp do katalogu. Wybierzmy numer grupy na tyle du¿y,
¿eby na ¿adnym z terminali linuksowych nie istnia³a ju¿ grupa o takim numerze.
Mo¿e to oznaczaæ taki wpis w pliku <filename>/etc/group</filename>:
<programlisting>
wspolne:x:1050:kierownik,prezes,nobody,palacz
</programlisting>
Do grupy musz± nale¿eæ wszyscy u¿ytkownicy, którzy maj± mieæ dostêp do
katalogu wspó³dzielonego, oraz, dodatkowo, u¿ytkownik z uprawnieniami którego
dzia³aj± demony Samby (czyli zwykle <emphasis>nobody</emphasis>).
</para></listitem>

<listitem><para>
Analogicznie, grupê o takiej samej nazwie i numerze tworzymy na wszystkich
terminalach linuksowych.
</para></listitem>

<listitem><para>
Na serwerze tworzymy odpowiedni katalog:
<programlisting>
mkdir /home/wspolne
chown nobody.wspolne /home/wspolne
chmod 2755 /home/wspolne
</programlisting>
</para></listitem>

<listitem><para>
Na wszystkich terminalach linuksowych tak¿e tworzymy katalog:
<programlisting>
mkdir /home/wspolne
</programlisting>
</para></listitem>

<listitem><para>
Na wszystkich komputerach linuksowych (z serwerem w³±cznie) w pliku
<filename>/etc/samba/smb.conf</filename> ustawiamy parameter
<emphasis>workgroup</emphasis> na u¿ywan± w sieci nazwê grupy roboczej, np.
<programlisting>
workgroup = WORKGROUP
</programlisting>
Je¿eli jeden z komputerów ma pe³niæ rolê serwera WINS, to musimy na nim dodaæ
wpis:
<programlisting>
wins support = yes
</programlisting>
Je¿eli pozosta³e komputery maj± problemy ze znalezieniem serwera WINS, to
mo¿na dodaæ im wpis z numerem IP serwera, np.
<programlisting>
wins server = 192.168.1.100
</programlisting>
</para></listitem>

<listitem><para>
Na serwerze linuksowym modyfikujemy plik
<filename>/etc/samba/smb.conf</filename>, aby obecne by³y nastêpuj±ce wpisy:
<programlisting>
[global]
	; zmiana ustawien domyslnych
	  security = share
	  load printers = no ; bonus

; dodana nowa sekcja
[wspolne]
	  comment = Katalog wspoldzielony
	  path = /home/wspolne
	  browseable = yes
	  writeable = yes
	  public = yes
	  force user = nobody
	  force group = wspolne
	  create mode = 0664
	  directory mode = 0775
	  force create mode = 0664
	  force directory mode = 0775
	  hosts deny = ALL
	  hosts allow = 192.168.1.21 192.168.1.22 192.168.1.2 192.168.1.3
</programlisting>
Ostatnia linia to przyk³adowa lista komputerów, którym pozwalamy na dostêp do 
naszego katalogu. Mo¿na te¿ podaæ ca³± podsieæ:
<programlisting>
	  hosts deny = ALL
	  hosts allow = 192.168.1.
</programlisting>

</para></listitem>

<listitem><para>
Je¿eli u¿ywamy j±dra 2.4, to na wszystkich komputerach linuksowych 
dodajemy do pliku
<filename>/etc/fstab</filename> liniê:
<programlisting>
//linserv/wspolne /home/wspolne smbfs rw,gid=1050,fmask=664,dmask=775, \
	password= 0 0
</programlisting>
Zamiast 1050 wstawiamy oczywi¶cie numer grupy 'wspolne'. Nazwa komputera
linserv musi te¿ byæ poprawnie t³umaczona na IP (mo¿na dodaæ wpis do
<filename>/etc/hosts</filename>).
</para>
<para>
Niestety, je¿eli u¿ywamy j±dra 2.6, to po wykonaniu tego oraz opisanych ni¿ej 
kroków
nasz katalog prawdopodobnie bêdzie niedostêpny dla u¿ytkowników zalogowanych
bezpo¶rednio na serwerze (programy chc±ce uzyskaæ dostêp do katalogu bêd± siê
"przywiesza³y"), a w logach otrzymamy komunikaty typu:
<programlisting>
Dec 11 00:33:35 linserv kernel: smb_add_request: request [c50f2e80, mid=17] \
	timed out!
</programlisting>
Rad± na to jest upgrade samby (w Debianie unstable pakiet co najmniej z wersj±
3.0.7-2) i u¿ycie nowej wersji protoko³u SMB o nazwie CIFS (Common Internet
File System). Oznacza to nastêpuj±ce wpisy w pliku
<filename>/etc/fstab</filename> na serwerze i terminalach linuksowych:
<programlisting>
//linserv/wspolne /home/wspolne cifs rw,gid=1050,file_mode=0664,dir_mode=0775, \
	password= 0 0
</programlisting>
</para>
</listitem>

<listitem><para>
Je¿eli dotychczas tego nie zrobili¶my, to nale¿y zrestartowaæ Sambê, aby
zosta³y uwzglêdnione zmiany poczynione przez nas w plikach konfiguracyjnych:
<programlisting>
/etc/init/samba restart
</programlisting>
</para></listitem>

<listitem><para>
Na komputerach linuksowych montujemy nasz nowy katalog za pomoc± komendy:
<programlisting>
mount /home/wspolne
</programlisting>
Jest to czynno¶æ jednorazowa - katalog bêdzie zawsze domy¶lnie montowany
podczas startu systemu.
</para></listitem>

<listitem><para>
W systemie Debian konieczna jest te¿ zmiana w pliku
<filename>/etc/profile</filename> wywo³ania 'umask 022' na 'umask 002'.
Prawid³owe prawa dostêpu do wspólnego katalogu bêd± mieli tylko u¿ytkownicy
zalogowani po tej zmianie.
</para></listitem>

<listitem><para>
Na koniec mo¿emy na komputerach linuksowych utworzyæ w katalogach domowych
u¿ytkowników linki symboliczne do katalogu <filename>/home/wspolne</filename>,
a na komputerach windowsowych zmapowaæ zasób //linserv/wspolne jako nowy dysk.
</para></listitem>

</orderedlist>
</para>

</section>

<section id="rsync">
<title>Synchronizowanie zawarto¶ci katalogów - <command>rsync</></title>
<para>
<command>Rsync</> - synchronizuje zbiory dyskowe (np. na odleg³ych maszynach). 
Program jest czê¶ci± standardowej dystrybucji Linuksa. Zosta³ u¿yty
do backupowania baz danych SZARPa oraz do przegrywania na bie¿±co zawarto¶ci
bazy danych z serwera (z dzia³aj±cym <command>parcook</>iem) na klienta
(z <command>SzarpDraw</>em).
</para>
<para>
<command>rsync</> dzia³a w dwóch konfiguracjach: 
<itemizedlist>
<listitem><para> klient rsync &lt;--&gt; serwer rsync </para></listitem>
<listitem><para> klient rsync (korzysta z rsh) &lt;--&gt; serwer rshd </para></listitem>
</itemizedlist>

Poni¿ej opisano <command>rsync</>a w 1-szej konfiguracji dla 
zestawu dwóch komputerów, z których:

<itemizedlist>
<listitem><para> 
 na pierwszym siedzi parcook i meaner. Nastêpuje ci±g³y zapis do bazy (serwer);
</para></listitem>
<listitem><para> 
 na drugim mamy Linuksa w du¿ym dyskiem do robienia backupów (klient).
</para></listitem>
</itemizedlist>

Zak³adam, ¿e oba kompy s± po³±czone sieci±.
Pierwszy w komputerów (serwer) musi mieæ dzia³aj±cego rsync-demona, czyli: 

<itemizedlist>
<listitem><para> 
  zainstalowany pakiet rsync (z rpm-ki),
</para></listitem>

<listitem><para> 
  ustawiony w inetd:
	<itemizedlist>
	<listitem><para> 
	sprawdziæ czy w <filename>/etc/services</> istnieje linijka
	<programlisting>
		rsync	873/tcp
	</programlisting>
	Je¶li nie, to j± dopisaæ!

	</para></listitem>
	<listitem><para> 
	sprawdziæ czy w <filename>/etc/inetd.conf</> jest co¶ na kszta³t:
	<programlisting>
		rsync stream tcp nowait root /usr/bin/rsync rsyncd --daemon
	</programlisting>
	  Je¶li nie, to dopisaæ!
	</para></listitem>

	<listitem><para> 
 	PrzeHUPowaæ demona internetowego:
	<programlisting>
		killall -HUP inetd
	</programlisting>
	</para></listitem>
	</itemizedlist>

</para></listitem>

<listitem><para> 
  skonfigurowanego rsync-demona:

	tworzymy plik <filename>/etc/rsyncd.conf</> nastêpuj±cego formatu:

<programlisting>
# poczatek pliku /etc/rsyncd.conf

uid = root
[baza]	
	path = /opt/szarp/baza
[home]
	path = /home
# .. i tak dalej

# EOF
</programlisting>

	 oczywi¶cie mo¿emy mieæ równie¿ jedn± sekcjê albo bardzo du¿o.
	 Do ¶ci±gania bazy nie trzeba wcale ¿adnych dodatkowych opcji.
      	 Jako uid mo¿emy wpisaæ dowolnego u¿ytkownika zamiast roota,
	 wa¿ne, ¿eby mia³ prawo do wchodzenia do katalogów i ich odczytu.
</para></listitem>
</itemizedlist>

Teraz drugi komp:
<itemizedlist>

<listitem><para> 
	instalujemy pakiet rsync (je¶li go jeszcze nie ma),
</para></listitem>

<listitem><para> 
¿eby ¶ci±gn±æ bazê, wydajemy polecenie:
<programlisting>
		rsync -avz &lt;adres_serwera&gt;::baza &lt;katalog_docelowy&gt;
</programlisting>

	gdzie 	&lt;adres_serwera&gt; to mo¿e byæ IP lub nazwa, 
		&lt;katalog_docelowy&gt; to istniej±cy lokalnie 
			katalog z prawami do zapisu,

	np.
<programlisting>
		rsync -avz 192.168.0.1::baza /sciagnieta_baza
</programlisting>
</para></listitem>

<listitem><para> 
¿eby ¶ci±gn±æ katalogi u¿ytkowników wystarczy wklepaæ:

<programlisting>
		rsync -avz 192.168.0.1::home /sciagniete_katalogi
</programlisting>
</para></listitem>

</itemizedlist>
UWAGA!

<itemizedlist>
<listitem><para> 
	 <emphasis>WA¯NE</>! Powtórne wywo³anie tej samej komendy 
          spowoduje ¶ci±gniêcie tylko nowych i zmodyfikowanych plików a
	  nie wszystkiego od nowa.
</para></listitem>


<listitem><para> 
 	 Ka¿dy zasób, który ¶ci±gamy tym sposobem musi byæ obecny w 
	 jakiej¶ sekcji w pliku <filename>/etc/rsyncd.conf</>
</para></listitem>

<listitem><para> 
	 Bardzo wa¿ny jest ten podwójny dwukropek <quote>::</> w komendzie.
	 Oznacza on, ze korzystamy z <command>rsyncd</>, a nie z 
  	<command>rsh</>.
</para></listitem>

<listitem><para> 
	<command>rsync</> mo¿e pracowaæ nie tylko w trybie <quote>pop</>, 
	ale równie¿ w trybie <quote>push</>. Poniewa¿ jest to mniej bezpieczne,
	wymagane jest ustawienie parametru w pliku 
	<filename>/etc/rsyncd.conf</> po stronie serwera:
	<programlisting>
		read only = false
	</programlisting>
	Wywo³anie komendy w tym przypadku ró¿ni siê tylko kolejno¶ci± 
	parametrów, np.:
	<programlisting>
		rsync -avz /katalogi 192.168.0.1::home 
	</programlisting>
</para></listitem>


<listitem><para> 
	  w poleceniu <filename>rsync -avz ..</> mo¿na pomin±æ parametr -v 
	  (bo to jest verbose) oraz -z (kompresja 'w locie'). 
	  Parametr -a oznacza archiwizacjê z zachowaniem wszystkich 
	  atrybutów plików (uid/gid/rwx/typ pliku).
</para></listitem>
</itemizedlist>

W Legionowie stworzono konfiguracjê <command>rsync</> + 
<command>crontab</> do robienia backupów bazy. Dwa serwery 
<quote>wymieniaj±</> siê w³asnymi bazami (<command>rsync</> pracuje 
w trybie <quote>pop</>) i dodatkowo przesy³aj± bazê do terminala
(<quote>push</>). Plik <filename>crontab</> z jednego z serwerów przedstawiono
poni¿ej, w rozdziale <xref linkend="crontab">.

</para>
</section>


<section id="crontab">
<title>Ustalanie zadañ do wykonania w systemie - <command>crontab</></title>
<para> W Linuksie
mamy mo¿liwo¶æ ustalania jakie zadania maj± byæ wykonywane w okre¶lonym terminie.
Do dyspozycji mamy dwa standardowe klasyczne uniksowe programy <command>at</>
i <command>cron</>. Jaka jest miêdzy nimi ró¿nica? Otó¿ <command>at</> s³u¿y
do jednorazowego wykonywania poleceñ, np. <emphasis>ósmego marca b.r. o godz. 9:00 wy¶lij
wszystkim paniom w firmie odpowiedniego maila</>. <command>Cron</> s³u¿y do 
wykonywania zadañ periodycznie, np. <emphasis>co godzinê rób mirrora pewnej strony WWW
i umieszczaj j± na naszym serwerze</>.
</para> 
<para>
Oba z tych programów pracuj± jako klient-serwer, tzn. zarz±dzaniem procesów
steruje stale obecny w systemie demon (<command>atd</> i <command>crond</>), a 
u¿ytkownik korzysta z programu klienckiego (odpowiednio <command>at</> i
<command>crontab</>). Dla obu tych programów tworzy siê przewa¿nie plik ze
zleceniami. Dla at jest to skrypt shella. 
Natomiast format pliku crona jest dosyæ skomplikowany i 
jest opisany poni¿ej:</para>
<para> Jedno zadanie jest opisane w jednej linii, zawieraj±cej
piêæ pól wyja¶niaj±cych kiedy dane zadanie ma siê wykonywaæ, po czym
umieszcza siê komendê shella, czyli:
<programlisting>
&lt;minuty&gt; &lt;godziny&gt; &lt;dni miesi±ca&gt; &lt;miesi±c&gt; &lt;dni_tygodnia&gt; &lt;<filename>KOMENDA</>&gt;
</programlisting>
Mo¿na zast±piæ dane pole gwiazdk±, ¿eby zadanie wykonywa³o siê <quote>zawsze</>,
np.: 
<programlisting>
0 1 * * * mail bgates@microsoft.com < obelgi
</programlisting>
Oznacza, ¿e codziennie o 1-szej nad ranem bêdziemy wysy³aæ na adres 
bgates@microsoft.com zawarto¶æ pliku <filename>obelgi</>.
</para>
<para>
¯eby zg³osiæ cronowi nasze zlecenie, nale¿y uruchomiæ komendê:
<programlisting>
crontab &lt;nazwa pliku konfiguracyjnego&gt;
</programlisting>
Poniewa¿ tradycyjnie konfiguracjê umieszcza w pliku <filename>crontab</>,
wiêc najczêstsze wywo³anie crontaba ma postaæ: 
<programlisting>
crontab crontab
</programlisting>
Ka¿dy z u¿ytkowników mo¿e mieæ po jednym aktywnym pliku konfiguracyjnym crontaba
(tzn. je¶li wywo³amy powtórnie komendê crontab, to stare ustawienia 
zostan± zatarte). Je¿eli programy wywo³ywane jako komendy crontaba wy¶wietlaj±
cokolwiek na standardowym wyj¶ciu, dane te s± przychwytywane przez crona 
i wysy³ane mailem do w³a¶ciciela crontaba. ¯eby unikn±æ wysy³ania maili nale¿y
ustawiæ zmienn± ¶rodowiskow± MAILTO="". Mo¿na równie¿ wysy³aæ maile komu¶
innemu, ustawiaj±c tê zmienn± na okre¶lony adres, np. 
MAILTO="lucek@praterm.com.pl". Zmienn± MAILTO mo¿na (i nale¿y) ustawiaæ w pliku
konfiguracyjnym crontaba. Je¿eli chcemy wykonywaæ periodycznie 
wiele niezale¿nych
zleceñ to musimy w jednym pliku konfiguracyjnym dla crontaba wpisaæ 
wiele rekordów (linii), tak jak na przyk³adzie poni¿ej (dwa zlecenia):
<programlisting>
MAILTO=""
1,11,21,31,41,51 * * * * /usr/bin/rsync -av /opt/szarp/baza/ 192.9.200.12::leg1
3,13,23,33,43,53 * * * * /usr/bin/rsync -av  192.9.200.170::baza \
	/opt/szarp/leg2/baza/
</programlisting>
</para></section>



<section id="terminale-w-linuksie">
<title>Wirtualne konsole w Linuksie</>
<para>
Mo¿emy ich mieæ wiele - najprawdopodobniej do 255. Konsole te oznaczane s±
symbolem ttyX, gdzie X jest identyfikatorem konsoli (terminala) - 
liczb± naturaln± 
(np. tty1, tty2, tty3 itd.). Reprezentowane s± przez urz±dzenia znakowe 
w katalogu <filename>/dev</> (np. <filename>/dev/tty1</>) o numerze MAJOR=4
i MINOR=0...255. 
Bezpo¶redni dostêp przez kombinacjê klawiszy ALT-&lt;klawisz funkcyjny&gt; 
mo¿emy mieæ do pocz±tkowych 24-ch terminali (tty1 - tty24). 
Terminale tty1-tty12
osi±gamy poprzez wci¶niêcie lewego klawisza ALT i klawisza funkcyjnego Fn, 
co powinno nas prze³±czyæ na terminal ttyn (np. po naci¶niêciu ALT-F6, 
prze³±czamy siê na terminal tty6). Kolejnych 12 terminali jest 
osi±galnych przez prawy ALT-Fn, co prze³±cza nas na 
terminal tty{n+12} (np. prawy ALT-F2 prze³±cza nas na terminal tty14). 
Innym sposobem prze³±czania terminali jest u¿ycie kombinacji ALT-&lt;strza³ka&gt;.
Po naci¶niêciu prawej strza³ki prze³±czamy siê na kolejn± konsolê, natomiast 
po naci¶niêciu lewej przechodzimy na poprzedni terminal. Wszystkie te operacje
s± przeprowadzane modulo ilo¶æ terminali.
</para>
<para>Przyk³ad: za³ó¿my, ¿e pracujemy w standardowym 3-cim runlevelu bez iksów.
Niech aktualnym terminalem bêdzie tty3. Wtedy piêciokrotne naci¶niêcie 
ALT-&lt;prawa strza³ka&gt; prze³±czy nas kolejno na terminale tty4, tty5, tty6,
tty1, tty2. Wówczas piêciokrotne naci¶niecie lewej strza³ki przeniesie nas
kolejno na terminal tty1, tty6, tty5, tty4, tty3 (z powrotem do punktu wyj¶cia).
Ten sam rezultat mogliby¶my osi±gn±æ naciskaj±c jeszcze jeden raz 
ALT-&lt;prawa strza³ka&gt;
</para>
<para>Powy¿sze skróty (ALT-&lt;klawisz funkcyjny&gt; ALT-&lt;strza³ka&gt; nie 
dzia³aj± niestety pod iksami, w iksach maj± one inne znaczenie. Do 
prze³±czenia konsoli, gdy aktywne s± iksy, u¿ywamy kombinacji lewy
ALT-CTRL-&lt;klawisz funkcyjny&gt; o dzia³aniu odpowiadaj±cym kombinacji lewy
ALT-&lt;klawisz funkcyjny&gt; w konsolach tekstowych. Uwaga: kombinacja
ALT-CTRL-&lt;strza³ka&gt; nie mo¿e byæ u¿ywana w ten sposób. 
Dostêp do konsoli o du¿ych numerach (np. tty25, tty26) jest tylko przez 
ALT-&lt;strza³ka&gt;. Problem z prze³±czaniem konsoli pojawia siê, gdy mamy 
równocze¶nie wiele sesji iksów. Wprawdzie taka sytuacja nie zdarza siê 
w praktyce nigdy (iksy + KDE to grubo ponad 20 MB ramu), ale niespójno¶æ
systemu dostêpu do odpowiednich terminali jest trochê irytuj±ca.
</para>
<para>
Ka¿dy terminal, zanim mo¿e byæ u¿yty, musi byæ otwarty. S³u¿± to tego 
programy z rodziny getty. Sam getty (<filename>/sbin/getty</>) jest 
dosyæ mocnym programem i mo¿e byæ u¿ywany do otwierana konsol wirtualnych 
jak i innych terminali (np. po³±czonych portem szeregowym). Dlatego
u¿ywa siê przewa¿nie jego uproszczonych, wyspecjalizowanych 
klonów: <command>mingetty</> do otwierania
konsol wirtualnych, <command>mgetty</> do modemów i innych. 
<command>mingetty</> jest uruchamiany przez inita. W standardowym
RedHacie init uruchamia mingetty'a sze¶ciokrotnie. Fragment pliku 
<filename>/etc/inittab</>:
<programlisting>
1:2345:respawn:/sbin/mingetty tty1
2:2345:respawn:/sbin/mingetty tty2
3:2345:respawn:/sbin/mingetty tty3
4:2345:respawn:/sbin/mingetty tty4
5:2345:respawn:/sbin/mingetty tty5
6:2345:respawn:/sbin/mingetty tty6
</programlisting>
Je¿eli mamy potrzebê u¿ycia wiêkszej ilo¶ci terminali (konsol), to nale¿y
dopisaæ odpowiednie wywo³ania mingetty'a, np.:
<programlisting>
11:2345:respawn:/sbin/mingetty tty11
12:2345:respawn:/sbin/mingetty tty12
</programlisting>
</para>
<para>
<emphasis>Uwaga!</> Niektóre dystrybucje nie maj± urz±dzeñ specjalnych 
w katalogu
<filename>/dev/</> reprezentuj±cych wy¿sze numery terminali (tty13-tty24), 
nie mówi±c ju¿ o terminalach o jeszcze wy¿szych identyfikatorach.
Tak jest w RedHacie. Nale¿y wówczas (tylko gdy jest taka potrzeba, czyli
nieczêsto) dodaæ te urz±dzenia rêcznie, np. komend± <command>mknod</>:
<programlisting>
	mknod /dev/tty12 c 4 12
	mknod /dev/tty13 c 4 13
	mknod /dev/tty14 c 4 14
</programlisting>
Dopiero wtedy wrzucamy konfiguracjê do inittaba i mo¿emy siê cieszyæ prawym
ALT-Fn. 
</para>
<para> 
Terminale otwierane s± równie¿ przez iksy (X-serwer
jest zwi±zany z jakim¶ okre¶lonym terminalem). 
Iksy wchodz± nam na pierwszy wolny terminal (z wyj±tkiem 
<quote>zarezerwowanego</> tty1) : w przypadku standardowych
dystrybucji 6-cio terminalowych jest to terminal siódmy (tty7). Tak jest w 
przypadku uruchamiania Linuksa w runlevelu 5-tym, jak i w przypadku rêcznego
uruchamiania iksów komend± <command>startkde</>, <command>startx</> itp.
Teoretycznie, gdyby ¿aden z terminali nie by³ inicjowany przez inita, 
iksy pakowa³yby siê na terminal drugi (tty2). W przypadku, gdy wszystkie
dostêpne terminale s± ju¿ zajête (otwarte przez konsolowego mingetty'a
lub otwarte przez inne sesje iksów) X-server wyjdzie z b³êdem 
<quote>Could not open /dev/ttyXX</>. Wtedy nale¿y u¿yæ komendy
<command>mknod</> do stworzenia urz±dzenia wirtualnego <filename>/dev/ttyXX</>.
Iksy dobrze siê czuj± równie¿ na wysokich numerach terminali (np. tty30),
dostêp jednak do nich jest trochê utrudniony (wielokrotne ALT-&lt;strza³ka>).
</para>

<section id="stty">
<title><quote>Naprawianie</quote> terminali wirtualnych</title>
<para>
Czasami terminal zostaje <quote>zepsuty</quote> (np. przez próbê
wy¶wietlenia pliku binarnego za pomoc± komendy 
<command>cat</command>). 
<quote>Zepsucie</quote> objawia siê zwykle poprzez 
niezrozumia³e znaki na terminalu (lub brak wy¶wietlania czegokolwiek).
Spowodowane jest zmian± pewnych parametrów terminala.
Naprawienie polega na wpisaniu komendy:
<programlisting>
stty sane
</programlisting>
lub
<programlisting>
reset
</programlisting>
(dzia³anie obu komend jest w tym przypadku identyczne).
W trakcie wpisywania komendy nie nale¿y zwracaæ uwagi na to, ¿e
znaki komendy nie s± wy¶wietlane lub wygl±daj± niezrozumiale
(i tak powinna przynie¶æ skutek).
Je¿eli jednak nie pomo¿e, mo¿e to oznaczaæ, ¿e terminal zosta³
zablokowany. 
Zablokowanie to nastêpuje zazwyczaj po naci¶niêciu CTRL-S i
³atwo je zrobiæ przypadkowo.
¯eby odblokowaæ terminal, nale¿y zwykle nacisn±æ CTRL-Q.
</para>
</section> <!-- stty -->

</section> <!-- terminale-w-linuksie -->

<section id="x-serwery"> <title>Uruchamianie wielu X-serwerów</>

<para> W ramach jednego hosta mo¿e funkcjonowaæ wiele
X-serwerów. Oznaczane s± przez tzw. display number, czyli liczbê poprzedzon±
dwukropkiem, np. :0, :1, :5, :666, itp. W ka¿dym przypadku domy¶lny display
number to :0. 
Mechanizm obs³ugi ekranu
jest analogiczny do terminali wirtualnych: równocze¶nie mo¿emy uruchomiæ 
kilka serwerów, do których dostêp mamy poprzez ALT-Fn lub CRTL-ALT-Fn
(w X-ach ALT-Fx miewa trochê inne znaczenie ni¿ na konsoli tekstowej, 
dlatego u¿ywamy CRTL-ALT-Fx).

Np. w runlevelu 3-cim mo¿emy uruchomiæ 3 X-serwery komend±:
<programlisting>
	X&amp; 
	X :1&amp; 
	X :2&amp;
</programlisting>
Do tak uruchomionych serwerów mo¿emy siê odwo³ywaæ najprawdopodobniej 
poprzez odpowiednio CRTL-ALT-F7, CRTL-ALT-F8, CRTL-ALT-F9. Trudno powiedzieæ
ile kopii X-ów mo¿e byæ równocze¶nie uruchomionych na jednej maszynie, 
prawdopodobnie tyle na ile wystarczy pamiêci.

Je¿eli u¿ywamy XDM/XDMCP to mo¿emy u¿yæ opcji -query, np.
<programlisting>
	X :1 -query 192.168.0.2
	X :1 -query localhost
</programlisting>
Opis parametrów przekazywanych do programu <command>X</> mo¿na uzyskaæ
przez <command>man Xserver</>, ogólny opis X-ów przez <command>man X</>.
</para>
</section> <!-- x-serwery -->

<section id="xephyr">
<title>X-serwer w oknie (Xephyr/Xnest)</title>
<para>
Istnieje mo¿liwo¶æ uruchomienia X-serwera w oknie wy¶wietlanym przez inny, dzia³aj±cy
X-serwer. S³u¿y do tego <command>Xephyr</command> lub <command>Xnest</command> (poprzednia
wersja Xephyra). Instalujemy go wywo³uj±c komendê:
<programlisting>
apt-get install xserver-xephyr
</programlisting>
Xephyr mo¿e pos³u¿yæ do uruchomienia dodatkowego lokalnego Xserwera lub do po³±czenia
siê z serwerem zdalnym przy u¿yciu opcji <command>-query</command>. Mo¿na go wykorzystaæ
do testowania XDMCP. Przyk³adowe u¿ycie:
<programlisting>
Xephyr :1 -query host
</programlisting>
Inne u¿yteczne opcje:
<itemizedlist>
<listitem><para>
<emphasis>-screen</emphasis> - pozwala podaæ wymiary okna Xephyra. Jako argument
nale¿y podaæ wymiary w postaci SZEROKOSCxWYSOKOSC w pikselach.
</para></listitem>
<listitem><para>
<emphasis>-fullscreen</emphasis> - pozwala uruchomiæ Xephyr na pe³nym ekranie</para></listitem>
</itemizedlist>
</para>
</section> <!-- xephyr -->

<section id="qemu">
<title>Instalacja i uruchamianie emulatora Qemu</title>

<section id="qemu-about">
<title>Opis</title>
<para>
<emphasis>Qemu</emphasis> to dostêpny na licencji GPL/LPGL emulator procesora.
Mo¿e pracowaæ w dwóch trybach - u¿ytkownika, w którym pozwala na uruchamianie
programów linuksowych skompilowanych na jeden typ procesora na innym typie,
oraz w trybie emulacji ca³ego systemu. W tym drugim trybie tworzy wirtualn±
maszynê z procesorem i odpowiednimi peryferiami, pozwalaj±c na uruchomienie
pod jej kontrol± ca³ego systemu operacyjnego - podobnie jak robi to
oprogramowanie typu VMWare czy Xen. Pozwala to na przyk³ad na
przetestowanie p³yty instalacyjnej czy dystrybucji <emphasis>live</emphasis>
Linuksa bez konieczno¶ci wypalania p³yty i resetowania komputera, a tak¿e np.
na uruchomienie pod kontrol± Linuksa sesji systemu Windows. Poza emulacj±
komputera typu PC Qemu pozwala tak¿e na emulacjê innych architektur, ale
niniejszy opis skupia siê na u¿ywaniu Qemu pod Linuksem na platformie PC do
uruchamiania innej sesji Linuksa lub Windows.
</para>
<para>
Do Qemu przy emulacji PC->PC dostêpny jest modu³ do j±dra 
<emphasis>kqemu</emphasis>,
przyspieszaj±cy jego dzia³anie 5 - 10 razy - dziêki temu programy uruchomione
pod kontrol± systemu operacyjnego w wirtualnej maszynie dzia³aj± niewiele
wolniej, ni¿ uruchomione bezpo¶rednio na danym komputerze. Kqemu nie jest
oprogramowaniem open-source - jest bezp³atny do u¿ytku, ale nie mo¿na go
dystrybuowaæ bez zezwolenia autora. Powsta³ wiêc tak¿e otwarty klon kqemu o
nazwie <emphasis>qvm86</emphasis>.
</para>
<para>
Przydatne linki:
<itemizedlist>
<listitem><para>
<ulink url="http://fabrice.bellard.free.fr/qemu/">fabrice.bellard.free.fr/qemu/</ulink> - g³ówna strona Qemu i Kqemu.
</para></listitem>

<listitem><para>
<ulink url="http://kidsquid.com/cgi-bin/moin.cgi/FrequentlyAskedQuestions">kidsquid.com/cgi-bin/moin.cgi/FrequentlyAskedQuestions</ulink>
- obszerny FAQ do Qemu.
</para></listitem>

<listitem><para>
<ulink url="http://pl.wikipedia.org/wiki/QEMU">pl.wikipedia.org/wiki/QEMU</ulink>
- opis Qemu w polskiej Wikipedii.
</para></listitem>

<listitem><para>
<ulink url="http://en.wikipedia.org/wiki/QEMU">en.wikipedia.org/wiki/QEMU</ulink>
- opis Qemu w angielskiej Wikipedii.
</para></listitem>

<listitem><para>
<ulink url="http://savannah.nongnu.org/projects/qvm86/">savannah.nongnu.org/projects/qvm86/</ulink>
- strona projektu qvm86.
</para></listitem>

<listitem><para>
<ulink url="http://emeitner.f2o.org/qemu_launcher">emeitner.f2o.org/qemu_launcher</ulink>
- interfejs graficzny dla Qemu.
</para></listitem>
</itemizedlist>

</para>
</section> <!-- qemu-about -->

<section id="qemu-debian">
<title>Instalacja z paczki debianowej</title>
<para>
Qemu jest dostêpne w postaci paczki debianowej - komenda <command>apt-get
install qemu</command> zainstaluje nam emulator wraz z BIOS'em do karty
graficznej. Niestety, qemu w paczce debianowej nie wspiera
akceleratorów kqemu ani qvm86. Je¶li wiêc chcemy mieæ emulator dzia³aj±cy
na tyle szybko, by wygodnie uruchamiaæ np. sesjê Windows, to musimy
zainstalowaæ go ze ¼róde³.
</para>
</section>

<section id="qemu-source">
<title>Instalacja ze ¼róde³</title>

<itemizedlist><listitem>
<para>
Na pocz±tek upewniamy siê, ¿e mamy zainstalowane nag³ówki do u¿ywanego przez
nas j±dra, pakiet <emphasis>libsdl-dev</emphasis> a tak¿e ustawiamy
odpowiednio link <filename>/usr/src/linux</filename>:
<programlisting>
# uname -a
2.6.16-1-686
# apt-get install linux-headers-2.6.16-1-686
# rm -f /usr/src/linux
# ln -s /usr/src/linux-headers-2.6.16-1-686 /usr/src/linux
# apt-get install libsdl-dev
</programlisting>
</para></listitem>

<listitem><para>
Nastêpnie ze strony <ulink url="http://fabrice.bellard.free.fr/qemu/download.html">fabrice.bellard.free.fr/qemu/download.html</ulink> 
¶ci±gamy ¼ród³a Qemu i Kqemu, przyk³adowo:
<programlisting>
# wget http://fabrice.bellard.free.fr/qemu/qemu-0.8.0.tar.gz
# wget http://fabrice.bellard.free.fr/qemu/kqemu-0.7.2.tar.gz
</programlisting>
Rozpakowujemy je (kqemu wewn±trz katalogu qemu):
<programlisting>
# tar xzf qemu-0.8.0.tar.gz
# cd qemu-0.8.0
# tar xzf ../kqemu-0.7.2.tar.gz
# cd ..
</programlisting>
</para></listitem>

<listitem><para>
Kolejny problem dotyczy wersji kompilatora - qemu, przynajmniej w wersji 0.8
wymaga kompilatora gcc z serii 3.X, tymczasem w Debian unstable mamy obecn±
wersjê 4.X. Przy próbie konfiguracji zobaczymy: 
<programlisting>
# ./configure
ERROR: "gcc" looks like gcc 4.x
...
</programlisting>
Musimy wiêc zainstalowaæ starszy kompilator:
<programlisting>
# apt-get install gcc-3.4
</programlisting>
a nastêpnie skonfigurowaæ qemu z odpowiednimi opcjami:
<programlisting>
# ./configure --cc=/usr/bin/gcc-3.4 --target-list=i386-softmmu --enable-adlib \
	--enable-alsa
</programlisting>
Przyk³adowe opcje w³±czaj± obs³ugê d¼wiêku oraz wybieraj± do kompilacji tylko
emulator PC. Przeprowadzamy kompilacjê i instalacjê (to ostatnie jako root):
<programlisting>
# make
# make install
</programlisting>
Qemu zosta³o zainstalowane w katalogu <filename>/usr/local/bin</filename>.
</para></listitem>

<listitem><para>
Nastêpnie mo¿emy spróbowaæ za³adowaæ modu³ <emphasis>kqemu</emphasis>,
wykonuj±c (jako root):
<programlisting>
# modprobe kqemu
</programlisting>
Je¿eli pojawi siê informacja <emphasis>Invalid Module Format</emphasis>, to
oznacza, ¿e j±dro zosta³o skompilowane innym kompilatorem ni¿ u¿yli¶my do
kompilacji Kqemu. Wersjê gcc u¿yt± do kompilacji j±dra mo¿emy sprawdziæ:
<programlisting>
# cat /proc/version
Linux version 2.6.16-1-686 (Debian 2.6.16-2) (tbm@cyrius.com) (gcc version
4.0.3 (Debian 4.0.3-1)) #1 Wed Mar 22 15:36:02 UTC 2006
</programlisting>
Przyk³adowy wynik oznacza, ¿e Kqemu tak¿e musimy skompilowaæ za pomoc± gcc
4.X. Na szczê¶cie mo¿emy to zrobiæ niezale¿nie od kompilacji pozosta³ej czê¶ci
Qemu, a nastêpnie skopiowaæ modu³ rêcznie do odpowiedniego katalogu.
Wywo³ujemy wiêc w katalogu ze ¼ród³ami Qemu:
<programlisting>
# make -C kqemu clean
# ./configure --target-list=i386-softmmu --disable-gcc-check
# make -C kqemu
# cp kqemu/kqemu.ko /lib/modules/2.6.16-1-686/misc
# update-modules
</programlisting>
</para></listitem>

</itemizedlist>

</section> <!-- qemu-source -->

<section id="qemu-usage">
<title>U¿ywanie Qemu</title>

<para>
Strona podrêcznika Qemu (<command>man qemu</command>) zawiera opis wszystkich
opcji programu. Poni¿ej opisanych jest kilka przyk³adów typowego u¿ycia.
</para>

<itemizedlist>

<listitem><para>
Aby w³±czyæ akceleracjê musimy upewniæ siê, ¿e za³adowany jest modu³ kqemu.
£adujemy go komend± <command>modprobe kqemu</command> lub, je¶li korzystamy
z udev'a, komend± <command>modprobe kqemu major=0</command>.
</para></listitem>

<listitem><para>
Pierwsz± rzecz± jak± bêdziemy musieli zwykle zrobiæ to utworzyæ obraz dysku,
na którym bêdziemy mogli np. zainstalowaæ system. Robimy to poleceniem:
<programlisting>
# qemu-img create test.img 2G
</programlisting>
Przyk³adowe polecenie tworzy obraz o rozmiarze 2 GB w pliku
<filename>test.img</filename>. Mo¿emy teraz uruchomiæ Qemu korzystaj±c z
naszego obrazu:
<programlisting>
# qemu -hda test.img -m 192
</programlisting>
Opcja <emphasis>-m</emphasis> ustala wielko¶æ pamiêci w MB, domy¶lnie 128
(nale¿y pamiêtaæ, ¿e Qemu mo¿e zajmowaæ tyle fizycznej pamiêci w naszym
systemie...). Zgodnie z przewidywaniem zobaczymy komunikaty uruchamiaj±cej siê
maszyny wirtualnej z informacj±, ¿e nie mo¿na za³adowaæ systemu z naszego
dysku - co jest prawd±, bo ¿adnego systemu na nim nie ma.
</para></listitem>

<listitem><para>Za pomoc± kombinacji klawiszy <emphasis>Ctrl+Alt+F</emphasis> prze³±czamy
maszynê w tryb pe³noekranowy i z powrotem na okienko, <emphasis>Ctrl+Alt</emphasis> zwalnia myszkê
z maszyny, <emphasis>Ctrl+Alt+1</emphasis> prze³±cza na g³ówny ekran Qemu, <emphasis>Ctrl+Alt+2</emphasis> na konsolê
monitoruj±c±. W konsoli monitoruj±cej mo¿emy miêdzy innymi obejrzeæ spis
dostêpnych poleceñ (<command>help</command>), sprawdziæ czy dzia³a kqemu
(<command>info kqemu</command>) a tak¿e zapisaæ lub za³adowaæ stan ca³ej
maszyny wirtualnej (<command>savevm</command>/<command>loadvm</command>).
</para></listitem>

<listitem><para>
Aby na naszym utworzonym obrazie dysku zainstalowaæ system Windows, musimy
w³o¿yæ do napêdu CD p³ytê instalacyjn± Windows (zalecane ze wzglêdu na
prêdko¶æ dzia³ania s± wersje 98 lub 2000) i kazaæ Qemu za³adowaæ system z CD:
<programlisting>
# qemu -hda test.img -cdrom /dev/cdrom -boot d
</programlisting>
Przy instalacji Windows 2000 zalecane jest tak¿e dodanie opcji
<emphasis>-win2k-hack</emphasis> - ale tylko przy instalacji, gdy¿ powoduje
ona spowolnienie dysku.
<note><para>
Uwaga - je¶li licencja Windows nie mówi inaczej, to nie mo¿na instalowaæ ani
uruchamiaæ wiêcej ni¿ jednej kopii Windows maj±c jedn± licencjê.
</para></note>
</para></listitem>

<listitem><para>
Teoretycznie mo¿liwe jest (choæ mo¿e nie zadzia³aæ) za³adowanie Windows
zainstalowanego na dysku, przez wykonanie komendy (jako root):
<programlisting>
# qemu -hda /dev/hda
</programlisting>
Jest jednak du¿a szansa, ¿e Windows siê nie uruchomi (ze wzglêdu na inny
sprzêt) - wiêcej informacji na ten temat mo¿na znale¼æ na 
<ulink url="http://kidsquid.com/cgi-bin/moin.cgi/FrequentlyAskedQuestions">stronie wspomnianego FAQ</ulink>. Nale¿y tak¿e zwróciæ uwagê, ¿eby pod ¿adnym
pozorem nie modyfikowaæ dysku u¿ywanego przez Windows spod Linuksa.
</para></listitem>

<listitem><para>
Ostatni przyk³ad pokazuje, jak uruchomiæ system z obrazu dystrybucji Live
takiej, jak np. Knoppix:
<programlisting>
# qemu -cdrom knoppix.iso -boot d
</programlisting>
</para></listitem>

</itemizedlist>
</section> <!-- qemu-usage -->

</section> <!-- qemu -->

<section id="ntfs-3g">
<title>NTFS-3g</title>
<para>
<emphasis>NTFS</emphasis> jest systemem plików opracowanym przez firmê
Microsoft, u¿ywanym w systemach Windows 2000 i XP. J±dro Linuksa pozwala
na korzystanie z niego w ograniczonym zakresie. Mo¿liwy jest odczyt
ale zapis jest niebezpieczny i mo¿e prowadziæ do uszkodzenia danych.
Pe³ny dostêp do partycji NTFS oferuje modu³ <emphasis>ntfs-3g</emphasis>
korzystaj±cy z podsystemu Filesystem in User Space (FUSE).
Modu³ jest jeszcze w fazie BETA co oznacza, ¿e istnieje ryzyko utraty
danych. Jednak na li¶cie dyskusyjnej projektu nie odnotowano informacji
o powa¿nych problemach. Poni¿ej przedstawiony zostanie opis instalacji
i korzystania z tego modu³u w systemie Debian.
</para>

<section id="ntfs-3g-install">
<title>Instalacja</title>
<para>
<emphasis>ntfs-3g</emphasis> wymaga modu³u FUSE. Jest on obecny w j±drze
od wersji 2.6.14. Dla starszych j±der konieczne jest zainstalowanie pakietu
<filename>fuse-source</filename> i skompilowanie modu³u przy pomocy 
<filename>module-assistant</filename>.
</para>
<para>
Nie zale¿nie od wersji j±dra nale¿y zainstalowaæ pakiet <filename>fuse-utils</filename>
oraz <filename>libfuse-dev</filename>. Pierwszy z nich zawiera on narzêdzia niezbêdne
do korzystania z <emphasis>ntfs-3g</emphasis>, drugi wymagany jest do kompilacji.
</para>
<para>
¬ród³a modu³u <emphasis>ntfs-3g</emphasis> nale¿y pobraæ ze strony
<ulink url="http://mlf.linux.rulez.org/mlf/ezaz/ntfs-3g-download.html">
http://mlf.linux.rulez.org/mlf/ezaz/ntfs-3g-download.html</ulink>
Nastêpnie nale¿y je rozpakowaæ i skompilowaæ:
<programlisting>
tar xzf ntfs-3g-XXXXXX-BETA.tgz
cd ntfs-3g-XXXXXX-BETA
./configure
make
</programlisting>
Kolejnym krokiem jest instalacja, aby j± wykonaæ nale¿y mieæ uprawnienia roota.
<programlisting>
make install
</programlisting>
Je¶li podczas instalacji nie wyst±pi³y ¿adne b³êdy mo¿na korzystaæ z partycji NTFS.
</para>
</section><!-- ntfs-3g-install -->

<section id="ntfs-3g-usage">
<title>U¿ywanie</title>
<para>
Przed prób± u¿ycia ntfs-3g nale¿y sprawdziæ czy partycje NTFS nie s± ju¿ zamontowane.
Listê zamontowanych systemów plików otrzymuje siê wydaj±c polecenie: <filename>mount</filename>.
Je¿eli w otrzymanej li¶cie znajduje siê wiersz z <emphasis>type ntfs</emphasis>
nale¿y wykonaæ polecenie:
<programlisting>
umount /nazwa/katalogu
</programlisting>
W miejsce <emphasis>/nazwa/katalogu</emphasis> nale¿y wstawiæ nazwê katalogu,
do którego zamontowana jest partycja ntfs. Znajduje siê ona miêdzy s³owami <emphasis>on</emphasis>
i <emphasis>type</emphasis> na listingu wy¶wietlonym przez <filename>mount</filename>.
Po wydaniu komendy mo¿e pojawiæ siê komunikat:
<programlisting>
umount: /home: device is busy
</programlisting>
Oznacza on, ¿e jaki¶ program wykorzystuje pliki z zamontowanej partycji.
Nale¿y sprawdziæ uruchomione programy i zamkn±æ te, które korzystaj±
z danej partycji. Nastêpnie ponownie wykonaæ komendê <filename>umount</filename>.
Gdy partycja zostanie odmontowana, mo¿na przyst±piæ do zamontowania jej przy u¿yciu
<emphasis>ntfs-3g</emphasis>.
</para>
<para>
W celu zamontowania partycji nale¿y wydaæ komendê:
<programlisting>
ntfs-3g /dev/hdXX /mnt/YYY
</programlisting>
gdzie w miejsce XX wpisujemy nazwê partycji, a w YYY nazwê katalogu, w którym
bêdzie ona zamontowana. Nazwê partycji i katalog mo¿na znale¼æ na uzyskanej
wcze¶niej li¶cie z komendy <filename>mount</filename>.
</para>
</section><!-- ntfs-3g-usage -->

</section> <!-- ntfs-3g -->

<section id="dosemu">
<title>Konfiguracja i u¿ytkowanie ¶rodowiska DOSEMU w systemie GNU Debian</title>
<para>
	Aby zainstalowaæ <emphasis>dosemu</emphasis> nale¿y wydaæ komendê:
<programlisting>
# apt-get install dosemu
</programlisting>
W przypadku, gdy <emphasis>dosemu</emphasis> bêdzie u¿ywane w ¶rodowisku <emphasis>X11</emphasis> dobrze jest zainstalowaæ dodatkowe czcionki:
<programlisting>
# apt-get install xfonts-dosemu
</programlisting>
jednak zalecane jest ¶ci±gniêcie plików binarnych lub ¼ród³owych <emphasis>dosemu</emphasis> ze strony <ulink url="http://dosemu.sourceforge.net/stable/">projektu dosemu</ulink> z uwagi na szybsze i bardziej stabilne dzia³anie programu.
</para>
<para>
	Poniewa¿ samo <emphasis>dosemu</emphasis> jest jedynie emulatorem komputera zoptymalizowanego pod k±tem uruchamiania systemu operacyjnego <emphasis>DOS</emphasis>. Aby mo¿na by³o korzystaæ z <emphasis>DOS</emphasis> konieczne jest jego zainstalowanie. Mo¿na to zrobiæ na dwa sposoby:
<itemizedlist>	
<listitem><para>
Zainstalowaæ <emphasis>freedos</emphasis>. W przypadku gdy <emphasis>dosemu</emphasis> by³ instalowany jako gotowy pakiet nale¿y wydaæ komendê:
<programlisting>
# apt-get install dosemu-freedos
</programlisting>
Gdy <emphasis>dosemu</emphasis> by³ instalowany rêcznie z plików binarnych lub ¼ród³owych nale¿y ¶ci±gn±æ <emphasis>freedos</emphasis> do odpowiedniej jego wersji.
</para></listitem>

<listitem><para>
		Zainstalowaæ dowolny system operacyjny <emphasis>DOS</emphasis> na obrazie dysku. Ten sposób jest analogiczny jak w przypadku systemów Red Hat i zosta³ opisany <link linkend="system-linux">tutaj</link>, dlatego te¿ nie bêdzie dalej opisywany w tym rozdziale.
</para></listitem>
</itemizedlist>
</para>

<section id="dosemu-freedos-config">
<title>Konfiguracja systemu freedos pracuj±cego pod kontrol± dosemu</title>
<para>
	W niniejszym rozdziale zostanie opisana konfiguracja jedynie najwa¿niejszych i najczê¶ciej u¿ywanych rzeczy:
<itemizedlist>	
<listitem><para>
konfiguracja <emphasis>autoexec.bat</emphasis> i mapowanie dysków. Plik autoexec.bat znajduje siê w katalogu:
<programlisting>
/etc/freedos/autoexec.bat
</programlisting>
Standardowo po zainstalowaniu <emphasis>freedos</emphasis> s± podmapowane dyski:
<itemizedlist>
<listitem><para>
<emphasis>C:</emphasis> - tylko do odczytu, jest to najczê¶ciej katalog <emphasis>/usr/lib/freedos</emphasis>
</para></listitem>
<listitem><para>
<emphasis>D:</emphasis> - do odczytu i zapisu, jest to najczê¶ciej katalog u¿ytkownika
</para></listitem>
<listitem><para>
<emphasis>E:</emphasis> - do odczytu i zapisu, jest to najczê¶ciej katalog tymczasowy wygenerowany automatycznie przez <emphasis>dosemu</emphasis> jako podkatalog <emphasis>/tmp/</emphasis>
</para></listitem>
</itemizedlist>
Istnieje te¿ mo¿liwo¶æ podmapowania dowolnego katalogu na dowoln± (woln±) literê dysku. W tym celu w <emphasis>freedos</emphasis> nale¿y wydaæ polecenie:
<programlisting>
lredir LITERA: linux\fs/KATALOG
</programlisting>
</para></listitem>

<listitem><para>
Wykorzystywanie portów szeregowych w <emphasis>dosemu</emphasis>. W celu umo¿liwienia dostêpu programom uruchamianym przez <emphasis>dosemu</emphasis> nale¿y wyedytowaæ plik:
<programlisting>
/etc/dosemu/dosemu.conf
</programlisting>
i odnale¼æ sekcjê <emphasis>Serial port settings</emphasis>. Aby zmapowaæ wbudowany port szeregowy <emphasis>/dev/ttyS0</emphasis> na urz±dzenie widziane w <emphasis>dos</emphasis> jako <emphasis>COM1</emphasis> nale¿y wpisaæ lub odkomentowaæ:
<programlisting>
$_com1 = "/dev/ttyS0 irq 4"
</programlisting>
Aby zmapowaæ port szeregowy <emphasis>/dev/ttyUSB0</emphasis> z przej¶ciówki <emphasis>USBRS-232</emphasis> na <emphasis>COM1</emphasis> nale¿y wpisaæ:
<programlisting>
$_com1 = "/dev/ttyS0 irq 4"
</programlisting>
</para></listitem>
</itemizedlist>
</para>
</section><!-- dosemu-freedos-config -->

<section id="versman-quickstart">
<title>Instalacja i konfiguracja programu Versman</title>
<para>
	<emphasis>Versman</emphasis> to nak³adka na kompilator <emphasis>Keil</emphasis> oraz narzêdzie do zarz±dzania logami programów technologicznych sterowników <emphasis>ZET</emphasis> zawartych w drzewie <emphasis>CVS programy</emphasis>. Szczegó³ow± dokumentacjê programu znale¼æ w pliku:
<programlisting>
<emphasis>CVS programy</emphasis>/utils/versman/versmanwin.html
</programlisting>
Program <emphasis>Versman</emphasis> mo¿na znale¼æ w katalogu:
<programlisting>
<emphasis>CVS programy</emphasis>/utils
</programlisting>
Do poprawnej pracy programu <emphasis>Versman</emphasis> konieczne bêd± jeszcze nastêpuj±ce programy:
<itemizedlist>
<listitem><para>
<emphasis>Keil 3.20</emphasis> (katalog <emphasis>C51PDK</emphasis>).
</para></listitem>
<listitem><para>
<emphasis>Perl dla DOS</emphasis> (katalog <emphasis>PERL</emphasis>).
</para></listitem>
</itemizedlist>
Powy¿sze dwa programy mo¿na znale¼æ w katalogu:
<programlisting>
<emphasis>CVS programy</emphasis>/utils
</programlisting>
</para>
<para>
	Aby zainstalowaæ program <emphasis>Versman</emphasis> nale¿y: 
<itemizedlist>	
<listitem><para>
Skopiowaæ z <emphasis>CVS programy</emphasis> katalogi <emphasis>Versman</emphasis>, <emphasis>C51PDK</emphasis>, <emphasis>PERL</emphasis> do katalogu g³ównego u¿ytkownika
</para></listitem>
<listitem><para>
Na koñcu pliku <emphasis>autoexec.bat</emphasis> dodaæ linie:
<programlisting>
PATH %PATH%;X:\PERL;X:\VERSMAN;X:\C51PDK\bin
SET TEMP=Y:\TEMP
set C51LIB=X:\C51PDK\LIB
set C51INC=X:\C51PDK\INC
SET USER=Z
SET WORKPATH=X:\PROGRAMY
SET EPROMPATH=X:\PROGRAMY\EPROM
SET perllib=X:\PERL\LIB

</programlisting>
gdzie:
<itemizedlist>
<listitem><para>
litera <emphasis>X</emphasis> oznacza literê dysku, która jest podmapowana do katalogu u¿ytkownika (W przypadku standardowej konfiguracji <emphasis>freedos</emphasis> jest to litera <emphasis>D</emphasis>). 
</para></listitem>
<listitem><para>
litera <emphasis>Y</emphasis> oznacza literê dysku na którym mo¿na przechowywaæ pliki tymczasowe (W przypadku standardowej konfiguracji <emphasis>freedos</emphasis> jest to litera <emphasis>E</emphasis>).  
</para></listitem>
<listitem><para>
litera <emphasis>Z</emphasis> oznacza numer programisty. W przypadku nowego pracownika numer powinien byæ skonsultowany z innymi programistami, w celu wybrania w³a¶ciwego/wolnego numeru.  
</para></listitem>
</itemizedlist>
Zmienne ¶rodowiskowe <emphasis>WORKPATH</emphasis> i <emphasis>EPROMPATH</emphasis> wskazuj± na ¶cie¿kê do repozytorium <emphasis>CVS programy</emphasis>
<listitem><para>
Odnale¼æ w pliku X:\versman\versman.cfg (gdzie X: litera podmapowanego dysku u¿ytkownika) sekcje i ewentualnie zmodyfikowaæ literê dysku:
<programlisting>
KEILLIB:
	X:\c51pdk\lib
</programlisting>

</para></listitem>

<listitem><para>
Odnale¼æ w pliku X:\versman\versman.pl (gdzie X: litera podmapowanego dysku u¿ytkownika) sekcje i ewentualnie zmodyfikowaæ literê dysku:
<programlisting>
$cfg       = "X:\\Versman\\versman.cfg"; # nazwa pliku konfiguracyjnego VersMana
</programlisting>
</para></listitem>
</itemizedlist>
Po wykonaniu powy¿szych czynno¶ci mo¿na ju¿ u¿ywaæ programu <emphasis>Versman</emphasis>.
</para>
</section><!-- versman-quickstart -->
</section><!-- dosemu -->
</chapter> <!-- system-linux -->

<chapter id="windows-terminal">
<title>Terminal z MS Windows</title>

<para>
Przewa¿nie na terminalu instalowane s± Win9x/2000/XP. Robi siê to przede wszystkim
po to, ¿eby umo¿liwiæ u¿ytkownikom
korzystanie ze znanych im programów (np. aplikacji pakietu MS Office itp.).
</para>
<para>
W trakcie instalacji systemu Windows nale¿y zainstalowaæ protokó³/protoko³y TCP/IP 
i powi±zaæ je z kart± sieciow± (w Windows 2000/XP s± one instalowane standardowo).
Numer IP terminala musi siê ró¿niæ od numeru IP serwera tylko ostatni± liczb±
- w przeciwnym razie ³±cz±ca je sieæ bêdzie musia³a byæ kategorii wy¿szej ni¿ C,
co jest k³opotliwe i zbêdne. Najlepiej te¿ wyrzuciæ kartê Dialup.
</para>
<para>
Je¿eli instalowane jest Windows 98 SE, to ustawiany jest domy¶lnie polski
uk³ad klawiatury (byæ mo¿e ta niedogodno¶æ wystêpuje
równie¿ w innych wersjach Windows). Korzystanie ze zwyk³ych (nie-polskich) 
klawiatur jest wtedy bardzo uci±¿liwe (zamiast dwukropka, ¶rednika i innych 
znaków mamy polskie literki). Dlatego zaraz po zainstalowaniu nale¿y 
ten uk³ad zmieniæ.
W tym celu nale¿y otworzyæ folder <command>Mój Komputer</>, w nim folder 
<command>Panel Sterowania</>,
tam odszukaæ ikonê o nazwie <command>Klawiatura</> i uruchomiæ. Pojawi siê okienko
o nazwie <quote>W³a¶ciwo¶ci: Klawiatura</quote>. W nim uaktywniamy 
zak³adkê <command>Jêzyk</>, a tam w okienku <quote>Zainstalowane Jêzyki i Uk³ady 
Klawiatury</quote>
odszukujemy jêzyk polski / uk³ad polski i klikamy na przycisk <command>W³a¶ciwo¶ci</>. 
Zmieniamy uk³ad z <quote>polskiego</quote> na 
<quote>polski (programisty)</quote>. Dodatkowo nale¿y w pliku 
<filename>C:\autoexec.bat</filename> zmodyfikowaæ wywo³anie:
<programlisting>
keyb pl,,C:\WINDOWS\COMMAND\keybrd2.sys
</programlisting>
na
<programlisting>
keyb pl,,C:\WINDOWS\COMMAND\keybrd4.sys
</programlisting>
Po reboocie wszystko powinno dzia³aæ normalnie.
</para> 

<section id="cygwin">
<title>Instalacja, konfiguracja i u¿ywanie pakietu Cygwin</title>
<para>
Cygwin jest to, zgodnie z zamys³em twórców, 
¶rodowisko umo¿liwiaj±ce dzia³anie 
pod systemem Windows tych aplikacji, które zosta³y stworzone z my¶l± o systemie Unix. 
Pakiet Cygwin jest zwykle instalowany w nastêpuj±cych przypadkach:
<itemizedlist>
<listitem><para>
gdy chcemy skorzystaæ z (darmowego) X-serwera Cygwin/Xorg,
</para></listitem>
<listitem><para>
gdy chcemy u¿yæ narzêdzi typu <command>rsync</command> oraz 
<command>ssh</command> i <command>sshd</command> pod systemem Windows.
</para></listitem>
</itemizedlist>
¦rodowisko Cygwin sk³ada siê z: 
<itemizedlist>
<listitem><para>biblioteki procedur (<filename>cygwin.dll</filename>), 
zamieniaj±cej wywo³ania funkcji uniksowych na wywo³ania systemu Windows,
</para></listitem>
<listitem><para>
zestawu programów skompilowanych tak, ¿eby z tej biblioteki
korzysta³y.
</para></listitem>
</itemizedlist>
W ten sposób u¿ytkownik systemu Windows mo¿e mieæ standardowo dostêp do wielu 
podstawowych narzêdzi uniksowych takich jak:
<command>bash</command>, 
<command>awk</command>, 
<command>grep</command>, 
<command>less</command>, 
<command>tail</command>, 
<command>head</command>, 
<command>iconv</command>, 
<command>cat</command>
oraz bardziej z³o¿onych programów takich jak:
<command>apache</command>, 
<command>ssh</command>, 
<command>rsync</command>
oraz 
<command>Xorg</command>. 
Bardzo wa¿nym elementem systemu Cygwin jest aktualnie X-serwer 
(z pakietu <command>Xorg</command>). Pozwala on na ³±czenie siê
z systemem Unix/Linux i zdaln± pracê na maszynach uniksowych/linuksowych.
</para>

<section id="cygwin-install"><title>Instalacja</title>

<para>
Mo¿liwe s± 2 sposoby instalacji ¶rodowiska Cygwin:
<itemizedlist>
<listitem><para>Z sieci, ze strony
<ulink url="http://www.cygwin.com">http://www.cygwin.com</ulink>.
</para></listitem>
<listitem><para>
Z no¶nika dostêpnego lokalnie, np. p³yty albo twardego dysku.
</para></listitem>
</itemizedlist>
Poniewa¿ system rozwija siê bardzo dynamicznie (najnowsze
wersje s± najpe³niejsze i najstabilniejsze), wiêc 
przed instalacj± z no¶nika lokalnego nale¿y zwróciæ uwagê na to, 
¿eby wersja instalacyjna by³a mo¿liwie najnowsza.
Problemu tego nie ma podczas instalacji sieciowej 
(gdy¿ u¿ywane s± tu bie¿±ce wersje pakietów). 
</para>
<itemizedlist>
<listitem><para>
Zalecan± metod± jest instalacja 
<emphasis>tylko wybranych pakietów</emphasis>. Wybór pakietów mo¿na przeprowadziæ 
podczas instalacji z sieci, mo¿na równie¿ stworzyæ w³asn± dystrybucjê systemu Cygwin
z tylko tymi pakietami, które s± najwa¿niejsze (sposób jak zrobiæ w³asn± dystrybucjê
Cygwina i propozycja wyboru pakietów znajduje siê <link linkend="customized-cygwin">tutaj</link>).
</para></listitem>
<listitem><para>Mo¿na równie¿ ¶ci±gn±æ gotow± dystrybucjê w formie obrazu ISO i zainstalowaæ 
j± ca³± b±d¼ jej fragment.
W Internecie dostêpnych jest wiele dystrybucji
(np. na <ulink url="http://inst.eecs.berkeley.edu/~instcd/iso/">http://inst.eecs.berkeley.edu/~instcd/iso/</ulink>) s± obrazy, które mo¿na bezpo¶rednio wypaliæ na p³ycie.
</para></listitem>
<listitem><para>
Cygwina w wersji instalacyjnej mo¿na równie¿ znale¼æ na wielu serwerach, w tym - polskich, np. na 
<ulink url="ftp://sunsite.icm.edu.pl/pub/cygwin/"
>ftp://sunsite.icm.edu.pl/pub/cygwin/</ulink>.
</para></listitem>
</itemizedlist>

<para>
W celu instalacji, czy to sieciowej czy lokalnej, uruchamiamy program program 
<command>setup.exe</command> (który znajduje siê zarówno w sieci, pod adresem 
<ulink url="http://www.cygwin.com/setup.exe">http://www.cygwin.com/setup.exe</ulink>,
jak i na ka¿dej wersji instalacyjnej z p³yt). Program <command>setup.exe</command>,
oprócz rozpakowywania i kopiowania pakietów, przygotowuje dla u¿ytkownika ca³e 
¶rodowisko dla Cygwina.
Po uruchomieniu <command>setup.exe</command> nale¿y postêpowaæ zgodnie 
z instrukcjami. Poni¿ej przedstawiamy ogólny opis postêpowania:
</para>
<itemizedlist>
<listitem><para> 
W oknie "Cygwin Setup - Choose Instalation Type" 
wybieramy opcjê "Install from Local Directory" (oczywi¶cie je¶li
instalujemy z p³ytki lub dysku twardego). W nastêpnym oknie, o nazwie 
"Cygwin Setup - Choose Installation Directory", zostawiamy domy¶lne
opcje "Install For All Users" oraz "Default Text File Type: Unix" a 
nastêpnie naciskamy przycisk "Dalej". W oknie "Cygwin Setup -
Select Local Package Directory" wybieramy katalog instalacyjny Cygwin
(zwykle odpowiedni katalog jest automatycznie wybierany) i naciskamy "Dalej".
</para></listitem>
<listitem><para>
Domy¶lnie w oknie "Cygwin Setup - Select Packages" instalowana jest podstawowa,
niewielka dystrybucja Cygwina 
(<command>bash</command> oraz kilka podstawowych programów i bibliotek), 
która zajmuje na dysku ok. 30 MB. 
</para></listitem>
<listitem><para>
¯eby móc korzystaæ z mo¿liwo¶ci opisanych poni¿ej, trzeba zainstalowaæ programy:
<command>rsync</command>, 
<command>openssh</command> a tak¿e 
<command>Xorg</command>.
</para></listitem>
<listitem><para>
Dodatkowo mog± siê przydaæ pakiety: 
<command>iconv</command>, 
<command>perl</command> (jest to stosunkowo du¿y pakiet),  
<command>tcl</command> no i oczywi¶cie 
<command>vim</command> 
(lista pakietów zalecanych do zainstalowania jest <link linkend="cygwin-minimal-packets">tutaj</link>).
</para></listitem>
<listitem><para>
Opcjê zainstalowania lub niezainstalowania pakietu 
(lub grupy pakietów) wybiera siê klikaj±c myszk± obok nazwy pakietu, 
przy "pêtelce" (uwaga - czasem prze³±czenie opcji trwa kilka chwil).
Mamy tu mo¿liwo¶ci: <quote>Default</quote> (domy¶lnie),
<quote>Install</quote> (zainstaluj),
<quote>Reinstall</quote> (przeinstaluj) oraz
<quote>Uninstall</quote> (odinstaluj).
</para></listitem>
<listitem><para>
Uwaga! W szczególno¶ci mo¿emy wybraæ opcjê <quote>Install</quote> dla ca³ego
drzewa pakietów (<quote>All</quote>), ¿eby zainstalowaæ wszystkie pakiety
(co jest dosyæ wygodne), np. je¿eli instalacja przebiega 
z przygotowanej wcze¶niej dystrybucji jak to opisuje 
<xref linkend="customized-cygwin">. Gdy instalujemy system z sieci, instalacja mo¿e
potrwaæ w tym przypadku dosyæ d³ugo i zajmie ponad 1GB miejsca na dysku.
</para></listitem>
<listitem><para>
 Tak zainstalowany pakiet Cygwin zajmuje, zale¿nie
od u¿ytej dystrybucji, od ok. 300 MB do ok. 1 GB (stan na maj 2003). 
W oknie "Cygwin Setup - Create Icons" nale¿y zacisn±æ "Zakoñcz" przy 
zaznaczonych opcjach "Create Icon on Desktop", "Add Icon to Start Menu".
W pe³nej wersji dostaniemy tu wszystkie narzêdzia developerskie,
kompilatory, debuggera i ca³± masê innych mniej lub bardziej przydatnych pakietów.
</para></listitem>
<listitem><para>
Uwaga! Podczas instalacji sieciowej mo¿na wybraæ jeden z wielu serwerów 
lustrzanych (czyli tzw. <emphasis>mirrorów</emphasis>).
Czasami instalacja jest przerywana np. komunikatem 
<quote>Download Incomplete</quote>.
Nale¿y wówczas spróbowaæ innego serwera.
</para></listitem>
<listitem><para>
Po zainstalowaniu nale¿y sprawdziæ system, poprzez uruchomienie konsoli tekstowej, 
która znajduje siê w menu <quote>Start/Cygwin/Cygwin Bash Shell</quote> 
(je¿eli w czasie instalacji wybierzemy, ¿e chcemy, ¿eby skrót do konsoli tekstowej 
pojawi³ siê na pulpicie, bêdziemy mogli uruchamiaæ ¶rodowisko Cygwin równie¿ dwoma klikniêciami
na ikonkê na pulpicie).
Je¿eli wszystko dzia³a (konsola siê uruchamia), to 
warto zdefiniowaæ w Windowsie zmienn± ¶rodowiskow± CYGWIN 
o warto¶ci <quote>ntsec tty</quote> (w Windows XP robimy to wchodz±c do 
Start/Panel Sterowania/System, nastêpnie wybieraj±c zak³adkê 
Zaawansowane wybieraj±c przycisk Zmienne ¦rodowiskowe 
i klikaj±c <quote>Nowa</quote> przy polu Zmienne Systemowe).
W oknie zmiennych ¶rodowiskowych warto równie¿ do zmiennej PATH dodaæ ¶cie¿kê 
dostêpu do programów wykonywalnych Cygwina (zwykle jest to <filename>C:\CYGWIN\BIN</filename>).
Pozwoli nam to korzystaæ z programów Cygwina nie tylko wywo³uj±c komendy z poziomu basha,
lecz równie¿ uruchamiaj±c je z poziomu skryptów .bat.
</para></listitem>
</itemizedlist>
<para>
Instalacjê i konfiguracjê systemu X Window opartego na Cygwinie opisuje sekcja 
<xref linkend="cygwin-xorg">.

</para>
</section> <!-- instalacja -->
<section><title>U¿ytkowanie</title>
<para>
¦rodowisko Cygwin uruchamia siê zwykle w sposób interaktywny (klikaj±c
na ikonê, która <emphasis>de facto</emphasis> uruchamia pow³okê 
<command>bash</command>). Uruchomi siê konsola, w której mo¿na wydawaæ komendy, 
podobnie jak w terminalu linuksowym. Mo¿na uruchamiaæ wiele
konsol systemu Cygwin równocze¶nie.

Procesy systemu Cygwin (takie jak <command>apache</command>,
<command>inetd</command> czy <command>sshd</command>) mog± 
jednak równie¿ dzia³aæ
w tle, jako us³ugi.
</para>
<para>
Trzeci± mo¿liwo¶ci± jest wywo³ywanie skryptów batchowych (bez potrzeby
uruchamiania pow³oki), które wywo³uj± komendy systemu Cygwin.
W tym celu nale¿y stworzyæ Windowsowy plik .bat o zawarto¶ci
(zak³adamy, ¿e Cygwin zainstalowany jest w katalogu 
<filename>C:\CYGWIN</filename>):
<programlisting>
<![CDATA[
cd C:\
cd CYGWIN\BIN

bash --login -c "<komenda do wywo³ania>"
]]>
</programlisting>
</para>
<para>
Kilku s³ów komentarza wymaga sposób dostêpu do zasobów dyskowych spod 
Cygwina. Otó¿ programy cygwinowe widz± system plików w sposób uniksowy:
rootem <filename>/</filename> jest tu katalog 
<filename>c:\cygwin</filename>. Wszystkie dyski DOS-owe / Windowsowe
s± udostêpnione jako <filename>/cygdrive/&lt;nazwa dysku&gt;/</filename>, 
np. dysk <filename>c:\</filename> jest udostêpniony jako 
<filename>/cygdrive/c</filename>, dysk <filename>d:\</filename>
jako <filename>/cygdrive/d</filename> itd. 
W ten sposób mamy dostêp do zasobów Cygwina na dwa sposoby:
<filename>/</filename> oraz <filename>/cygdrive/c/cygwin/</filename>.
</para>

<para>
W systemie Cygwin konta u¿ytkowników nie s± tym samym czym w Linuksie.
Obecne s± wprawdzie pliki <filename>/etc/passwd</filename> 
i <filename>/etc/group</filename>, lecz odzwierciedlaj± one jedynie
u¿ytkowników systemu Windows (<quote>g³ówna kopia</quote> danych
znajduje siê w plikach systemowych Windowsów). 
Pliki <filename>/etc/{passwd,group}</filename> powstaj± w trakcie instalacji
systemu Cygwin i nie s± automatycznie poprawiane po dodaniu b±d¼ usuniêciu 
u¿ytkownika. Niezmieniane, odzwierciedlaj± stan na dzieñ 
instalacji systemu Cygwin. ¯eby wygenerowaæ zawarto¶æ pliku 
<filename>/etc/passwd</filename>,
nale¿y wywo³aæ komendê 
<command>mkpasswd</command>.
Komenda <command>mkgroup</command>
wygeneruje z kolei zawarto¶æ pliku 
<filename>/etc/group</filename>. Obie komendy przyjmuj±
nastêpuj±ce parametry: 
<quote>-l</quote> oznacza konta lokalne, 
<quote>-d</quote> - konta domenowe.
Poniewa¿ obie komendy zwracaj± zawarto¶ci plików na standardowe wyj¶cie, 
zwykle wywo³uje siê je w nastêpuj±cy sposób:
<programlisting>
mkpasswd -l >/etc/passwd
mkgroup -l >/etc/group
</programlisting>
Równie¿ zawarto¶æ wygenerowanych plików mo¿e siê wydawaæ <quote>dziwna</quote>.
W polu opisowym znajduje siê ci±g znaków, np.
<filename>S-1-5-21-2130074997-1700076171-1250845650-4684</filename>.
Jest to pe³ny identyfikator u¿ytkownika, grupy, zasobu w systemie Windows.
Jego znaczenie jest wiêc szersze ni¿ uniksowego UID-a.
Funkcjê UID-a w pliku <filename>/etc/passwd</filename> spe³nia w tym przypadku 
ostatni cz³on - tutaj 4684.
</para>

</section> <!-- U¿ytkowanie -->

<section id="cygwin-servers">
<title>Uruchamianie serwerów sshd i crond</title>

<para>
Mo¿liwe jest zainstalowanie pod kontrol± Cygwina (przynajmniej na Windows z
serii NT - a wiêc NT, 2000 i XP) linuksowych demonów, takich jak sshd czy
crond. W tym celu nale¿y:
<itemizedlist>
<listitem><para>
<emphasis>Zainstalowaæ odpowiednie pakiety.</emphasis> 
Uruchamiamy program instalacyjny cygwina (setup.exe) i wybieramy b±d¼
instalacjê z internetu, b±d¼ te¿ z lokalnego no¶nika, na przyk³ad p³ytki.
Klikamy na guzik <command>View</command> i prze³±czamy typ widoku z
<emphasis>Categories</emphasis> na <emphasis>Full</emphasis>. Zaznaczamy do
instalacji pakiet <filename>cygrunsrv</filename> oraz pakiet dla odpowiedniego
demona, np. <filename>OpenSSH</filename> czy
<filename>crond</filename>, dodatkowo tak¿e np. <filename>rsync</filename>.
Instalujemy wybrane pakiety.
</para></listitem>

<listitem><para>
<emphasis>Instalacja sshd</emphasis> jest prosta, sprowadza siê do
uruchomienia skryptu <filename>ssh-host-config</filename> (obecny w ¶cie¿ce,
wymaga uprawnieñ administratora). Na zadawane pytania 
odpowiadamy <emphasis>yes</emphasis>. Na pytanie o zmienne ¶rodowiskowe
(proponowana odpowied¼ <emphasis>ntsec</emphasis>) odpowiadamy <emphasis>ntsec
tty</emphasis>. Upewniamy siê tak¿e, ¿e zmienna systemowa Windows o nazwie
<emphasis>CYGWIN</emphasis> ma w³a¶nie warto¶æ <emphasis>ntsec tty</emphasis>
(zobacz <xref linkend="cygwin-install">).
Aby uruchomiæ serwer, wydajemy komendê:
<programlisting>
cygrunsrv --start sshd
</programlisting>
Od tej chwili sshd powinien byæ uruchamiany automatycznie przy starcie
Windows. Mo¿na go zastopowaæ przez wydanie komendy
<programlisting>
cygrunsrv --stop sshd
</programlisting>
</para></listitem>

<listitem><para>
<emphasis>Instalacja cron'a</emphasis> mo¿e napotkaæ kilka problemów.
Teoretycznie powinna siê sprowadzaæ do wydania nastêpuj±cych komend:
<programlisting>
cygrunsrv -I cron -p /usr/sbin/cron.exe
cygrunsrv --start sshd
</programlisting>
Je¿eli zobaczymy jednak komunikat o b³êdzie, to musimy zrobiæ kilka
dodatkowych rzeczy. Po pierwsze odinstalowujemy us³ugê crond komend±:
<programlisting>
cygrunsrv --top sshd
cygrunsrv -R cron
</programlisting>
Nastêpnie upewniamy siê, ¿e istnieje katalog 
<filename>/etc/cron.d</filename> i ma prawa do zapisu (najlepiej, niestety,
dla wszystkich):
<programlisting>
mkdir /etc/cron.d
chmod +w /etc/cron.d
</programlisting>
Jeszcze tylko jedna drobna rzecz:
<programlisting>
chmod +x /bin/cygwin1.dll
</programlisting>
i mo¿emy ponownie spróbowaæ zainstalowaæ i uruchomiæ us³ugê:
<programlisting>
cygrunsrv -I cron -p /usr/sbin/cron.exe 
cygrunsrv --start sshd
</programlisting> 
Je¿eli nadal pojawiaj± siê b³êdy, to ich przyczyn nale¿y szukaæ w pliku
<filename>/var/log/cron.log</filename>.
</para></listitem>

</itemizedlist>
</para>

<para>
Uruchomione w ten sposób 'demony' nie s± widoczne jako uniksowe procesy. S±
natomiast pe³noprawnymi us³ugami Windows - mo¿na je obejrzeæ przez 
<emphasis>Ustawienia -> Narzêdzia administracyjne -> Us³ugi</emphasis>. Mo¿na
te¿ zmieniaæ sposób ich uruchamiania.
</para>

</section> <!-- cygwin-servers -->

</section>


<section id="customized-cygwin">
<title>Tworzenie w³asnej dystrybucji Cygwina</title>
<para>
Pe³ny system Cygwin zajmuje dzisiaj ju¿ ponad 1GB na dysku. W rozdziale
niniejszym opisany jest sposób stworzenia dystrybucji znacznie mniejszej,
zawieraj±cej narzêdzia:
<command>rsync</command>, 
<command>ssh</command>,
<command>sshd</command> 
oraz
<command>cygwin/Xorg</command>.
Dodatkowo w dystrybucji znajdzie siê kilkadziesi±t przydatnych programów
uniksowych i bibliotek (tzw. baza - <emphasis>Cygwin-base</emphasis>).
<!--
Uwaga! Xorg zainstalowane wg poni¿szego sposobu bêdzie pozbawione 
(dysko¿ernych) czcionek, wiêc w tym przypadku
trzeba skorzystaæ z zewnêtrznego serwera fontów (opcja -fp do programu
<command>XWin.exe</command>).
-->

</para>

<para>
Przygotowanie dystrybucji jest bardzo proste. W kroku pierwszym
nale¿y ¶ci±gn±æ dok³adnie te pakiety, które nas interesuj±
(wypisane <link linkend="cygwin-minimal-packets">poni¿ej</link>).
Wykorzystujemy w tym celu standardowy program <filename>setup.exe</filename>
(<ulink url="http://www.cygwin.com/setup.exe"
>http://www.cygwin.com/setup.exe</ulink>), 
gdzie nale¿y wybraæ opcjê "Download from Internet", wybraæ katalog 
docelowy (w okno "Local Package Directory" wpisaæ/wybraæ nazwê, np. 
<filename>C:\CYGWIN-INSTALL</filename>) i nacisn±æ "Dalej". 
</para>
<para>
Nastêpnie
nale¿y wybraæ optymalny rodzaj po³±czenia (zwykle 
<quote>Use IE 5 Settings</quote>) i ponownie nacisn±æ "Dalej".
W oknie "Available Download Sites" pod¶wietliæ serwer, z którego bêd±
¶ci±gane pakiety (najlepiej z domeny .pl). 
</para>
<para>
Po nastêpnym naci¶niêciu 
"Dalej" nale¿y dokonaæ odpowiedniego 
wyboru pakietów. Po tym uruchomione zostanie ¶ci±ganie pakietów z sieci.
¦ci±gniêty zestaw pakietów umieszczany jest we wskazanym katalogu, 
np. <filename>C:\CYGWIN-INSTALL</filename>, w podkatalogu o przedziwnej 
nazwie rozpoczynaj±cej siê od s³owa 
<quote>ftp</quote>, który ma w nazwie zakodowan± równie¿ nazwê mirrora, 
z którego w³a¶nie ¶ci±gnêli¶my ca³o¶æ (mam nadziejê, ¿e opis
jest wystarczaj±co obrazowy, ¿eby podkatalog odnale¼æ bez trudu).
Wraz w tym podkatalogiem w katalogu <filename>C:\CYGWIN-INSTALL</filename>
musi znale¼æ siê program <filename>setup.exe</filename>, który tak¿e ¶ci±gamy. 
</para>
<para>
Innym sposobem jest ¶ci±gniêcie ca³o¶ci pakietów (lub na przyk³ad 
skorzystanie z istniej±cej dystrybucji ISO i skasowanie tych, 
które s± zbyteczne).
Poszczególne pakiety s± umieszczone w podkatalogach w katalogu
<filename>release</filename> (który sam znajduje siê w katalogu
o przedziwnej nazwie, p. wy¿ej). ¯eby pozbyæ siê danego pakietu
z dystrybucji, nale¿y usun±æ ca³y podkatalog z pakietem (np. apache).
</para>
<para>
Gdy jest przygotowany katalog z pakietami i programem 
<filename>setup.exe</filename>,
mo¿na ju¿ z niego zaczynaæ instalowanie system Cygwin.
Wybieramy tu opcjê "Install from Local Directory".
Katalog, z którego instalujemy, nie wymaga prawa do zapisu,
wiêc mo¿na go wypaliæ na p³ytce i instalowaæ bezpo¶rednio 
z p³yty. 
</para>
<para>
Uwaga! W czasie wybierania pakietów do instalacji w opisanej dystrybucji 
musimy wybraæ opcjê <quote>Install</quote> dla ca³ego drzewa pakietów (sekcji All).
</para>
<para>
<anchor id="cygwin-minimal-packets">
Pakiety do zainstalowania (w stosunku do standardowej wersji <quote>wszystko Default</quote>):

<itemizedlist>
<listitem><para>
W kategorii <command>Admin</command>: dodajemy <command>cygrunsrv</command>.
</para></listitem>

<listitem><para>
W kategorii <command>Net</command> dodajemy: 
<command>openssh</command>,
<command>openssl</command>,
<command>rsync</command>.
</para></listitem>

<listitem><para>
W kategorii <command>Xorg</command> dodajemy:
<command>xorg-x11-base</command>.
Uwaga! Z powodu zale¿no¶ci miêdzy pakietami, automatycznie zostanie dodanych kilka innych pakietów
z rodziny xorg-x11-.
</para></listitem>

</itemizedlist>

Powy¿sza wersja instalacyjna ma oko³o 30MB, 
natomiast system Cygwin po zainstalowaniu zajmie ok. 100MB.

<!--(W kategoriach, których nazwy pominiêto, wybieramy opcjê <quote>Uninstall</quote>)-->

<!--
<itemizedlist>
<listitem><para>
Kategoria Admin: <command>cygrunsrv</command>
</para></listitem>

<listitem><para>
Kategoria Base: <emphasis>wszystko</emphasis>
</para></listitem>

<listitem><para>
Kategoria Devel: <command>gettext</command>
</para></listitem>

<listitem><para>
Kategoria Editors: <emphasis>nic</emphasis>
</para></listitem>

<listitem><para>
Kategoria Graphics: <emphasis>nic</emphasis>
</para></listitem>
<listitem><para>
Kategoria Graphics: <emphasis>nic</emphasis>
</para></listitem>

<listitem><para>
Kategoria Libs: <emphasis>wszystko</emphasis>
</para></listitem>
<listitem><para>
Kategoria Math: <emphasis>nic</emphasis>
</para></listitem>
<listitem><para>
Kategoria Net: 
<command>openssh</command>,
<command>openssl</command>,
<command>openssl096</command>,
<command>rsync</command>
</para></listitem>

<listitem><para>
Kategoria Shells: 
<command>ash</command>,
<command>bash</command>,
<command>sh-utils</command>
</para></listitem>
<listitem><para>
Kategoria Text: <emphasis>nic</emphasis>
</para></listitem>

<listitem><para>
Kategoria Web: <emphasis>nic</emphasis>
</para></listitem>

<listitem><para>
Kategoria XFree86: 
<command>XFree86-base</command>,
<command>XFree86-bin</command>,
<command>XFree86-etc</command>,
<command>XFree86-fenc</command>,
<command>XFree86-lib</command>,
<command>XFree86-startup-scripts</command>,
<command>XFree86-xserv</command>
</para></listitem>

</itemizedlist>
-->

<!--

Niestety, nie wszystkie pakiety domy¶lnie siê instaluj± w Cygwinie.
Jest to zale¿ne od pewnych ustawieñ programu instalacyjnego Cygwina,
których nie mo¿a zmieniæ. Mo¿na za to poprawiæ plik konfiguracyjny 
systemu Cygwin (<filename>setup.ini.</filename>), 
oznaczaj±c wszystkie nasze pakiety jako nale¿±ce do kategorii Base
(bo ca³o¶æ Base jest zawsze instalowana), np. w taki sposób:
<programlisting>
cat setup.ini | sed 's/category:/\0 Base/'
</programlisting>

TODO: Przetestowaæ, ew. poprawiæ
Zastanowic siê czy ten opis powy¿ej ma sens.
-->

</para>
</section>

<section id="x-terminale">
<title>X-terminale w systemie Windows</title>
<para>
Rozdzia³ ten opisuje sposób instalacji i konfiguracji X-serwerów
(WinaXe i Cygwin/Xorg). X-serwer jest to oprogramowanie s³u¿±ce do
wzbogacenia hosta o funkcjonalno¶æ X-terminala (co umo¿liwia zdaln± pracê
w trybie graficznym na systemach linuksowych).
Dodatkowo, w rozdziale omówiono kilka spraw pokrewnych 
(tunelowanie po³±czeñ X-owych).
</para>

<section id="winaxe">
<title>Instalacja XSerwera Labf.com</title>

<para>
Jednym z najlepszych XServerów pod Windows jest WinaXe (dawniej XWin-Pro) fiñskiej firmy Labf.com (dawniej Labtam).
Dystrybucja to jeden plik <filename>winaxe.exe</filename> (<filename>Xwp32.exe</filename>) z programem (ok. 6MB)
+ plik z licencj±
<filename>licence.exe</filename> (ok. 60kB).
</para>

<para>

<itemizedlist>
<listitem>

<para>
W katalogu tymczasowym uruchomiæ <filename>winaxe.exe/Xwp32.exe</filename> - archiwum 
samorozpakowuj±ce siê;
standardowo rozpakowuje siê do katalogu <filename>c:\xinstall</filename> - 
lepiej nie
zmieniaæ.
</para>
</listitem>
<listitem>

<para>
Je¶li jest wykupiona licencja, w oknie WinZip Self-Extractor wy³±czyæ
opcjê <command>When Done Unzipping Run: SETUP.EXE</> i nacisn±æ <command>Unzip</>, po
zakoñczeniu - <command>Close</>; potem skopiowaæ plik <filename>licence.exe</filename> 
do katalogu
instalacji - <filename>c:\xinstall</filename> i uruchomiæ (to jest te¿
samorozpakowuj±ce siê
archiwum) tak, jak <filename>winaxe.exe/Xwp32.exe</filename>.
</para>
</listitem>
<listitem>

<para>
W katalogu <filename>c:\xinstall</filename> uruchomiæ <filename>Setup.exe
</filename>, wersja instalacji <command>Typical</>.
</para>
</listitem>
<listitem>

<para>
Przekopiowaæ do miejsca zainstalowania
(zwykle <filename>c:\Program Files\Labf.com\WinaXe</filename>, w starszych wersjach <filename>c:\Program Files\Labtam\X-WinPro</filename>) plik klawiatury
<filename>jojo.kmf</filename>. <!--NIEAKTUALNE Plik ten mo¿na zdobyæ przez anonymous ftp z 
serwera jojo.praterm.com.pl.-->Od wersji 6.0 WinaXe'a plik ten nie jest potrzebny - standardowo w dystrybucji znajduje siê w³a¶ciwa klawiatura polish.kmf.
</para>
</listitem>
<listitem>

<para>
Mo¿na korzystaæ z fontów przez xserwer albo (szybsze) z lokalnych. Z ró¿nych
powodów (m.in. wiêksza stabilno¶æ) zaleca siê to drugie. Je¿eli terminal ma
pracowaæ z lokalnymi fontami nale¿y:

<itemizedlist>
<listitem>

<para>
utworzyæ podkatalog, np. 
<filename>75dpipl</filename>, w miejscu zainstalowania fontów
WinaXe: <filename>c:\Program Files\Labf.com\WinaXe\fonts</filename> (w starszych wersjach <filename>c:\Program Files\Labtam\X-WinPro\Fonts</filename>).
</para>
</listitem>
<listitem>

<para>
Zalogowaæ siê przez telnet do serwera (telnet ip_serwera) i do
pomocniczego katalogu np. <filename>/temp</filename> skopiowaæ ca³y katalog z
fontami polskimi 75dpi (gdzie jest ten katalog mo¿na znale¼æ zagl±daj±c w sekcjê FontPath w
pliku <filename>/etc/X11/XF86Config</filename>. Je¿eli jest tam wpis
"unix/:-1", to znaczy, ¿e jest uruchomiony font server i ¶cie¿ki
mo¿na odczytaæ z pliku <filename>/etc/X11/fs/config</filename> z sekcji 
catalogue).
</para>
</listitem>
<listitem>

<para>
Aby sprawdziæ, które katalogi zawieraj± polskie fonty, nale¿y sprawdziæ
wpisy w plikach <filename>fonts.dir</filename> poszczególnych katalogów czy
s± tam
wpisy zakoñczone iso8859-2 (standard kodowania polskich liter).
Zwykle ta nazwa jest wpleciona w ¶cie¿kê katalogu z fontami,
np. w RH v6.1 jest to <filename>/usr/share/fonts/ISO8859-2/75dpi</filename>.
</para>
</listitem>
<listitem>

<para>
Po przegraniu zawarto¶ci katalogu, np.
<programlisting>
cp /usr/share/fonts/ISO8859-2/75dpi/* /temp/
</programlisting>
nale¿y rozpakowaæ wszystkie fonty (nie jest to konieczne w wersjach WinaXe 6.2 i pó¼niejszych):
<programlisting>
gzip -d &nbsp;/temp/*
</programlisting>
(gzip powinien napisaæ, ¿e
zignorowa³ dwa pliki: <filename>fonts.alias</filename> i <filename>fonts.dir
</filename> a resztê
rozpakowa³). 
</para>
</listitem>
<listitem>

<para>
W pliku <filename>fonts.dir</filename> nale¿y usun±æ z wszystkich nazw plików koñcówkê
".gz" (w przypadku wersji WinaXe 6.2 lub pó¼niejszej, je¿eli fonty nie zosta³y rozpakowane, nie nale¿y zmieniaæ zawarto¶ci <filename>fonts.dir</filename>). 
</para>
</listitem>
<listitem>

<para>
W Windows z utworzonego dla nowych fontów katalogu nale¿y siê
po³±czyæ przez ftp z serwerem (<command>ftp ip serwera</>), ustawiæ
transfer na binarny (<command>binary</>), przej¶æ do podkatalogu z
przygotowanymi fontami (<command>cd /temp/</>), wy³±czyæ tryb interaktywny
(<command>prompt</>) i ¶ci±gn±æ wszystko (<command>mget *</>) i wreszcie zakoñczyæ (<command>bye</>).
</para>
</listitem>
<listitem>

<para>
Lokalnie na Windows nale¿y zmieniæ nazwê pliku <filename>fonts.alias</filename>
na
<filename>fonts.ali</filename>.
</para>
</listitem>
<listitem>

<para>
w sesji telnetu wymazaæ ca³y katalog pomocniczy:
<programlisting>
rm -rf /temp/
</programlisting>
I mo¿na ju¿ zakoñczyæ sesjê telnet.
</para>
</listitem>
</ItemizedList>

<listitem>
<para>
Uruchomiæ XSettings z pakietu WinaXe i ustawiæ tam:
<itemizedlist>
<listitem>
<para>
RGB Path: rgb.txt.
</para>
</listitem>
<listitem>

<para>
Keyboard Settings \ Keyboard File List: jojo.kmf (to jest plik
przygotowany przez firmê PRATERM i nale¿y go wcze¶niej umie¶ciæ
w katalogu z WinaXe) lub w WinaXe 6.x: polish.kmf.
</para>
</listitem>
<listitem>

<para>
Keyboard Settings \ Block Key Syms Changing: + (w WinaXe 6.x standardowo zaznaczone).
</para>
</listitem>
<listitem>

<para>
Startup \ Window Mode List: Full Screen.
</para>
</listitem>
<listitem>

<para>
Startup\ XDMCP \ Use XDMCP: +
w oknie wywo³ywanym przyciskiem Settings w
Startup \ Window Mode List \ XDMCP ustawiæ:

<itemizedlist>
<listitem>

<para>
XDMCP mode: Query.
</para>
</listitem>

<listitem>
<para>
X depth (bits per pixel): Auto.
</para>
</listitem>

<listitem>
<para>
Reset XServer at XDMCP Close: + (w WinaXe 6.x standardowo zaznaczone).
</para>
</listitem>

<listitem>
<para>
Connect Host: ip_serwera.
</para>
</listitem>

</ItemizedList>

W oknie XSettings w oknie wywo³ywanym przyciskiem Font Control \ FontPath
ustawiæ:

<itemizedlist>
<listitem>

<para>
Przez Browse wsadziæ do okienka Font directory ¶cie¿kê z
przekopiowanymi polskimi fontami albo fontserwer -
wpis postaci: <filename>tcp/ip_serwera:port</filename>, gdzie <quote>port</quote> przyjmuje zwykle warto¶æ 7100.
</para>
</listitem>
<listitem>

<para>
Zaznaczyæ pierwsz± ¶cie¿kê w oknie Priority ordered path i
nacisn±æ przycisk <command>Insert Before</>, potem <command>Save</>.
</para>
</listitem>

</ItemizedList>

</para>
</listitem>


<listitem>
<para>
Reszta ustawieñ bez znaczenia.
</para>
</listitem>

<listitem>
<para>
Na koniec nacisn±æ <command>OK</> w g³ównym oknie XSettings, w dialogu z zapytaniem o
plik jojo.kmf odpowiedzieæ twierdz±co.
</para>
</listitem>

</ItemizedList>
</para>
</listitem>

<listitem>
<para>
Na serwerze, nale¿y skonfigurowaæ odpowiednio program
<command>xdm</command> (lub jeden z pochodnych:
<command>kdm</command> b±d¼
<command>gdm</command>), tak jak to opisuje
<xref linkend="xdm-config">.
</para>

</listitem>

<listitem>

<para>
XWin-Pro / WinaXe jest gotów do uruchomienia.
</para>
</listitem>

</ItemizedList>

</para>
</section>

<section id="cygwin-xorg">
<title>Instalacja X-serwera Cygwin/Xorg</title>
<para>
System Cygwin/Xorg jest darmowym X-serwerem z otwartymi ¼ród³ami.
Stanowi dzi¶ najpowa¿niejsz± konkurencjê dla produktów komercyjnych 
(typu WinaXe). Nie dostarcza wprawdzie tak wielu udogodnieñ 
a jego interfejs jest dosyæ <quote>surowy</quote>, ale bie¿±ce wersje 
dzia³aj± bardzo stabilnie i spe³niaj± swoje podstawowe funkcje.
Najwa¿niejsz± funkcj± X-serwera Cygwin/Xorg jest umo¿liwienie
komputerowi PC zdalnej pracy na maszynach uniksowych/linuksowych
(komputer PC staje siê wówczas tzw. X-terminalem).
X-terminal jest wiêc tylko <quote>wy¶wietlark±</quote> informacji z aplikacji, która
w rzeczywisto¶ci dzia³a na innym, zdalnym komputerze.
</para>
<para>
¯eby zainstalowaæ Xorg na systemie Windows, trzeba wcze¶niej
skonfigurowaæ i zainstalowaæ ¶rodowisko Cygwin. Pe³n± informacjê o mo¿liwych
sposobach instalacji cygwina zawiera <xref linkend="cygwin">. Minimalna, w
pe³ni funkcjonalna wersja (bez obs³ugi polskiej klawiatury), mo¿e byæ
¶ci±gniêta ze strony 
<ulink url="http://www.szarp.com.pl/download.php">www.szarp.com.pl/download.php</ulink>. Przy
instalacji pyta siê ona jedynie o adres IP serwera X-ów. Mo¿e byæ tak¿e 
konieczne zastosowanie opcji <emphasis>-from</emphasis> (zobacz dalej).
</para>
<para>
Inny, do¶æ prosty i ogólny sposób sprowadza siê do nastêpuj±cych czynno¶ci:
<orderedlist>
<listitem><para>
Uruchomiæ program ¶ci±gniêty z 
<ulink url="http://www.cygwin.com/setup.exe">www.cygwin.com/setup.exe</ulink>.
</para></listitem>
<listitem><para>
Potwierdziæ domy¶lny typ instalacji, domy¶lne opcje i sposób po³±czenia z
internetem (trzy kolejne ekrany).
</para></listitem>
<listitem><para>
Wybraæ jeden z serwerów lustrzanych, z których bêd± ¶ci±gane pakiety. Je¿eli
dane z jakiego¶ serwera s± ¶ci±gane wolno lub w ogóle, nale¿y spróbowaæ z innym
serwerem.
</para></listitem>
<listitem><para>
Wybraæ pakiety do instalacji - w tym celu na górze po prawej stronie okienka
do wyboru pakietów klikamy na guzik <emphasis>View</emphasis>, aby uzyskaæ
alfabetyczn± listê pakietów, a potem klikamy na napisie
<emphasis>Skip</emphasis> w linii z pakietem
<emphasis>xorg-x11-xwin</emphasis> - zostanie zaznaczony do instalacji pakiet
z X-serwerem oraz kilka innych pakietów. Zatwierdzamy nasz wybór.
</para></listitem>
<listitem><para>
Czekamy a¿ instalator ¶ci±gnie i zainstaluje wybrane pakiety - mo¿e to trochê
potrwaæ. Na koñcu mo¿emy wybraæ dodanie pozycji w menu start i utworzenie
skrótu na pulpicie.
</para></listitem>
</orderedlist>
<emphasis>Uwaga! Cygwin/Xorg, w przeciwieñstwie do reszty programów pakietu
Cygwin, jest systemem graficznym, wiêc ma wiêksze wymagania. Korzysta z 
systemu DirectX. Musi byæ zainstalowana wersja co najmniej 4.
Problem mo¿e pojawiæ siê w przypadku starszych wersji systemu Windows (95, 98),
nie dotyczy jednak nowszych systemów (Me, 2000, XP),
gdzie system DirectX jest standardowo obecny.
</emphasis>
</para>

<para>
Konfiguracja X-terminala nie jest skomplikowana. W pierwszym kroku musimy odszukaæ
plik o nazwie <filename>startxdmcp.bat</filename>. Powinien znajdowaæ siê on 
w katalogu <filename>C:\CYGWIN\USR\X11R6\BIN</filename> (je¿eli system Cygwin
zosta³ zainstalowany na dysku <filename>C:</filename>). Przegrywamy ten plik
w miejsce, z którego bêdzie nam wygodnie uruchamiaæ system Cygwin (np. na pulpit).
Nastêpnie musimy wyedytowaæ ten plik (np. za pomoc± edytora Notepad). Modyfikujemy 
tu nastêpuj±c± liniê w pliku:
<programlisting>
SET REMOTE_HOST=10.0.0.1
</programlisting>
Powinni¶my ustawiæ REMOTE_HOST jako adres serwera uniksowego/linuksowego, z którym bêdziemy
siê ³±czyæ.
</para>

<para>
Je¿eli chcieliby¶my skorzystaæ z serwera fontów, to nale¿y przej¶æ na koniec pliku
i odnale¼æ liniê wywo³ania X-servera (programu <command>XWin</command>):
<programlisting>
<![CDATA[
REM Connect to a specified machine.

%RUN% Xwin -query %REMOTE_HOST% -nodecoration -lesspointer

...

REM Connect to a specified machine and a specified font server.

REM %RUN% Xwin -query %REMOTE_HOST% -nodecoration -lesspointer -fp \
	tcp/%REMOTE_HOST%:7100
]]>
</programlisting>

Mo¿na j± rozpoznaæ po braku <quote>REM</quote> na pocz±tku.
Liniê tê nale¿y wykomentowaæ dodaj±c <quote>REM</quote> a odkomentowaæ
liniê zawieraj±c± opcjê <command>-fp tcp/...</command>.
</para>

<para>
Je¶li wyst±pi± problemy z obs³ug± klawiatury (powtarzanie wpisanych znaków),
nale¿y dodaæ <command>-kb</command> na koñcu linii wywo³ania <command>Xwin</command>.
</para>

<para>
Dodatkowo, je¿eli Cygwin jest zainstalowany na komputerze z systemem Windows
98, to konieczne jest podanie w linii wywo³ania programu <command>Xwin</command>
numeru IP komputera z Windows. Przyk³adowo, je¿eli komputer ma numer IP
192.168.0.100, to na koñcu linijki z wywo³aniem program
<command>XWin</command> dopisujemy:
<programlisting>
-from 192.168.0.100
</programlisting>
Zdarza siê, ¿e taki wpis musimy te¿ zrobiæ na komputerze z nowszym systemem
(tak¿e Windows XP), np. gdy komputer ma kilka interfejsów sieciowych.
</para>

<para>
Po zmodyfikowaniu pliku, zapisujemy zmiany i wychodzimy z edytora.
Po uruchomieniu powinni¶my siê po³±czyæ z serwerem
i po kilku sekundach otrzymaæ graficzne okno logowania siê do systemu.
</para>

<para>
Je¿eli z jakiego¶ powodu nie otrzymujemy okna logowania siê do systemu,
to powinni¶my sprawdziæ czy to <quote>sprawka</quote> ustawieñ sieci czy 
raczej z³ej instalacji X-serwera (np. braku niezbêdnych pakietów). 
W celu sprawdzenia czy system X-Window zosta³ poprawnie zainstalowany, uruchamiany konsolê
tekstow± i wpisujemy komendê:
<programlisting>
/usr/X11R6/bin/startxwin.bat
</programlisting>
</para>
<para>
W wyniku powinien uruchomiæ siê X-serwer z prostym window managerem i pojedynczym shellem. 
K³opoty z uruchomieniem siê X-serwera w tym momencie mog± wynikaæ z nieprawid³owego
zainstalowania (lub braku) pakietów systemu Xorg. ¯eby poprawiæ ten problem, nale¿y 
jeszcze raz uruchomiæ program <command>setup.exe</command> i w³±czyæ pakiety 
z listy <command>X11</command>.
<emphasis>Uwaga! Nie mo¿na w ten sposób uruchomiæ X-serwera, gdy mamy zainstalowane 
zupe³nie minimalne ¶rodowisko Cygwin (np. bez lokalnych fontów, 
bez window managera). Taka instalacja jest przez nas jednak niezalecana.</emphasis>
</para>

<para><emphasis>
Uwaga (2)! Czasami zdarza siê, ¿e X-serwer nie chce siê uruchomiæ zwracaj±c
komunikat <quote>Brak miejsca na ¶rodowisko</quote> (lub w wersji angielskiej
<quote>Out of environment space</quote>). Nale¿y wówczas przydzieliæ
w systemie wiêcej miejsca na ¶rodowisko w programach konsolowych.
Szczegó³ow± instrukcjê mo¿na znale¼æ na stronach Microsoftu:
<ulink url="http://support.microsoft.com/default.aspx?scid=http://support.microsoft.com:80 \
/support/kb/articles/Q230/2/05.ASP&amp;NoWebContent=1
">http://support.microsoft.com/default.aspx?scid=http://support.microsoft.com:80 \
/support/kb/articles/Q230/2/05.ASP&amp;NoWebContent=1</ulink>.
Po wprowadzeniu zmian komunikat powinien przestaæ siê pojawiaæ.
</emphasis></para>

<para>
Je¿eli X-serwer uruchamia siê poprawnie, mo¿emy spróbowaæ po³±czyæ siê rêcznie z jak±¶ aplikacj± 
iksow± do naszego serwera (wykorzystuj±c metodê <quote>putty</quote>, opisan± w rozdziale 
<xref linkend="x-forwarding">). Je¿eli aplikacja siê nie uruchamia (jej interfejs nie jest 
wy¶wietlany na serwerze), to mo¿e oznaczaæ, ¿e lokalny system Windows ma zainstalowanego
firewalla i nie wpuszcza ¿adnej aplikacji na porty X-serwera (od 6000 w górê).
</para>
<para>
Je¿eli aplikacja siê uruchamia i jest wy¶wietlana, mo¿e to oznaczaæ, ¿e to serwer z kolei 
ma zainstalowanego firewalla i nie wpuszcza do siebie pakietów XDMCP. W tym przypadku
nale¿y skontaktowaæ siê z administratorem serwera.
</para>

<!--
<itemizedlist>
<listitem><para>
Nastêpnie wchodzimy do katalogu <filename>/usr/X11R6/bin</filename> i kopiujemy plik
<filename>/usr/X11R6/bin/startxwin.bat</filename> do np. 
<filename>/usr/X11R6/bin/x-query.bat</filename>. 
(Uwaga! ¶cie¿ka <filename>/usr/X11R6/bin/</filename> jest to lokalizacja
w ¶rodowisku Cygwin natomiast w systemie Windows bêdzie zwykle ¶cie¿ka
<filename>C:\CYGWIN\USR\X11R6\BIN\</filename>).
Potem ten plik edytujemy (np. WordPadem), 
i znajdujemy tam liniê rozpoczynaj±c± siê nastêpuj±co: "start XWin ...", któr±
modyfikujemy tak, ¿eby wygl±da³a jak poni¿ej:
<programlisting>
<![CDATA[
start XWin -query <adres_ip_serwera> -fullscreen -fp tcp/<adres_ip_serwera>:7100 -from <adres_ip_klienta>
]]>
</programlisting>

<emphasis>Uwaga! Je¿li korzystamy z DHCP i nie mamy na sta³e przydzielonego numeru
IP naszego komputera (klienta) to mo¿emy spróbowaæ pomin±æ opcjê 
<quote>-from</quote>. Jest ona jednak konieczna na niektórych systemach XP
a w systemach Windows 
95, 98, Me jest niezbêdna zawsze - bez niej <command>xdm</command> (b±d¼ <command>kdm</command> 
czy <command>gdm</command>) nas nie wpu¶ci do systemu. 
Je¿eli wiêc nasz system to Windows NT/2000/XP i korzystamy DHCP mo¿emy 
spokojnie pomin±æ opcjê wraz z parametrem.
</emphasis>
</para>
<para><emphasis>Uwaga(2)! Je¿eli zosta³y zainstalowane czcionki lokalnie to mo¿emy opu¶ciæ
parametr <quote>-fp</quote> wraz z argumentem <quote>tcp/adres:port</quote>. 
Opuszczenie parametru 
mo¿e byæ równie¿ po¿±dane w przypadku k³opotów z serwerami fontów
(wówczas nie bêdziemy mieli polskich fontów, ale system bêdzie dzia³a³).
</emphasis>
</para></listitem>

<listitem><para>
Warto zrobiæ sobie skrót do na pulpicie do pliku który w³a¶nie 
zmodyfikowali¶my (<filename>x-query.bat</filename>). Mo¿na równie¿
stworzyæ sobie wyspecjalizowany skrypt uruchamiaj±cy odpowiedni
program w wielu oknach, np.
<programlisting>
<![CDATA[
set DISPLAY=localhost:0
start XWin -multiwindow -fp tcp/192.168.1.100:7100
ssh -x lucek@praterm.com.pl /etc/X11/xinit/xinitrc.d/scc
]]>
</programlisting>
uruchomi w systemie Windows jedno okno z 
<ulink url="http://www.szarp.com.pl/howto/scc/html/scc.html">programem SCC</ulink>, 
który pozwoli nam na uruchamianie programów SZARP-a w oddzielnych oknach windowsowych
(opcja -multiwindow).
</para></listitem>

<listitem><para>
Po uruchomieniu tego skryptu powinni¶my otrzymaæ ekran zachêcaj±cy 
do zalogowania siê. Je¿eli ekranu nie ma to nale¿y w pierwszej 
kolejno¶ci sprawdziæ czy przekazujemy odpowiedni adres serwera. 
Je¿eli adres jest dobry to nale¿y sprawdziæ czy nie jest to
jeden z problemów, które opisuje <xref linkend="xterminals-problems">.
</para></listitem>

<listitem><para>
Fonty. Trzeba zadbaæ, aby na serwerze by³ 
aktywny font server (program <command>xfs</command>) na porcie TCP = 7100. 
W tym celu na serwerze do pliku 
<filename>/etc/fs/config</filename> nale¿y dodaæ port = 7100 (o ile go tam nie ma).
</para>
<para>
Wprawdzie bez serwera fontów Cygwin bêdzie wy¶wietla³ polskie czcionki
(do systemu s± do³±czone polskie fonty ISO-8859-2),
ale standardowe fonty do³±czone z Cygnusem czasem wygl±daj± kiepsko.
W najnowszych dystrybucjach sytuacja siê znacznie poprawi³a.
</para></listitem>

<listitem><para>
Je¶li chcemy, aby Cygwin uruchomi³ siê w oknie, usuwamy opcjê <quote>-fullscreen</quote> 
(brak parametru).
Mo¿emy j± zast±piæ opcjami <quote>-multiwindow</quote> (windowsowe okienko dla ka¿dej 
aplikacji) b±d¼ <quote>-rootless</quote> (przezroczysty desktop manager), lecz te
opcje nie s± jeszcze najlepiej wspierane.
</para></listitem>
-->

<para>
X-serwer mo¿emy zabiæ na 2 sposoby: 

<itemizedlist>
<listitem><para>
przez naci¶niêcie Alt-F4 (standardowy sposób zamykania 
programów w Windowsach). Pojawi nam siê wówczas okno dialogowe,
gdzie powinni¶my potwierdziæ nasz zamiar;
</para></listitem>

<listitem><para>
poprzez naci¶niêcie ma³ego znaczka X na pasku zadañ (znaczek
ten pojawia siê na czas uruchomienia X-serwera). W tym
celu musimy najpierw jako¶ <quote>przej¶æ</quote> ze ¶rodowiska
X-Windows do Windowsów (np. naciskaj±c CTRL-ESC, Alt-ESC albo Alt-Tab).
</para></listitem>

</itemizedlist>

Stronê serwera (Linux) opisuje <xref linkend="xdm-config">.

</para>

</section> <!-- cygwin-xorg -->

<section id="pexus-xserver">
<title>Instalacja X-serwera Pexus X-Deep/32</title>

<para>
Jeszcze inn± mo¿liwo¶ci±, je¿eli chodzi o darmowe X-serwery pod Windows,
jest aplikacja X-Deep/32. By³ to produkt komercyjny, rozwijany przez
firmê Pexus. W sierpniu 2004 roku firma przesta³a istnieæ, a prawa autorskie
do programu zosta³y przekazane jego autorowi, który opublikowa³ go na
licencji freeware (nie OpenSource !), co oznacza, ¿e mo¿na go wykorzystywaæ
za darmo, ale nie mo¿na np. modyfikowaæ.
</para>
<para>
X-Deep ma ma³e wymaganie sprzêtowe i programowe, wed³ug autorów 
wystarczy procesor 486DX i dowolna wersja Windows od 95 w³±cznie (choæ w
przypadku Windows 95 mo¿e byæ konieczne zainstalowanie dodatkowych bibliotek).
Zalet± jest tak¿e ma³y rozmiar plików do ¶ci±gniêcia (9 MB). Niestety
program prawdopodobnie nie bêdzie ju¿ rozwijany, wiêc nie ma co liczyæ
na poprawki czy nowe funkcje.
</para>
<para>
Instalacjê rozpoczynamy od ¶ci±gniêcia programu ze strony 
<ulink url="http://www.pexus.com">www.pexus.com</ulink> - wybieramy wersjê
<emphasis>Basic, Single file download</emphasis>. Po ¶ci±gniêciu pliku
<filename>xdp40Basic.exe</filename> uruchamiamy go, klikamy na
<emphasis>Next</emphasis> na pierwszym ekranie, na kolejnym zaznaczamy, ¿e
zgadzamy siê na warunki licencji (<emphasis>I agree with above terms and
conditions</emphasis>) i ponownie klikamy <emphasis>Next</emphasis>. Kolejnym
krokiem jest wybór katalogu instalacyjnego - mo¿emy zostawiæ proponowany
<filename>c:\xdeep32_40</filename> i klikn±æ <emphasis>Start</emphasis>.
Po zakoñczeniu instalacji klikamy <emphasis>Ok</emphasis> i na nastêpnym
ekranie zostawiamy wybrane <emphasis>Create shortcut(s) on Desktop</emphasis>
- utworzenie skrótów na ekranie, potwierdzamy <emphasis>OK</emphasis>.
</para>
<para>
Nastêpnie albo z menu Start, albo korzystaj±c z utworzonego skrótu na pulpicie,
uruchamiamy program X-Server. Pojawi siê po chwili okienko ze spisem
dostêpnych interfejsów sieciowych. Na razie mo¿emy zostawiæ domy¶lny
<emphasis>ANY</emphasis> i klikn±æ <emphasis>Select</emphasis>. Po chwili
zobaczymy kolejne okienko, z list± wykrytych w sieci serwerów XDM. Wybieramy
serwer, z którym bêdziemy siê ³±czyli i naciskamy <emphasis>Connect</emphasis>.
Po chwili powinni¶my zobaczyæ okno logowania na serwer.
</para>
<para>
Mo¿emy tak¿e skonfigurowaæ X-Deep/32 w taki sposób, aby automatycznie ³±czy³
siê od razu z wybranym przez nas serwerem. W tym celu:
<itemizedlist>
<listitem><para>
Klikamy prawym przyciskiem myszy na belce tytu³owej okna Windows z uruchomionym
X-Serwerem i wybieramy z menu <emphasis>X-Server Menu</emphasis> a nastêpnie
<emphasis>X-Server Options</emphasis>.
</para></listitem>
<listitem><para>
W okienku dialogowym, które siê pojawi wybieramy zak³adkê XDMCP. Zaznaczamy
opcjê <emphasis>XDMCP by Query Host</emphasis>, wpisujemy tak¿e adres IP
serwera - <emphasis>XDMCP Hostname or IP address</emphasis>.
</para></listitem>
<listitem><para>
W zak³adce <emphasis>Network Interfaces</emphasis> wybieramy jako domy¶lny
interfejs sieciowy sieæ lokaln±. Je¿eli nie wiemy, która to jest, mo¿emy
zostawiæ ANY. Odznaczamy obie opcje poni¿ej (<emphasis>Never
show...</emphasis> i <emphasis>Always prompt...</emphasis>).
</para></listitem>
<listitem><para>
W zak³adce <emphasis>Font</emphasis>, je¿eli chcemy korzystaæ z font serwera
(co jest najprostsz± metod± uzyskania np. polskich znaków), klikamy na
<emphasis>Add Font Server</emphasis> i wpisujemy adres IP serwera (port
zostawiamy bez zmian 7100) i klikamy OK - 
oczywi¶cie font serwer musi byæ uruchomiony na
serwerze i musi nas³uchiwaæ na porcie TCP/IP (zobacz 
<xref linkend="xdm-config">).
</para></listitem>
<listitem><para>
Aby uzyskaæ polsk± klawiaturê, nale¿y ¶ci±gn±æ plik 
<ulink url="http://www.szarp.com.pl/polish.map">polish.map</ulink> i
skopiowaæ go do katalogu <filename>/usr/lib/X11/keymaps</filename> (¶cie¿ka
podana od katalogu, w którym zainstalowali¶my X-Deep/32). Nastêpnie w zak³adce
<emphasis>Input</emphasis> klikamy <emphasis>Select Keymap File</emphasis> i
wybieramy plik <filename>polish.map</filename>.
</para></listitem>
<listitem><para>
W zak³adce <emphasis>Input</emphasis> nale¿y odznaczyæ opcjê
<emphasis>Keyboard autorepeat</emphasis>. Oznacza to w³±czenie
automatycznego powtarzania klawiszy, które powoduje problemy
z obs³ug± niektórych programów przy pomocy klawiatury.
</para></listitem>
<listitem><para>
Nastêpnie w g³ównym oknie opcji klikamy OK. Na pytanie o restart programu
mo¿emy odpowiedzieæ <emphasis>Nie</emphasis> i samemu zamkn±æ program, a
nastêpnie uruchomiæ ponownie, aby upewniæ siê, ¿e jest poprawnie
skonfigurowany. Najprawdopodobniej w wyniku b³êdu w programie pojawi siê okno
wyboru serwera XDMCP. Musimy wybraæ nasz serwer, a nastêpnie ponownie wybraæ
<emphasis>X-Server Menu -> X-Server Options -> XDMCP -> XDMCP by Query
Host</emphasis>. Po kolejnym uruchomieniu okno z pytaniem o serwer nie
powinno ju¿ siê pojawiaæ.
</para></listitem>
</itemizedlist>
</para>
<para>
Je¿eli dostaniemy komunikat o b³êdnym ustawieniu ¶cie¿ki do
fontów (FontPath), oznacza to najprawdopodobniej problem w po³±czeniu siê z
serwerem fontów. Mo¿na wykasowaæ serwer z pocz±tku ¶cie¿ki i uruchomiæ
aplikacjê, aby móc sprawdziæ i ewentualnie zmieniæ ustawienia.
</para>

</section>



<section id="x-forwarding">
<title>Tunelowanie po³±czeñ X-owych</title>
<para>
Po co tunelowaæ? S± dwa g³ówne powody:
<itemizedlist>
<listitem><para>Domy¶lnie X-serwery z X-klientami komunikuj± siê za pomoc± 
nieszyfrowanych kana³ów. Tunelowanie X-ów przez ssh umo¿liwia bezpieczn± 
zdaln± pracê przez Internet.</para></listitem>
<listitem><para>
Tunelowanie umo¿liwia ³±czenie siê z X-serwera z X-klientami schowanymi 
tak za translatorami adresów (NAT-ami, Masquerade'ami), jak i za firewallami.
</para></listitem>
</itemizedlist>
Umieszczono tu opis dwóch sposobów tunelowania po³±czeñ X-owych:
<itemizedlist>
<listitem><para>
Z wykorzystaniem <application>putty</application>
</para>
<para>
Wymagane oprogramowanie: 
	<itemizedlist>
	<listitem><para>
	Terminal: putty.exe w wersji jak naj¶wie¿szej 
	(dostêpne z <ulink url="ftp://sunsite.icm.edu.pl/site/putty-devel"> 
	ftp://sunsite.icm.edu.pl/site/putty-devel</ulink>), 
	jaki¶ XServer (WinaXe, Cygwin/Xorg, ...).
	</para></listitem>
	<listitem><para>
	Serwer: ¿adne dodatkowe oprogramowanie nie jest wymagane.
	</para></listitem>
	</itemizedlist>
Uruchamianie systemu:
	<itemizedlist>
	<listitem><para>
	Program <application>putty</application> nie wymaga instalacji
	i jest dystrybuowany w postaci jednego pliku wykonywalnego 
	(<filename>putty.exe</filename>). 
	</para></listitem>

	<listitem><para>
	Uruchamiamy <application>putty</application>, ustawiamy odpowiedni
	adres serwera i wybieramy opcjê u¿ywania protoko³u <quote>ssh</quote>. 
	Wybieramy okienko Connection/Ssh/Tunnels, gdzie ustawiamy opcjê 
	<quote>X11 Forwarding</quote>.
	</para></listitem>

	<listitem><para>
	Logujemy siê na serwer. Mo¿emy sprawdziæ, ¿e 
	<application>putty</application> odpowiednio ustawi³ zmienn± 
	¶rodowiskow± DISPLAY.
	</para></listitem>

	<listitem><para>
	Po stronie Terminala uruchamiamy Xserver - 
	w przypadku WinAxe/XWinPro nie jest wymagane ustawianie dodatkowych
	parametrów (Xsettings) w stosunku do ustawieñ domy¶lnych.
	</para></listitem>

	<listitem><para>
	Po stronie serwera mo¿emy ju¿ uruchamiaæ programy X-owe 
	(np. <application>xterm</application>). Teoretycznie 
	mo¿emy uruchomiæ równie¿ jakiego¶ Desktop/Window Managera 
	<!--(TODO: sprawdziæ jakie)-->.
	</para></listitem>

	</itemizedlist>

</para></listitem>

<listitem><para>
Przy u¿yciu WinaXe v6.2 i LbxLoxy
</para>
<para>
Wymagane oprogramowanie:
	<itemizedlist>
	<listitem><para>
	Terminal: WinaXe v6.2.
	</para></listitem>
	<listitem><para>
	Serwer: lbxloxy, dystrybuowany w formie gotowego programu wykonywalnego
	(1 plik). Nie u¿ywa plików konfiguracyjnych.
	</para></listitem>
	</itemizedlist>
Uruchamianie systemu:
	<itemizedlist>

	<listitem><para>
	Na Terminalu instalujemy standardowy WinaXe (nie jest wymagana
	zmiana ustawieñ domy¶lnych w XSettings).
	</para></listitem>

	<listitem><para>
	Po stronie Serwera instalujemy <application>lbxloxy</application> 
	(np. rozpakowujemy zipa i kopiujemy plik <filename>lbxloxy</filename>
	do odpowiedniego katalogu, np. <filename>/usr/bin</filename>). 
	</para></listitem>

	<listitem><para>
	Uruchamiamy <application>lbxloxy</application>: 
	<programlisting>
	lbxloxy -waitXServer
	</programlisting>
	Wywo³any w ten sposób <application>lbxloxy</application> skorzysta
	z domy¶lnego portu 6163 (DISPLAY=:63).
	</para></listitem>

	<listitem><para>
	Uruchamiamy WinaXe i klikamy prawym przyciskiem myszy w symbol 
	WinaXe na pasku zadañ.
	Wybieramy Options/Connect LbxLoxyServer. Pojawi siê okienko, w którym
	ustawiamy adres hosta, na którym uruchomili¶my 
	<application>lbxloxy</application> oraz numer portu (6163).
	Ustawienia zatwierdzamy ENTER-em, bo przycisk OK ¼le dzia³a.
	</para></listitem>

	<listitem><para>
	Klikamy znowu prawym przyciskiem myszy na WinaXe na pasku zadañ 
	i sprawdzamy w Messages czy uda³o nam siê po³±czyæ z lbxloxy 
	(ostatni± wiadomo¶ci± powinien byæ napis: <filename>ConnectLbxLoxy/EstablishNewConnections(mail.praterm.com.pl,6163)=1 : OK</filename>).
	</para></listitem>

	<listitem><para>
	Po stronie serwera ustawiamy odpowiednio zmienn± ¶rodowiskow± DISPLAY, 
	np. 
	<programlisting>
	export DISPLAY=:63
	</programlisting>
	Od tej pory mo¿emy ju¿ uruchamiaæ programy X-owe na serwerze.
	</para></listitem>

	</itemizedlist>

</para></listitem>
</itemizedlist>
</para>
<para>
Oba rozwi±zania (putty + WinaXe) oraz (lbxloxy + winaXe) s± identyczne
pod wzglêdem funkcjonalno¶ci. 
</para>
<para>
Metoda <quote>putty</quote> jest szybsza 
i prostsza w konfiguracji (nie robimy nic na serwerze), jednak wymagane
jest wywo³ywanie komend z shella po stronie serwera.
</para>
<para>
Sposób <quote>lbxloxy</quote> wymaga skonfigurowania programu lbxloxy 
na serwerze i dbaniu o to, ¿eby by³ uruchamiany (czasami zdarza siê, 
¿e lbxloxy sam <quote>wychodzi</quote> - wtedy nale¿y go ponownie 
uruchomiæ). Wprawdzie u¿ytkownik nie musi korzystaæ z shella, ale
jest zmuszony do ka¿dorazowego klikania prawym klawiszem myszy
na pasku zadañ i rêcznego ustawiania parametrów dla lbxloxy.
</para>
<para>
Jak dot±d nie uda³o mi siê sprawiæ, ¿eby którykolwiek z powy¿szych sposobów 
zacz±³ wspó³pracowaæ z kdm/xdm, a bez tego nie jest mo¿liwe przyjazne 
u¿ytkownikowi korzystanie z X-ów.
</para>
</section>

<!--
<section id="x-multihop-tunnel">
<title>Tunelowanie w przypadku wielu wêz³ów po¶rednich</title>
<para>
Sekcja niniejsza opisuje przypadek 
</para>
</section>

- czy jest sens o tym pisac?
-->

<section id="xdm-config">
<title>Konfiguracja xdm/kdm</title>

<para>
Ta sekcja opisuje sposób konfiguracji programu <command>xdm</command>
i <command>kdm</command> w taki sposób, ¿eby umo¿liwia³y zdalne 
korzystanie z systemu.
Pierwszy opis (preferowany) dotyczy protoko³u XDMCP. Drugi, mniej elastyczny,
to po³±czenie bez wykorzystywania XDMCP.
</para>


<itemizedlist>
<listitem><para>
Program <command>kdm</command> pochodzi bezpo¶rednio od programu
<command>xdm</command> (maj± wspólny kod ¼ród³owy). U¿ywaj± siê one
tych samych plików konfiguracyjnych. Protokó³ XDMCP dzia³a
nastêpuj±co: po³±czenie jest inicjowane z X-terminala do programu
<command>xdm</command> (który nas³uchuje na porcie 177).
Po zg³oszeniu siê (ang. <quote>query</quote>), <command>xdm</command>
próbuje siê przy³±czyæ do hosta od którego przysz³o g³oszenie.
¯eby skonfigurowaæ <command>xdm</command>/<command>kdm</command> 
do po³±czeñ za pomoc± protoko³u XDMCP, nale¿y zmodyfikowaæ pliki:

<itemizedlist>

<listitem><para>
W pliku <filename>/etc/X11/xdm/Xaccess</filename> ma byæ 
odkomentowana <emphasis>tylko</emphasis> linia:
<programlisting>
*		 	#any host can get a login window
</programlisting>
Reszta, a w szczególno¶ci linia:
<programlisting>
#*              CHOOSER BROADCAST       #any indirect host can get a chooser
</programlisting>
powinna byæ zakomentowana.
</para></listitem>

<listitem><para>
W systemach v6.2, v7.x, v8.x i nowszych nale¿y w pliku
<filename>/etc/X11/xdm/xdm-config</filename>
wykomentowaæ ostatni± liniê, ¿eby wygl±da³a nastêpuj±co:
<programlisting>
  ! DisplayManager.requestPort: 0
</programlisting>
(w tym pliku znakiem komentarza jest wykrzyknik - <quote>!</quote>, 
a nie hasz - <quote>#</quote>).
</para></listitem>

<listitem><para>
(Je¿eli korzystamy z KDE 2.2/3.x, czyli na nowych systemach).
Konfiguracja <command>kdm</command> znajduje siê tu
w katalogu <filename>/etc/kde/kdm/</filename> 
lub <filename>/etc/kde3/kdm</filename>. Wiêkszo¶æ plików
to odno¶niki (linki) do ich odpowiedników w 
<filename>/etc/X11/xdm/xdm-config</filename>, tak wiêc modyfikowaæ
nale¿y np. plik <filename>/etc/kde3/kdm/Xaccess</filename>.
Plikiem 
charakterystycznym dla systemu <command>kdm</command> 
jest <filename>/etc/kde/kdm/kdmrc</filename>.
W celu uruchomienia protoko³u XDMCP (bez niego nie otrzymamy
okna <command>xdm</command>/<command>kdm</command>), 
nale¿y w sekcji [Xdmcp] ustawiæ parametr <quote>Enable=true</quote>
(lub opcjê tê usun±æ zupe³nie).
</para></listitem>

</itemizedlist> <!-- wewnetrzne -->

</para></listitem>



<listitem><para>
Konfiguracja systemu <command>xdm</command>/<command>kdm</command>
oraz X-serwera bez u¿ycia XDMCP. W tym przypadku to nie X-terminal
rozpoczyna sesjê lecz <command>xdm</command>. Dlatego zwykle trudno
znale¼æ dla tego przypadku sensowne zastosowanie. Bo sk±d ma 
<command>xdm</command> wiedzieæ kiedy rozpocz±æ sesjê?
</para>
<para>
¯eby skonfigurowaæ system w ten sposób, nale¿y
w pliku <filename>/etc/X11/xdm/Xservers</> wstawiæ dla ka¿dego 
terminala nastêpn± liniê: 
<programlisting>
&lt;ip_terminala&gt;:0 foreign, 
</programlisting>
a po stronie X-terminala (wy³±czyæ) opcjê wykorzystania 
protoko³u XDMCP. W przypadku systemu WinaXe polega to na
odznaczeniu zaznaczonej uprzednio opcji <quote>XDMCP</quote>, 
a w systemie Cygwin/Xorg na nie korzystaniu z opcji <quote>-query</quote>.
Po stronie serwera mo¿na w tym przypadku wykomentowaæ
wszystkie wpisy w <filename>/etc/X11/xdm/Xaccess</filename>.

</para></listitem>
</itemizedlist> <!-- zewnetrzne -->

<para>
Je¿eli chcemy 
umo¿liwiæ zdalnym klientom korzystanie z fontów z serwera (co zwykle
jest opcj± najprostsz±, choæ zwiêksza obci±¿enie sieci), to musimy zadbaæ,
aby font serwer by³ uruchamiany przy starcie systemu (w sposób
odpowiedni dla danej dystrybucji, zwykle przez skrypt z katalogu
<filename>/etc/init.d/</filename>. Dodatkowo font serwer musi nas³uchiwaæ
na porcie TCP/IP, co nie zawsze jest opcj± domy¶ln±. Nale¿y siê wiêc
upewniæ, ¿e w pliku konfiguracyjnym, zwykle
<filename>/etc/X11/fs/config</filename>, nie ma wpisu <emphasis>no-listen
tcp</emphasis>, b±d¼ te¿ jest wykomentowany. Zmiana opcji w tym pliku
wymaga przerestartowania serwera fontów. Domy¶lny port, na którym nas³uchuje
serwer ma numer 7100.
<note><para>
W pakietach xfs Debiana z serii X-org 7.0 pliki z katalogu
<filename>/etc/X11/fs</filename> istniej±, ale s± ignorowane - odpowiednie
wpisy nale¿y zrobiæ w plikach z katalogu <filename>/usr/lib/X11/fs</filename>.
B³±d ten powinien zostaæ poprawiony w przysz³ych wersjach pakietu.
</para></note>
</para>

</section>

<section id="xterminals-problems">
<title>Najczêstsze k³opoty z X-terminalami</title>
<para>
Czasami nasz X-terminal nie mo¿e siê przy³±czyæ do serwera,
czyli nie wy¶wietlane jest zg³oszenie systemu 
<command>xdm</command> (lub pokrewnego).
W takich przypadkach warto jest sprawdziæ kilka rzeczy, po kolei:
<itemizedlist>
<listitem><para>
Serwer. 
Czy inne X-terminale mog± siê przy³±czyæ do serwera?
Je¶li nie to czy po stronie serwera nie ma uruchomionego firewalla?
Je¿eli tak to jakie porty s± zablokowane/otwarte? Czy jest 
odblokowany XDMCP-owy port 177 (zwykle UDP, ale tak¿e TCP)?
A mo¿e zablokowany jest ca³y interfejs?
</para></listitem>

<listitem><para>
X-terminal. Nale¿y pamiêtaæ, ¿e architektura X-Window System
wymaga mo¿liwo¶ci <quote>dobicia siê</quote> do X-terminala.
Czy X-terminal nie ma firewalla, który blokuje po³±czenia?
Czy X-terminal nie jest schowany za NAT-em (w Linuksie: IP masquerading)?
</para></listitem>
</itemizedlist>

Je¶li problemy z systemem <command>xdm</command>/<command>kdm</command>
nie s± spowodowane ¿adnym z powy¿szych b³êdów, mo¿na spróbowaæ
debuggowania. Opcje do programu <command>xdm</command> s±
opisane w manualu (<command>man xdm</command>), natomiast 
<command>kdm</command>
przyjmuje dwie opcje debugguj±ce: 
<quote>-debug &lt;debug_level&gt;</quote>
i <quote>-logfile &lt;plik&gt;</quote>. Obie opcje musz± byæ
przekazane <emphasis>przed</emphasis> innymi opcjami.
Argumentem do <quote>-debug</quote> jest warto¶æ dziesiêtna
1, 2, 4, 8, 16, .., 512, oznaczaj±ca odpowiedni± czê¶æ systemu.
Je¶li chcemy debuggowaæ wiêcej ni¿ jedn± rzecz równocze¶nie,
to sumujemy warto¶ci (np. 1+2+16), rzecz analogiczna jak
w przypadku sumy logicznej w przypadku ustawiania flag. 
<!--NIEAKTUALNE Wiêcej na temat warto¶ci poszczególnych parametrów mo¿na znale¼æ w
<ulink url="http://kde.cict.fr/kdebase/kdm/README"
>http://kde.cict.fr/kdebase/kdm/README</ulink>.-->
Argumentem drugiego parametru (czyli <quote>-logfile</quote>)
jest nazwa pliku, do którego bêd± zrzucane wszystkie komunikaty.

</para>
</section> <!-- xterminals-problems -->

</section> <!-- X-terminale w X-Windows -->

<section id="ultravnc">
<title>Pomoc zdalna dla Windows</title>
<section id="ultravnc-intro">
<title>Wstêp</title>
<para>
W sytuacji, gdy u¿ytkownik znajduje siê w oddalonej lokalizacji a kontakt
telefoniczny nie doprowadzi³ do rozwi±zania jego problemu, rozwi±zaniem
mo¿e byæ u¿ycie systemu <emphasis>VNC</emphasis>. Pozwala on na zdaln±
pracê na systemie Windows. Typowe aplikacje <emphasis>VNC</emphasis>
wymagaj± jednak instalacji, która dla niedo¶wiadczonego u¿ytkownika mo¿e
stanowiæ problem. Z tego powodu powsta³ system <emphasis>UltraVNC Single
Click</emphasis> dostêpny na stronie
<ulink url="http://ultravnc.sourceforge.net/addons/singleclick.html">
http://ultravnc.sourceforge.net/addons/singleclick.html</ulink>.
Umo¿liwia on stworzenie programu nie wymagaj±cego instalacji,
który po uruchomieniu po³±czy siê z wybranym przez u¿ytkownika
serwerem pomocy technicznej i udostêpni jego pulpit.
Poni¿ej przedstawiony zosta³ przyk³ad jego wykorzystania.
</para>
</section>

<section id="ultravnc-create">
<title>Przygotowanie programu dla u¿ytkowników</title>
<para>
Opis przygotowany zosta³ na podstawie dokumentacji ze strony:
<ulink url="http://ultravnc.sourceforge.net/addons/singleclick.html">
http://ultravnc.sourceforge.net/addons/singleclick.html</ulink>
</para>
<para>
Pierwszym krokiem jest pobranie i rozpakowanie archiwum <filename>custom.zip</filename>
spod adresu: <ulink url="http://www.uvnc.com/custom.zip">http://www.uvnc.com/custom.zip</ulink>
</para>
<para>
Nastêpnie nale¿y wyedytowaæ plik <filename>helpdesk.txt</filename>.
Serwery dodaje siê wpisuj±c sekcjê <emphasis>HOST</emphasis>.
Przyk³adowa sekcja:
<programlisting>
[HOST]
Serwer pomocy technicznej
-connect 192.168.1.1:5500 -noregistry
</programlisting>
Pierwsza linia bêdzie nazw± serwera wy¶wietlan± w oknie wyboru. Druga zawiera
opcje wywo³ania programu. Opcja <emphasis>-noregistry</emphasis> jest obowi±zkowa
a po opcji <emphasis>-connect</emphasis> nale¿y podaæ adres i port serwera.
</para>
<para>
Nastêpnie nale¿y wyedytowaæ sekcje odpowiedzialne za tre¶æ komunikatów
wy¶wietlanych przez program. <emphasis>BALLON1</emphasis> odpowiada
za komunikaty wy¶wietlane w trakcie nawi±zywania po³±czenia,
a <emphasis>BALLON2</emphasis> za komunikaty wy¶wietlone, kiedy po³±czenie
zostanie nawi±zane.
</para>
<para>
Sekcje <emphasis>TEXT*</emphasis> odpowiadaj± za dodatkowe komunikaty
wy¶wietlane w oknie wyboru serwera. Ich funkcjê ilustruje zrzut
okna zamieszczony na stronie dokumentacji.
</para>

<para>
Do tak przygotowanego pliku konfiguracyjnego mo¿na do³±czyæ
ikony i logo. Ich wymiary i nazwy plików opisane s±
w na stronie dokumentacji.
</para>

<para>
Kolejnym etapem przygotowywania programu jest stworzenie archiwum
zip zawieraj±cego wymienione wy¿ej pliki (wymagany jest tylko plik
helpdesk.txt). Nazwa archiwum musi zmieniaæ siê przy tworzeniu
kolejnych wersji programu. W przeciwnym wypadku mo¿e doj¶æ
do pomieszania plików z ró¿nych wersji. Archiwum nale¿y wys³aæ
przy pomocy formularza: <ulink url="http://sc.uvnc.com/index.php?section=19">
http://sc.uvnc.com/index.php?section=19</ulink>. Nazwa u¿ytkownika
i has³o wymagane przez formularz podane s± na stronie dokumentacji.
Po wys³aniu nast±pi przekierowanie na stronê z gotowym plikiem wykonywalnym.
Plik ten nale¿y zapisaæ i udostêpniæ u¿ytkownikom.
</para>
    
</section> <!-- ultravnc-create -->

<section id="ultravnc-use">
<title>U¿ywanie UltraVNC SC</title>
<para>    
Do rozpoczêcia korzystania z pomocy zdalnej potrzebne jest jeszcze
uruchomienie na serwerze <emphasis>UltraVNC Viewer</emphasis>.
Mo¿na go pobraæ ze strony: <ulink url="http://www.uvnc.com/">
http://www.uvnc.com/</ulink>. Nie uda³o siê zast±piæ go innymi
programami (np. krdc), ale mo¿na u¿ywaæ go na Linuksie przy pomocy
pakietu <emphasis>wine</emphasis> i wersji <emphasis>Standalone</emphasis>,
która nie wymaga instalacji. Przyk³ad wywo³ania:
<programlisting>
wine vncviewer.exe -listen
</programlisting>
</para>
</section>

</section> <!-- ultravnc -->

</chapter>

</part>

<part id="praterm-hub">
<title>Dodatki</title>

<chapter id="doxygen">
<title>Dokumentowanie kodu w C</title>

<section>
<title>Idea</>
<para>
<application>Doxygen</> s³u¿y do generowania dokumentacji kodu napisanego w 
C, C++ i Javie. Strona domowa projektu to <ulink url="http://www.doxygen.org">
http://www.doxygen.org</>. S± do
¶ci±gniêcia pakiety RPM na wiêkszo¶æ popularnych dystrybucji. W nowszych
program jest ju¿ standardowo obecny.
</para>
<para>
Jak wszyscy wiemy, nie wszyscy pisz± komentarze w kodzie, a pó¼niej wszyscy 
tego ¿a³uj± - zw³aszcza, ¿e d³ugo¶æ ¿ycia kodu np. w Pratermie jest do¶æ du¿a. 
<application>Doxygen</> poza tym, ¿e pozwala generowaæ ³adn± dokumentacjê, 
która pozwala siê zorientowaæ w strukturze kodu i s³u¿yæ jako <emphasis>
reference</> do funkcji i typów danych, wymusza tak¿e pewien styl komentowania,
który na d³u¿sz± metê okazuje siê ca³kiem sensowny. Zapewnia tak¿e generacjê
dokumentacji w ró¿nych formatach - jako strony HTML, jako Latex, RTF lub strony podrêcznika man. Obs³uguje wiele jêzyków, w tym jêzyk polski.
</para>
<para>Aby uzyskaæ dokumentacjê kodu, nale¿y po pierwsze opisaæ odpowiednio
kod (za pomoc± odpowiednio sformatowanych komentarzy), a po drugie uruchomiæ
<application>Doxygena</> z odpowiednim plikiem konfiguracyjnym. Oba te elementy s± pokrótce opisane poni¿ej. Pe³ny opis wszystkich opcji mo¿na znale¼æ w 
dokumentacji programu.
</para>
</section>
<section>
<title>Komentowanie kodu</title>
<para>
Komentarze, które maj± byæ przetwarzane przez
<application>Doxygena</application>
zaczynaj± siê dwoma gwiazdkami lub trzema slashami:
<programlisting>
/** Komentarz blokowy */
/// Komentarz jednolinijkowy
</programlisting>
Komentarz umieszczamy <emphasis>PRZED</emphasis> opisywan± funkcja, struktur± danych 
itp. Pierwsze zdanie (do kropki), s³u¿y jako krótki ogólny opis. Potem mo¿emy 
napisaæ trochê szczegó³ów (je¶li trzeba). A na koniec opisujemy wszystkie 
parametry funkcji, u¿ywaj±c konstrukcji:
<programlisting>
@param nazwa opis_parametru
</>
oraz warto¶æ zwracan±, przez konstrukcjê: 
<programlisting>@return opis</programlisting>
Wa¿ne, ¿eby opisy parametrów zawiera³y tak¿e informacje o dopuszczalnych 
warto¶ciach, ewentualnie reakcji na nietypowe warto¶ci itp. Ca³y opis funkcji 
(metody), mo¿e wygl±daæ tak:
<programlisting>
/**
 * Funkcja nic nie robi (opis ogólny). Ta funkcja naprawdê nic nie robi
 * (opis szczegó³owy).
 * @param par1 naprawdê wszystko jedno, co podasz
 * @param par2 te¿ nie ma znaczenia
 * @return zawsze -18
 * @see co¶_robi
 */
int nic_nie_robi(int par1, char *par2)
{
        return -18;
}
</programlisting>
U¿yto tu te¿ konstrukcji <emphasis>@see</emphasis>, powoduj±cej wygenerowanie linku 
do dokumentacji funkcji <emphasis>co¶_robi</emphasis>. 
</para>
<para>Opis funkcji mo¿emy podaæ 
zarówno w miejscu deklaracji, jak i definicji. Opisuj±c typy (struktury danych)
czasami woleliby¶my umieszczaæ opisy pól struktury (klasy) po nich. Mo¿emy 
robiæ to u¿ywaj±c komentarza w postaci <command>/**&lt; ... */</command>, w ten sposób:
<programlisting>
<![CDATA[
/** Opis ogólny struktury ble. Opis szczegó³owy. */
struct ble {
        int pole1;      /**< To jest pierwsze pole struktury ble */
        int pole2;      /**< A to jest drugie pole. */
};
]]>
</programlisting>
W komentarzach mo¿na u¿ywaæ tak¿e innych dyrektyw postaci
<emphasis>@costam</emphasis>,
oraz wiêkszo¶ci tagów html-owych. Przedstawiona konwencja dokumentowania jest
zgodna z JavaDoc, mo¿na tak¿e u¿ywaæ innych (np. Qt).
</para>
</section>

<section>
<title>Plik konfiguracyjny</title>
<para>
Operacja generowania dokumentacji polega na wywo³aniu programu 
<application>doxygen</> z jedn± opcj± - nazw± pliku konfiguracyjnego.
</para>
<para>
Generowanie tego pliku mo¿na sobie u³atwiæ przez u¿ycie programu <application>
doxywizard</>. Uruchamia siê go pod X-ami. Umo¿liwia wygodne ustawienie 
wszystkich potrzebnych opcji za pomoc± klikanego interfejsu. Najwa¿niejsze jest
podanie katalogu, w którym znajduj± siê pliki z kodem. Mo¿na kazaæ generowaæ
dokumentacjê dla wszystkich plików o podanej masce, lub o konkretnych nazwach.
Wa¿ne jest zaznaczenie opcji <emphasis>EXTRACT_ALL</emphasis>, dziêki czemu zostanie 
wygenerowany opis tak¿e tych funkcji, które nie s± opisane komentarzami. 
Nale¿y tak¿e zaznaczyæ, jakich formatów danych wyj¶ciowych siê spodziewamy i w
jakich katalogach maj± byæ wygenerowane.
</para>
<para>
Po ustawieniu opcji ka¿emy zapisaæ plik konfiguracyjny na dysku, a potem mo¿emy
go u¿ywaæ jako parametru dla programu <application>Doxygen</application>. Uwaga! W 
niektórych wersjach <application>Doxygena</> (np. 1.2.8.1) program 
<application>doxywizard</> mia³ b³±d, objawiaj±cy siê niezapisywaniem do 
wyj¶ciowego pliku prawid³owej warto¶ci opcji <emphasis>EXTRACT_ALL</emphasis>. Konieczna
 jest wtedy rêczna edycja pliku konfiguracyjnego i ustawienie jej warto¶ci na
<emphasis>YES</emphasis>.
</para>
</section>

</chapter> <!-- id="doxygen" -->

<chapter id="htdig">
<title>Przeszukiwanie dokumentacji - system <command>ht://Dig</command></title>
<para>
<command>ht://Dig</command> jest systemem u¿ywanym do indeksowania 
i wyszukiwania informacji
na stronach WWW (na danym serwerze, w domenie lub intranecie).
Interfejs u¿ytkownika przypomina popularne
wyszukiwarki, takie jak Yahoo!, Google czy Infoseek: u¿ytkownik ma
mo¿liwo¶æ wpisania s³ów, które nastêpnie bêd± wyszukiwane (po naci¶niêciu
przycisku <quote>Znajd¼</quote>). Zwracana jest pe³na lista trafieñ.
</para>

<para>System ht://Dig sk³ada siê z zestawu komend oraz bazy s³ów kluczowych.
Komendy, m.in. <command>htdig</command>, <command>htsearch</command>, 
<command>htstat</command>, <command>htmerge</command>, s³u¿± do konfiguracji
i monitorowania pracy systemu oraz spe³niaj± funkcjê skryptów CGI,
uruchamianych prosto ze strony WWW. Te, które nie s± skryptami CGI 
(np. <command>htdig</command>), wywo³uje siê z poziomu shella. 
Baza s³ów kluczowych jest z kolei zbiorem wszystkich s³ów w przeszukiwanej domenie wraz
z miejscami ich wyst±pienia. Przeszukiwanie bazy jest znacznie wydajniejsze ni¿
by³oby ka¿dorazowe przeszukiwanie ca³ej dokumentacji.
</para>

<para>Pakiety instalacyjne systemu ht://Dig s± standardowo rozpowszechniane z ka¿d± 
dystrybucj± systemu RedHat. Naj¶wie¿sza wersja systemu jest dostêpna 
z <ulink url="http://www.htdig.org">http://www.htdig.org</ulink>.
</para>
<para>
Plikiem konfiguracyjnym dla systemu ht://Dig jest <filename>/etc/htdig.conf</filename>.
Wersja tego pliku, która jest do³±czona do systemu (domy¶lna), mo¿e byæ wykorzystana 
do konfiguracji systemu bez ¿adnych zmian. Nale¿y jednak sprawdziæ, 
czy warto¶æ zmiennej <quote>start_url</quote> w pliku to 
<quote>http://localhost</quote>
i czy warto¶æ <quote>localhost</quote> jest odpowiednio ustawione w 
<filename>/etc/hosts</filename> (z regu³y warto¶æ 127.0.0.1).
Nale¿y równie¿ sprawdziæ czy dzia³a demon httpd, np. poprzez przy³±czenie
siê do serwera WWW: <command>lynx http://localhost</command>.
Wy¶wietlona strona powinna byæ stron± g³ówn± przeszukiwanej dokumentacji,
wraz z odno¶nikami do wszystkich poddokumentów. Naturalnie, adresy podane
jak wy¿ej mog± byæ zmienione, w naszym przypadku zamiast 
<filename>http://localhost</filename> ustawiono 
<filename>http://www.praterm.com.pl/howto</filename>.
</para>

<para>Gdy serwer WWW dzia³a tak, jak to opisano powy¿ej, nale¿y wytworzyæ
bazê danych. S³u¿y do tego polecenie: <command>rundig</command> (bez parametrów). 
Czas trwania procesu tworzenia bazy
jest uzale¿niony od ilo¶ci przeszukiwanych informacji. W przypadku niniejszego HOWTO 
i dokumentacji do systemu SZARP ca³o¶æ trwa kilka sekund.
Je¿eli informacje na stronie czêsto siê zmieniaj±, to nale¿y ten proces przeprowadzaæ
wielokrotnie, na przyk³ad po ka¿dej zmianie w dokumentacji, najlepiej automatycznie.
</para>

<para>Kolejnym krokiem jest odpowiednia modyfikacja interfejsu ht://Dig.
Wprawdzie ca³o¶æ interfejsu jest dostarczana wraz z systemem
(znajduje siê w katalogu <filename>/usr/share/htdig</filename>, wskazywanym domy¶lnie
przez <filename>/var/www/html/htdig</filename>) i mo¿na siê do niej
odnie¶æ poprzez adres <filename>http://localhost/htdig</filename>, lecz jest to 
interfejs przyk³adowy, który nale¿y dopiero zintegrowaæ z w³asn± stron±.
Poza tym jest to wersja angielska, wiêc w przypadku polskich stron powinien
byæ przet³umaczony na polski. Interfejs sk³ada siê z kilku plików 
<filename>html</filename>
o okre¶lonych nazwach, które s± wy¶wietlane w odpowiednich momentach (np. gdy 
nie znaleziono ¿adnego wyst±pienia danego s³owa, wy¶wietlana jest zawarto¶æ
pliku <filename>nomatch.html</filename>). W opisywanym tu systemie wyszukiwawczym dla 
dokumentacji SZARP-a skopiowano zawarto¶æ katalogu <filename>/usr/share/htdig</filename>
i zmodyfikowano odpowiednie pliki. Nastêpnie usuniêto istniej±cy link 
<filename>/var/www/html/htdig</filename> i stworzono nowy, wskazuj±cy na
zmodyfikowany katalog z plikami ht://Dig, tak jak poni¿ej:
<programlisting>
rm /var/www/html/htdig
ln -s /opt/szarp/resources/documentation/htdig /var/www/html/htdig
</programlisting>
Strona, w której wywo³ywane jest przeszukiwanie domeny, zosta³a zintegrowana
ze spisem tre¶ci dokumentacji SZARP-a. Od tej pory system ht://Dig powinien byæ
w pe³ni sprawny.
</para>
</chapter>


<chapter id="tips">
<title>Tips & Tricks</title>

<section id="dcopserver">
<title>Problemy z DCOPServer</title>
<para>
Je¿eli w KDE 3.X po pewnym czasie pracy pojawiaj± siê komunikat o problemach w
komunikacji miêdzyprocesowej KDE i przestaje dzia³aæ panel, nale¿y skasowaæ
ca³± zawarto¶æ katalogu <filename>/tmp</filename> oraz pliki zaczynaj±ce siê od
<emphasis>.DCOPserver</emphasis> w katalogach domowych u¿ytkowników.
</para>
</section>

<section id="xsri">
<title>Narzêdzie <command>xsri</command></title>
<para>
Zapewne wielu z Was zastanawia³o siê nad sposobem usuniêcia 
denerwuj±cego logo RedHata z t³a KDM-a.
Otó¿ logo to jest ustawiane za pomoc± programu 
<command>xsri</command>. Program ten jest wywo³ywany automatycznie 
przy starcie mened¿erów logowania KDM/XDM z pliku:
<filename>/etc/X11/xdm/Xsetup_0</filename>. ¯eby logo siê nie pojawia³o,
wystarczy wykomentowaæ wywo³anie programu <command>xsri</command>,
tzn. wszystko zaczynaj±ce siê od linii:
<programlisting>
if [ -x /usr/bin/xsri -a -f /etc/X11/xsrirc ]; then
</programlisting>
Program <command>xsri</command> mo¿na wykorzystaæ tak¿e w innym celu:
¿eby ustawiæ w³asne logo, np. logo Pratermu. Mo¿na przy tym 
pos³u¿yæ siê opcj± --tile (która ustawia s±siaduj±co wiele kopii obrazka):
<programlisting>
     /usr/bin/xsri --tile= \
     	/opt/szarp/resources/documentation/new/common/praterm-logo.png
</programlisting>
RedHat wykorzystuje plik konfiguracyjny <filename>/etc/X11/xsrirc</filename>,
w którym jest zdefiniowany specjalny alias. W przypadku w³asnego logo
mo¿na zrobiæ to samo.
</para>
</section>



<section id="screenshot">
<title>Robienie zrzutów ekranu (<emphasis>screenshotów</emphasis>) pod Linuksem</title>
<para>
Do robienia zrzutów okienek (lub ca³ego ekranu) mo¿na pod Linuksem
wykorzystaæ jeden z wielu programów. Tu zostanie opisany program 
<command>display</command>, nale¿±cy do pakietu ImageMagick.
G³ówn± funkcj± tego programu jest wy¶wietlanie plików
graficznych (obs³uguje stosunkowo du¿o formatów graficznych), 
ich modyfikacja (w ograniczonym zakresie) oraz w³a¶nie robienie
zrzutów okien. W tym celu nale¿y:
<itemizedlist>

<listitem><para>
Uruchomiæ program <command>display</command> i klikn±æ lewym klawiszem
na wy¶wietlonym okienku, ¿eby pojawi³o siê menu g³ówne programu.
</para></listitem>

<listitem><para>
Z menu wybraæ opcjê File, a nastêpnie Open. Pojawi siê okienko
wyboru pliku <quote>Browse and Select a File</quote>.
</para></listitem>

<listitem><para>
W okienku nie wybieramy ¿adnego pliku, lecz klikamy na klawisz 
<command>Grab</command> (¿±danie zrzutu ekranu). Pojawi siê
okienko <quote>Enter any delay in seconds</quote>, wymagaj±ce wpisania
ilo¶ci sekund do uaktywnienia trybu zrzutów ekranu.
</para></listitem>

<listitem><para>
W okienku nale¿y wpisaæ kilka sekund (np. 5) i potwierdziæ klawiszem 
<command>Grab</command>.
</para></listitem>

<listitem><para>
Teraz mamy kilka sekund (np. 5 ;) na otwarcie okienka, które chcemy zrzuciæ 
(lub prze³±czenie siê na inny pulpit). Po tym czasie nasz kursor zamieni 
siê w krzy¿yk, którym nale¿y klikn±æ w interesuj±ce nas okienko.
</para></listitem>

<listitem><para>
Okienko to zostanie przekopiowane do programu <command>display</command> 
i wy¶wietlone (przez chwilê mo¿e siê wydawaæ, ¿e otworzono drugie, 
identyczne okienko, lecz to tylko kopia w programie <command>display</command>).
</para></listitem>

<listitem><para>
Teraz wybieramy opcjê <command>Save</command>, ¿eby zapisaæ obrazek
w odpowiednim formacie (np. png). Mo¿na to zrobiæ pó³automatycznie
(poprzez napisanie nazwy pliku wraz z rozszerzeniem). 
Przed zapisaniem pliku mo¿emy go oczywi¶cie jeszcze przetworzyæ.
</para></listitem>

</itemizedlist>

</para>
</section>

</chapter> <!-- tips -->


</part>

<part id="historia-zmian">
<title>Historia</title>
<chapter id="historia-zmian1">
<title>Historia</title>
<para>

<note>
<para>Historia dokumentu obecnie nie jest uaktualniana, do ¶ledzenia
zmian w dokumencie nale¿y pos³ugiwaæ siê CVS'em lub g³ównym plikiem ChangeLog
systemu SZARP. Ze wzglêdu na du¿e zmiany w strukturze dokumentu, usuniête
zosta³y dowi±zania w historii do konkretnych rozdzia³ów.</para>
</note>

<itemizedlist>

<listitem>
<para>
v 1.103, 2004.11.10 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Konfiguracja Neostrady+ przy pomocy modemu ADSL Sagem F@st 800 (USB) pod Debianem (...). 
</para>
</listitem>

<listitem>
<para>
v 1.102, 2004.11.02 <ulink url="mailto:ecto@praterm.com.pl">Ecto</ulink>
</para>
<para>
Konfiguracja ISDN pod Debianem (...). Nie jest
to Da Debian Proper Way, ale tak robimy ...
</para>
</listitem>

<listitem>
<para>
v 1.101, 2004.08.31 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Oddzielny rozdzia³ o NAT/masqueradzie (...), wiêkszo¶æ 
tre¶ci by³a ju¿ wcze¶niej. Teraz z odpowiednich miejsc s± linki do rozdzia³u
o NAT.
</para>
</listitem>

<listitem>
<para>
v 1.100, 2004.08.27 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Dodanie rozdzia³u od us³udze TPSA "Internet DSL" (...), dopisanie instrukcji jak nale¿y robiæ aliasy IP w Debianie (...).
</para>
</listitem>

<listitem>
<para>
v 1.99, 2004.05.20 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Napisanie paru dodatkowych s³ów o PPP na pocz±tku rozdzia³u (...).
</para>
</listitem>

<listitem>
<para>
v 1.98, 2004.05.19 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Konfiguracja Sferii (...).
</para>
</listitem>

<listitem>
<para>
v 1.97, 2004.04.15 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Dodanie sekcji o GRUB-ie: ....
</para>
</listitem>

<listitem>
<para>
v 1.96, 2003.10.19 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Poprawki i uzupe³nienia w rozdziale o RAIDzie: ....
</para>
</listitem>

<listitem>
<para>
v 1.95, 2003.10.14 <ulink url="mailto:pawel@praterm.com.pl">Pawe³</ulink>
</para>
<para>
Króciutki rozdzia³ o FreeDOS'ie: ....
</para>
<para>
Poza tym w rozdziale szarp-redhat ostrze¿enia przed strasznymi
babolami w redhatowym gcc-2.96.
</para>
</listitem>

<listitem>
<para>
v 1.94, 2003.09.26 <ulink url="mailto:pawel@praterm.com.pl">Pawe³</ulink>
</para>
<para>
Dodanie rozdzia³u o sieciach WLAN: ..., opis instalacji
karty OvisLink AirLive 1120PCI: ....
</para>
</listitem>

<listitem>
<para>
v 1.93, 2003.09.24 <ulink url="mailto:pawel@praterm.com.pl">Pawe³</ulink>
</para>
<para>
Przejrzenie HOWTO pod k±tem nieaktualnych ¶cie¿ek (stara konwencja
/opt/szarp/config), uaktualnienia w rozdzia³ach o instalacji i konfiguracji
SZARPA.
</para>
</listitem>

<listitem>
<para>
v 1.92, 2003.07.01 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Jak stworzyæ w³asn± okrojon± dystrybucjê Cygwina? 
Odpowied¼ <link linkend="customized-cygwin">tutaj</link>.
</para>
</listitem>

<listitem>
<para>
v 1.91, 2003.06.25 <ulink url="mailto:pawel@praterm.com.pl">Pawe³</ulink>
</para>
<para>
Poprawki w opisie konfiguracji firewalla (...),
informacja o nieaktualno¶ci informacji w rozdziale o polskich literach na
wydrukach.
</para>
</listitem>

<listitem>
<para>
v 1.90, 2003.06.25 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Wyodrêbniony rozdzia³ (...). 
</para>
</listitem>

<listitem>
<para>
v 1.89, 2003.06.20 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Wyodrêbniony rozdzia³ o programie <command>xdm</command>
(...). Dodanie informacji
jak konfigurowaæ xfree86/cygwin, ¿eby dzia³a³o pod Windows 9x/Me (dzia³a!).

</para>
</listitem>

<listitem>
<para>
v 1.88, 2003.06.18 <ulink url="mailto:pawel@praterm.com.pl">Pawe³ Pa³ucha</ulink>
</para>
<para>
Uzupe³nienia w opisie uzyskiwania polskich liter na wydrukach z programu
przegl±daj±cego.
</para>
</listitem>

<listitem>
<para>
v 1.87, 2003.06.04 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Opis instalacji i konfiguracji systemów RedHat 9.0/Aurox 9.0
(...). Poprawki w rozdzia³ach
o konf. drukowania.
</para>
</listitem>

<listitem>
<para>
v 1.86, 2003.05.13 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Jak siê ³±czyæ z Internetem przez GPRS?
....
</para>
</listitem>

<listitem>
<para>
v 1.85, 2003.05.09 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Uzupe³nienie informacji o Cygwinie (instalacja, u¿ytkowanie -
...). <quote>Stawianie</quote> sshd na Cygwinie,
jak to zrobiæ: ....
</para>
</listitem>

<listitem>
<para>
v 1.84, 2003.04.11 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Jak zainstalowaæ Debiana, ¿eby SZARP na tym dzia³a³
(...).
</para>
</listitem>

<listitem>
<para>
v 1.83, 2003.03.31 <ulink url="mailto:pawel@praterm.com.pl">Pawe³</ulink>
</para>
<para>
Uaktualnienia w sekcji o sprzêcie, instalacja i konfiguracja modemu wewnêtrznego
PCI Pentagram Hex2 56I (...).
</para>
</listitem>

<listitem>
<para>
v 1.82, 2003.03.31 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Opis programu redhat-config-network, obecnego w RH 7.x
(kliknij <link linkend="redhat-config-network">tutaj</link>).
</para>
</listitem>

<listitem>
<para>
v 1.81, 2003.03.22 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Dodanie informacji o aliasach IP (...).
</para>
</listitem>
<listitem>
<para>
v 1.80, 2003.03.08 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Ogólny rozdzia³ o Cygwinie (...), 
Wrzucenie informacji o WinaXe i XFree86 do wspólnego rozdzia³u 
o X-Terminalach (...).
Poprawki dot. serwera XFree86 (...).
</para>
</listitem>

<listitem>
<para>
v 1.79, 2003.03.02 <ulink url="mailto:pawel@praterm.com.pl">Pawe³</ulink>
</para>
<para>
Poprawki w rozdziale o lm-sensors (co zrobiæ je¶li modu³y nie zosta³y
prawid³owo przekopiowane) - ... i uwagi o instalacji
oprogramowania LanSafe do UPS-ów Powerware 5115 w wersji 4.17a dostarczanej na
p³ytce CD z UPS-em - ....
</para>
</listitem>

<listitem>
<para>
v 1.78, 2003.02.18 <ulink url="mailto:pawel@praterm.com.pl">Pawe³</ulink>
</para>
<para>
Przepisany na nowo rozdzia³ o lm-sensors. Poniewa¿ w wersji 2.7.0 sporo siê
zmieni³o, trudno by³oby zapanowaæ nad ba³aganem w tym rozdziale. Wobec tego
zostawi³em w³a¶ciwie tylko opis instalacji lm-sensors 2.7.0 ze ¼róde³ a doda³em
opis instalacji i konfiguracji demona <emphasis>mondo</emphasis>, którego mo¿na
u¿yæ do kontrolowania stanu czujników i podejmowania odpowiednich akcji
(...).
</para>
</listitem>

<listitem>
<para>
v 1.77, 2003.02.17 <ulink url="mailto:pawel@praterm.com.pl">Pawe³</ulink>
</para>
<para>
Uniwersalny sposób konfigurowania GhostScripta, ¿eby na wydrukach by³y polskie
litery  - dzia³a w LPD i w CUPS.
</para>
</listitem>

<listitem>
<para>
v 1.76, 2003.01.09 <ulink url="mailto:pawel@praterm.com.pl">Pawe³</ulink>
</para>
<para>
Uwagi o konfigurowaniu przez CUPS drukarki pod³±czonej do Windows XP, 
rozdzialik o problemach z plikami kdelnk, rozdzia³ o konfiguracji WindowMakera (<xref
linkend="windowmaker">).
</para>
</listitem>
<listitem>
<para>
v1.75, 2002.12.2 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Male rozdzialiki o: programiku xsri (...), 
o naprawianiu terminala jak siê skopsa (...),
i o screenshotach (...).
</para>
</listitem>

<listitem>
<para>
V 1.74, 2002.11.30 <ulink url="mailto:pawel@praterm.com.pl">Pawe³</ulink>
</para>
<para>
Uaktualnienie sekcji o sprzêcie (...).
</para>
<para>
Dodano opis drukowania z u¿yciem systemu CUPS.
</para>
<para>
Nowy rozdzia³ "Tips & Tricks" na drobne rzeczy, które nigdzie nie pasuj± 
(...).
</para>
<para>
Opis rozwi±zania problemy z DCOPServer w KDE (...).
</para>
</listitem>


<listitem>
<para>
v1.73, 2002.11.09 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Dodano informacjê o zdalnym wywo³ywaniu programów iksowych przy pomocy
ssh (..., dopisane na koñcu).
</para>
</listitem>


<listitem>
<para>
v1.72, 2002.10.31 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Dodany nag³ówek z logo i informacjami o Pratermie SA. Identyczne nag³ówki
s± w reszcie dokumentacji SZARP-a.
</para>
</listitem>

<listitem>
<para>
v1.71, 2002.10.30 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Porz±dki w HOWTO: UPS-y do jednego rozdzia³u (...), 
powsta³ rozdzia³ o protoko³ach p-t-p (...), 
tam¿e przeniós³ siê rozdzia³ o modemie GSM Siemensa.
Dodatkowo zmieniona zosta³a kolejno¶æ niektórych rozdzia³ów (mniejszy ba³agan), 
np. najpierw konfiguracja sieci, potem ssh, przekierowywanie portów, 
a na koñcu SMTP.
</para>
</listitem>

<listitem>
<para>
v1.70, 2002.10.28 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Dodanie opisu konfiguracji drukarki lokalnej na Linuksie
oraz opisu zdalnego drukowania pod Windowsami 
(...). Przeniesienie sekcji
<quote>Konfiguracja serwera drukowania poprzez SMB</quote> z rozdzia³u
o SZARP-ie do rozdzia³u o terminalu z MS Windows, delikatna zmiana nazwy
(...).
</para>
<para>Rozwi±zanie problemu z kdm-em pod RH 7.x (..., pod 
sam koniec).
</para>
</listitem>

<listitem>
<para>
v1.69, 2002.09.24 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Jak skonfigurowaæ drukowanie pod RH7.x.
</para>
</listitem>

<listitem>
<para>
v1.68, 2002.08.28 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Uzupe³nienie informacji o KickStarcie 
(...), usuniêcie zawarto¶ci pliku 
<filename>ks.cfg</filename> dla konfiguracji minimalnej.
Parê drobnych poprawek.
</para>
</listitem>


<listitem>
<para>
v1.67, 2002.08.24 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
System indeksowania i wyszukiwania informacji ht://Dig 
(...).
</para>
</listitem>

<listitem>
<para>
v1.66, 2002.08.07 <ULink URL="mailto:ecto@praterm.com.pl">Ecto</ULink>
</para>
<para>
Konfiguracja UPS-a EVER (...), autologowanie do KDE
(...).
</para>
</listitem>

<listitem>
<para>
v1.66, 2002.08.07 <ULink URL="mailto:lucek@praterm.com.pl">Lucek</ULink>
</para>
<para>
Pinologia kabla do PLIPa (...). Obudowa py³oszczelna Advantech (...). 
</para>
</listitem>

<listitem>
<para>
v1.65, 2002.08.07 <ULink URL="mailto:ecto@praterm.com.pl">Ecto</ULink>
</para>
<para>
Konfiguracja PLIPa (...). Nowa p³yta g³ówna (...).
</para>
</listitem>

<listitem>
<para>
v1.64, 2002.07.26 <ULink URL="mailto:lucek@praterm.com.pl">Lucek</ULink>
</para>
<para>
Rozdzia³ o instalacji CDI (...).
</para>
</listitem>

<listitem>
<para>
v1.63, 2002.07.08 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Dodanie opisu mechanizmu RedHat KickStart (...), automatyzuj±cego
instalacjê RedHata.
</para>
</listitem>

<listitem>
<para>
v1.62, 2002.06.25 <ULink URL="mailto:pawel@praterm.com.pl">Pawe³</ULink>
</para>
<para>
Zmiany w WinaXe 6.2 i pó¼niejszych (...).
</para>
</listitem>


<listitem>
<para>
v1.61, 2002.05.24 <ULink URL="mailto:pawel@praterm.com.pl">Pawe³</ULink>
</para>
<para>
Poprawki dotycz±ce instalacji Linuksa na RH 7.3, uwagi o karcie S3 Paradise
i downgrade'u X-ów z wersji 4.* do 3.3.6 (...).
</para>
</listitem>

<listitem>
<para>
v1.60, 2002.05.11 <ULink URL="mailto:ecto@praterm.com.pl">Ecto</ULink>
</para>
<para>
Udostêpnianie po³±czenia innym u¿ytkownikom sieci lokalnej przy serwerze SDI w Red Hat v7.2 (...).
</para>
</listitem>

<listitem>
<para>
v1.59, 2002.05.05 <ULink URL="mailto:ecto@praterm.com.pl">Ecto</ULink>
</para>
<para>
APM i ACPI, czyli zamykanie systemu w komputerach z nowymi p³ytami g³ównymi, nowe karty graficzne (...).
</para>
</listitem>

<listitem>
<para>
v1.58, 2002.05.03 <ULink URL="mailto:lucek@praterm.com.pl">Lucek</ULink>
</para>
<para>
lm-sensors (szczególnie wersja 2.6.3) a Red Hat v7.2 (...).
</para>
</listitem>

<listitem>
<para>
v1.57, 2002.03.21 <ULink URL="mailto:lucek@praterm.com.pl">Lucek</ULink>
</para>
<para>
Dodanie (na podstawie do¶wiadczalnej) opcji `lba32` do /etc/lilo.conf (...).
</para>
</listitem>

<listitem>
<para>
v1.56, 2002.03.16 <ulink url="mailto:pawel@praterm.com.pl">Pawe³</ulink>
</para>
<para>
Uaktualnienie dla instalacji na Red Hat v7.2.
</para>
</listitem>

<listitem>
<para>
v1.55, 2002.03.16 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Opis rsyncowego backupu na terminal windowsowy przy pomocy Cygwin (...).
</para>
</listitem>

<listitem>
<para>
v1.54, 2002.02.22 <ULink URL="mailto:lucek@praterm.com.pl">Lucek</ULink>
</para>
<para>
Namieszane w rozdziale ..., dodanie podrozdzia³u o
polskich fontach dla wiêkszej czytelno¶ci.
</para>
</listitem>

<listitem>
<para>
v1.53, 2002.02.22 <ulink url="mailto:vooyeck@praterm.com.pl">Vooyeck</ulink>
</para>
<para>
Wreszcie uporz±dkowane zosta³o trochê drukowanie: posta³ du¿y rozdzia³ 
o konfiguracji zdalnego drukowania pod Linuksem po stronie klienckiej 
jak i po stronie serwera (...), 
tam¿e - dodano  o konfigurowaniu
drukarek poprzez przekopiowanie odpowiednich plików,
odchudzono rozdzia³ w sekcji SZARP (...). 
</para>
</listitem>

<listitem>
<para>
v1.52, 2002.02.19 <ulink url="mailto:pawel@praterm.com.pl">Pawe³</ulink>
</para>
<para>
Opis <application>netconf'a</> (...).
</para>
</listitem>

<listitem>
<para>
v1.51, 2002.02.19 <ulink url="mailto:pawel@praterm.com.pl">Pawe³</ulink>
</para>
<para>
Opis konfiguracji i u¿ywania systemu do dokumentacji kodu <application>
Doxygen</> (...).
</para>
</listitem>

<listitem>
<para>
v1.50, 2002.01.19 <ULink URL="mailto:lucek@praterm.com.pl">Lucek</ULink>
</para>
<para>
Wywalenie rozdzia³u o terminalu z wykorzystaniem netbasd i o terminalu mieszanym - rzeczach nigdy nie wykorzystywanych.
</para>
</listitem>

<listitem>
<para>
v1.49, 2002.01.19 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Rozdzia³ o tym jak mo¿na tunelowaæ iksy (...).
</para>
</listitem>

<listitem>
<para>
v1.48, 2001.12.20 <ULink URL="mailto:ecto@praterm.com.pl">Ecto</ULink>
</para>
<para>
Rozdzia³y: o forwardowaniu portów (...) oraz o
konfiguracji sendmaila jako mailera dla sieci lokalnej (...).
</para>
</listitem>

<listitem>
<para>
v1.47, 2001.12.14 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Ca³a masa poprawek w HOWTO, w¶ród nich: dodanie opisu instalacji pakietów 
openssh (...), rozwi±zywanie problemów z klawiatur± pod 
Win 98 SE (...), dodanie sekcji o BODASie
<emphasis>pull</emphasis>.
</para>
</listitem>

<listitem>
<para>
v1.46, 2001.10.28 <ULink URL="mailto:ecto@praterm.com.pl">Ecto</ULink>
</para>
<para>
Ma³e zmiany - sw_cursor dla S3 Trio, oraz opcja persist dla SDI.
</para>
</listitem>

<listitem>
<para>
v1.45, 2001.09.13 <ULink URL="mailto:ecto@praterm.com.pl">Ecto</ULink>
</para>
<para>
Dodanie informacji o tworzeniu tunelików i skrypcie do tego ...
</para>
</listitem>

<listitem>
<para>
v1.44, 2001.09.10 <ULink URL="mailto:ecto@praterm.com.pl">Ecto</ULink> &amp;
<ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Rozdzia³ o instalacji SDI ...
</para>
</listitem>

<listitem>
<para>
v1.43, 2001.08.27 <ULink URL="mailto:ecto@praterm.com.pl">Ecto</ULink>
</para>
<para>
Zmiany i uzupe³nienia:
<ITEMIZEDLIST>
<listitem><para>
Dodanie do wymagañ SZARPa tclreadline wraz z metod± instalacji.
</para></listitem>
<listitem><para>
Nowy rozdzia³ - instalacja nowego kernela.
</para></listitem>
<listitem><para>
Korekta ortograficzna ca³o¶ci.
</para></listitem>
<listitem><para>
Interferencje minicom'a i mgetty (...)
</para></listitem>
</ITEMIZEDLIST>
</para>
</listitem>

<listitem>
<para>
v1.42, 2001.08.28 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Opis konfiguracji serwera + terminala na Linuksie w oparciu 
o rsync BODASA i netpar(d)a (...).
</para>
</listitem>

<listitem>
<para>
v1.41, 2001.08.28 <ULink URL="mailto:pawel@praterm.com.pl">Pawe³</ULink>
</para>
<para>
Opis lokalizacji i sposobu instalacji plików w /etc/skel daj±cych nowo
tworzonym u¿ytkownikom polskie literki. ....
</para>
</listitem>

<listitem>
<para>
v1.40, 2001.08.28 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Modyfikacje rozdzia³u o DocBooku - teraz na pewno zadzia³a (pod RH 6.2);
poza tym dodano ekspresow± konfiguracjê.
</para>
</listitem>

<listitem>
<para>
v1.39, 2001.08.27 <ULink URL="mailto:ecto@praterm.com.pl">Ecto</ULink>
</para>
<para>
Zmiany i uzupe³nienia:
<ITEMIZEDLIST>
<listitem><para>
Nowe p³yty g³ówne ...
</para></listitem>
<listitem><para>
Uzupe³nienia konfiguracji BIOS'u ...
</para></listitem>
<listitem><para>
Uzupe³nienia (drobne) w konfiguracji startowej Linuksa ...
</para></listitem>
</ITEMIZEDLIST>
</para>
</listitem>
<listitem>
<para>
v1.38, 2001.08.18 <ULink URL="mailto:lucek@praterm.com.pl">Lucek</ULink>
</para>
<para>
Zmiany i uzupe³nienia w li¶cie potrzebnych pakietów.
</para>
</listitem>

<listitem>
<para>
v1.37, 2001.08.17 <ULink URL="mailto:lucek@praterm.com.pl">Lucek</ULink>
</para>
<para>
Drobne modyfikacje opisu instalacji UPS Powerware w przypadku LanSafeIII w wersji 4.16 ....
</para>
</listitem>

<listitem>
<para>
v1.36, 2001.08.16 <ULink URL="mailto:pawel@praterm.com.pl">Pawe³</ULink>
</para>
<para>
Krótki rozdzialik o tym, do czego s³u¿y katalog <filename>/etc/skeleton</>
(...).
</para>
</listitem>

<listitem>
<para>
v1.35, 2001.08.14 <ULink URL="mailto:lucek@praterm.com.pl">Lucek</ULink>
</para>
<para>
Opis karty Moxa C168H/PCI (...), opis ustawiania nazwy komputera ..., dodanie nowych obs³ugiwanych p³yt g³ównych ..., kart graficznych ..., kart sieciowych i HUBów ..., uwagi dotycz±ce dysków ATA/100 ..., uwaga czego nie da siê wykonaæ przy pomocy anakondy ..., poprawki i uzupe³nienia do konfiguracji lm_sensors ..., dodanie opisu instalacji i konfiguracji vim-5.8.
</para>
</listitem>

<listitem>
<para>
v1.34, 2001.08.08 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Jeszcze o ssh (...), dodanie opisu konfiguracji BODAS-ów.
</para>
</listitem>

<listitem>
<para>
v1.33, 2001.07.24 <ULink URL="mailto:code@praterm.com.pl">code</ULink>
</para>
<para>
Cygwin - opis
</para>
</listitem>

<listitem>
<para>
v1.32, 2001.07.21 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Uzupe³nienie rozdzia³u Paw³a o konfigurowaniu ssh (...) 
o opis ró¿nych wersji protoko³u. Jak z tym walczyæ.
</para>
</listitem>

<listitem>
<para>
v1.31, 2001.07.06 <ULink URL="mailto:lucek@praterm.com.pl">Lucek</ULink>
</para>
<para>Uzupe³nienia zwi±zane z now± wersj± emulatora xserwera Labtama 
....
</para>
</listitem>

<listitem>
<para>
v1.30, 2001.06.16 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>Rozdzia³ "Ciekawostki" rozpad³ siê ju¿ zupe³nie, powsta³y rozdzia³y: ... i .... </para>
<para>Opisany zosta³ sposób tworzenia w³asnej dystrybucji RedHata, czyli RedHattie (...) . </para>
<para>Wyg³adzenie rozdzia³u o konfiguracji samby do drukowania.</para>
</listitem>

<listitem>
<para>
v1.29, 2001.06.15 <ULink URL="mailto:code@praterm.com.pl">Maciek</ULink>
</para>
<para>Nowy rozdzia³ Praterm HUB (...) dotycz±cy
serwera WWW Pratermu.
</para>
</listitem>

<listitem>
<para>
v1.28, 2001.05.31 <ULink URL="mailto:pawel@praterm.com.pl">Pawe³</ULink>
</para>
<para>Opis synchronizacji czasu (...).
</para>
</listitem>

<listitem>
<para>
v1.27, 2001.05.04 <ULink URL="mailto:lucek@praterm.com.pl">Lucek</ULink>
</para>
<para>Drobne dodatki do rozdzia³u ....
</para>
</listitem>

<listitem>
<para>
v1.26, 2001.04.27 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>Rozbi³em rozdzia³ ... na dwa, i tak powsta³ 
.... Rozbi³em tak¿e informacje o sambie na dwa
oddzielne: na serwer i klienta  
(...).
</para>
</listitem>

<listitem>
<para>
v1.25, 2001.04.09 <ULink URL="mailto:pawel@praterm.com.pl">Pawe³</ULink>
</para>
<para>
Opis konfiguracji DocBook'a, coby dzia³a³.
</para>
</listitem>


<listitem>
<para>
v1.24, 2001.04.06 <ULink URL="mailto:pawel@praterm.com.pl">Pawe³</ULink>
</para>
<para>
Du¿o drobnych poprawek po kolejnym SZARP install party.
</para>
</listitem>


<listitem>
<para>
v1.23, 2001.03.19 <ULink URL="mailto:pawel@praterm.com.pl">Pawe³</ULink>
</para>
<para>
Instalowanie oprogramowania do Fideltronika z rpm'a (...).
</para>
</listitem>

<listitem>
<para>
v1.22, 2001.04.04 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>Poprawiony rozdzia³ o konfiguracji modemu i ppp 
(...), 
dorzucone informacje o konfiguracji uugetty (tam¿e).
</para>
</listitem>

<listitem>
<para>
v1.21, 2001.03.19 <ULink URL="mailto:pawel@praterm.com.pl">Pawe³</ULink>
</para>
<para>
Konfigurowanie ssh (...) i opis BODASa - koncepcja,
konfigurowanie wariantu <emphasis>push</emphasis>.
</para>
</listitem>


<listitem>
<para>
v1.20, 2001.03.10 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Doda³em informacje o UPS-ie Powerware 
... przerzuci³em info o APC i Fideltroniku do
odrêbnych rozdzia³ów
(... i ...).
</para>
</listitem>

<listitem>
<para>
v1.19, 2001.02.21 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Nowe rozdzia³y ze star±, ale poszerzon± zawarto¶ci± przerzucone z 
<quote>Ciekawostek</>:
(... i ...),
Dodany rozdzia³ o lm_sensors (...), któremu jeszcze trochê
brakuje do doskona³o¶ci.
</para>
</listitem>

<listitem>
<para>
v1.18, 2001.02.14 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Trochê informacji (by Lucek) o konfiguracji sieci 100Mbit (...), 
Poprawienie, uzupe³nienie wpisów z v1.17, szczególnie o terminalach wirtualnych
(...).
</para>
</listitem>

<listitem>
<para>
v1.17, 2001.02.12/13 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Podstawowe informacje HUB-ach (...), 
Trochê o X-ach, trochê o crontabie, trochê o anacondzie (...).
</para>
</listitem>

<listitem>
<para>
v1.16, 2001.01.15 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Dodano opis rsynca (...)
</para>
</listitem>

<listitem>
<para>
v1.15, 2001.01.04 <ULink URL="mailto:pawel@praterm.com.pl">Pawe³ Pa³ucha</ULink>
</para>
<para>
Drobne poprawki, zw³aszcza je¶li chodzi o ¶ci±ganie backup'u z terminala - teraz
powinien to robiæ meaner.
</para>
</listitem>

<listitem>
<para>
v1.15, 2001.01.02 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Opis drukowania w SzarpDraw.
</para>
</listitem>


<listitem>
<para>
v1.14, 2000.11.25 <ULink URL="mailto:lucek@praterm.com.pl">Lucek</ULink>
</para>
<para>
kilkana¶cie zmian i wstawek: wdro¿one instalacje (...), kcmdpms, X'y (...), alarmy w BIOSie (...), mgetty (...), inne modu³y Specialix (...), nowe drivery do Specialixa (...), smb (...), backup bazy danych na terminalu z Windows (...)).
</para>
</listitem>

<listitem>
<para>
v1.13, 2000.11.24 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Opis klienta ppp opartego o skrypty (...),
Intel 815, jak z tym walczyæ (gdzie¶ w rozdziale ...).
</para>
</listitem>

<listitem>
<para>
v1.12, 2000.10.28 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Weryfikacja HOWTO w warunkach bojowych. Delikatne poprawki - wszêdzie.
</para>
</listitem>

<listitem>
<para>
v1.11, 2000.10.16 <ULink URL="mailto:vooyeck@praterm.com.pl">Vooyeck</ULink>
</para>
<para>
Techniczne poprawki: Makefile dla sgmla (make html, make clean); wywalenie
labeli, wstawienie xrefów i id gdzie tylko siê da. Wywalenie buga z
ampersandem (zamiast &amp; w kodzie SGML nale¿y u¿ywaæ &amp;amp;!). 
</para>
</listitem>

<listitem>
<para>
v1.10, 2000.10.08 <ULink URL="mailto:code@praterm.com.pl">Maciek</ULink>
</para>
<para>
Raid, Moxa.
</para>
</listitem>

<listitem>
<para>
v1.9, 2000.07.15 <ULink URL="mailto:lucek@praterm.com.pl">Lucek</ULink>
</para>
<para>
Kilkana¶cie wstawek (m.in. icewm, dosemu, lilo-colors, ux-1.0, nowe i ju¿ zrealizowane systemy i inne).
</para>
</listitem>

<listitem>
<para>
v1.8, 2000.06.30 <ULink URL="mailto:code@praterm.com.pl">Maciek</ULink>
</para>
<para>
Dokumentacja nowego SzarpDraw z parametrami definiowalnymi.
</para>
</listitem>

<listitem>
<para>
v1.7, 2000.05.01 <ULink URL="mailto:jojo@praterm.com.pl">Jarek</ULink>
</para>
<para>
Wersja SGML dla DocBook'a.
</para>
</listitem>

<listitem>
<para>
v1.6, 2000.03.08 <ULink URL="mailto:code@praterm.com.pl">Maciek</ULink>
</para>
<para>
Wersja SGML, opis instalacji i konfiguracji SZARPa.
</para>
</listitem>

<listitem>
<para>
v1.5, 2000.03.05 <ULink URL="mailto:jojo@praterm.com.pl">Jarek</ULink>
</para>
<para>
Dodany opis konfiguracji kppp.
</para>
</listitem>

<listitem>
<para>
v1.4, 2000.03.03 <ULink URL="mailto:jojo@praterm.com.pl">Jarek</ULink>
</para>
<para>
Poprawienie opisu konfiguracji /etc/rc.d.
</para>
</listitem>

<listitem>
<para>
v1.3, 2000.02.25 <ULink URL="mailto:jojo@praterm.com.pl">Jarek</ULink>
</para>
<para>
Dodanie opisu konfiguracji lilo, uporz±dkowanie spisu tre¶ci (Terminal).
</para>
</listitem>

<listitem>
<para>
v1.2, 2000.02.13 <ULink URL="mailto:lucek@praterm.com.pl">Lucek</ULink>
</para>
<para>
<!--dodanie nowej p³yty g³ównej w 1.1.1., dodanie nowego modemu w 1.1.12.-->
Dodanie nowej p³yty g³ównej (...), 
dodanie nowego modemu (...).
</para>
</listitem>

<listitem>
<para>
v1.1, 2000.02.04 <ULink URL="mailto:jojo@praterm.com.pl">Jarek</ULink>
</para>
<para>
Zmiana na iso-8859-2, dodany opis instalacji modemu i ppp, poprawione formatowanie, ca³y plik umieszczony w cvs.
</para>
</listitem>

<listitem>
<para>
v1.0, 2000.01.31 <ULink URL="mailto:lucek@praterm.com.pl">Lucek</ULink>
</para>
<para>
Za³o¿enie pliku.
</para>
</listitem>

</ItemizedList>

</para>
</chapter>
</part>

</book>

<!--
-->
